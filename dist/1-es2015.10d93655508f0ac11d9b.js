(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+XmF":function(e,t,r){"use strict";r.d(t,"e",(function(){return d})),r.d(t,"c",(function(){return u})),r.d(t,"f",(function(){return l})),r.d(t,"b",(function(){return m})),r.d(t,"a",(function(){return p})),r.d(t,"d",(function(){return g}));var o=r("QGCU"),i=r("2pNN"),n=r("oz8C"),s=r("fXoL"),a=r("tyNb"),c=r("F2nW");let h=(()=>{class e{constructor(e,t){this.router=e,this.globalServie=t}canActivate(){return!!n.a.getUserId()||(this.router.navigate(["staff/login"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(s.lc(a.b),s.lc(c.a))},e.\u0275prov=s.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),d=(()=>{class e{constructor(e,t){this.router=e,this.globalServie=t}canActivate(){return!!n.a.getUserId()||(isOnMobile()?this.router.navigate(["staff/login"]):this.router.navigate(["admin/login"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(s.lc(a.b),s.lc(c.a))},e.\u0275prov=s.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),u=(()=>{class e{constructor(e,t){this.router=e,this.globalServie=t}canActivate(){if(!new d(this.router,this.globalServie).canActivate())return!1;const e=o.a.getCurrentRole();if(e==i.i.Admin)return!0;switch(e){case i.i.Account:this.router.navigate(["staff/orders-manage"]);break;case i.i.Florist:this.router.navigate(["staff/florist-main"]);break;case i.i.Shipper:this.router.navigate(["staff/shipper-main"])}return!1}}return e.\u0275fac=function(t){return new(t||e)(s.lc(a.b),s.lc(c.a))},e.\u0275prov=s.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),l=(()=>{class e{constructor(e,t){this.router=e,this.globalServie=t}canActivate(){if(!new d(this.router,this.globalServie).canActivate())return!1;switch(o.a.getCurrentRole()){case i.i.Account:case i.i.Admin:this.router.navigate(["staff/orders-manage"]);break;case i.i.Florist:this.router.navigate(["staff/florist-main"]);break;case i.i.Shipper:this.router.navigate(["staff/shipper-main"])}return!1}}return e.\u0275fac=function(t){return new(t||e)(s.lc(a.b),s.lc(c.a))},e.\u0275prov=s.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),m=(()=>{class e{constructor(e,t){this.router=e,this.globalServie=t}canActivate(){if(!new h(this.router,this.globalServie).canActivate())return!1;const e=o.a.getCurrentRole();return e==i.i.Admin||e==i.i.Account||(this.router.navigate(["staff/login"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(s.lc(a.b),s.lc(c.a))},e.\u0275prov=s.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),p=(()=>{class e{constructor(e,t){this.router=e,this.globalServie=t}canActivate(){if(!new h(this.router,this.globalServie).canActivate())return!1;const e=o.a.getCurrentRole();return e==i.i.Admin||e==i.i.Account||e==i.i.Shipper||(this.router.navigate(["staff/login"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(s.lc(a.b),s.lc(c.a))},e.\u0275prov=s.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),g=(()=>{class e{constructor(e,t){this.router=e,this.globalServie=t}canActivate(){return!(!new h(this.router,this.globalServie).canActivate()||o.a.getCurrentRole()!=i.i.Florist&&(this.router.navigate(["staff/login"]),1))}}return e.\u0275fac=function(t){return new(t||e)(s.lc(a.b),s.lc(c.a))},e.\u0275prov=s.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},"0zL+":function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var o=r("mrSG"),i=r("uP5C"),n=r("jXcA"),s=r("dkQB"),a=r("fXoL"),c=r("pI0t"),h=r("F2nW");let d=(()=>{class e{constructor(e,t){this.httpService=e,this.globalService=t}updateAllCustomerMemberType(e){return this.httpService.post(s.a.updateAllCustomerMemberType,{config:e}).then(e=>(console.log(e),e)).catch(e=>{throw this.httpService.handleError(e),e})}updateFields(e,t){return this.httpService.post(s.a.updateCustomerFields,{customerId:e,obj:t}).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}getById(e){return this.httpService.get(s.a.getCustomeById,{id:e}).then(e=>{const t=e.customer,r=new i.a;return r.Id=t.Id,r.FullName=t.FullName,r.PhoneNumber=t.PhoneNumber,r.Birthday=t.Birthday,r.Sex=t.Sex,r.Address=new i.b,r.Address.Work=t.WorkAddress,r.Address.Home=t.HomeAddress,r.ContactInfo=new i.c,r.ContactInfo.Facebook=t.ContactInfo_Facebook,r.ContactInfo.Zalo=t.ContactInfo_Zalo,r.ContactInfo.Skype=t.ContactInfo_Skype,r.ContactInfo.Viber=t.ContactInfo_Viber,r.ContactInfo.Instagram=t.ContactInfo_Instagram,r.MainContactInfo=t.MainContactInfo,r.MembershipInfo=new i.d,r.MembershipInfo.AccumulatedAmount=t.AccumulatedAmount,r.MembershipInfo.UsedScoreTotal=t.UsedScoreTotal,r.MembershipInfo.AvailableScore=t.AvailableScore,r.MembershipInfo.MembershipType=t.MembershipType,r.ReceiverInfos=[],r.SpecialDays=[],t.receivers.forEach(e=>{const t=new n.a;t.PhoneNumber=e.PhoneNumber,t.FullName=e.FullName,r.ReceiverInfos.push(t)}),t.specialDays.forEach(e=>{const t=new i.e;t.Date=e.Date,t.Description=e.Description,r.SpecialDays.push(t)}),r}).catch(e=>{throw this.httpService.handleError(e),e})}updateReceiverList(e,t,r=!0){return this.httpService.post(s.a.updateReciverInfo,{customerId:e,receiverList:t},r).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}getCount(){return this.httpService.get(s.a.getCustomeCount).then(e=>e.max).catch(e=>{throw this.httpService.handleError(e),e})}updateCustomer(e){const t=[];return e.SpecialDays&&e.SpecialDays.forEach(e=>{t.push({date:e.Date,description:e.Description})}),this.httpService.post(s.a.updateCustomer,{fullName:e.FullName,phoneNumber:e.PhoneNumber,birthday:e.Birthday,sex:e.Sex,usedScoreTotal:e.MembershipInfo.UsedScoreTotal,availableScore:e.MembershipInfo.AvailableScore,accumulatedAmount:e.MembershipInfo.AccumulatedAmount,membershipType:e.MembershipInfo.MembershipType,facebook:e.ContactInfo.Facebook,zalo:e.ContactInfo.Zalo,skype:e.ContactInfo.Skype,viber:e.ContactInfo.Viber,instagram:e.ContactInfo.Instagram,mainContactInfo:e.MainContactInfo,id:e.Id,specialDays:t,workAddress:e.Address.Work,homeAddress:e.Address.Home}).then(()=>{}).catch(e=>{throw this.httpService.handleError(e),e})}updateList(e){return this.httpService.post(s.a.updateCustomerList,e).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}createCustomers(e){return Object(o.a)(this,void 0,void 0,(function*(){const t=[];e.forEach(e=>{t.push({fullName:e.FullName,phoneNumber:e.PhoneNumber,birthday:e.Birthday,sex:e.Sex,usedScoreTotal:e.MembershipInfo.UsedScoreTotal,availableScore:e.MembershipInfo.AvailableScore,accumulatedAmount:e.MembershipInfo.AccumulatedAmount,membershipType:e.MembershipInfo.MembershipType,facebook:e.ContactInfo.Facebook,zalo:e.ContactInfo.Zalo,skype:e.ContactInfo.Skype,viber:e.ContactInfo.Viber,instagram:e.ContactInfo.Instagram,mainContactInfo:e.MainContactInfo,homeAddress:e.Address.Home,workAddress:e.Address.Work,id:e.Id})});let r=100,o=100,i=[];for(r=0,o=t.length;r<o;r+=100)i=t.slice(r,r+100),yield this.httpService.post(s.a.createCustomers,{customers:i}).then(e=>{console.log(r)})}))}createCustomer(e){return this.httpService.post(s.a.createCustomer,{fullName:e.FullName,phoneNumber:e.PhoneNumber,birthday:e.Birthday,sex:e.Sex,usedScoreTotal:e.MembershipInfo.UsedScoreTotal,availableScore:e.MembershipInfo.AvailableScore,accumulatedAmount:e.MembershipInfo.AccumulatedAmount,membershipType:e.MembershipInfo.MembershipType,facebook:e.ContactInfo.Facebook,zalo:e.ContactInfo.Zalo,skype:e.ContactInfo.Skype,viber:e.ContactInfo.Viber,instagram:e.ContactInfo.Instagram,mainContactInfo:e.MainContactInfo,id:e.Id}).then(e=>e).catch(e=>{this.httpService.handleError(e)})}delete(e){return this.httpService.post(s.a.deleteCustomer,{id:e}).then(()=>{}).catch(e=>{throw this.httpService.handleError(e),e})}deleteMany(e){return this.httpService.post(s.a.deleteManyCustomer,{ids:e}).then(()=>{}).catch(e=>{throw this.httpService.handleError(e),e})}getCustomerFromRaw(e){const t=[];return e.forEach(e=>{const r=new i.a;r.Id=e.Id,r.FullName=e.FullName,r.PhoneNumber=e.PhoneNumber,r.Birthday=e.Birthday,r.Sex=e.Sex,r.Address=new i.b,r.Address.Work=e.WorkAddress,r.Address.Home=e.HomeAddress,r.ContactInfo=new i.c,r.ContactInfo.Facebook=e.ContactInfo_Facebook,r.ContactInfo.Zalo=e.ContactInfo_Zalo,r.ContactInfo.Skype=e.ContactInfo_Skype,r.ContactInfo.Viber=e.ContactInfo_Viber,r.ContactInfo.Instagram=e.ContactInfo_Instagram,r.MainContactInfo=e.MainContactInfo,r.MembershipInfo=new i.d,r.MembershipInfo.AccumulatedAmount=e.AccumulatedAmount,r.MembershipInfo.UsedScoreTotal=e.UsedScoreTotal,r.MembershipInfo.AvailableScore=e.AvailableScore,r.MembershipInfo.MembershipType=e.MembershipType,r.ReceiverInfos=[],r.SpecialDays=[],e.receivers&&e.receivers.length>0&&e.receivers.forEach(e=>{const t=new n.a;t.PhoneNumber=e.PhoneNumber,t.FullName=e.FullName,t.Address=e.Address,r.ReceiverInfos.push(t)}),e.specialDays&&e.specialDays.length>0&&e.specialDays.forEach(e=>{const t=new i.e;t.Date=e.Date,t.Description=e.Description,r.SpecialDays.push(t)}),t.push(r)}),t}getAll(){return this.httpService.get(s.a.getAllCustomer).then(e=>this.getCustomerFromRaw(e.customers)).catch(e=>{throw this.httpService.handleError(e),e})}getList(e,t,r,o=""){return this.httpService.get(s.a.getCustomers,{page:e-1,size:t,term:o,memberShipType:r}).then(e=>{const t={totalItemCount:0,totalPages:0,Customers:[]};return t.totalItemCount=e.totalItemCount,t.totalPages=e.totalPages,t.Customers=this.getCustomerFromRaw(e.items),t}).catch(e=>{throw this.httpService.handleError(e),e})}}return e.\u0275fac=function(t){return new(t||e)(a.lc(c.a),a.lc(h.a))},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},"2JOt":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));class o{constructor(){}}},Abtb:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var o=r("uP5C");class i{constructor(){this.Customer=new o.a}}},EeL4:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var o=r("TjQO"),i=r("dkQB"),n=r("fXoL"),s=r("pI0t"),a=r("F2nW");let c=(()=>{class e{constructor(e,t){this.htttpService=e,this.globalService=t}formatDate(e){const t=new Date(e);return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.getTime()}createPromotion(e){return e.StartTime=this.formatDate(e.StartTime),e.EndTime=this.formatDate(e.EndTime),this.htttpService.post(i.a.createPromotion,{amount:e.Amount,promotionType:e.PromotionType,name:e.Name,startTime:e.StartTime,endTime:e.EndTime,isEnable:e.IsEnable}).then(e=>e).catch(e=>{this.htttpService.handleError(e)})}updatePromotion(e){return e.StartTime=this.formatDate(e.StartTime),e.EndTime=this.formatDate(e.EndTime),this.htttpService.post(i.a.updatePromotion,{amount:e.Amount,promotionType:e.PromotionType,name:e.Name,startTime:e.StartTime,endTime:e.EndTime,isEnable:e.IsEnable,id:e.Id}).then(e=>e).catch(e=>{this.htttpService.handleError(e)})}deletePromotion(e){return this.htttpService.post(i.a.deletePromotion,{id:e}).then(e=>e).catch(e=>{this.htttpService.handleError(e)})}deletePromotions(e){return this.htttpService.post(i.a.deletePromotions,{promotionIds:e}).then(e=>e).catch(e=>{this.htttpService.handleError(e)})}getAvailablePromotions(e,t=!0){const r=this.formatDate(e);return this.htttpService.post(i.a.getAvailable,{currentDate:r},t).then(e=>{const t=[];return e.promotions.forEach(e=>{t.push(this.getPromotionFromRaw(e))}),t}).catch(e=>{throw this.htttpService.handleError(e),e})}getAll(){return this.htttpService.get(i.a.getAllPromotions).then(e=>{const t=[];return e.forEach(e=>{t.push(this.getPromotionFromRaw(e))}),t}).catch(e=>{throw this.htttpService.handleError(e),e})}getPromotionFromRaw(e){const t=new o.a;return t.Id=e.Id,t.PromotionType="Amount"===e.PromotionType?o.b.Amount:o.b.Percent,t.Name=e.Name,t.Amount=e.Amount,t.StartTime=e.StartTime,t.EndTime=e.EndTime,t.IsEnable=e.IsEnable,t}getRecords(e,t,r=""){return this.htttpService.get(i.a.getPromotions,{page:e-1,size:t,name:r}).then(e=>{if(!e)return null;const t={};return t.totalItemCount=+e.totalItemCount,t.totalPages=+e.totalPages,t.promotions=[],e.items&&e.items.forEach(e=>{t.promotions.push(this.getPromotionFromRaw(e))}),t}).catch(e=>{throw this.htttpService.handleError(e),e})}}return e.\u0275fac=function(t){return new(t||e)(n.lc(s.a),n.lc(a.a))},e.\u0275prov=n.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},Gdn9:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var o=r("nAti"),i=r("dkQB"),n=r("t6I5"),s=r("2JOt"),a=r("fXoL"),c=r("pI0t"),h=r("F2nW");let d=(()=>{class e{constructor(e,t){this.htttService=e,this.globalService=t}deleteProduct(e,t){return this.htttService.post(i.a.deleteProduct,{productImg:t,productId:e}).then(()=>{}).catch(e=>{this.htttService.handleError(e)})}deleteManyProducts(e,t){return this.htttService.post(i.a.deleteManyProduct,{productIds:e,productImgNames:t}).then(e=>{}).catch(e=>{this.htttService.handleError(e)})}validateProductPrices(e){return(!e.PriceList||e.PriceList.length<1)&&(e.PriceList=[e.Price&&e.Price>0?e.Price:0]),(!e.Price||e.Price<=0)&&(e.Price=e.PriceList[0]),e.PriceList.indexOf(e.Price)<0&&(e.PriceList.push(e.Price),console.log(e.Price,e.PriceList)),e.PriceList=e.PriceList.filter((e,t,r)=>r.indexOf(e)==t),e}insertListWithOneCate(e,t){return this.htttService.post(i.a.addBulkOneCate,{products:t,categoryId:e}).then(e=>{}).catch(e=>{throw this.htttService.handleError(e),e})}updateProduct(e,t=[],r=[],o){e=this.validateProductPrices(e),console.log(e);const n={categoryIds:JSON.stringify(t),tagIds:JSON.stringify(r),description:e.Description,price:e.Price,name:e.Name,productImg:o,id:e.Id,oldProductImg:e.ImageUrl,priceList:JSON.stringify(e.PriceList)};return this.htttService.postForm(i.a.updateProduct,n).then(e=>(this.globalService.stopLoading(),e)).catch(e=>{this.htttService.handleError(e)})}createProduct(e,t=[],r=[],o){e=this.validateProductPrices(e);const n={categoryIds:JSON.stringify(t),tagIds:JSON.stringify(r),description:e.Description,price:e.Price,name:e.Name,productImg:o,priceList:JSON.stringify(e.PriceList)};return this.htttService.postForm(i.a.createProduct,n).then(e=>(this.globalService.stopLoading(),e)).catch(e=>{this.htttService.handleError(e)})}getProductsFromRaw(e){const t=[];return e.forEach(e=>{const r=new o.a;r.Id=e.Id,r.Name=e.Name,r.Price=e.Price,r.ImageUrl=e.ImageUrl,r.PriceList=e.PriceList?JSON.parse(e.PriceList):[],r.Description=e.Description;const i=[];e.tags.forEach(e=>{const t=new s.a;t.Name=e.Name,t.Description=e.Description,t.Alias=e.Alias,t.Id=e.Id,i.push(t)});const a=[];e.categories.forEach(e=>{const t=new n.a;t.Id=e.Id,t.Description=e.Description,t.Name=e.Name,a.push(t)}),t.push({Product:r,Tags:i,Categories:a})}),t}getAll(){return this.htttService.post(i.a.getAllProducts).then(e=>this.getProductsFromRaw(e.products))}get(e,t){return this.htttService.post(e,t).then(e=>{if(!e)return null;const t={totalItemCount:0,totalPages:0,products:[]};return e.items?(t.totalItemCount=e.totalItemCount,t.totalPages=e.totalPages,t.products=this.getProductsFromRaw(e.items),t):null}).catch(e=>{throw this.htttService.handleError(e),e})}getRecords(e,t,r,o=[],n=""){return this.get(i.a.getProducts,{page:e-1,size:t,name:n,categoryId:r,tagIds:o})}getRecordsByPrice(e,t,r,o){return this.get(i.a.getProductsByPrice,{page:e-1,size:t,price:o,categoryId:r})}}return e.\u0275fac=function(t){return new(t||e)(a.lc(c.a),a.lc(h.a))},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},LQcV:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var o=r("2pNN"),i=r("AytR"),n=r("oz8C"),s=r("ofXK"),a=r("fXoL");let c=(()=>{class e{static getPreVATVal(e){return e/1.1}static detectMemberShipType(e){const t=n.a.getConfig();return e<t.MemberValue?o.d.NewCustomer:e>=t.MemberValue&&e<t.VipValue?o.d.Member:e>=t.VipValue&&e<t.VVipValue?o.d.Vip:e>=t.VVipValue?o.d.VVip:void 0}static getMemberDiscountPercent(e){const t=n.a.getConfig();switch(e){case o.d.NewCustomer:return 0;case o.d.Member:return t.MemberDiscount;case o.d.Vip:return t.VipDiscount;case o.d.VVip:return t.VVipDiscount}}static detectCustomerId(e){return e>9999?"FD-"+e.toString():e>999?"FD-0"+e.toString():e>99?"FD-00"+e.toString():e>9?"FD-000"+e.toString():"FD-0000"+e.toString()}static getFullImgUrl(e,t){return console.log(t),t.indexOf("http")>=0?t:`${i.a.base_domain}${e}${t}`}static getMainContact(e){switch(e.MainContactInfo){case o.b.Facebook:return e.ContactInfo.Facebook;case o.b.Zalo:return e.ContactInfo.Zalo;case o.b.Skype:return e.ContactInfo.Skype;case o.b.Viber:return e.ContactInfo.Viber;case o.b.Instagram:return e.ContactInfo.Instagram;default:return e.ContactInfo.Zalo}}static getFinalPrice(e,t,r,o){return o?e-e/100*t+r:e+r}static getGainedScore(e){return e/1e5}static getAmountFromScore(e){return 1e5*e}static toFormatCurrency(e){return new s.c("vi-VN").transform(e,"VND","symbol-narrow","","vi-VN")}static isBase64(e){try{return e.length>1e3}catch(t){return!1}}static getScoreFromOrder(e){let t=e.TotalAmount;return e.VATIncluded&&(t/=1.1),e.OrderDetails.forEach(e=>{e.AdditionalFee&&(t-=e.AdditionalFee)}),t/1e5}static getDetailDiscount(e){let t=0;return e.PercentDiscount&&e.PercentDiscount>0&&(t=e.ModifiedPrice/100*e.PercentDiscount),e.AmountDiscount&&e.AmountDiscount>0&&(t+=e.AmountDiscount),t}static geExchangableAmount(e){return 1e3*e}static receiverInfoCompare(e,t){return e.Address===t.Address&&e.FullName===t.FullName&&e.PhoneNumber===t.PhoneNumber}static deliveryInfoCompare(e,t){return!(!this.dateCompare(e.DateTime,t.DateTime)||e.Address!==t.Address||e.FullName!==t.FullName||e.PhoneNumber!==t.PhoneNumber)}static dateCompare(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()&&e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()}static getTimeFromExcel(e){if(!e||""===e)return 0;if(!(e.toString().indexOf("/")>-1)){const t=parseInt(e);return new Date(86400*(t-25569)*1e3).getTime()}{const t=e.split("/",3);if(console.log(t),3===t.length){const e=t[2].indexOf(".")>-1?0:parseInt(t[2]),r=parseInt(t[1])-1,o=parseInt(t[0]);return new Date(e,r,o,0,0,0,0).getTime()}}}static stringPriceToNumber(e){const t=e.substring(0,e.length-1).replace(/,/g,"");return parseFloat(t)||0}static getAlias(e){if(!e)return"";let t=e.toLowerCase();return t=t.replace(/\xe0|\xe1|\u1ea1|\u1ea3|\xe3|\xe2|\u1ea7|\u1ea5|\u1ead|\u1ea9|\u1eab|\u0103|\u1eb1|\u1eaf|\u1eb7|\u1eb3|\u1eb5/g,"a"),t=t.replace(/\xe8|\xe9|\u1eb9|\u1ebb|\u1ebd|\xea|\u1ec1|\u1ebf|\u1ec7|\u1ec3|\u1ec5/g,"e"),t=t.replace(/\xec|\xed|\u1ecb|\u1ec9|\u0129/g,"i"),t=t.replace(/\xf2|\xf3|\u1ecd|\u1ecf|\xf5|\xf4|\u1ed3|\u1ed1|\u1ed9|\u1ed5|\u1ed7|\u01a1|\u1edd|\u1edb|\u1ee3|\u1edf|\u1ee1/g,"o"),t=t.replace(/\xf9|\xfa|\u1ee5|\u1ee7|\u0169|\u01b0|\u1eeb|\u1ee9|\u1ef1|\u1eed|\u1eef/g,"u"),t=t.replace(/\u1ef3|\xfd|\u1ef5|\u1ef7|\u1ef9/g,"y"),t=t.replace(/\u0111/g,"d"),t=t.replace(/!|@|%|\^|\*|\(|\)|\+|\=|\<|\>|\?|\/|,|\.|\:|\;|\'|\"|\&|\#|\[|\]|~|\$|_|`|-|{|}|\||\\/g," "),t=t.replace(/ + /g," "),t=t.trim().replace(/ /g,"-"),t}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},NWHx:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var o=r("dkQB"),i=r("Abtb"),n=r("uP5C"),s=r("fXoL"),a=r("pI0t");let c=(()=>{class e{constructor(e){this.httpService=e}delete(e){return this.httpService.post(o.a.deletePurchase,{purchaseId:e}).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}getByTerm(e,t,r,s,a,c,h){return this.httpService.post(o.a.getPurchaseByTerm,{page:t-1,size:r,startTime:s,endTime:a,term:e,isUnknownOnly:c,method:h}).then(e=>{const t={totalItemCount:0,items:[],totalPages:0,currentPage:0};return t.totalItemCount=e.totalItemCount,t.currentPage=e.currentPage,t.totalPages=e.totalPages,e.items.forEach(e=>{const r=new i.a;r.Id=e.Id,r.AddingTime=e.AddingTime,r.Amount=e.Amount,r.Method=e.Method,r.OrderId=e.OrderId?e.OrderId:"",r.Note=e.Note?e.Note:"",e.order&&e.order.customer&&(r.Customer=new n.a,r.Customer.Id=e.order.customer.Id,r.Customer.FullName=e.order.customer.FullName),t.items.push(r)}),t}).catch(e=>{throw this.httpService.handleError(e),e})}bulkInsert(e){return this.httpService.post(o.a.bulkInsertPurchase,{purchases:e}).then(e=>e)}bulkCreate(e,t,r){const i=[];e.forEach(e=>{e.Id&&0!==e.Id||i.push(e)}),i.length<=0&&r(),this.httpService.post(o.a.bulkAddPurchase,{purchases:i,orderId:t}).then(e=>{r()}).catch(e=>{throw this.httpService.handleError(e),e})}assignToOrder(e,t,r){return this.httpService.post(o.a.assignPurchaseOrder,{orderId:t,purchaseId:e,amount:r}).then(e=>e)}update(e,t,r){return this.httpService.post(o.a.updatePurchaseOrder,{orderId:e.OrderId,amount:e.Amount,method:e.Method,id:e.Id,oldAmount:r,oldOrderId:t,addingTime:e.AddingTime,note:e.Note}).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}createOrUpdate(e,t){return this.httpService.post(o.a.addPurchase,{orderId:e.OrderId,amount:e.Amount,method:e.Method,newtotalPaidAmount:t,id:e.Id,addingTime:e.AddingTime,note:e.Note}).then(e=>e.purchase).catch(e=>{throw this.httpService.handleError(e),e})}addAndAssign(e){return this.httpService.post(o.a.addAndAsign,e).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}refund(e,t){return this.httpService.post(o.a.addRefund,{orderId:t,amount:e,addingTime:(new Date).getTime()}).then(e=>e.message).catch(e=>{throw this.httpService.handleError(e),e})}}return e.\u0275fac=function(t){return new(t||e)(s.lc(a.a))},e.\u0275prov=s.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},TjQO:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i}));class o{}var i=function(e){return e[e.Amount=0]="Amount",e[e.Percent=1]="Percent",e}({})},cPV5:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var o=r("t6I5"),i=r("dkQB"),n=r("fXoL"),s=r("pI0t"),a=r("F2nW");let c=(()=>{class e{constructor(e,t){this.htttpService=e,this.globalService=t}createCategory(e){return this.htttpService.post(i.a.createCategory,{name:e.Name,description:e.Description}).then(e=>e).catch(e=>{this.htttpService.handleError(e)})}updateCategory(e){return this.htttpService.post(i.a.updateCategory,{name:e.Name,description:e.Description,id:e.Id}).then(e=>e).catch(e=>{this.htttpService.handleError(e)})}deleteCategory(e){return this.htttpService.post(i.a.deleteCategory,{id:e}).then(e=>e).catch(e=>{this.htttpService.handleError(e)})}deleteCategorys(e){return this.htttpService.post(i.a.deleteCategories,{categoryIds:e}).then(e=>e).catch(e=>{this.htttpService.handleError(e)})}getAll(){return this.htttpService.get(i.a.getAllCategories,!1).then(e=>{const t=[];return e.forEach(e=>{const r=new o.a;r.Id=e.Id,r.Description=e.Description,r.Name=e.Name,t.push(r)}),t}).catch(e=>{throw this.htttpService.handleError(e),e})}getRecords(e,t,r=""){return this.htttpService.get(i.a.getCategories,{page:e-1,size:t,description:r}).then(e=>{if(!e)return null;const t={};return t.totalItemCount=+e.totalItemCount,t.totalPages=+e.totalPages,t.categories=[],e.items&&e.items.forEach(e=>{t.categories.push(e)}),t}).catch(e=>{throw this.htttpService.handleError(e),e})}}return e.\u0275fac=function(t){return new(t||e)(n.lc(s.a),n.lc(a.a))},e.\u0275prov=n.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},e6qa:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var o=r("mrSG"),i=r("jXcA"),n=r("2pNN"),s=r("dkQB"),a=r("r5y0"),c=r("TG2U"),h=r("fXoL"),d=r("pI0t"),u=r("kVqo");let l=(()=>{class e{constructor(e,t){this.httpService=e,this.orderService=t}updateFields(e,t){return this.httpService.post(s.a.updateODFields,{obj:t,orderDetailId:+e}).then(e=>e.result).catch(e=>{throw this.httpService.handleError(e),e})}getFinishedOrderIds(){return this.httpService.post(s.a.getFinishedOrderIds).then(e=>e.ids).catch(e=>{throw this.httpService.handleError(e),e})}completeOD(e,t){return this.httpService.post(s.a.completeOD,e).then(e=>{if(e)return e.finished?this.orderService.addScoreToCustomer(t):void 0}).catch(e=>{throw this.httpService.handleError(e),e})}completeOrder(e){return this.httpService.post(s.a.completeOrder,{orderId:e.OrderId}).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}resultConfirm(e,t,r){return this.httpService.postForm(s.a.resultConfirm,{orderDetailId:e,resultImg:r,makingId:t}).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}shippingConfirm(e,t,r){const o=this.getLastestShipping(e);return this.httpService.postForm(s.a.shippingConfirm,{shippingId:o.Id,shippingImg:t,orderDetailId:e.OrderDetailId,deliveryCompletedTime:(new Date).getTime(),note:r}).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}getFromRaw(e){const t=new a.c;return t.ProductName=e.ProductName,t.OrderId=e.OrderId,t.OrderDetailId=e.Id,t.State=e.State,t.ProductId=e.ProductId,t.ProductImageUrl=e.ProductImageUrl,t.Index=e.Index,t.DeliveryInfo.Address=e.ReceivingAddress,t.DeliveryInfo.DateTime=new Date(e.ReceivingTime),t.DeliveryInfo.FullName=e.ReceiverName,t.DeliveryInfo.PhoneNumber=e.ReceiverPhoneNumber,t.PurposeOf=e.PurposeOf,t.OriginalPrice=e.ProductPrice,t.ModifiedPrice=e.ProductPrice,t.AdditionalFee=e.AdditionalFee,t.IsVATIncluded=e.IsVATIncluded,t.Description=e.Description,t.CustomerName=e.CustomerName,t.CustomerPhoneNumber=e.CustomerPhoneNumber,t.HardcodeImageName=e.HardcodeImageName,t.PercentDiscount=e.PercentDiscount,t.AmountDiscount=e.AmountDiscount,t.MakingRequestTime=e.MakingRequestTime,t.ShippingNote=e.ShippingNote,t.Quantity=e.Quantity?e.Quantity:1,t.MakingNote=e.MakingNote,e.orderDedailShippings&&e.orderDedailShippings.length>0&&(t.Shippings=[],e.orderDedailShippings.forEach(e=>{const r=new i.f;r.AssignTime=e.AssignTime,r.CompleteTime=e.CompleteTime,r.DeliveryImageUrl=e.DeliveryImageUrl,r.Id=e.Id,r.Note=e.Note,r.StartTime=e.StartTime,r.OrderDetailId=t.OrderDetailId,r.ShipperId=e.ShipperId,t.Shippings.push(r)})),e.shippers&&e.shippers.length>0&&(t.Shippers=[],e.shippers.forEach(e=>{const r=new c.b;r.Id=e.Id,r.AvtUrl=e.AvtUrl,r.Email=e.Email,r.FullName=e.FullName,r.IsExternalShipper=e.IsExternalShipper,r.PhoneNumber=e.PhoneNumber,t.Shippers.push(r)})),e.orderDetailMakings&&e.orderDetailMakings.length>0&&(t.Makings=[],e.orderDetailMakings.forEach(e=>{const r=new i.b;r.AssignTime=e.AssignTime,r.CompleteTime=e.CompleteTime,r.ResultImageUrl=e.ResultImageUrl,r.Id=e.Id,r.StartTime=e.StartTime,r.FloristId=e.FloristId,r.OrderDetailId=t.OrderDetailId,r.MakingType=e.MakingType,t.Makings.push(r)})),e.florists&&e.florists.length>0&&(t.Florists=[],e.florists.forEach(e=>{const r=new c.b;r.Id=e.Id,r.AvtUrl=e.AvtUrl,r.Email=e.Email,r.FullName=e.FullName,r.IsExternalShipper=e.IsExternalShipper,r.PhoneNumber=e.PhoneNumber,t.Florists.push(r)})),t.NoteImages=e.NoteImages?e.NoteImages.split(","):[],t}getByState(e,t,r="ASC"){return this.getByStates([e],t,r)}getDetailWithTimeSort(e,t){return Object(o.a)(this,void 0,void 0,(function*(){const r=yield this.getByStates(e,t);return r?this.sortOrderDetail(r,t):[]}))}sortOrderDetail(e,t){let r=[];return e.forEach(e=>{r.push({detail:e,delta:Math.abs((new Date).getTime()-("ReceivingTime"===t?e.DeliveryInfo.DateTime.getTime():e.MakingRequestTime))})}),r=r.sort((e,t)=>e.delta-t.delta),r.map(e=>e.detail)}getByStates(e,t,r="ASC"){return this.httpService.post(s.a.getOrderDetailByStates,{states:e,orderColumn:t,direction:r}).then(e=>{const t=[];return null==e||null==e.orderDetails?[]:(e.orderDetails.forEach(e=>{t.push(this.getFromRaw(e))}),t)}).catch(e=>{throw this.httpService.handleError(e),e})}getByOrderId(e){return this.httpService.post(s.a.getOrderDetailsByOrderId,{orderId:e}).then(e=>{const t=[];return null==e||null==e.orderDetails?[]:(e.orderDetails.forEach(e=>{t.push(this.getFromRaw(e))}),t)}).catch(e=>{throw this.httpService.handleError(e),e})}assignSingleMaking(e,t,r,o){return this.httpService.post(s.a.assignSingleMaking,{orderDetailId:e,floristId:t,assignTime:r,makingType:o}).then(e=>e)}assignSingleShipper(e,t,r){return this.httpService.post(s.a.assignSingleShipper,{orderDetailId:e,shipperId:t,assignTime:r}).then(e=>e)}replaceShipper(e,t,r=-1){return this.httpService.post(s.a.replaceShipper,{orderDetailId:e,newShipperId:r,oldShippingId:t,newAssignTime:(new Date).getTime()}).then(e=>e)}replaceFlorist(e,t,r=-1){return this.httpService.post(s.a.replaceFlorist,{orderDetailId:e,newFloristId:r,oldMakingId:t,newAssignTime:(new Date).getTime()}).then(e=>e)}updateShippingFields(e,t){return this.httpService.post(s.a.updateShippingFields,{obj:t,id:e}).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}updateMakingFields(e,t){return this.httpService.post(s.a.updateMakingFields,{obj:t,id:e}).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}assignShipperForOrderDetails(e,t,r){return this.httpService.post(s.a.assignShipperForOrderDetails,{orderDetailIds:e,shipperId:t,assignTime:r}).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}assignFloristForOrderDetails(e,t,r){const o=[];return e.forEach(e=>{o.push({AssignTime:r,StartTime:r,FloristId:t,MakingType:e.State===n.f.SentBack?n.c.Fixing:n.c.Making,OrderDetailId:e.OrderDetailId})}),this.httpService.post(s.a.assignFloristForOrderDetails,{makings:o}).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}getByStateAndFloristId(e,t){return this.getByStatesAndFloristId(e,[t])}getByStatesAndFloristId(e,t){return this.httpService.post(s.a.getOrderDetailByStatesAndFloristId,{states:t,floristId:e}).then(e=>{const t=[];return e.orderDetails.forEach(e=>{t.push(this.getFromRaw(e))}),t}).catch(e=>{throw this.httpService.handleError(e),e})}getShippingOrderDetails(e){return this.httpService.post(s.a.getShippingOrderDetails,{shipperId:e}).then(e=>{const t=[];return null==e||e.length<=0?[]:(e.forEach(e=>{t.push(this.getFromRaw(e))}),this.sortOrderDetail(t,"ReceivingTime"))}).catch(e=>{throw this.httpService.handleError(e),e})}getMakingOrderDetails(e){return this.httpService.post(s.a.getMakingWaitOrderDetails,{floristId:e}).then(e=>{const t=[];return null==e||e.length<=0?[]:(e.forEach(e=>{t.push(this.getFromRaw(e))}),this.sortOrderDetail(t,"MakingRequestTime"))}).catch(e=>{throw this.httpService.handleError(e),e})}getLastestMaking(e){if(!e.Makings||e.Makings.length<=0)return new i.b;let t=new i.b;return t.AssignTime=0,e.Makings.forEach(e=>{e.AssignTime>t.AssignTime&&(t=e)}),t}getLastestShipping(e){if(!e.Shippings||e.Shippings.length<=0)return new i.f;let t=new i.f;return t.AssignTime=0,e.Shippings.forEach(e=>{e.AssignTime>t.AssignTime&&(t=e)}),t}updateDetailSeen(e,t,r,o=!0){return this.httpService.post(s.a.updateDetailSeen,{userId:t,orderDetailId:e,seenTime:r},o).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}getODFlorisAndShipper(e){return this.httpService.post(s.a.getOrderDetailShipperAndFlorist,{orderDetailId:e}).then(e=>({Florist:e.florist,Shipper:e.shipper,FixingFlorist:e.fixingFlorist})).catch(e=>{throw this.httpService.handleError(e),e})}getODSeeners(e){return this.httpService.post(s.a.getODSeeners,{orderDetailId:e}).then(e=>{const t=[];return e&&null!=e&&e.seeners.length>0&&e.seeners.forEach(e=>{t.push({FullName:e.user?e.user.FullName:"",UserId:e.user?e.user.Id:0,Role:e.user&&e.user.roles?e.user.roles[0].Name:"",SeenTime:e.SeenTime?e.SeenTime:0,Avt:e.user?e.user.AvtUrl:""})}),t}).catch(e=>{throw this.httpService.handleError(e),e})}}return e.\u0275fac=function(t){return new(t||e)(h.lc(d.a),h.lc(u.a))},e.\u0275prov=h.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},jXcA:function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"e",(function(){return s})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return c})),r.d(t,"f",(function(){return h})),r.d(t,"a",(function(){return u}));var o=r("sWfF"),i=r("2pNN");class n extends o.a{constructor(){super(...arguments),this.CustomerId="",this.AccountId="",this.VATIncluded=!1,this.TotalAmount=0,this.TotalPaidAmount=0,this.GainedScore=0,this.ScoreUsed=0,this.PercentDiscount=0,this.AmountDiscount=0}}class s{constructor(){this.Id=0,this.OrderId="",this.AdditionalFee=0,this.ProductId=0,this.ProductName="",this.ProductImageUrl="",this.ProductModifiedPrice=0,this.ProductPrice=0,this.TotalAmount=0,this.Description="",this.Index=-1,this.State=i.f.Added,this.IsVATIncluded=!1,this.Quantity=1,this.PurposeOf="",this.IsHardcodeProduct=!1,this.HardcodeProductImageName="",this.CustomerName="",this.CustomerPhoneNumber="",this.NoteImagesBlobbed="",this.DeliveryInfo=new d,this.SeenUsers=[],this.NoteImages=[]}}class a{static DeepCopy(e){var t=new a;return t.Avt=e.Avt,t.FullName=e.FullName,t.Role=e.Role,t.UserId=e.UserId,t.SeenTime=e.SeenTime,t}}class c{constructor(){}}class h{constructor(){}}class d{constructor(){this.ReceivingTime=0,this.ReceiverDetail=new u}}class u{constructor(){this.FullName="",this.PhoneNumber="",this.Address=""}}},kLqA:function(e,t,r){"use strict";t.__esModule=!0;var o=function(){function e(t){if(!t)throw new TypeError("Invalid argument; `value` has no value.");this.value=e.EMPTY,t&&e.isGuid(t)&&(this.value=t)}return e.isGuid=function(t){var r=t.toString();return t&&(t instanceof e||e.validator.test(r))},e.create=function(){return new e([e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-"))},e.createEmpty=function(){return new e("emptyguid")},e.parse=function(t){return new e(t)},e.raw=function(){return[e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-")},e.gen=function(e){for(var t="",r=0;r<e;r++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t},e.prototype.equals=function(t){return e.isGuid(t)&&this.value===t.toString()},e.prototype.isEmpty=function(){return this.value===e.EMPTY},e.prototype.toString=function(){return this.value},e.prototype.toJSON=function(){return{value:this.value}},e.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),e.EMPTY="00000000-0000-0000-0000-000000000000",e}();t.Guid=o},kVqo:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var o=r("uP5C"),i=r("jXcA"),n=r("dkQB"),s=r("r5y0"),a=r("LQcV");class c{}var h=r("Abtb"),d=r("TG2U"),u=r("fXoL"),l=r("pI0t"),m=r("0zL+");let p=(()=>{class e{constructor(e,t){this.httpService=e,this.customerService=t}getCustomerInfo(e,t){const r=new s.a;return r.Name=e.FullName,r.PhoneNumber=e.PhoneNumber,r.AvailableScore=e.MembershipInfo.AvailableScore,r.DiscountPercent=a.a.getMemberDiscountPercent(e.MembershipInfo.MembershipType),r.Id=e.Id,r.GainedScore=t.CustomerInfo.GainedScore,r.ScoreUsed=t.CustomerInfo.ScoreUsed,r.AccumulatedAmount=e.MembershipInfo.AccumulatedAmount,r.Address=e.Address.Home?e.Address.Home:e.Address.Work?e.Address.Work:"",r.CustomerScoreUsedTotal=e.MembershipInfo.UsedScoreTotal,r.ReceiverInfos=[],r.ReceiverInfos=[],e.ReceiverInfos.forEach(e=>{const t=new i.a;t.PhoneNumber=e.PhoneNumber,t.FullName=e.FullName,r.ReceiverInfos.push(t)}),e.SpecialDays.forEach(e=>{const t=new o.e;t.Date=e.Date,t.Description=e.Description,r.SpecialDays.push(t)}),r}getOrderVMByRaw(e){const t=new s.d;return null==e?null:(t.OrderId=e.Id,t.TotalAmount=e.TotalAmount,t.TotalPaidAmount=e.TotalPaidAmount,t.VATIncluded=e.VATIncluded,t.OrderType=e.OrderType,t.CreatedDate=new Date(e.CreatedDate),t.PercentDiscount=e.PercentDiscount,t.AmountDiscount=e.AmountDiscount,t.IsMemberDiscountApply=e.IsMemberDiscountApply,t.DoneTime=!e.DoneTime||e.DoneTime<=0?e.CreatedDate:e.DoneTime,t.IsFinished=e.IsFinished,e.purchases&&e.purchases.forEach(e=>{const r=new h.a;r.Id=e.Id,r.OrderId=e.OrderId,r.Amount=e.Amount,r.Method=e.Method,r.Note=e.Note,r.AddingTime=e.AddingTime,t.PurchaseItems.push(r)}),t.CustomerInfo=new s.a,e.customer&&(t.CustomerInfo.Name=e.customer.FullName,t.CustomerInfo.PhoneNumber=e.customer.PhoneNumber,t.CustomerInfo.AvailableScore=e.customer.AvailableScore,t.CustomerInfo.DiscountPercent=a.a.getMemberDiscountPercent(e.customer.MembershipType),t.CustomerInfo.Id=e.customer.Id,t.CustomerInfo.GainedScore=e.GainedScore,t.CustomerInfo.ScoreUsed=e.ScoreUsed,t.CustomerInfo.AccumulatedAmount=e.customer.AccumulatedAmount,t.CustomerInfo.Address=e.customer.HomeAddress?e.customer.HomeAddress:e.customer.WorkAddress?e.customer.WorkAddress:"",t.CustomerInfo.CustomerScoreUsedTotal=e.customer.UsedScoreTotal,t.CustomerInfo.ReceiverInfos=[],t.CustomerInfo.ReceiverInfos=[]),e.orderdetails&&e.orderdetails.length>0&&e.orderdetails.forEach(e=>{const r=new s.c;r.ProductName=e.ProductName,r.OrderId=e.OrderId,r.OrderDetailId=e.Id.toString(),r.State=e.State,r.ProductId=e.ProductId,r.ProductImageUrl=e.ProductImageUrl,r.Index=e.Index,r.DeliveryInfo.Address=e.ReceivingAddress,r.DeliveryInfo.DateTime=new Date(e.ReceivingTime),r.DeliveryInfo.FullName=e.ReceiverName,r.DeliveryInfo.PhoneNumber=e.ReceiverPhoneNumber,r.PurposeOf=e.PurposeOf,r.OriginalPrice=e.ProductPrice,r.ModifiedPrice=e.ProductPrice,r.AdditionalFee=e.AdditionalFee,r.IsVATIncluded=e.IsVATIncluded,r.Description=e.Description,r.CustomerName=e.CustomerName,r.IsFromHardCodeProduct=e.IsHardcodeProduct,r.CustomerPhoneNumber=e.CustomerPhoneNumber,r.HardcodeImageName=e.HardcodeImageName,r.PercentDiscount=e.PercentDiscount,r.AmountDiscount=e.AmountDiscount,r.MakingNote=e.MakingNote,r.ShippingNote=e.ShippingNote,r.Quantity=e.Quantity?e.Quantity:1,e.orderDedailShippings&&e.orderDedailShippings.length>0&&(r.Shippings=[],e.orderDedailShippings.forEach(e=>{let t=new i.f;t.AssignTime=e.AssignTime,t.CompleteTime=e.CompleteTime,t.DeliveryImageUrl=e.DeliveryImageUrl,t.Id=e.Id,t.Note=e.Note,t.StartTime=e.StartTime,t.ShipperId=e.ShipperId,r.Shippings.push(t)})),e.shippers&&e.shippers.length>0&&(r.Shippers=[],e.shippers.forEach(e=>{const t=new d.b;t.Id=e.Id,t.AvtUrl=e.AvtUrl,t.Email=e.Email,t.FullName=e.FullName,t.IsExternalShipper=e.IsExternalShipper,t.PhoneNumber=e.PhoneNumber,r.Shippers.push(t)})),e.orderDetailMakings&&e.orderDetailMakings.length>0&&(r.Makings=[],e.orderDetailMakings.forEach(e=>{const t=new i.b;t.AssignTime=e.AssignTime,t.CompleteTime=e.CompleteTime,t.ResultImageUrl=e.ResultImageUrl,t.Id=e.Id,t.StartTime=e.StartTime,t.FloristId=e.FloristId,r.Makings.push(t)})),e.florists&&e.florists.length>0&&(r.Florists=[],e.florists.forEach(e=>{const t=new d.b;t.Id=e.Id,t.AvtUrl=e.AvtUrl,t.Email=e.Email,t.FullName=e.FullName,t.IsExternalShipper=e.IsExternalShipper,t.PhoneNumber=e.PhoneNumber,r.Florists.push(t)})),r.NoteImages=e.NoteImages?e.NoteImages.split(","):[],t.OrderDetails.push(r)}),t)}addBulk(e){return this.httpService.post(n.a.addBulkOrder,e).then(e=>e.message)}getSaleModels(e){const t=[];return e.forEach(e=>{const r=new c;r.OrderId=e.OrderId,r.CreatedDate=e.CreatedDate,r.CustomerId=e.CustomerInfo.Id,r.CustomerName=e.CustomerInfo.Name,r.CustomerPhoneNumber=e.CustomerInfo.PhoneNumber,r.AmountTotal=e.TotalAmount,r.FeeTotal=0,r.DiscountTotal=0,r.PriceTotal=0,r.TotalPaidAmount=e.TotalPaidAmount,r.IsVATIncluded=e.VATIncluded,e.OrderDetails.forEach(e=>{r.PriceTotal+=e.ModifiedPrice,r.FeeTotal+=e.AdditionalFee}),r.FinalTotal=e.VATIncluded?a.a.getPreVATVal(r.AmountTotal):r.AmountTotal,t.push(r)}),t.sort((e,t)=>e.CreatedDate<t.CreatedDate?-1:e.CreatedDate>t.CreatedDate?1:0),t}finishOrders(e){return this.httpService.post(n.a.finishOrders,e).then(e=>e.updatedCount).catch(e=>{throw this.httpService.handleError(e),e})}getSaleTotalByTimes(e,t,r){return this.httpService.post(n.a.getOrderByDayRange,{startDate:e,endDate:t,purchaseMethod:r}).then(e=>{const t=this.getOrderVMsByRaw(e.orders);return this.getSaleModels(t)}).catch(e=>{throw this.httpService.handleError(e),e})}getSaleTotalByYear(e,t){const r=new Date;r.setFullYear(e,0,1),r.setHours(0,0,0,0);const o=new Date;return o.setFullYear(e,11,31),o.setHours(23,59,59,0),this.getSaleTotalByTimes(r.getTime(),o.getTime(),t)}getSaleTotalByRange(e,t){const r=new Date(e[1]);return r.setDate(r.getDate()+1),this.getSaleTotalByTimes(e[0],r.getTime(),t)}addScoreToCustomer(e){const t=new o.d,r=e.CustomerInfo.GainedScore;return t.AvailableScore=e.CustomerInfo.AvailableScore-e.CustomerInfo.ScoreUsed+r,t.AccumulatedAmount=e.CustomerInfo.AccumulatedAmount+a.a.getAmountFromScore(r),t.UsedScoreTotal=e.CustomerInfo.CustomerScoreUsedTotal+e.CustomerInfo.ScoreUsed,t.MembershipType=a.a.detectMemberShipType(t.AccumulatedAmount),this.customerService.updateFields(e.CustomerInfo.Id,{UsedScoreTotal:t.UsedScoreTotal,AvailableScore:t.AvailableScore,AccumulatedAmount:t.AccumulatedAmount,MembershipType:t.MembershipType}).catch(e=>{throw this.httpService.handleError(e),e})}getOrderVMsByRaw(e){const t=[];return!e||e.length<=0?[]:(e.forEach(e=>{t.push(this.getOrderVMByRaw(e))}),t)}getDebtOrders(e,t,r,o,i){return this.httpService.post(n.a.getDebts,{page:t-1,size:r,startTime:o,endTime:i,searchTerm:e}).then(e=>{const t={totalItemCount:0,totalPages:0,orders:[]};return t.totalItemCount=e.totalItemCount,t.totalPages=e.totalPages,t.orders=this.getOrderVMsByRaw(e.items),t}).catch(e=>{throw this.httpService.handleError(e),e})}getById(e){return this.httpService.post(n.a.getById,{id:e}).then(e=>e?this.getOrderVMByRaw(e.order):null).catch(e=>{throw this.httpService.handleError(e),e})}getSingleById(e){return this.httpService.post(n.a.getOrderNotLazyById,{id:e}).then(e=>e?this.getOrderVMByRaw(e.order):null).catch(e=>{throw this.httpService.handleError(e),e})}updateFields(e,t){return this.httpService.post(n.a.updateOrderFields,{obj:t,orderId:e}).then(e=>e.result).catch(e=>{throw this.httpService.handleError(e),e})}getOrderViewModelsByCusId(e){return this.httpService.post(n.a.getOrdersByCustomerId,{customerId:e}).then(e=>this.getOrderVMsByRaw(e.orders)).catch(e=>{throw this.httpService.handleError(e),e})}searchOrders(e,t,r,o){return this.httpService.post(n.a.searchOrders,{term:o,page:e,size:t,statuses:r}).then(e=>{const t={totalItemCount:0,totalPages:0,orders:[]};return t.totalItemCount=e.totalItemCount,t.totalPages=e.totalPages,t.orders=this.getOrderVMsByRaw(e.items),t}).catch(e=>{throw this.httpService.handleError(e),e})}getMaxNumberId(e){return this.httpService.post(n.a.getMaxOrderNumberId,{year:e}).then(e=>e.max).catch(e=>{throw this.httpService.handleError(e),e})}deleteOrderDetailByOrderId(e,t){return this.httpService.post(n.a.deleteOrderDetailByOrderId,{orderId:e,exceptImgNames:t}).then(e=>{}).catch(e=>{throw this.httpService.handleError(e),e})}deleteOrder(e){return this.httpService.post(n.a.deleteOrder,{orderId:e}).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}revertUsedScore(e){return this.httpService.post(n.a.revertUsedScore,{orderId:e}).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}uploadNoteImg(e){return this.httpService.postForm(n.a.uploadNoteImage,{noteImg:e},!1).then(e=>e.imgName).catch(e=>{throw this.httpService.handleError(e),e})}addOrderDetails(e){return console.log(e),this.httpService.post(n.a.addOrderDetails,{orderDetails:e}).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}updateOrderInfos(e,t,r,o){return this.httpService.post(n.a.updateOrderInfos,{orderDetails:t,orderId:e,totalPaidAmount:r,customerId:o}).then(e=>e).catch(e=>{throw this.httpService.handleError(e),e})}addOrEditOrder(e,t){return this.httpService.post(t?n.a.editOrder:n.a.addOrder,{customerId:e.CustomerId,id:e.Id,vatIncluded:e.VATIncluded,totalAmount:e.TotalAmount,totalPaidAmount:e.TotalPaidAmount,gaindedScore:e.GainedScore,scoreUsed:e.ScoreUsed,orderType:e.OrderType,createdDate:e.Created,percentDiscount:e.PercentDiscount,amountDiscount:e.AmountDiscount,isMemberDiscountApply:e.IsMemberDiscountApply,doneTime:e.DoneTime,isFinished:e.IsFinished}).then(t=>e).catch(e=>{throw this.httpService.handleError(e),e})}}return e.\u0275fac=function(t){return new(t||e)(u.lc(l.a),u.lc(m.a))},e.\u0275prov=u.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},lBcp:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var o=r("2JOt"),i=r("dkQB"),n=r("fXoL"),s=r("pI0t"),a=r("F2nW");let c=(()=>{class e{constructor(e,t){this.htttService=e,this.globalService=t}bulkAdd(e){const t=[];return e.forEach(e=>{t.push({Alias:e.Alias,Name:e.Name})}),this.htttService.post(i.a.bulkAddTags,e).then(e=>e).catch(e=>{throw this.htttService.handleError(e),e})}addBulkProductTag(e){return this.htttService.post(i.a.bulkAddProductsTags,e).then(e=>e).catch(e=>{throw this.htttService.handleError(e),e})}getAll(){return this.htttService.get(i.a.getAllTags).then(e=>{const t=[];return e.forEach(e=>{const r=new o.a;r.Id=e.Id,r.Description=e.Description,r.Name=e.Name,r.Alias=e.Alias,t.push(r)}),t}).catch(e=>{throw this.htttService.handleError(e),e})}createTag(e){return this.htttService.post(i.a.createTag,{alias:e.Alias,name:e.Name,description:e.Description}).then(e=>{const t=new o.a;return t.Id=e.tag.Id,t.Description=e.tag.Description,t.Name=e.tag.Name,t}).catch(t=>{throw this.htttService.handleError(t),e})}updateTag(e){return this.htttService.post(i.a.updateTag,{alias:e.Alias,name:e.Name,description:e.Description,id:e.Id}).then(e=>e).catch(e=>{this.htttService.handleError(e)})}deleteTag(e){return this.htttService.post(i.a.deleteTag,{id:e}).then(e=>e).catch(e=>{this.htttService.handleError(e)})}deleteTags(e){return this.htttService.post(i.a.deleteTags,{tagIds:e}).then(e=>e).catch(e=>{this.htttService.handleError(e)})}getRecords(e,t,r=""){return this.htttService.get(i.a.getTags,{page:e-1,size:t,description:r}).then(e=>{if(!e)return null;const t={};return t.totalItemCount=+e.totalItemCount,t.totalPages=+e.totalPages,t.tags=[],e.items&&e.items.forEach(e=>{t.tags.push(e)}),t}).catch(e=>{throw this.htttService.handleError(e),e})}}return e.\u0275fac=function(t){return new(t||e)(n.lc(s.a),n.lc(a.a))},e.\u0275prov=n.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},nAti:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));class o{constructor(){this.Description="",this.PriceList=[]}}},r5y0:function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"c",(function(){return s})),r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return c}));var o=r("LQcV"),i=r("jXcA");class n{constructor(){this.VATIncluded=!1,this.PercentDiscount=0,this.AmountDiscount=0,this.PurchaseItems=[],this.OrderDetails=[],this.CustomerInfo=new c,this.TotalAmount=0,this.TotalPaidAmount=0,this.OrderId=""}}class s{constructor(){this.ProductName="",this.OrderDetailId=0,this.OrderId="",this.OrderIndex=0,this.ProductId=0,this.ProductImageUrl="",this.Quantity=1,this.Index=0,this.PurposeOf="",this.OriginalPrice=0,this.ModifiedPrice=0,this.AdditionalFee=0,this.IsVATIncluded=!1,this.Description="",this.CustomerName="",this.CustomerPhoneNumber="",this.IsFromHardCodeProduct=!1,this.HardcodeImageName="",this.DeliveryInfo=new a,this.Makings=[],this.Shippings=[],this.SeenUsers=[],this.NoteImages=[],this.Shippers=[],this.Florists=[]}static DeepCopy(e){const t=new s;return t.MakingNote=e.MakingNote,t.MakingRequestTime=e.MakingRequestTime,t.CustomerName=e.CustomerName,t.CustomerPhoneNumber=e.CustomerPhoneNumber,t.IsVATIncluded=e.IsVATIncluded,t.ProductName=e.ProductName,t.OrderDetailId=e.OrderDetailId,t.State=e.State,t.ProductId=e.ProductId,t.ProductImageUrl=e.ProductImageUrl,t.Quantity=e.Quantity,t.Index=e.Index,t.DeliveryInfo=a.DeepCopy(e.DeliveryInfo),t.OriginalPrice=e.OriginalPrice,t.ModifiedPrice=e.ModifiedPrice,t.AdditionalFee=e.AdditionalFee,t.Description=e.Description,t.IsFromHardCodeProduct=e.IsFromHardCodeProduct,t.PurposeOf=e.PurposeOf,t.PercentDiscount=e.PercentDiscount,t.AmountDiscount=e.AmountDiscount,t.ShippingNote=e.ShippingNote,e.NoteImages&&Object.assign(t.NoteImages,e.NoteImages),e.SeenUsers&&e.SeenUsers.length>0&&e.SeenUsers.forEach(e=>{t.SeenUsers.push(i.c.DeepCopy(e))}),e.Shippings&&Object.assign(t.Shippings,e.Shippings),e.MakingNote&&Object.assign(t.MakingNote,e.MakingNote),e.Shippers&&Object.assign(t.Shippers,e.Shippers),e.Florists&&Object.assign(t.Florists,e.Florists),t}}class a{constructor(){this.DateTime=new Date}static DeepCopy(e){const t=new a;t.Address=e.Address,t.FullName=e.FullName,t.PhoneNumber=e.PhoneNumber;const r=e.DateTime.getTime();return t.DateTime=new Date(r),t}}class c{constructor(){this.DiscountPercent=0,this.ScoreUsed=0,this.GainedScore=0,this.AvailableScore=0,this.ReceiverInfos=[],this.SpecialDays=[]}static toViewModel(e,t=null){return t&&null!=t||(t=new c),t.Id=e.Id,t.Name=e.FullName,t.PhoneNumber=e.PhoneNumber,t.MembershipType=e.MembershipInfo.MembershipType,t.DiscountPercent=o.a.getMemberDiscountPercent(e.MembershipInfo.MembershipType),t.AvailableScore=e.MembershipInfo.AvailableScore,t.AccumulatedAmount=e.MembershipInfo.AccumulatedAmount,t.Address=e.Address.Home?e.Address.Home:e.Address.Work?e.Address.Work:"",t.CustomerScoreUsedTotal=e.MembershipInfo.UsedScoreTotal,Object.assign(t.ReceiverInfos,e.ReceiverInfos),Object.assign(t.SpecialDays,e.SpecialDays),t}}},sWfF:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));class o{constructor(){this.IsDeleted=!1,this.Created=(new Date).getTime()}}},t6I5:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));class o{}},uP5C:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"e",(function(){return s})),r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return h}));var o=r("sWfF"),i=r("2pNN");class n extends o.a{constructor(){super(),this.Index=0,this.Sex=i.j.Male,this.ContactInfo=new c,this.Address=new h,this.MembershipInfo=new a,this.FullName="",this.PhoneNumber="",this.SpecialDays=[],this.ReceiverInfos=[],this.MainContactInfo=i.b.Zalo}}class s{}class a{constructor(){this.UsedScoreTotal=0,this.AvailableScore=0,this.AccumulatedAmount=0,this.MembershipType=i.d.NewCustomer}}class c{constructor(){this.Zalo="",this.Viber="",this.Instagram="",this.Skype=""}}class h{constructor(){this.Home="",this.Work=""}}}}]);