!function(){function e(e,i){var c;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(c=function(e,i){if(!e)return;if("string"==typeof e)return t(e,i);var c=Object.prototype.toString.call(e).slice(8,-1);"Object"===c&&e.constructor&&(c=e.constructor.name);if("Map"===c||"Set"===c)return Array.from(e);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return t(e,i)}(e))||i&&e&&"number"==typeof e.length){c&&(e=c);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){c=e[Symbol.iterator]()},n:function(){var e=c.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==c.return||c.return()}finally{if(s)throw o}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,c=new Array(t);i<t;i++)c[i]=e[i];return c}function i(e,t,c){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var c=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(c){var r=Object.getOwnPropertyDescriptor(c,t);return r.get?r.get.call(i):r.value}})(e,t,c||e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function n(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,c=s(e);if(t){var r=s(this).constructor;i=Reflect.construct(c,arguments,r)}else i=c.apply(this,arguments);return o(this,i)}}function o(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?a(e):t}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){for(var i=0;i<t.length;i++){var c=t[i];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}function l(e,t,i){return t&&u(e.prototype,t),i&&u(e,i),e}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"711k":function(t,r,o){"use strict";o.r(r),o.d(r,"ROUTES",(function(){return Vi})),o.d(r,"StaffModule",(function(){return Ji}));var u,h=o("tyNb"),g=o("+XmF"),m=o("d2mR"),p=o("mrSG"),f=o("fXoL"),v=o("IAJr"),b=o("F2nW"),O=o("QGCU"),S=function e(t,i){d(this,e),this.Title=t,this.NavigateClass=i},D=o("ofXK"),k=o("CVMR"),I=o("oz8C"),y=((u=function(){function e(){d(this,e),this.IsDataLosingWarning=!0,this.NavigateClass="prev-icon",this.viewProdOptions={btnClass:"default",zoomFactor:.1,containerBackgroundColor:"#ccc",wheelZoom:!0,allowDrag:!0,btnIcons:{zoomIn:"fa fa-plus",zoomOut:"fa fa-minus",rotateClockwise:"fa fa-repeat",rotateCounterClockwise:"fa fa-undo",next:"fa fa-arrow-right",prev:"fa fa-arrow-left",fullscreen:"fa fa-arrows-alt"},btnShow:{zoomIn:!0,zoomOut:!0,rotateClockwise:!0,rotateCounterClockwise:!0,next:!0,prev:!0}};var t=v.a.getInjector();this.globalService=t.get(b.a),this.authService=t.get(O.a),this.location=t.get(D.h),this.ngZone=t.get(f.H),this.addressService=t.get(k.a)}return l(e,[{key:"ngOnInit",value:function(){var e=this;window.BaseReference={component:this,zone:this.ngZone,dateTimeSelected:function(t,i,c,r,n){return e.dateTimeSelected(t,i,c,r,n)},forceBackNavigate:function(){return e.backNavigateOnClick()},fileChosen:function(t){return e.fileChosen(t)},printConfirm:function(t){return e.printConfirm(t)},rememberPassConfirm:function(){return e.rememberPassConfirm()},savedLoginInforReturn:function(t,i){return e.savedLoginInforReturn(t,i)}},this.IsOnTerminal=this.globalService.isRunOnTerimal(),this.Init()}},{key:"menuOpening",value:function(e,t){menuOpen(e,t)}},{key:"savedLoginInforReturn",value:function(e,t){}},{key:"moveCursor",value:function(e){function t(t,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){setTimeout((function(){e>3&&moveCursor(t,e-3)}),10)}))},{key:"askForRememberPassword",value:function(){this.globalService.isRememberPassWillCheck&&(this.globalService.isRememberPassWillCheck=!1,this.globalService.isOnMobile()&&isRememberPassChecking())}},{key:"rememberPassConfirm",value:function(){this.openConfirm("B\u1ea1n mu\u1ed1n l\u01b0u th\xf4ng tin \u0111\u0103ng nh\u1eadp?",(function(){passwordSaving()}),(function(){passwordClearing()}))}},{key:"ngOnDestroy",value:function(){this.navigateOnClick.unsubscribe(),this.destroy()}},{key:"ngAfterViewInit",value:function(){var e=this;this.globalService.updaterMobileHeaderInfo(new S(this.Title,this.NavigateClass)),this.navigateOnClick=this.globalService.navigateOnClick.subscribe((function(t){t&&e.backNavigateOnClick()}))}},{key:"printConfirm",value:function(e){this.openConfirm("In th\xeam b\u1ea3n?",(function(){e()}),(function(){}))}},{key:"selectAddress",value:function(e){var t=this;this.globalwards.length<=0?this.addressService.getAllDistrict().then((function(i){t.globalDistricts=i,t.addressService.getAllWards().then((function(i){t.globalwards=i,t.addressRequest(e)}))})):this.addressRequest(e)}},{key:"addressRequest",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=this;addressRequest(this.globalDistricts,e,(function(e,i){i(t.globalwards.filter((function(t){return t.DistrictId===e})))}))}))},{key:"dateTimeSelected",value:function(e,t,i,c,r){}},{key:"showError",value:function(e){this.globalService.showError(e)}},{key:"showInfo",value:function(e){this.globalService.showInfo(e)}},{key:"showSuccess",value:function(e){this.globalService.showSuccess(e)}},{key:"showWarning",value:function(e){this.globalService.showWarning(e)}},{key:"openFile",value:function(){pickFile(!1)}},{key:"openFileForShare",value:function(){pickFile(!0)}},{key:"startLoading",value:function(){this.globalService.startLoading()}},{key:"stopLoading",value:function(){this.globalService.stopLoading()}},{key:"setStatusBarColor",value:function(e){this.globalService.setStatusBarColor(e)}},{key:"OnBackNaviage",value:function(){this.location.back()}},{key:"backNavigateOnClick",value:function(){var e=this;this.IsDataLosingWarning?this.openConfirm("D\u1eef li\u1ec7u hi\u1ec7n t\u1ea1i s\u1ebd b\u1ecb m\u1ea5t! B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn?",(function(){e.OnBackNaviage()})):this.OnBackNaviage()}},{key:"destroy",value:function(){}},{key:"fileChosen",value:function(e){}},{key:"openConfirm",value:function(e,t,i,c,r,n){this.globalService.openMobileConfirm(e,t,i,c,r,n)}},{key:"isEdittingOrder",get:function(){return this.globalService.isEdittingOrder},set:function(e){this.globalService.isEdittingOrder=e}},{key:"globalPurchases",get:function(){return this.globalService.currentPurchases},set:function(e){this.globalService.currentPurchases=e}},{key:"globalOrder",get:function(){return this.globalService.currentOrderViewModel},set:function(e){this.globalService.currentOrderViewModel=e}},{key:"globalOrderDetail",get:function(){return this.globalService.currentOrderDetailViewModel},set:function(e){this.globalService.currentOrderDetailViewModel=e}},{key:"globalDistricts",get:function(){return this.globalService.currentDistricts},set:function(e){this.globalService.currentDistricts=e}},{key:"globalwards",get:function(){return this.globalService.currentWards},set:function(e){this.globalService.currentWards=e}},{key:"CurrentUser",get:function(){return{FullName:I.a.getUserName(),Role:I.a.getRole(),Avt:I.a.getUserAvtUrl(),Id:I.a.getUserId(),PhoneNumber:I.a.getPhoneNumber()}}}]),e}()).\u0275fac=function(e){return new(e||u)},u.\u0275dir=f.Wb({type:u}),u),C=o("r5y0"),P=o("2pNN"),A=o("+hdJ"),w=o("jXcA"),R=o("TjQO"),T=o("Abtb"),M=o("uP5C"),F=o("kVqo"),x=o("0zL+"),N=o("kGcc"),L=o("EeL4"),U=o("NWHx"),B=o("3Pt+"),q=o("z17N"),E=o("O0x4"),H=o("wRGf"),V=o("jjJn");function J(e,t){if(1&e){var i=f.ic();f.hc(0,"li",72),f.hc(1,"div",73),f.hc(2,"span"),f.Rc(3),f.gc(),f.gc(),f.hc(4,"div",74),f.cc(5,"img",75),f.uc(6,"ImgPipe"),f.hc(7,"div",76),f.hc(8,"h5",77),f.Rc(9),f.gc(),f.hc(10,"span",78),f.Rc(11),f.uc(12,"myCurrPipe"),f.gc(),f.hc(13,"span",79),f.Rc(14),f.gc(),f.hc(15,"span",79),f.Rc(16),f.uc(17,"myCurrPipe"),f.gc(),f.hc(18,"span",79),f.Rc(19),f.uc(20,"myCurrPipe"),f.gc(),f.gc(),f.gc(),f.hc(21,"div",80),f.hc(22,"a",81),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit;return f.tc().deleteOrderDetail(c.Index)})),f.cc(23,"img",82),f.gc(),f.hc(24,"a",81),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit;return f.tc().editOrderDetail(c.Index)})),f.cc(25,"img",83),f.gc(),f.gc(),f.gc()}if(2&e){var c=t.$implicit,r=f.tc();f.Ob(3),f.Sc(c.Index+1),f.Ob(2),f.Bc("src",f.wc(6,7,c.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(c.ProductName),f.Ob(2),f.Tc("",f.vc(12,10,c.ModifiedPrice)," "),f.Ob(3),f.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",c.Quantity," "),f.Ob(2),f.Tc("Ph\u1ee5 ph\xed: ",f.vc(17,12,c.AdditionalFee)," "),f.Ob(3),f.Tc("Gi\u1ea3m gi\xe1: ",f.vc(20,14,r.getDetailDiscount(c)),"")}}function W(e,t){if(1&e){var i=f.ic();f.hc(0,"li",84),f.pc("click",(function(e){f.Jc(i);var c=t.index;return f.tc().selectPromotion(c)})),f.hc(1,"p",85),f.Rc(2),f.gc(),f.hc(3,"span",86),f.Rc(4),f.gc(),f.hc(5,"span",87),f.Rc(6),f.uc(7,"myDatePipe"),f.uc(8,"myDatePipe"),f.gc(),f.gc()}if(2&e){var c=t.$implicit,r=t.index,n=f.tc();f.Pb("data-index",r),f.Ob(2),f.Sc(c.Name),f.Ob(2),f.Sc(n.getPromotionAmount(c)),f.Ob(2),f.Uc("",f.vc(7,5,c.StartTime),"-",f.vc(8,7,c.EndTime),"")}}var j,G=((j=function(e){c(i,e);var t=n(i);function i(e,c,r,n,o,a){var s;return d(this,i),(s=t.call(this)).router=e,s.orderService=c,s.customerService=r,s.printJobService=n,s.promotionService=o,s.purchaseService=a,s.Title="Th\xeam \u0110\u01a1n",s.memberShipTitle="",s.totalBalance=0,s.orderDiscount=0,s.isPurchased=!1,s.purchaseType=P.g,s.qrContentTemplate="",s.purchaseNote="",s.promotions=[],s.currentPayAmount=0,s.qrContent="",s.wishingDoneTime=new Date,s}return l(i,[{key:"Init",value:function(){var e=this;if(this.promotionService.getAvailablePromotions((new Date).getTime(),!1).then((function(t){e.promotions=t})),this.order=this.globalOrder,this.isEdittingOrder)this.wishingDoneTime=new Date(this.order.DoneTime);else if(this.memberShipTitle="New Customer",!this.order.OrderId){var t=(new Date).getFullYear();this.orderService.getMaxNumberId(t).then((function(i){null==i&&(i=0),e.order.OrderId="".concat(t%100,".").concat((i+1).toString())}))}switch(this.onVATIncludedChange(),this.order.CustomerInfo.MembershipType){case P.c.NewCustomer:this.memberShipTitle="New Customer";break;case P.c.Member:this.memberShipTitle="Member";break;case P.c.Vip:this.memberShipTitle="VIP";break;case P.c.VVip:this.memberShipTitle="VVIP";break;default:this.memberShipTitle="New Customer"}this.totalBalance=this.order.TotalAmount-this.order.TotalPaidAmount}},{key:"onMemberDiscountChange",value:function(){this.totalAmountCalculate()}},{key:"getPromotionAmount",value:function(e){return e.PromotionType==R.b.Amount?e.Amount+" \u20ab":e.Amount+" %"}},{key:"selectPromotion",value:function(e){this.order.AmountDiscount=this.order.PercentDiscount=0;var t=this.promotions[e];t.PromotionType==R.b.Amount?this.order.AmountDiscount=t.Amount:this.order.PercentDiscount=t.Amount,hideReceiverPopup(),this.onVATIncludedChange()}},{key:"completingOrder",value:function(){this.placeOrder(!0)}},{key:"editOrder",value:function(){var e=this,t=[],i=[];this.order.OrderDetails.forEach((function(c){var r=new w.f;r.OrderId=e.globalOrder.OrderId,r.Id=c.OrderDetailId,r.State=c.State,r.CustomerName=e.globalOrder.CustomerInfo.Name,r.CustomerPhoneNumber=e.globalOrder.CustomerInfo.PhoneNumber;var n=new w.a;n.Address=c.DeliveryInfo.Address?c.DeliveryInfo.Address:e.order.CustomerInfo.Address?e.order.CustomerInfo.Address:"",n.FullName=c.DeliveryInfo.FullName?c.DeliveryInfo.FullName:e.order.CustomerInfo.Name?e.order.CustomerInfo.Name:"",n.PhoneNumber=c.DeliveryInfo.PhoneNumber?c.DeliveryInfo.PhoneNumber:e.order.CustomerInfo.PhoneNumber?e.order.CustomerInfo.PhoneNumber:"",r.DeliveryInfo.ReceivingTime=c.DeliveryInfo.DateTime?c.DeliveryInfo.DateTime.getTime():(new Date).getTime(),r.DeliveryInfo.ReceiverDetail=n,t.push(r);var o=!0;i.forEach((function(e){A.a.receiverInfoCompare(e,n)&&(o=!1)})),o&&i.push(n)})),this.globalOrder.CustomerInfo.ReceiverInfos.forEach((function(e){var t=!0;i.forEach((function(i){A.a.receiverInfoCompare(e,i)&&(t=!1)})),t&&i.push(e)})),this.globalPurchases.length>0&&this.purchaseService.bulkCreate(this.globalPurchases,this.order.OrderId,(function(){e.globalPurchases=[]})),this.orderService.updateOrderInfos(this.order.OrderId,t,this.order.TotalPaidAmount,this.order.CustomerInfo.Id).then((function(){"KHACH_LE"!=e.order.CustomerInfo.Id?e.customerService.updateReceiverList(e.order.CustomerInfo.Id,i).then((function(t){e.OnBackNaviage()})):e.OnBackNaviage()}))}},{key:"placeOrder",value:function(e){var t=this;this.currentPayAmount=this.order.TotalAmount-this.order.TotalPaidAmount,this.order.DoneTime=this.wishingDoneTime.getTime(),this.order.CustomerInfo&&this.order.CustomerInfo.Id||(this.order.CustomerInfo=new C.a,this.order.CustomerInfo.Id="KHACH_LE",this.order.CustomerInfo.Name="Kh\xe1ch l\u1ebb"),this.isEdittingOrder?this.editOrder():!this.order.OrderDetails||this.order.OrderDetails.length<=0?this.showError("Ch\u01b0a ch\u1ecdn s\u1ea3n ph\u1ea9m n\xe0o!"):!this.order.TotalAmount||this.order.TotalAmount<=0?this.showError("Th\xe0nh ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!"):this.order.TotalPaidAmount<=0?this.openConfirm("Ho\xe1 \u0111\u01a1n ch\u01b0a \u0111\u01b0\u1ee3c thanh to\xe1n, c\xf3 mu\u1ed1n ti\u1ebfp t\u1ee5c?",(function(){t.addPurchase()}),(function(){t.printConfirmation(e)}),null,"Thanh To\xe1n","Ti\u1ebfp t\u1ee5c"):this.printConfirmation(e)}},{key:"addPurchase",value:function(){this.currentPayAmount=this.totalBalance,this.currentPurType=P.g.Cash,this.purchaseNote="",purchaseDoing()}},{key:"printConfirmation",value:function(e){var t=this;this.order.CreatedDate||(this.order.CreatedDate=new Date),this.order.CustomerInfo.GainedScore=A.a.getScoreFromOrder(this.order),this.openConfirm("In ho\xe1 \u0111\u01a1n?",(function(){t.doPrintJob(e)}),(function(){t.orderConfirm(e)}),(function(){}))}},{key:"getDetailDiscount",value:function(e){return A.a.getDetailDiscount(e)}},{key:"doPrintJob",value:function(e){var t=0,i=[];this.order.OrderDetails.forEach((function(e){i.push({productName:e.ProductName,index:e.Index+1,price:e.ModifiedPrice,additionalFee:e.AdditionalFee,discount:A.a.getDetailDiscount(e),quantity:e.Quantity}),t+=e.ModifiedPrice*e.Quantity}));var c=[];this.globalPurchases.forEach((function(e){c.push({method:e.Method,amount:e.Amount})}));var r={Created:(new Date).getTime(),doneTime:new Date(this.order.DoneTime).toLocaleString("en-US",{hour12:!1}),Id:this.order.OrderId,Active:!0,IsDeleted:!1,saleItems:i,createdDate:this.order.CreatedDate.toLocaleString("en-US",{hour12:!1}),orderId:this.order.OrderId,summary:t,totalAmount:this.order.TotalAmount,totalPaidAmount:this.order.TotalAmount-this.AcctualBalance,totalBalance:this.totalBalance,vatIncluded:this.order.VATIncluded,memberDiscount:this.order.CustomerInfo.DiscountPercent,scoreUsed:this.order.CustomerInfo.ScoreUsed,gainedScore:this.order.CustomerInfo.GainedScore,totalScore:this.order.CustomerInfo.AvailableScore-this.order.CustomerInfo.ScoreUsed+this.order.CustomerInfo.GainedScore,customerName:this.order.CustomerInfo.Name,customerId:this.order.CustomerInfo.Id,discount:this.orderDiscount,isMemberDiscountApply:this.order.IsMemberDiscountApply,purchaseItems:c};this.printJobService.addPrintJob(r),this.orderConfirm(e)}},{key:"orderConfirm",value:function(e){var t=this;this.startLoading();var i=new w.e;i.CustomerId=this.order.CustomerInfo.Id,i.Id=this.order.OrderId,i.Created=this.order.CreatedDate.getTime(),i.VATIncluded=this.order.VATIncluded,i.TotalAmount=this.order.TotalAmount,i.TotalPaidAmount=this.order.TotalPaidAmount,i.GainedScore=this.order.CustomerInfo.GainedScore,i.ScoreUsed=this.order.CustomerInfo.ScoreUsed,i.Index=this.order.Index,i.OrderType=this.order.OrderType,i.PercentDiscount=this.order.PercentDiscount,i.AmountDiscount=this.order.AmountDiscount,i.IsMemberDiscountApply=this.order.IsMemberDiscountApply,i.DoneTime=this.order.DoneTime,this.orderService.addOrEditOrder(i,this.isEdittingOrder).then((function(c){return Object(p.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){var c,r,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.globalPurchases.length>0&&this.purchaseService.bulkCreate(this.globalPurchases,i.Id,(function(){n.globalPurchases=[]})),c=[],r=[],this.order.OrderDetails.forEach((function(t){var o=new w.f;o.OrderId=i.Id,o.IsHardcodeProduct=t.IsFromHardCodeProduct,o.HardcodeProductImageName=t.HardcodeImageName,o.ProductId=t.ProductId,o.ProductImageUrl=t.ProductImageUrl,o.ProductPrice=t.ModifiedPrice,o.AdditionalFee=t.AdditionalFee,o.ProductName=t.ProductName,o.Description=t.Description,o.State=e?P.e.Completed:P.e.Added,o.IsVATIncluded=i.VATIncluded,o.PurposeOf=t.PurposeOf,o.Index=t.Index,o.PercentDiscount=t.PercentDiscount,o.AmountDiscount=t.AmountDiscount,o.Quantity=t.Quantity,o.NoteImages=t.NoteImages,o.CustomerName=n.order.CustomerInfo.Name,o.CustomerPhoneNumber=n.order.CustomerInfo.PhoneNumber;var a=new w.a;a.Address=t.DeliveryInfo.Address?t.DeliveryInfo.Address:n.order.CustomerInfo.Address?n.order.CustomerInfo.Address:"",a.FullName=t.DeliveryInfo.FullName?t.DeliveryInfo.FullName:n.order.CustomerInfo.Name?n.order.CustomerInfo.Name:"",a.PhoneNumber=t.DeliveryInfo.PhoneNumber?t.DeliveryInfo.PhoneNumber:n.order.CustomerInfo.PhoneNumber?n.order.CustomerInfo.PhoneNumber:"",o.DeliveryInfo.ReceivingTime=t.DeliveryInfo.DateTime?t.DeliveryInfo.DateTime.getTime():n.order.DoneTime,o.DeliveryInfo.ReceiverDetail=a,c.push(o);var s=!0;r.forEach((function(e){A.a.receiverInfoCompare(e,a)&&(s=!1)})),s&&r.push(a)})),this.globalOrder.CustomerInfo.ReceiverInfos.forEach((function(e){var t=!0;r.forEach((function(i){A.a.receiverInfoCompare(e,i)&&(t=!1)})),t&&r.push(e)})),this.uploadImage(c).then((function(e){console.log("---------"),n.orderService.addOrderDetails(c).then((function(){"KHACH_LE"!=i.CustomerId?n.customerService.updateReceiverList(i.CustomerId,r).then((function(e){n.stopLoading(),e&&n.completeOrder()})):(n.stopLoading(),n.completeOrder())})).catch((function(e){console.log(e),n.globalService.stopLoading(),n.showError(e.toString())}))}));case 3:case"end":return t.stop()}}),t,this)})))}))}},{key:"selectPurType",value:function(e){this.currentPurType=e,e==P.g.Momo&&this.currentPayAmount>0&&(this.qrContent=this.qrContentTemplate+this.currentPayAmount.toString(),openQR())}},{key:"purchaseConfirm",value:function(){if(this.currentPayAmount>this.totalBalance||this.currentPayAmount<=0)this.showError("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!");else{var e=new T.a;e.OrderId=this.order.OrderId,e.Amount=+this.currentPayAmount,e.Method=this.currentPurType,e.Note=this.purchaseNote,e.AddingTime=(new Date).getTime(),this.globalPurchases.push(e),this.order.TotalPaidAmount+=e.Amount,this.currentPayAmount=0,this.showSuccess("\u0110\xe3 th\xeam 1 thanh to\xe1n!"),this.totalAmountCalculate(),this.totalBalance<=0?dismissPurchaseDialog():(this.currentPayAmount=this.totalBalance,this.currentPurType=P.g.Cash)}}},{key:"uploadImages",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t,c){var r="",n=0;e.NoteImages.forEach((function(o){return Object(p.a)(i,void 0,void 0,regeneratorRuntime.mark((function i(){var a,s,u,l,d=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,fetch(o);case 2:return a=i.sent,i.next=5,a.blob();case 5:if(null==(s=i.sent)){i.next=12;break}return u=new File([s],"result.png",{type:"image/png"}),i.next=10,this.orderService.uploadNoteImg(u).catch((function(e){d.showError(e),c(e)}));case 10:""!=(l=i.sent)&&(n==e.NoteImages.length-1?t(r+=l):(r=r+l+",",n+=1));case 12:case"end":return i.stop()}}),i,this)})))}))})).then((function(e){return e}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))}},{key:"uploadImage",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t,c){try{var r=0,n=!1;e.forEach((function(c){return Object(p.a)(i,void 0,void 0,regeneratorRuntime.mark((function i(){var o;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(r>=e.length-1)){i.next=4;break}n||(t("added"),n=!0),i.next=12;break;case 4:if(!(c.NoteImages&&c.NoteImages.length>0)){i.next=11;break}return i.next=7,this.uploadImages(c);case 7:(o=i.sent)&&(c.NoteImages=[],c.NoteImagesBlobbed=o,console.log(c.NoteImages,o),r+=1,n||(t("added"),n=!0)),i.next=12;break;case 11:r+=1;case 12:case"end":return i.stop()}}),i,this)})))}))}catch(o){c(o)}})).then((function(e){return e}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))}},{key:"totalAmountCalculate",value:function(){var e=this;this.order.TotalAmount=0,this.order.OrderDetails.forEach((function(t){t.AdditionalFee||(t.AdditionalFee=0);var i=t.ModifiedPrice*t.Quantity,c=i;t.PercentDiscount&&t.PercentDiscount>0&&(c-=c/100*t.PercentDiscount),t.AmountDiscount&&t.AmountDiscount>0&&(c-=t.AmountDiscount),e.order.TotalAmount+=e.order.CustomerInfo&&e.order.CustomerInfo.DiscountPercent&&e.order.CustomerInfo.DiscountPercent>0&&e.order.IsMemberDiscountApply?c-i/100*e.order.CustomerInfo.DiscountPercent+t.AdditionalFee:c+t.AdditionalFee})),this.orderDiscount=0,this.order.PercentDiscount&&this.order.PercentDiscount>0&&(this.orderDiscount=this.order.TotalAmount/100*this.order.PercentDiscount,this.order.TotalAmount-=this.orderDiscount),this.order.AmountDiscount&&this.order.AmountDiscount>0&&(this.order.TotalAmount=this.order.TotalAmount-this.order.AmountDiscount,this.orderDiscount+=this.order.AmountDiscount),this.order.VATIncluded&&(this.order.TotalAmount=this.order.TotalAmount+.1*this.order.TotalAmount),this.order.TotalAmount-=A.a.geExchangableAmount(this.order.CustomerInfo.ScoreUsed),this.totalBalance=this.order.TotalAmount-this.order.TotalPaidAmount}},{key:"onDiscountChanged",value:function(e){this.onVATIncludedChange()}},{key:"onPayChanged",value:function(e){this.currentPayAmount<10&&this.currentPayAmount>0&&(this.currentPayAmount*=1e3,this.moveCursor(this.currentPayAmount.toString().length,"currentPayAmount")),this.currentPayAmount=+this.currentPayAmount}},{key:"onPayFocus",value:function(){this.currentPayAmount||(this.currentPayAmount=0),this.moveCursor(this.currentPayAmount.toString().length,"currentPayAmount")}},{key:"onAmountDiscountChanged",value:function(e){this.order.AmountDiscount<10&&this.order.AmountDiscount>0&&(this.order.AmountDiscount*=1e3,this.moveCursor(this.order.AmountDiscount.toString().length,"AmountDiscount")),this.order.AmountDiscount=+this.order.AmountDiscount,this.onVATIncludedChange()}},{key:"onAmountDiscountFocus",value:function(){this.order.AmountDiscount||(this.order.AmountDiscount=0),this.moveCursor(this.order.AmountDiscount.toString().length,"AmountDiscount")}},{key:"onVATIncludedChange",value:function(){this.totalAmountCalculate()}},{key:"scoreExchange",value:function(){var e=this;openExcForm((function(t,i){return e.order.CustomerInfo.AvailableScore<t?(e.showError("V\u01b0\u1ee3t qu\xe1 \u0111i\u1ec3m t\xedch l\u0169y!!"),void i.call(e,!1)):A.a.geExchangableAmount(t)>=e.totalBalance?(e.showError("V\u01b0\u1ee3t qu\xe1 t\u1ed5ng ti\u1ec1n thanh to\xe1n!"),void i.call(e,!1)):(i.call(e,!0),e.order.CustomerInfo.ScoreUsed=t,void e.onVATIncludedChange())}))}},{key:"addNewOrderDetail",value:function(){this.globalOrderDetail=new C.c,this.router.navigate(["/staff/order-detail/-1"])}},{key:"editOrderDetail",value:function(e){var t=this;menuOpen((function(i){var c=C.c.DeepCopy(t.order.OrderDetails[e]);switch(+i){case 0:t.globalOrderDetail=c,t.router.navigate(["/staff/order-detail/"+e]);break;case 1:c.Index=t.order.OrderDetails.length,t.order.OrderDetails.push(c),t.onVATIncludedChange()}}),["Ch\u1ec9nh s\u1eeda","Sao ch\xe9p"])}},{key:"deleteOrderDetail",value:function(e){var t=this;this.openConfirm("Ch\u1eafc ch\u1eafn xo\xe1?",(function(){t.order.OrderDetails.splice(e,1);var i=0;t.order.OrderDetails.forEach((function(e){e.Index=i,i++})),t.onVATIncludedChange()}))}},{key:"completeOrder",value:function(){var e=this;if("KHACH_LE"!=this.order.CustomerInfo.Id){var t=new M.d,i=A.a.getScoreFromOrder(this.order);t.AvailableScore=this.order.CustomerInfo.AvailableScore-this.order.CustomerInfo.ScoreUsed+i,t.AccumulatedAmount=this.order.CustomerInfo.AccumulatedAmount+A.a.getAmountFromScore(i),t.UsedScoreTotal=this.order.CustomerInfo.CustomerScoreUsedTotal+this.order.CustomerInfo.ScoreUsed,t.MembershipType=A.a.detectMemberShipType(t.AccumulatedAmount),this.customerService.updateFields(this.order.CustomerInfo.Id,{UsedScoreTotal:t.UsedScoreTotal,AvailableScore:t.AvailableScore,AccumulatedAmount:t.AccumulatedAmount,MembershipType:t.MembershipType}).then((function(t){e.OnBackNaviage()}))}else this.OnBackNaviage()}},{key:"AcctualBalance",get:function(){return this.order?this.order.TotalAmount-this.order.TotalPaidAmount:0}}]),i}(y)).\u0275fac=function(e){return new(e||j)(f.bc(h.b),f.bc(F.a),f.bc(x.a),f.bc(N.a),f.bc(L.a),f.bc(U.a))},j.\u0275cmp=f.Vb({type:j,selectors:[["app-add-order"]],features:[f.Lb],decls:138,vars:36,consts:[["id","confirm",1,"page-content"],[1,"container"],[1,"row","custBrow",2,"margin-bottom","1vh"],[1,"col-10","custList"],["routerLink","/staff/select-customer",1,"main-bg","custListButton"],["src","../../../../assets/images/cust.png","alt",""],["behavior","scroll","direction","left"],[1,"col-2","prodAdd","text-right","pl-0"],[1,"main-bg",3,"click"],["src","../../../../assets/images/add.svg","alt","",1,"main-filter"],[1,"vatStatus"],[1,"vatScope"],["type","checkbox","id","IsMemberDiscountApply","name","IsMemberDiscountApply","value","1",1,"custom-checkbox",3,"ngModel","change","ngModelChange"],[1,"main-bg","vatCustom"],[1,"title-field"],[1,"form-group","orderInfo","borderless-field"],["type","text","name","OrderId","id","OrderId","placeholder","M\xe3 \u0111\u01a1n...",1,"orderField","small-height",3,"ngModel","readonly","ngModelChange"],["href","javascript:void(0)","onclick","openCustMenu()","type","button",1,"btn","main-btn","w-100",2,"margin-bottom","1vh"],[1,"row","col-xs-12",2,"height","62px","padding-left","15px","padding-right","15px"],[1,"addInfo",2,"width","50%","padding-right","5px"],[1,"form-group","orderInfo","borderless-field",2,"margin-bottom","1vh"],["type","number","name","PercentDiscount","id","PercentDiscount","placeholder","%",1,"orderField","small-height",3,"ngModel","input","ngModelChange"],[1,"addInfo",2,"width","50%","padding-left","5px"],["type","tel","name","AmountDiscount","id","AmountDiscount","placeholder","0",1,"orderField","small-height",3,"ngModel","ngModelChange","input","focus"],["type","text","name","wishingDoneTime","id","wishingDoneTime","placeholder","",1,"orderField","small-height",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],[1,"orderDetail","cusScroll"],["class","orderDetailItem",4,"ngFor","ngForOf"],["type","checkbox","id","VATIncluded","name","VATIncluded","value","1",1,"custom-checkbox",3,"ngModel","change","ngModelChange"],[1,"orderTotal"],[1,"totalOld"],[1,"orderPrice"],[1,"totalNew"],[1,"totalExc"],["href","javascript:void(0)","type","button",1,"btn","main-btn","w-100",2,"margin-top","2vh",3,"click"],[1,"row","orderConfirm","text-center"],[1,"col-4","exchange"],[1,"btn","main-bg","w-100",3,"click"],["src","../../../../assets/images/money.svg","alt","\u0110\u1ed5i \u0111i\u1ec3m",1,"main-filter"],[1,"col-8","pl-0"],["href","javascript:void(0)","type","submit",1,"btn","main-btn","w-100",3,"click"],["id","exchangeAdd",1,"popup-content"],["action","",1,""],[1,"form-group"],["for","",1,"excLabel"],[1,"memberLevel","v"],[1,""],["type","number","name","","id","exchange-val","placeholder","S\u1ed1 \u0111i\u1ec3m mu\u1ed1n \u0111\u1ed5i...",1,"mainForm"],[1,"row"],[1,"col-8","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-3","exchange-confirm"],["id","recentInfo",1,"actionMenu2"],["style","height: 69px;text-align: left;",3,"click",4,"ngFor","ngForOf"],["id","purchase-dialog",1,"popup-content"],[1,"checkOut",2,"margin-top","0px","padding","0px"],[1,"checkOutTotal"],[1,"checkOutLeft","mb-2"],["for","currentPayAmount",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","currentPayAmount","id","currentPayAmount",1,"mainForm",3,"ngModel","input","focus","ngModelChange"],["for","Note",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","purchaseNote","id","purchaseNote",1,"mainForm",3,"ngModel","ngModelChange"],[1,"form-group","methodGrid","mb-0"],["href","javascript:void(0)",1,"methodItem",3,"ngClass","click"],["src","../../../../assets/images/momo.jpg","alt",""],["src","../../../../assets/images/banking.jpg","alt",""],["src","../../../../assets/images/cash.png","alt",""],[1,"col-12","mx-auto","text-center"],["type","button",1,"btn","main-btn","w-100",3,"click"],["id","codeQR",1,"popup-content"],[3,"value","size"],["type","button","id","submit-btn","onClick","qrDone()",1,"btn","main-btn","w-100","mt-3"],[1,"orderDetailItem"],[1,"itemNumb"],[1,"itemDetail"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPrice"],[1,"prodCharge"],[1,"itemAction"],[3,"click"],["src","../../../../assets/images/delete.svg","alt","",1,"white-filter"],["src","../../../../assets/images/edit.svg","alt","",1,"white-filter"],[2,"height","69px","text-align","left",3,"click"],[1,"recentInfo-name"],[1,"recentInfo-phone",2,"width","25%"],[1,"recentInfo-date",2,"width","75%"]],template:function(e,t){if(1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.hc(4,"a",4),f.cc(5,"img",5),f.hc(6,"marquee",6),f.Rc(7),f.gc(),f.gc(),f.gc(),f.hc(8,"div",7),f.hc(9,"a",8),f.pc("click",(function(e){return t.addNewOrderDetail()})),f.cc(10,"img",9),f.gc(),f.gc(),f.gc(),f.hc(11,"div",10),f.hc(12,"p"),f.Rc(13,"\xc1p d\u1ee5ng khuy\u1ebfn m\xe3i th\xe0nh vi\xean"),f.gc(),f.hc(14,"div",11),f.hc(15,"input",12),f.pc("change",(function(e){return t.onMemberDiscountChange()}))("ngModelChange",(function(e){return t.order.IsMemberDiscountApply=e})),f.gc(),f.cc(16,"span",13),f.gc(),f.gc(),f.hc(17,"label",14),f.Rc(18,"M\xe3 \u0111\u01a1n "),f.gc(),f.hc(19,"div",15),f.hc(20,"input",16),f.pc("ngModelChange",(function(e){return t.order.OrderId=e})),f.gc(),f.gc(),f.hc(21,"a",17),f.Rc(22,"\xc1p d\u1ee5ng khuy\u1ebfn m\xe3i"),f.gc(),f.hc(23,"div",18),f.hc(24,"div",19),f.hc(25,"label",14),f.Rc(26,"Gi\u1ea3m gi\xe1 ph\u1ea7n tr\u0103m"),f.gc(),f.hc(27,"div",20),f.hc(28,"input",21),f.pc("input",(function(e){return t.onDiscountChanged(e.target.value)}))("ngModelChange",(function(e){return t.order.PercentDiscount=e})),f.gc(),f.gc(),f.gc(),f.hc(29,"div",22),f.hc(30,"label",14),f.Rc(31,"Gi\u1ea3 gi\xe1 ti\u1ec1n"),f.gc(),f.hc(32,"div",15),f.hc(33,"input",23),f.pc("ngModelChange",(function(e){return t.order.AmountDiscount=e}))("input",(function(e){return t.onAmountDiscountChanged(e.target.value)}))("focus",(function(e){return t.onAmountDiscountFocus()})),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(34,"label",14),f.Rc(35,"Th\u1eddi gian nh\u1eadn d\u1ef1 ki\u1ebfn"),f.gc(),f.hc(36,"div",15),f.hc(37,"input",24),f.pc("ngModelChange",(function(e){return t.wishingDoneTime=e})),f.gc(),f.cc(38,"owl-date-time",25,26),f.gc(),f.hc(40,"ul",27),f.Pc(41,J,26,16,"li",28),f.gc(),f.hc(42,"div",10),f.hc(43,"p"),f.Rc(44,"Bao g\u1ed3m VAT"),f.gc(),f.hc(45,"div",11),f.hc(46,"input",29),f.pc("change",(function(e){return t.onVATIncludedChange()}))("ngModelChange",(function(e){return t.order.VATIncluded=e})),f.gc(),f.cc(47,"span",13),f.gc(),f.gc(),f.hc(48,"div",30),f.hc(49,"p",31),f.Rc(50,"C\xf2n l\u1ea1i: "),f.hc(51,"span",32),f.Rc(52),f.uc(53,"myCurrPipe"),f.gc(),f.gc(),f.hc(54,"p",33),f.Rc(55,"Th\xe0nh ti\u1ec1n: "),f.hc(56,"span",32),f.Rc(57),f.uc(58,"myCurrPipe"),f.gc(),f.gc(),f.hc(59,"p",34),f.Rc(60,"\u0110\u1ed5i \u0111i\u1ec3m: "),f.hc(61,"span",32),f.Rc(62),f.gc(),f.gc(),f.gc(),f.hc(63,"a",35),f.pc("click",(function(e){return t.addPurchase()})),f.Rc(64," Thanh to\xe1n"),f.gc(),f.hc(65,"a",35),f.pc("click",(function(e){return t.completingOrder()})),f.Rc(66," K\u1ebft th\xfac \u0111\u01a1n"),f.gc(),f.hc(67,"div",36),f.hc(68,"div",37),f.hc(69,"button",38),f.pc("click",(function(e){return t.scoreExchange()})),f.cc(70,"img",39),f.gc(),f.gc(),f.hc(71,"div",40),f.hc(72,"a",41),f.pc("click",(function(e){return t.placeOrder(!1)})),f.Rc(73,"L\u01b0u"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(74,"div",42),f.hc(75,"form",43),f.hc(76,"div",44),f.hc(77,"label",45),f.Rc(78,"Th\xe0nh vi\xean: "),f.gc(),f.hc(79,"span",46),f.Rc(80),f.gc(),f.gc(),f.hc(81,"div",44),f.hc(82,"label",45),f.Rc(83,"\u0110i\u1ec3m t\xedch l\u0169y: "),f.gc(),f.hc(84,"span",47),f.Rc(85),f.gc(),f.gc(),f.hc(86,"div",44),f.cc(87,"input",48),f.gc(),f.hc(88,"div",49),f.hc(89,"div",50),f.hc(90,"button",51),f.Rc(91,"\u0110\u1ed5i \u0111i\u1ec3m"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(92,"div",52),f.hc(93,"ul"),f.Pc(94,W,9,9,"li",53),f.gc(),f.gc(),f.hc(95,"div",54),f.hc(96,"div",1),f.hc(97,"div",55),f.hc(98,"div",56),f.hc(99,"h3"),f.Rc(100,"T\u1ed5ng"),f.gc(),f.hc(101,"p"),f.Rc(102),f.uc(103,"myCurrPipe"),f.gc(),f.gc(),f.hc(104,"div",57),f.hc(105,"h4"),f.Rc(106,"S\u1ed1 ti\u1ec1n c\xf2n l\u1ea1i"),f.gc(),f.hc(107,"p"),f.Rc(108),f.uc(109,"myCurrPipe"),f.gc(),f.gc(),f.hc(110,"div",44),f.hc(111,"label",58),f.Rc(112,"S\u1ed1 ti\u1ec1n thanh to\xe1n"),f.gc(),f.hc(113,"input",59),f.pc("input",(function(e){return t.onPayChanged(e.target.value)}))("focus",(function(e){return t.onPayFocus()}))("ngModelChange",(function(e){return t.currentPayAmount=e})),f.gc(),f.gc(),f.hc(114,"div",44),f.hc(115,"label",60),f.Rc(116,"Ghi Ch\xfa"),f.gc(),f.hc(117,"input",61),f.pc("ngModelChange",(function(e){return t.purchaseNote=e})),f.gc(),f.gc(),f.hc(118,"div",62),f.hc(119,"a",63),f.pc("click",(function(e){return t.selectPurType(t.purchaseType.Momo)})),f.cc(120,"img",64),f.gc(),f.hc(121,"a",63),f.pc("click",(function(e){return t.selectPurType(t.purchaseType.Banking)})),f.cc(122,"img",65),f.gc(),f.hc(123,"a",63),f.pc("click",(function(e){return t.selectPurType(t.purchaseType.Cash)})),f.cc(124,"img",66),f.gc(),f.gc(),f.hc(125,"div",49),f.hc(126,"div",67),f.hc(127,"button",68),f.pc("click",(function(e){return t.purchaseConfirm()})),f.Rc(128,"X\xe1c nh\u1eadn"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(129,"div",69),f.hc(130,"span"),f.Rc(131,"Qu\xe9t m\xe3 QR \u0111\u1ec3 thanh to\xe1n "),f.gc(),f.hc(132,"div"),f.cc(133,"qr-code",70),f.gc(),f.hc(134,"div",49),f.hc(135,"div",67),f.hc(136,"button",71),f.Rc(137,"Xong"),f.gc(),f.gc(),f.gc(),f.gc()),2&e){var i=f.Hc(39);f.Ob(7),f.Uc("",t.order.CustomerInfo.Name," (-",t.order.CustomerInfo.DiscountPercent,"%)"),f.Ob(8),f.Ac("ngModel",t.order.IsMemberDiscountApply),f.Ob(5),f.Ac("ngModel",t.order.OrderId)("readonly",t.isEdittingOrder),f.Ob(8),f.Ac("ngModel",t.order.PercentDiscount),f.Ob(5),f.Ac("ngModel",t.order.AmountDiscount),f.Ob(4),f.Ac("owlDateTime",i)("owlDateTimeTrigger",i)("ngModel",t.wishingDoneTime),f.Ob(1),f.Ac("stepMinute",5),f.Ob(3),f.Ac("ngForOf",t.order.OrderDetails),f.Ob(5),f.Ac("ngModel",t.order.VATIncluded),f.Ob(6),f.Tc("",f.vc(53,28,t.AcctualBalance)," "),f.Ob(5),f.Tc("",f.vc(58,30,t.order.TotalAmount)," "),f.Ob(5),f.Sc(t.order.CustomerInfo.ScoreUsed),f.Ob(18),f.Sc(t.memberShipTitle),f.Ob(5),f.Sc(t.order.CustomerInfo.AvailableScore),f.Ob(9),f.Ac("ngForOf",t.promotions),f.Ob(8),f.Sc(f.vc(103,32,t.order.TotalAmount)),f.Ob(6),f.Sc(f.vc(109,34,t.totalBalance)),f.Ob(5),f.Ac("ngModel",t.currentPayAmount),f.Ob(4),f.Ac("ngModel",t.purchaseNote),f.Ob(2),f.Ac("ngClass","Momo"===t.currentPurType?" img-purchase-selected":""),f.Ob(2),f.Ac("ngClass","Banking"===t.currentPurType?" img-purchase-selected":""),f.Ob(2),f.Ac("ngClass","Cash"===t.currentPurType?" img-purchase-selected":""),f.Ob(10),f.Ac("value",t.qrContent)("size",290)}},directives:[h.c,B.a,B.k,B.n,B.b,B.p,q.c,q.f,q.b,D.k,B.v,B.l,B.m,D.j,E.a],pipes:[H.a,V.a,H.b],styles:[""]}),j),X=o("e6qa");function $(e,t){if(1&e){var i=f.ic();f.hc(0,"a",7),f.pc("click",(function(e){return f.Jc(i),f.tc().openFileForShare()})),f.Rc(1,"Ch\u1ecdn h\xecnh"),f.gc()}}function _(e,t){if(1&e){var i=f.ic();f.hc(0,"a",7),f.pc("click",(function(e){return f.Jc(i),f.tc().openFile()})),f.Rc(1,"Ch\u1ecdn h\xecnh"),f.gc()}}function z(e,t){if(1&e){var i=f.ic();f.hc(0,"div"),f.hc(1,"input",8,9),f.pc("change",(function(e){return f.Jc(i),f.tc().onChange(e)})),f.gc(),f.hc(3,"a",7),f.pc("click",(function(e){return f.Jc(i),f.Hc(2).click()})),f.Rc(4,"Ch\u1ecdn h\xecnh"),f.gc(),f.gc()}}function Q(e,t){if(1&e){var i=f.ic();f.hc(0,"a",7),f.pc("click",(function(e){return f.Jc(i),f.tc().shareForCus()})),f.Rc(1,"Share cho KH"),f.gc()}}function K(e,t){if(1&e){var i=f.ic();f.hc(0,"a",7),f.pc("click",(function(e){return f.Jc(i),f.tc().confirm("")})),f.Rc(1,"X\xe1c nh\u1eadn"),f.gc()}}function Z(e,t){if(1&e){var i=f.ic();f.hc(0,"a",7),f.pc("click",(function(e){return f.Jc(i),f.tc().shipperCofirm()})),f.Rc(1,"X\xe1c nh\u1eadn"),f.gc()}}var Y,ee,te=((Y=function(e){c(r,e);var t=n(r);function r(e,i,c,n){var o;return d(this,r),(o=t.call(this)).orderDetailService=e,o.customerService=i,o.router=c,o.orderService=n,o.Title="X\xe1c nh\u1eadn v\u1edbi kh\xe1ch h\xe0ng",o.edittingImageUrl="",o.totalBalance=0,o.orderDetail=new C.c,o.order=new C.d,o.customer=new M.a,o}return l(r,[{key:"Init",value:function(){var e=this;this.orderDetail=this.globalOrderDetail,this.orderService.getById(this.orderDetail.OrderId).then((function(t){e.order=t,e.totalBalance=e.order.TotalAmount-e.order.TotalPaidAmount,e.customerService.getById(e.order.CustomerInfo.Id).then((function(t){e.customer=t}))}))}},{key:"fileChosen",value:function(e){this.edittingImageUrl="data:image/png;base64,"+e}},{key:"onChange",value:function(e){var t=this,i=e.target.files[0];if(i)if(null!=i.type.match(/image\/*/)){var c=new FileReader;c.readAsDataURL(i),c.onload=function(e){t.edittingImageUrl=c.result.toString()}}else this.showError("Ph\u1ea3i ch\u1ecdn h\xecnh !!")}},{key:"destroy",value:function(){i(s(r.prototype),"destroy",this).call(this),deleteTempImage()}},{key:"shipperCofirm",value:function(){var e=this;getShippingNoteDialog("X\xe1c nh\u1eadn",(function(t){e.confirm(t)}))}},{key:"confirm",value:function(e){var t=this;switch(this.CurrentUser.Role){case P.h.Account:case P.h.Admin:""!=this.edittingImageUrl&&fetch(this.edittingImageUrl).then((function(e){return e.blob()})).then((function(e){var i=new File([e],"result.png",{type:"image/png"});t.orderDetailService.resultConfirm(t.orderDetail.OrderDetailId,i).then((function(e){t.router.navigate(["staff/account-main"])}))}));break;case P.h.Shipper:""!=this.edittingImageUrl?fetch(this.edittingImageUrl).then((function(e){return e.blob()})).then((function(i){var c=new File([i],"shipping.png",{type:"image/png"});t.orderDetailService.shippingConfirm(t.orderDetail.OrderDetailId,c,e).then((function(e){t.router.navigate(["staff/shipper-main"])}))})):this.orderDetailService.updateFields(this.orderDetail.OrderDetailId,{DeliveryCompletedTime:(new Date).getTime(),State:P.e.Deliveried,MakingSortOrder:0,ShippingSortOrder:0,ShippingNote:e}).then((function(e){t.router.navigate(["staff/shipper-main"])}))}}},{key:"shareForCus",value:function(){""!=this.edittingImageUrl&&(this.IsOnTerminal?shareImageCus(A.a.getMainContact(this.customer)):shareImageCusWithData(this.edittingImageUrl,A.a.getMainContact(this.customer)))}}]),r}(y)).\u0275fac=function(e){return new(e||Y)(f.bc(X.a),f.bc(x.a),f.bc(h.b),f.bc(F.a))},Y.\u0275cmp=f.Vb({type:Y,selectors:[["app-customer-confirm"]],features:[f.Lb],decls:11,vars:7,consts:[["id","staff",1,"page-content"],[1,"container"],[1,"image-top"],["id","selected-image","onclick","rotateImage()","alt","",3,"src"],[1,"image-action"],["href","javascript:void(0)","class","main-bg",3,"click",4,"ngIf"],[4,"ngIf"],["href","javascript:void(0)",1,"main-bg",3,"click"],["type","file","id","resultFile","name","uploadedFile","hidden","",1,"img-cover","file-upload-default",3,"change"],["imageUpload",""]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.cc(3,"img",3),f.gc(),f.hc(4,"div",4),f.Pc(5,$,2,0,"a",5),f.Pc(6,_,2,0,"a",5),f.Pc(7,z,5,0,"div",6),f.Pc(8,Q,2,0,"a",5),f.Pc(9,K,2,0,"a",5),f.Pc(10,Z,2,0,"a",5),f.gc(),f.gc(),f.gc()),2&e&&(f.Ob(3),f.Ac("src",t.edittingImageUrl,f.Lc),f.Ob(2),f.Ac("ngIf",t.IsOnTerminal&&"Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf",t.IsOnTerminal&&"Shipper"==t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf",!t.IsOnTerminal),f.Ob(1),f.Ac("ngIf","Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Shipper"==t.CurrentUser.Role))},directives:[D.l],styles:[""]}),Y),ie=o("AytR"),ce=o("dkQB"),re=((ee=function(){function e(t){d(this,e),this.globalService=t}return l(e,[{key:"pushFileToStorage",value:function(e,t,i){}},{key:"push",value:function(e,t,i){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","");case 1:case"end":return e.stop()}}),e)})))}},{key:"deleteFile",value:function(e,t){}},{key:"downloadFIle",value:function(e,t){var i=new XMLHttpRequest;i.responseType="blob",i.onload=function(e){t(i.response)},i.open("GET",e),i.send()}},{key:"pushStringToStorage",value:function(e,t,i){}}]),e}()).\u0275fac=function(e){return new(e||ee)(f.lc(b.a))},ee.\u0275prov=f.Xb({token:ee,factory:ee.\u0275fac,providedIn:"root"}),ee);function ne(e,t){if(1&e&&(f.hc(0,"div",22),f.hc(1,"span",12),f.Rc(2,"SDT ng\u01b0\u1eddi nh\u1eadn:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.orderDetail.DeliveryInfo.PhoneNumber)}}function oe(e,t){if(1&e&&(f.hc(0,"div",22),f.hc(1,"span",12),f.Rc(2,"\u0110\u1ecba ch\u1ec9 giao:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.orderDetail.DeliveryInfo.Address)}}var ae,se=((ae=function(e){c(r,e);var t=n(r);function r(e,i,c,n,o){var a;return d(this,r),(a=t.call(this)).router=e,a.orderService=i,a.orderDetailService=c,a.storageService=n,a.customerService=o,a.Title="X\xe1c nh\u1eadn giao h\xe0ng",a.sharingImage="",a}return l(r,[{key:"Init",value:function(){var e=this;this.orderDetail=this.globalOrderDetail,this.customerService.getById(this.globalOrder.CustomerInfo.Id).then((function(t){e.customer=t}))}},{key:"destroy",value:function(){i(s(r.prototype),"destroy",this).call(this),deleteTempImage()}},{key:"confirmOrderDetail",value:function(){var e=this;this.orderDetailService.updateFields(this.orderDetail.OrderDetailId,{State:P.e.Completed,ShippingSortOrder:0}).then((function(){return Object(p.a)(e,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.orderDetailService.getByOrderId(this.orderDetail.OrderId);case 2:if(e.t0=e.sent.filter((function(e){return e.State!=P.e.Completed})).length,0!=e.t0){e.next=7;break}this.orderDetailService.updateStatusByOrderId(this.orderDetail.OrderId,P.e.Completed,(new Date).getTime()).then((function(e){t.router.navigate(["staff/orders-manage"])})),e.next=8;break;case 7:this.router.navigate(["staff/orders-manage"]);case 8:case"end":return e.stop()}}),e,this)})))}))}},{key:"shareToCus",value:function(){var e=this;this.startLoading(),this.storageService.downloadFIle("".concat(ie.a.base_domain).concat(ce.b.shipping_img).concat(this.orderDetail.DeliveryImageUrl),(function(t){e.stopLoading();var i=new FileReader;i.readAsDataURL(t),i.onloadend=function(){var t=i.result.toString();e.sharingImage=t,shareImageCusWithData(e.sharingImage,A.a.getMainContact(e.customer))}}))}}]),r}(y)).\u0275fac=function(e){return new(e||ae)(f.bc(h.b),f.bc(F.a),f.bc(X.a),f.bc(re),f.bc(x.a))},ae.\u0275cmp=f.Vb({type:ae,selectors:[["app-final-confirm"]],features:[f.Lb],decls:61,vars:30,consts:[["id","deliConfirm",1,"page-content"],[1,"container"],[1,"prodDetail"],[1,"prodGen"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPriceOld"],[1,"prodCharge"],[1,"prodPrice"],[1,"prodInfo","cusScroll"],[1,"prodQuan","infoGroup"],[1,"itemlabel"],[1,"itemVal"],[1,"prodName","infoGroup"],[1,"prodTime","infoGroup"],["class","prodAddr infoGroup",4,"ngIf"],[1,"prodDesc","infoGroup"],[1,"row"],[1,"col-10","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-2",3,"click"],["type","submit",1,"btn","grey-btn","w-100","mt-2",3,"click"],[1,"prodAddr","infoGroup"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.cc(4,"img",4),f.uc(5,"ImgPipe"),f.cc(6,"img",4),f.uc(7,"ImgPipe"),f.hc(8,"div",5),f.hc(9,"h5",6),f.Rc(10),f.gc(),f.hc(11,"span",7),f.Rc(12),f.uc(13,"myCurrPipe"),f.gc(),f.hc(14,"span",8),f.Rc(15),f.uc(16,"myCurrPipe"),f.gc(),f.hc(17,"span",9),f.Rc(18),f.uc(19,"myCurrPipe"),f.gc(),f.gc(),f.gc(),f.hc(20,"div",10),f.hc(21,"div",11),f.hc(22,"span",12),f.Rc(23,"M\xe3 \u0111\u01a1n: "),f.gc(),f.hc(24,"span",13),f.Rc(25),f.gc(),f.gc(),f.hc(26,"div",14),f.hc(27,"span",12),f.Rc(28,"T\xean KH"),f.gc(),f.hc(29,"span",13),f.Rc(30),f.gc(),f.gc(),f.hc(31,"div",14),f.hc(32,"span",12),f.Rc(33,"SDT KH"),f.gc(),f.hc(34,"span",13),f.Rc(35),f.gc(),f.gc(),f.hc(36,"div",15),f.hc(37,"span",12),f.Rc(38,"Th\u1eddi gian giao:"),f.gc(),f.hc(39,"span",13),f.Rc(40),f.uc(41,"date"),f.gc(),f.gc(),f.hc(42,"div",14),f.hc(43,"span",12),f.Rc(44,"T\xean ng\u01b0\u1eddi nh\u1eadn:"),f.gc(),f.hc(45,"span",13),f.Rc(46),f.gc(),f.gc(),f.Pc(47,ne,5,1,"div",16),f.Pc(48,oe,5,1,"div",16),f.hc(49,"div",17),f.hc(50,"span",12),f.Rc(51,"M\xf4 t\u1ea3:"),f.gc(),f.hc(52,"span",13),f.Rc(53),f.gc(),f.gc(),f.gc(),f.hc(54,"div",18),f.hc(55,"div",19),f.hc(56,"button",20),f.pc("click",(function(e){return t.shareToCus()})),f.Rc(57,"X\xe1c nh\u1eadn Kh\xe1ch h\xe0ng"),f.gc(),f.gc(),f.hc(58,"div",19),f.hc(59,"button",21),f.pc("click",(function(e){return t.confirmOrderDetail()})),f.Rc(60,"X\xe1c nh\u1eadn"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()),2&e&&(f.Ob(4),f.Bc("src",f.wc(5,15,t.orderDetail.ResultImageUrl,"ResultImg"),f.Lc),f.Ob(2),f.Bc("src",f.wc(7,18,t.orderDetail.DeliveryImageUrl,"ShippingImg"),f.Lc),f.Ob(4),f.Sc(t.orderDetail.ProductName),f.Ob(2),f.Sc(f.vc(13,21,t.orderDetail.OriginalPrice)),f.Ob(3),f.Tc("Ph\u1ee5 ph\xed: ",f.vc(16,23,t.orderDetail.AdditionalFee),""),f.Ob(3),f.Sc(f.vc(19,25,t.orderDetail.ModifiedPrice)),f.Ob(7),f.Uc("",t.orderDetail.OrderId,"_",t.orderDetail.Index+1,""),f.Ob(5),f.Sc(t.orderDetail.CustomerName),f.Ob(5),f.Sc(t.orderDetail.CustomerPhoneNumber),f.Ob(5),f.Sc(f.wc(41,27,t.orderDetail.DeliveryInfo.DateTime,"HH:mm dd/MM/yyyy")),f.Ob(6),f.Sc(t.orderDetail.DeliveryInfo.FullName),f.Ob(1),f.Ac("ngIf","Florist"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Florist"!=t.CurrentUser.Role),f.Ob(5),f.Sc(t.orderDetail.Description))},directives:[D.l],pipes:[V.a,H.a,D.e],styles:[""]}),ae);function ue(e,t){if(1&e){var i=f.ic();f.hc(0,"div",15),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var c=f.tc(2);f.Ob(2),f.Sc(c.index)}}function le(e,t){if(1&e){var i=f.ic();f.hc(0,"div",16),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var c=f.tc(2);f.Ob(2),f.Sc(c.index)}}function de(e,t){if(1&e){var i=f.ic();f.hc(0,"div",17),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var c=f.tc(2);f.Ob(2),f.Sc(c.index)}}function he(e,t){if(1&e){var i=f.ic();f.hc(0,"div",18),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var c=f.tc(2);f.Ob(2),f.Sc(c.index)}}function ge(e,t){if(1&e){var i=f.ic();f.hc(0,"div",19),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var c=f.tc(2);f.Ob(2),f.Sc(c.index)}}function me(e,t){if(1&e){var i=f.ic();f.hc(0,"div",20),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var c=f.tc(2);f.Ob(2),f.Sc(c.index)}}function pe(e,t){if(1&e){var i=f.ic();f.hc(0,"div",21),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var c=f.tc(2);f.Ob(2),f.Sc(c.index)}}function fe(e,t){if(1&e){var i=f.ic();f.hc(0,"div",22),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var c=f.tc(2);f.Ob(2),f.Sc(c.index)}}function ve(e,t){if(1&e){var i=f.ic();f.hc(0,"div",23),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var c=f.tc(2);f.Ob(2),f.Sc(c.index)}}function be(e,t){if(1&e){var i=f.ic();f.hc(0,"div",24),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var c=f.tc(2);f.Ob(2),f.Sc(c.index)}}function Oe(e,t){if(1&e){var i=f.ic();f.hc(0,"div",25),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var c=f.tc(2);f.Ob(2),f.Sc(c.index)}}function Se(e,t){if(1&e){var i=f.ic();f.hc(0,"div",26),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var c=f.tc(2);f.Ob(2),f.Sc(c.index)}}function De(e,t){if(1&e){var i=f.ic();f.hc(0,"div",27),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var c=f.tc(2);f.Ob(2),f.Sc(c.index)}}function ke(e,t){if(1&e&&(f.hc(0,"div",1),f.Pc(1,ue,3,1,"div",2),f.Pc(2,le,3,1,"div",3),f.Pc(3,de,3,1,"div",4),f.Pc(4,he,3,1,"div",5),f.Pc(5,ge,3,1,"div",6),f.Pc(6,me,3,1,"div",7),f.Pc(7,pe,3,1,"div",8),f.Pc(8,fe,3,1,"div",9),f.Pc(9,ve,3,1,"div",10),f.Pc(10,be,3,1,"div",11),f.Pc(11,Oe,3,1,"div",12),f.Pc(12,Se,3,1,"div",13),f.Pc(13,De,3,1,"div",14),f.gc()),2&e){var i=f.tc();f.Ac("ngSwitch",i.state),f.Ob(1),f.Ac("ngSwitchCase",i.states.Added),f.Ob(1),f.Ac("ngSwitchCase",i.states.Waiting),f.Ob(1),f.Ac("ngSwitchCase",i.states.Making),f.Ob(1),f.Ac("ngSwitchCase",i.states.Comfirming),f.Ob(1),f.Ac("ngSwitchCase",i.states.DeliveryWaiting),f.Ob(1),f.Ac("ngSwitchCase",i.states.DeliverAssinged),f.Ob(1),f.Ac("ngSwitchCase",i.states.Deliveried),f.Ob(1),f.Ac("ngSwitchCase",i.states.Completed),f.Ob(1),f.Ac("ngSwitchCase",i.states.Canceled),f.Ob(1),f.Ac("ngSwitchCase",i.states.OnTheWay),f.Ob(1),f.Ac("ngSwitchCase",i.states.SentBack),f.Ob(1),f.Ac("ngSwitchCase",i.states.FixingRequest),f.Ob(1),f.Ac("ngSwitchCase",i.states.Fixing)}}function Ie(e,t){if(1&e){var i=f.ic();f.hc(0,"div",15),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function ye(e,t){if(1&e){var i=f.ic();f.hc(0,"div",16),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function Ce(e,t){if(1&e){var i=f.ic();f.hc(0,"div",17),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function Pe(e,t){if(1&e){var i=f.ic();f.hc(0,"div",18),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function Ae(e,t){if(1&e){var i=f.ic();f.hc(0,"div",19),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function we(e,t){if(1&e){var i=f.ic();f.hc(0,"div",20),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function Re(e,t){if(1&e){var i=f.ic();f.hc(0,"div",21),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function Te(e,t){if(1&e){var i=f.ic();f.hc(0,"div",22),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function Me(e,t){if(1&e){var i=f.ic();f.hc(0,"div",23),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function Fe(e,t){if(1&e){var i=f.ic();f.hc(0,"div",24),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function xe(e,t){if(1&e){var i=f.ic();f.hc(0,"div",25),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function Ne(e,t){if(1&e){var i=f.ic();f.hc(0,"div",26),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function Le(e,t){if(1&e){var i=f.ic();f.hc(0,"div",27),f.pc("click",(function(e){return f.Jc(i),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function Ue(e,t){if(1&e&&(f.hc(0,"div",1),f.Pc(1,Ie,2,0,"div",2),f.Pc(2,ye,2,0,"div",3),f.Pc(3,Ce,2,0,"div",4),f.Pc(4,Pe,2,0,"div",5),f.Pc(5,Ae,2,0,"div",6),f.Pc(6,we,2,0,"div",7),f.Pc(7,Re,2,0,"div",8),f.Pc(8,Te,2,0,"div",9),f.Pc(9,Me,2,0,"div",10),f.Pc(10,Fe,2,0,"div",11),f.Pc(11,xe,2,0,"div",12),f.Pc(12,Ne,2,0,"div",13),f.Pc(13,Le,2,0,"div",14),f.gc()),2&e){var i=f.tc();f.Ac("ngSwitch",i.state),f.Ob(1),f.Ac("ngSwitchCase",i.states.Added),f.Ob(1),f.Ac("ngSwitchCase",i.states.Waiting),f.Ob(1),f.Ac("ngSwitchCase",i.states.Making),f.Ob(1),f.Ac("ngSwitchCase",i.states.Comfirming),f.Ob(1),f.Ac("ngSwitchCase",i.states.DeliveryWaiting),f.Ob(1),f.Ac("ngSwitchCase",i.states.DeliverAssinged),f.Ob(1),f.Ac("ngSwitchCase",i.states.Deliveried),f.Ob(1),f.Ac("ngSwitchCase",i.states.Completed),f.Ob(1),f.Ac("ngSwitchCase",i.states.Canceled),f.Ob(1),f.Ac("ngSwitchCase",i.states.OnTheWay),f.Ob(1),f.Ac("ngSwitchCase",i.states.SentBack),f.Ob(1),f.Ac("ngSwitchCase",i.states.FixingRequest),f.Ob(1),f.Ac("ngSwitchCase",i.states.Fixing)}}var Be,qe=((Be=function(){function e(){d(this,e),this.states=P.e,this.index=-1,this.id="",this.onClicked=new f.q,this.onChange=function(){},this.onTouched=function(){}}return l(e,[{key:"ngOnInit",value:function(){}},{key:"pointClicked",value:function(){this.onClicked.emit(this.id)}},{key:"preventEvent",value:function(e){e.stopPropagation()}},{key:"writeValue",value:function(e){}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"updateChanges",value:function(){this.onChange()}}]),e}()).\u0275fac=function(e){return new(e||Be)},Be.\u0275cmp=f.Vb({type:Be,selectors:[["app-status-point"]],inputs:{state:"state",index:"index",id:"id"},outputs:{onClicked:"onClicked"},features:[f.Nb([{provide:B.j,useExisting:Object(f.fb)((function(){return Be})),multi:!0}])],decls:2,vars:2,consts:[[3,"ngSwitch",4,"ngIf"],[3,"ngSwitch"],["class","item-status pi",3,"click",4,"ngSwitchCase"],["class","item-status r",3,"click",4,"ngSwitchCase"],["class","item-status o",3,"click",4,"ngSwitchCase"],["class","item-status y",3,"click",4,"ngSwitchCase"],["class","item-status p",3,"click",4,"ngSwitchCase"],["class","item-status b",3,"click",4,"ngSwitchCase"],["class","item-status bl",3,"click",4,"ngSwitchCase"],["class","item-status g",3,"click",4,"ngSwitchCase"],["class","item-status x",3,"click",4,"ngSwitchCase"],["class","item-status on-the-way",3,"click",4,"ngSwitchCase"],["class","item-status send-back",3,"click",4,"ngSwitchCase"],["class","item-status fixing-request",3,"click",4,"ngSwitchCase"],["class","item-status fixing",3,"click",4,"ngSwitchCase"],[1,"item-status","pi",3,"click"],[1,"item-status","r",3,"click"],[1,"item-status","o",3,"click"],[1,"item-status","y",3,"click"],[1,"item-status","p",3,"click"],[1,"item-status","b",3,"click"],[1,"item-status","bl",3,"click"],[1,"item-status","g",3,"click"],[1,"item-status","x",3,"click"],[1,"item-status","on-the-way",3,"click"],[1,"item-status","send-back",3,"click"],[1,"item-status","fixing-request",3,"click"],[1,"item-status","fixing",3,"click"]],template:function(e,t){1&e&&(f.Pc(0,ke,14,14,"div",0),f.Pc(1,Ue,14,14,"div",0)),2&e&&(f.Ac("ngIf",t.index>-1),f.Ob(1),f.Ac("ngIf",-1==t.index))},directives:[D.l,D.n,D.o],styles:[""]}),Be);function Ee(e,t){if(1&e){var i=f.ic();f.hc(0,"div",17),f.hc(1,"div",18),f.hc(2,"span",19),f.Rc(3),f.gc(),f.hc(4,"div",20),f.hc(5,"h4",21),f.Rc(6),f.gc(),f.hc(7,"span",22),f.Rc(8),f.gc(),f.gc(),f.cc(9,"app-status-point",23),f.gc(),f.hc(10,"div",24),f.hc(11,"ul",25),f.hc(12,"li",26),f.hc(13,"div",27),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit;return f.tc().getMenu(c)})),f.cc(14,"img",28),f.uc(15,"ImgPipe"),f.hc(16,"div",29),f.hc(17,"span",30),f.Rc(18),f.uc(19,"myCurrPipe"),f.gc(),f.hc(20,"span",31),f.Rc(21),f.uc(22,"myCurrPipe"),f.gc(),f.hc(23,"span",32),f.Rc(24),f.uc(25,"myCurrPipe"),f.gc(),f.hc(26,"span",33),f.Rc(27),f.gc(),f.hc(28,"span",34),f.Rc(29),f.uc(30,"myTimePipe"),f.gc(),f.hc(31,"span",35),f.Rc(32),f.uc(33,"myDatePipe"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var c=t.$implicit,r=t.index;f.Ob(3),f.Uc("",c.OrderId,"_",c.Index+1,""),f.Ob(3),f.Sc(c.ProductName),f.Ob(2),f.Uc("",c.CustomerName,"-",c.CustomerPhoneNumber,""),f.Ob(1),f.Ac("state",c.State)("id",c.OrderDetailId)("index",r+1),f.Ob(5),f.Bc("src",f.wc(15,15,c.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(f.vc(19,18,c.OriginalPrice)),f.Ob(3),f.Sc(f.vc(22,20,c.AdditionalFee)),f.Ob(3),f.Sc(f.vc(25,22,c.ModifiedPrice)),f.Ob(3),f.Sc(c.DeliveryInfo.Address),f.Ob(2),f.Sc(f.vc(30,24,c.MakingRequestTime)),f.Ob(3),f.Sc(f.vc(33,26,c.MakingRequestTime))}}function He(e,t){if(1&e){var i=f.ic();f.hc(0,"div",17),f.hc(1,"div",18),f.hc(2,"span",19),f.Rc(3),f.gc(),f.hc(4,"div",20),f.hc(5,"h4",21),f.Rc(6),f.gc(),f.hc(7,"span",22),f.Rc(8),f.gc(),f.gc(),f.cc(9,"app-status-point",23),f.gc(),f.hc(10,"div",24),f.hc(11,"ul",25),f.hc(12,"li",26),f.hc(13,"div",27),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit;return f.tc().getMenu(c)})),f.cc(14,"img",28),f.uc(15,"ImgPipe"),f.hc(16,"div",29),f.hc(17,"span",30),f.Rc(18),f.uc(19,"myCurrPipe"),f.gc(),f.hc(20,"span",31),f.Rc(21),f.uc(22,"myCurrPipe"),f.gc(),f.hc(23,"span",32),f.Rc(24),f.uc(25,"myCurrPipe"),f.gc(),f.hc(26,"span",33),f.Rc(27),f.gc(),f.hc(28,"span",34),f.Rc(29),f.uc(30,"myTimePipe"),f.gc(),f.hc(31,"span",35),f.Rc(32),f.uc(33,"myDatePipe"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var c=t.$implicit,r=t.index;f.Ob(3),f.Uc("",c.OrderId,"_",c.Index+1,""),f.Ob(3),f.Sc(c.ProductName),f.Ob(2),f.Uc("",c.CustomerName,"-",c.CustomerPhoneNumber,""),f.Ob(1),f.Ac("state",c.State)("id",c.OrderDetailId)("index",r+1),f.Ob(5),f.Bc("src",f.wc(15,15,c.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(f.vc(19,18,c.OriginalPrice)),f.Ob(3),f.Sc(f.vc(22,20,c.AdditionalFee)),f.Ob(3),f.Sc(f.vc(25,22,c.ModifiedPrice)),f.Ob(3),f.Sc(c.DeliveryInfo.Address),f.Ob(2),f.Sc(f.vc(30,24,c.MakingRequestTime)),f.Ob(3),f.Sc(f.vc(33,26,c.MakingRequestTime))}}var Ve,Je=((Ve=function(e){c(i,e);var t=n(i);function i(e,c){var r;return d(this,i),(r=t.call(this)).router=e,r.orderDetailService=c,r.Title="Th\u1ee3 c\u1eafm hoa",r.NavigateClass="nav-icon ",r.IsDataLosingWarning=!1,r.waitingMenuItems=["Nh\u1eadn \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],r.fixingRequestMenuItems=["S\u1eeda \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],r.makingMenuItems=["Ho\xe0n th\xe0nh \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],r}return l(i,[{key:"OnBackNaviage",value:function(){customerSupport()}},{key:"logout",value:function(){var e=this;this.authService.logOut((function(t){t&&e.router.navigate(["staff/login"])}))}},{key:"Init",value:function(){this.loadWaitingDetails(),this.loadMakingDetails(),this.askForRememberPassword()}},{key:"viewDetail",value:function(e){this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}},{key:"loadWaitingDetails",value:function(){var e=this;this.waitingOrderDetails=[],this.orderDetailService.getByStates([P.e.Waiting,P.e.FixingRequest]).then((function(t){e.waitingOrderDetails=t,e.waitingOrderDetails.sort((function(e,t){return e.MakingSortOrder<t.MakingSortOrder?-1:e.MakingSortOrder>t.MakingSortOrder?1:0}))}))}},{key:"loadMakingDetails",value:function(){var e=this;this.makingOrderDetails=[],this.orderDetailService.getByStatesAndFloristId(this.CurrentUser.Id,[P.e.Making,P.e.Fixing]).then((function(t){e.makingOrderDetails=t,e.makingOrderDetails.sort((function(e,t){return e.MakingSortOrder<t.MakingSortOrder?-1:e.MakingSortOrder>t.MakingSortOrder?1:0}))}))}},{key:"getMenu",value:function(e){var t,i=this;switch(e.State){case P.e.Waiting:t=this.waitingMenuItems;break;case P.e.Making:case P.e.Fixing:t=this.makingMenuItems;break;case P.e.FixingRequest:t=this.fixingRequestMenuItems}menuOpen((function(t){switch(+t){case 0:switch(e.State){case P.e.Waiting:i.orderDetailService.updateDetailSeen(e.OrderDetailId,i.CurrentUser.Id,(new Date).getTime()).then((function(t){var c;c=e.State==P.e.Waiting?{State:P.e.Making,MakingSortOrder:0,FloristId:i.CurrentUser.Id,MakingStartTime:(new Date).getTime()}:{State:P.e.Fixing,MakingSortOrder:0,FixingFloristId:i.CurrentUser.Id,MakingStartTime:(new Date).getTime()},i.orderDetailService.updateFields(e.OrderDetailId,c).then((function(){i.loadMakingDetails(),i.loadWaitingDetails()}))}));break;case P.e.Making:case P.e.Fixing:i.openConfirm("ch\u1eafc ch\u1eafn ho\xe0n th\xe0nh \u0111\u01a1n?",(function(){i.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.Comfirming,MakingCompletedTime:(new Date).getTime()}).then((function(){i.loadMakingDetails(),i.loadWaitingDetails()}))}))}break;case 1:i.globalOrderDetail=e,i.router.navigate(["staff/order-detail-view"])}}),t)}}]),i}(y)).\u0275fac=function(e){return new(e||Ve)(f.bc(h.b),f.bc(X.a))},Ve.\u0275cmp=f.Vb({type:Ve,selectors:[["app-florist-main"]],features:[f.Lb],decls:27,vars:9,consts:[["id","arrange",1,"page-content"],[1,"container"],["id","listNav","role","tablist",1,"nav","nav-tabs","row"],[1,"nav-item","col-6"],["id","nav1","data-toggle","tab","href","#camhoa","role","tab","aria-controls","camhoa","aria-selected","true",1,"active","main-bg"],["id","nav2","data-toggle","tab","href","#giaohoa","role","tab","aria-controls","giaohoa","aria-selected","false",1,"main-bg"],["id","listContent",1,"tab-content","order-list-bot"],["id","camhoa","role","tabpanel","aria-labelledby","nav1",1,"tab-pane","fade","show","active"],[1,"order-content","cusScroll"],["class","order-content-item product-item",4,"ngFor","ngForOf"],["id","giaohoa","role","tabpanel","aria-labelledby","nav2",1,"tab-pane","fade"],[1,"customer-support"],["alt","",1,"customer-avatar",3,"src"],[1,"customer-name"],["href","tel:0000",1,"customer-phone"],[1,"customer-position"],["id","logoutBtn",1,"customer-position",3,"click"],[1,"order-content-item","product-item"],[1,"item-top"],[1,"item-code"],[1,"item-info"],[1,"item-name"],[1,"item-quantity"],[3,"state","id","index"],[1,"item-bot"],[1,"order-product-list","cusScroll"],[1,""],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"prodPriceOld"],[1,"prodCharge"],[1,"prodPrice"],[1,"item-address"],[1,"item-time"],[1,"item-date"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"ul",2),f.hc(3,"li",3),f.hc(4,"a",4),f.Rc(5,"Ch\u1edd c\u1eafm"),f.gc(),f.gc(),f.hc(6,"li",3),f.hc(7,"a",5),f.Rc(8,"\u0110ang c\u1eafm"),f.gc(),f.gc(),f.gc(),f.hc(9,"div",6),f.hc(10,"div",7),f.hc(11,"ul",8),f.Pc(12,Ee,34,28,"div",9),f.gc(),f.gc(),f.hc(13,"div",10),f.hc(14,"ul",8),f.Pc(15,He,34,28,"div",9),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(16,"div",11),f.cc(17,"img",12),f.uc(18,"ImgPipe"),f.hc(19,"p",13),f.Rc(20),f.gc(),f.hc(21,"a",14),f.Rc(22),f.gc(),f.hc(23,"p",15),f.Rc(24),f.gc(),f.hc(25,"p",16),f.pc("click",(function(e){return t.logout()})),f.Rc(26,"\u0110\u0103ng xu\u1ea5t"),f.gc(),f.gc()),2&e&&(f.Ob(12),f.Ac("ngForOf",t.waitingOrderDetails),f.Ob(3),f.Ac("ngForOf",t.makingOrderDetails),f.Ob(2),f.Bc("src",f.wc(18,6,t.CurrentUser.Avt,"UserAvt"),f.Lc),f.Ob(3),f.Sc(t.CurrentUser.FullName),f.Ob(2),f.Sc(t.CurrentUser.PhoneNumber),f.Ob(2),f.Sc(t.CurrentUser.Role))},directives:[D.k,qe],pipes:[V.a,H.a,H.c,H.b],styles:[""]}),Ve);function We(e,t){1&e&&(f.hc(0,"span",15),f.Rc(1,"\u0110\xe3 bao g\u1ed3m"),f.gc())}function je(e,t){1&e&&(f.hc(0,"span",15),f.Rc(1,"Ch\u01b0a bao g\u1ed3m"),f.gc())}function Ge(e,t){if(1&e&&(f.hc(0,"div",22),f.hc(1,"span",14),f.Rc(2,"VAT: "),f.gc(),f.Pc(3,We,2,0,"span",23),f.Pc(4,je,2,0,"span",23),f.gc()),2&e){var i=f.tc();f.Ob(3),f.Ac("ngIf",i.orderDetail.IsVATIncluded),f.Ob(1),f.Ac("ngIf",!i.orderDetail.IsVATIncluded)}}function Xe(e,t){if(1&e&&(f.hc(0,"div",24),f.hc(1,"span",14),f.Rc(2,"T\xean KH"),f.gc(),f.hc(3,"span",15),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.orderDetail.CustomerName)}}function $e(e,t){if(1&e&&(f.hc(0,"div",24),f.hc(1,"span",14),f.Rc(2,"T\xean ng\u01b0\u1eddi nh\u1eadn"),f.gc(),f.hc(3,"span",15),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.orderDetail.DeliveryInfo.FullName)}}function _e(e,t){if(1&e&&(f.hc(0,"div",24),f.hc(1,"span",14),f.Rc(2,"SDT KH"),f.gc(),f.hc(3,"span",15),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.orderDetail.CustomerPhoneNumber)}}function ze(e,t){if(1&e&&(f.hc(0,"div",24),f.hc(1,"span",14),f.Rc(2,"SDT ng\u01b0\u1eddi nh\u1eadn"),f.gc(),f.hc(3,"span",15),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.orderDetail.DeliveryInfo.PhoneNumber)}}function Qe(e,t){if(1&e){var i=f.ic();f.hc(0,"button",25),f.pc("click",(function(e){return f.Jc(i),f.tc().gotToCusConfirm()})),f.Rc(1,"X\xe1c nh\u1eadn v\u1edbi Kh\xe1ch h\xe0ng"),f.gc()}}function Ke(e,t){if(1&e){var i=f.ic();f.hc(0,"button",25),f.pc("click",(function(e){return f.Jc(i),f.tc().gotToCusConfirm()})),f.Rc(1,"Ch\u1ee5p \u1ea3nh"),f.gc()}}var Ze,Ye=((Ze=function(e){c(i,e);var t=n(i);function i(e,c){var r;return d(this,i),(r=t.call(this)).router=e,r.orderDetailService=c,r.Title="X\xe1c nh\u1eadn th\xe0nh ph\u1ea9m",r.IsDataLosingWarning=!1,r}return l(i,[{key:"Init",value:function(){this.orderDetail=this.globalOrderDetail}},{key:"gotToCusConfirm",value:function(){this.router.navigate(["staff/customer-confirming"])}},{key:"confirm",value:function(){var e=this;switch(this.CurrentUser.Role){case P.h.Account:case P.h.Admin:this.orderDetailService.getNextShippingSortOrder().then((function(t){e.orderDetailService.updateFields(e.globalOrderDetail.OrderDetailId,{State:P.e.DeliveryWaiting,ShippingSortOrder:t}).then((function(){e.router.navigate(["staff/account-main"])}))}));break;case P.h.Shipper:this.orderDetailService.updateFields(this.globalOrderDetail.OrderDetailId,{ShippingSortOrder:0,State:P.e.Deliveried,DeliveryCompletedTime:(new Date).getTime()}).then((function(){e.router.navigate(["staff/shipper-main"])}))}}}]),i}(y)).\u0275fac=function(e){return new(e||Ze)(f.bc(h.b),f.bc(X.a))},Ze.\u0275cmp=f.Vb({type:Ze,selectors:[["app-order-detail-confirming"]],features:[f.Lb],decls:49,vars:29,consts:[["id","orderConfirm",1,"page-content"],[1,"container"],[1,"prodDetail"],[1,"prodGen"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPriceOld"],[1,"prodCharge"],[1,"prodPrice"],[1,"prodInfo","cusScroll"],["class","prodQuan infoGroup",4,"ngIf"],["class","prodName infoGroup",4,"ngIf"],[1,"prodAddr","infoGroup"],[1,"itemlabel"],[1,"itemVal"],[1,"prodTime","infoGroup"],[1,"prodDesc","infoGroup"],[1,"row"],[1,"col-10","mx-auto","text-center"],["type","button","class","btn main-btn w-100 mt-2",3,"click",4,"ngIf"],["type","button",1,"btn","grey-btn","w-100","mt-2",3,"click"],[1,"prodQuan","infoGroup"],["class","itemVal",4,"ngIf"],[1,"prodName","infoGroup"],["type","button",1,"btn","main-btn","w-100","mt-2",3,"click"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.cc(4,"img",4),f.uc(5,"ImgPipe"),f.hc(6,"div",5),f.hc(7,"h5",6),f.Rc(8),f.gc(),f.hc(9,"h5",6),f.Rc(10),f.gc(),f.hc(11,"span",7),f.Rc(12),f.uc(13,"myCurrPipe"),f.gc(),f.hc(14,"span",8),f.Rc(15),f.uc(16,"myCurrPipe"),f.gc(),f.hc(17,"span",9),f.Rc(18),f.uc(19,"myCurrPipe"),f.gc(),f.gc(),f.gc(),f.hc(20,"div",10),f.Pc(21,Ge,5,2,"div",11),f.Pc(22,Xe,5,1,"div",12),f.Pc(23,$e,5,1,"div",12),f.Pc(24,_e,5,1,"div",12),f.Pc(25,ze,5,1,"div",12),f.hc(26,"div",13),f.hc(27,"span",14),f.Rc(28,"\u0110\u1ecba ch\u1ec9 giao:"),f.gc(),f.hc(29,"span",15),f.Rc(30),f.gc(),f.gc(),f.hc(31,"div",16),f.hc(32,"span",14),f.Rc(33,"Th\u1eddi gian giao:"),f.gc(),f.hc(34,"span",15),f.Rc(35),f.uc(36,"date"),f.gc(),f.gc(),f.hc(37,"div",17),f.hc(38,"span",14),f.Rc(39,"M\xf4 t\u1ea3:"),f.gc(),f.hc(40,"span",15),f.Rc(41),f.gc(),f.gc(),f.gc(),f.hc(42,"div",18),f.hc(43,"div",19),f.Pc(44,Qe,2,0,"button",20),f.Pc(45,Ke,2,0,"button",20),f.gc(),f.hc(46,"div",19),f.hc(47,"button",21),f.pc("click",(function(e){return t.confirm()})),f.Rc(48,"Xong"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()),2&e&&(f.Ob(4),f.Bc("src",f.wc(5,17,t.orderDetail.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Uc("",t.orderDetail.OrderId,"_",t.orderDetail.Index+1,""),f.Ob(2),f.Sc(t.orderDetail.ProductName),f.Ob(2),f.Sc(f.vc(13,20,t.orderDetail.OriginalPrice)),f.Ob(3),f.Tc("Ph\u1ee5 ph\xed: ",f.vc(16,22,t.orderDetail.AdditionalFee),""),f.Ob(3),f.Sc(f.vc(19,24,t.orderDetail.ModifiedPrice)),f.Ob(3),f.Ac("ngIf","Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Shipper"==t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Shipper"==t.CurrentUser.Role),f.Ob(5),f.Sc(t.orderDetail.DeliveryInfo.Address),f.Ob(5),f.Sc(f.wc(36,26,t.orderDetail.DeliveryInfo.DateTime,"hh:mm a dd/MM/yyyy")),f.Ob(6),f.Sc(t.orderDetail.Description),f.Ob(3),f.Ac("ngIf","Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Shipper"==t.CurrentUser.Role))},directives:[D.l],pipes:[V.a,H.a,D.e],styles:[""]}),Ze),et=o("cPV5"),tt=o("ftz2");function it(e,t){if(1&e){var i=f.ic();f.hc(0,"li",50),f.pc("click",(function(e){f.Jc(i);var c=t.index;return f.tc().selectPromotion(c)})),f.hc(1,"p",51),f.Rc(2),f.gc(),f.hc(3,"span",52),f.Rc(4),f.gc(),f.hc(5,"span",53),f.Rc(6),f.uc(7,"myDatePipe"),f.uc(8,"myDatePipe"),f.gc(),f.gc()}if(2&e){var c=t.$implicit,r=t.index,n=f.tc();f.Pb("data-index",r),f.Ob(2),f.Sc(c.Name),f.Ob(2),f.Sc(n.getPromotionAmount(c)),f.Ob(2),f.Uc("",f.vc(7,5,c.StartTime),"-",f.vc(8,7,c.EndTime),"")}}function ct(e,t){if(1&e){var i=f.ic();f.hc(0,"div",54),f.pc("click",(function(e){return f.Jc(i),f.tc().addNoteImage()})),f.cc(1,"img",55),f.gc()}}function rt(e,t){if(1&e){var i=f.ic();f.hc(0,"div",54),f.pc("click",(function(e){return f.Jc(i),f.Hc(3).click()})),f.cc(1,"img",55),f.hc(2,"input",56,57),f.pc("change",(function(e){return f.Jc(i),f.tc(2).onChange(e)})),f.gc(),f.gc()}}function nt(e,t){if(1&e&&(f.hc(0,"div"),f.Pc(1,rt,4,0,"div",44),f.gc()),2&e){var i=f.tc();f.Ob(1),f.Ac("ngIf",!i.IsOnTerminal)}}function ot(e,t){if(1&e){var i=f.ic();f.hc(0,"div",43),f.hc(1,"div",58),f.pc("click",(function(e){f.Jc(i);var c=t.index;return f.tc().selectNoteImage(c)})),f.cc(2,"img",59),f.uc(3,"ImgPipe"),f.gc(),f.gc()}if(2&e){var c=t.$implicit;f.Ob(2),f.Bc("src",f.wc(3,1,c,"NoteImg"),f.Lc)}}var at,st,ut=((at=function(e){c(r,e);var t=n(r);function r(e,i,c,n){var o;return d(this,r),(o=t.call(this)).route=e,o.router=i,o.categoryService=c,o.promotionService=n,o.Title="Chi ti\u1ebft \u0111\u01a1n",o.isAddingNoteImage=!1,o.promotions=[],o.images=[],o.globalOrderDetail.NoteImages||(o.globalOrderDetail.NoteImages=[]),o}return l(r,[{key:"Init",value:function(){var e=this;this.promotionService.getAvailablePromotions((new Date).getTime(),!1).then((function(t){e.promotions=t})),this.route.params.subscribe((function(t){e.detailIndex=+t.id,e.globalOrderDetail.PurposeOf||(e.globalOrderDetail.PurposeOf="Mua t\u1eb7ng"),e.globalOrderDetail.ProductName||(e.globalOrderDetail.ProductName="...."),createNumbericElement(!1,(function(t){e.globalOrderDetail.Quantity=t}))}))}},{key:"getPromotionAmount",value:function(e){return e.PromotionType==R.b.Amount?e.Amount+" \u20ab":e.Amount+" %"}},{key:"onAmountDiscountChanged",value:function(e){this.globalOrderDetail.AmountDiscount<10&&(this.globalOrderDetail.AmountDiscount*=1e3,this.moveCursor(this.globalOrderDetail.AmountDiscount.toString().length,"AmountDiscount")),this.globalOrderDetail.AmountDiscount=+this.globalOrderDetail.AmountDiscount}},{key:"onAcmountDiscountFocus",value:function(){this.globalOrderDetail.AmountDiscount||(this.globalOrderDetail.AmountDiscount=0),this.moveCursor(this.globalOrderDetail.AmountDiscount.toString().length,"AmountDiscount")}},{key:"addNoteImage",value:function(){this.isAddingNoteImage=!0,i(s(r.prototype),"openFileForShare",this).call(this)}},{key:"fileChosen",value:function(e){this.globalOrderDetail.NoteImages.push("data:image/png;base64,"+e)}},{key:"onChange",value:function(e){var t=this,i=e.target.files[0];if(i)if(null!=i.type.match(/image\/*/)){var c=new FileReader;c.readAsDataURL(i),c.onload=function(e){t.globalOrderDetail.NoteImages.push(c.result.toString())}}else this.showError("Ph\u1ea3i ch\u1ecdn h\xecnh !!")}},{key:"selectNoteImage",value:function(e){var t=this;this.menuOpening((function(i){switch(+i){case 0:t.globalOrderDetail.NoteImages.splice(e,1);break;case 1:var c=V.a.getImgUrl(t.globalOrderDetail.NoteImages[e],ce.c.NoteImg);t.images=[c],console.log(c),setTimeout((function(){viewImages((function(){t.images=[]}))}),100)}}),["Xo\xe1 \u1ea3nh","Xem chi ti\u1ebft \u1ea3nh"])}},{key:"onAddFeeChanged",value:function(e){this.globalOrderDetail.AdditionalFee<10&&(this.globalOrderDetail.AdditionalFee*=1e3,this.moveCursor(this.globalOrderDetail.AdditionalFee.toString().length,"AdditionalFee")),this.globalOrderDetail.AdditionalFee=+this.globalOrderDetail.AdditionalFee}},{key:"onAddFeeFocus",value:function(){this.globalOrderDetail.AdditionalFee||(this.globalOrderDetail.AdditionalFee=0),this.moveCursor(this.globalOrderDetail.AdditionalFee.toString().length,"AdditionalFee")}},{key:"onNewPriceChanged",value:function(e){this.newPrice<10&&(this.newPrice*=1e3,this.moveCursor(this.newPrice.toString().length,"NewPrice")),this.newPrice=+this.newPrice}},{key:"onNewPriceFocus",value:function(){this.newPrice||(this.newPrice=0),this.moveCursor(this.newPrice.toString().length,"NewPrice")}},{key:"clearProductImg",value:function(){var e=this;this.globalOrderDetail.ProductImageUrl&&(this.globalOrderDetail.IsFromHardCodeProduct?this.globalOrderDetail.ProductImageUrl="":this.openConfirm("Ch\u1eafc ch\u0103c xo\xe1 \u1ea3nh n\xe0y? ",(function(){e.globalOrderDetail.ProductImageUrl=""})))}},{key:"productNameChangeRequest",value:function(){var e=this;getTextInput((function(t){""!=t&&(e.globalOrderDetail.ProductName=t,e.globalOrderDetail.IsFromHardCodeProduct=!0)}),"C\u1eadp nh\u1eadt t\xean s\u1ea3n ph\u1ea9m...","...."==this.globalOrderDetail.ProductName?"":this.globalOrderDetail.ProductName)}},{key:"insertModifiedValue",value:function(){this.newPrice=this.globalOrderDetail.ModifiedPrice,openFixPriceDialog()}},{key:"submitPrice",value:function(){this.newPrice<0?this.showError("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!!"):(this.globalOrderDetail.ModifiedPrice=this.newPrice,dismissFixPriceDialog())}},{key:"searchProduct",value:function(){this.router.navigate(["/staff/search-product"],{queryParams:{category:-1},queryParamsHandling:"merge"})}},{key:"submitOrderDetail",value:function(e){if(e.valid)if(this.globalOrderDetail.ModifiedPrice<=0)this.showError("Ch\u01b0a nh\u1eadp gi\xe1 ti\u1ec1n!");else{this.globalOrderDetail.Index=this.detailIndex>-1?this.detailIndex:this.globalOrder.OrderDetails.length;var t=C.c.DeepCopy(this.globalOrderDetail);this.insertOrderDetail(t)}}},{key:"insertOrderDetail",value:function(e){this.detailIndex>-1?this.globalOrder.OrderDetails[this.detailIndex]=e:this.globalOrder.OrderDetails.push(e),i(s(r.prototype),"OnBackNaviage",this).call(this)}},{key:"selectPromotion",value:function(e){this.globalOrderDetail.PercentDiscount=this.globalOrderDetail.AmountDiscount=0;var t=this.promotions[e];t.PromotionType==R.b.Amount?this.globalOrderDetail.AmountDiscount=t.Amount:this.globalOrderDetail.PercentDiscount=t.Amount,hideReceiverPopup()}}]),r}(y)).\u0275fac=function(e){return new(e||at)(f.bc(h.a),f.bc(h.b),f.bc(et.a),f.bc(L.a))},at.\u0275cmp=f.Vb({type:at,selectors:[["app-order-detail"]],features:[f.Lb],decls:84,vars:21,consts:[["id","orderAdd",1,"page-content"],[1,"container"],["autocomplete","on",1,"addOrderForm",3,"submit"],["form","ngForm"],[1,"form-group","prodInfo"],[1,"prodImg"],["alt","",3,"src"],["src","../../../../assets/images/delete_white.svg","alt","",1,"close-img",3,"click"],[1,"prodContent"],[1,"prodCode"],[1,"prodPrice"],[1,"prodQuantity"],["type","number","readonly","","name","Quantity","id","Quantity","step","1","min","1",3,"ngModel","ngModelChange"],[1,"prodBrowser",3,"click"],[1,"fa","fa-search","main-bg"],[1,"row","col-xs-12",2,"margin-bottom","10px","padding-left","15px","padding-right","15px"],[1,"addInfo",2,"width","50%","padding-right","5px"],["href","javascript:void(0);",1,"btn","main-btn",3,"click"],[1,"addInfo",2,"width","50%","padding-left","5px"],[1,"form-group","addInfo"],["routerLink","/staff/select-receiver",1,"btn","main-btn"],[1,"title-field"],[1,"form-group","orderInfo"],["type","text","name","AdditionalFee","id","AdditionalFee","placeholder","Ph\u1ee5 ph\xed (k)...",1,"orderField",3,"ngModel","ngModelChange","input","focus"],["href","javascript:void(0)","onclick","openCustMenu()","type","button",1,"btn","main-btn","w-100",2,"margin-bottom","1vh","font-size","16px"],[1,"row","col-xs-12",2,"padding-left","15px","padding-right","15px"],["type","number","name","PercentDiscount","id","PercentDiscount","placeholder","%",1,"orderField",3,"ngModel","ngModelChange"],["type","tel","name","AmountDiscount","id","AmountDiscount","placeholder","0",1,"orderField",3,"ngModel","ngModelChange","input","focus"],["type","text","name","PurposeOf","id","PurposeOf","placeholder","M\u1ee5c \u0111\xedch mua h\xe0ng...",1,"orderField",3,"ngModel","ngModelChange"],["type","text","name","Description","id","Description","placeholder","M\xf4 t\u1ea3 giao h\xe0ng...",1,"orderField","col-xs-6",3,"ngModel","ngModelChange"],["href","javascript:void(0)","onClick","openImgsDialog()",1,"btn","main-btn"],["type","submit",1,"btn","main-btn","w-100"],["id","recentInfo",1,"actionMenu2"],["style","height: 69px;text-align: left;",3,"click",4,"ngFor","ngForOf"],["id","inputDialog",1,"popup-content","dialog-popup"],[1,"form-group"],["type","tel","name","newPrice","id","NewPrice","placeholder","c\u1eadp nh\u1eadt gi\xe1 ti\u1ec1n...",1,"mainForm",3,"ngModel","ngModelChange","input","focus"],[1,"row"],[1,"col-6"],["id","confirm-button",1,"main-btn","btn",3,"click"],["id","cancel-button","onClick","dismissFixPriceDialog()",1,"main-bg","border","btn"],["id","imgsDialog",1,"popup-content","dialog-popup"],[1,"row","imageList","cusScroll",2,"max-height","450px"],[1,"col-6","product-item-big"],["class","prodItem-tall","style","height: 220px;position: relative;",3,"click",4,"ngIf"],[4,"ngIf"],["class","col-6 product-item-big",4,"ngFor","ngForOf"],["id","confirm-button","onClick","closeImgsDialog()",1,"main-btn","btn"],["id","view-product",1,"popup-content","view-img-popup-content",2,"z-index","1000"],[3,"src","config"],[2,"height","69px","text-align","left",3,"click"],[1,"recentInfo-name"],[1,"recentInfo-phone",2,"width","25%"],[1,"recentInfo-date",2,"width","75%"],[1,"prodItem-tall",2,"height","220px","position","relative",3,"click"],["src","../../../../assets/images/add.svg","alt","",2,"margin-bottom","0px","width","64px","height","64px","position","absolute","top","50%","left","50%","transform","translate(-50%, -50%)"],["type","file","name","uploadedFile","hidden","",1,"img-cover","file-upload-default",3,"change"],["imageUpload",""],[1,"prodItem-tall",3,"click"],["alt","",2,"margin-bottom","0px",3,"src"]],template:function(e,t){if(1&e){var i=f.ic();f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"form",2,3),f.pc("submit",(function(e){f.Jc(i);var c=f.Hc(3);return t.submitOrderDetail(c)})),f.hc(4,"div",4),f.hc(5,"div",5),f.cc(6,"img",6),f.uc(7,"ImgPipe"),f.hc(8,"img",7),f.pc("click",(function(e){return t.clearProductImg()})),f.gc(),f.gc(),f.hc(9,"div",8),f.hc(10,"h5",9),f.Rc(11),f.gc(),f.hc(12,"span",10),f.Rc(13),f.uc(14,"myCurrPipe"),f.gc(),f.hc(15,"div",11),f.hc(16,"input",12),f.pc("ngModelChange",(function(e){return t.globalOrderDetail.Quantity=e})),f.gc(),f.gc(),f.gc(),f.hc(17,"div",13),f.pc("click",(function(e){return t.searchProduct()})),f.cc(18,"i",14),f.gc(),f.gc(),f.hc(19,"div",15),f.hc(20,"div",16),f.hc(21,"a",17),f.pc("click",(function(e){return t.productNameChangeRequest()})),f.Rc(22,"C\u1eadp nh\u1eadt T\xean"),f.gc(),f.gc(),f.hc(23,"div",18),f.hc(24,"a",17),f.pc("click",(function(e){return t.insertModifiedValue()})),f.Rc(25,"C\u1eadp nh\u1eadt gi\xe1"),f.gc(),f.gc(),f.gc(),f.hc(26,"div",19),f.hc(27,"a",20),f.Rc(28,"Th\xf4ng tin ng\u01b0\u1eddi nh\u1eadn"),f.gc(),f.gc(),f.hc(29,"label",21),f.Rc(30,"Ph\u1ee5 ph\xed"),f.gc(),f.hc(31,"div",22),f.hc(32,"input",23),f.pc("ngModelChange",(function(e){return t.globalOrderDetail.AdditionalFee=e}))("input",(function(e){return t.onAddFeeChanged(e.target.value)}))("focus",(function(e){return t.onAddFeeFocus()})),f.gc(),f.gc(),f.hc(33,"a",24),f.Rc(34,"\xc1p d\u1ee5ng khuy\u1ebfn m\xe3i"),f.gc(),f.hc(35,"div",25),f.hc(36,"div",16),f.hc(37,"label",21),f.Rc(38,"Gi\u1ea3m gi\xe1 ph\u1ea7n tr\u0103m "),f.gc(),f.hc(39,"div",22),f.hc(40,"input",26),f.pc("ngModelChange",(function(e){return t.globalOrderDetail.PercentDiscount=e})),f.gc(),f.gc(),f.gc(),f.hc(41,"div",18),f.hc(42,"label",21),f.Rc(43,"Gi\u1ea3m gi\xe1 ti\u1ec1n"),f.gc(),f.hc(44,"div",22),f.hc(45,"input",27),f.pc("ngModelChange",(function(e){return t.globalOrderDetail.AmountDiscount=e}))("input",(function(e){return t.onAmountDiscountChanged(e.target.value)}))("focus",(function(e){return t.onAcmountDiscountFocus()})),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(46,"label",21),f.Rc(47,"M\u1ee5c \u0111\xedch mua h\xe0ng"),f.gc(),f.hc(48,"div",22),f.hc(49,"input",28),f.pc("ngModelChange",(function(e){return t.globalOrderDetail.PurposeOf=e})),f.gc(),f.gc(),f.hc(50,"label",21),f.Rc(51,"M\xf4 t\u1ea3"),f.gc(),f.hc(52,"div",22),f.hc(53,"input",29),f.pc("ngModelChange",(function(e){return t.globalOrderDetail.Description=e})),f.gc(),f.gc(),f.hc(54,"div",19),f.hc(55,"a",30),f.Rc(56,"\u1ea2nh m\xf4 t\u1ea3"),f.gc(),f.gc(),f.hc(57,"div",19),f.hc(58,"button",31),f.Rc(59,"Xong"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(60,"div",32),f.hc(61,"ul"),f.Pc(62,it,9,9,"li",33),f.gc(),f.gc(),f.hc(63,"div",34),f.hc(64,"div",35),f.hc(65,"input",36),f.pc("ngModelChange",(function(e){return t.newPrice=e}))("input",(function(e){return t.onNewPriceChanged(e.target.value)}))("focus",(function(e){return t.onNewPriceFocus()})),f.gc(),f.gc(),f.hc(66,"div",37),f.hc(67,"div",38),f.hc(68,"button",39),f.pc("click",(function(e){return t.submitPrice()})),f.Rc(69,"X\xe1c nh\u1eadn"),f.gc(),f.gc(),f.hc(70,"div",38),f.hc(71,"button",40),f.Rc(72,"H\u1ee7y"),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(73,"div",41),f.hc(74,"div",42),f.hc(75,"div",43),f.Pc(76,ct,2,0,"div",44),f.Pc(77,nt,2,1,"div",45),f.gc(),f.Pc(78,ot,4,4,"div",46),f.gc(),f.hc(79,"div",37),f.hc(80,"button",47),f.Rc(81,"\u0110\xf3ng"),f.gc(),f.gc(),f.gc(),f.hc(82,"div",48),f.cc(83,"angular-image-viewer",49),f.gc()}2&e&&(f.Ob(6),f.Bc("src",f.wc(7,16,t.globalOrderDetail.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(5),f.Tc("",t.globalOrderDetail.ProductName," "),f.Ob(2),f.Sc(f.vc(14,19,t.globalOrderDetail.ModifiedPrice)),f.Ob(3),f.Ac("ngModel",t.globalOrderDetail.Quantity),f.Ob(16),f.Ac("ngModel",t.globalOrderDetail.AdditionalFee),f.Ob(8),f.Ac("ngModel",t.globalOrderDetail.PercentDiscount),f.Ob(5),f.Ac("ngModel",t.globalOrderDetail.AmountDiscount),f.Ob(4),f.Ac("ngModel",t.globalOrderDetail.PurposeOf),f.Ob(4),f.Ac("ngModel",t.globalOrderDetail.Description),f.Ob(9),f.Ac("ngForOf",t.promotions),f.Ob(3),f.Ac("ngModel",t.newPrice),f.Ob(11),f.Ac("ngIf",t.IsOnTerminal),f.Ob(1),f.Ac("ngIf",!t.IsOnTerminal),f.Ob(1),f.Ac("ngForOf",t.globalOrderDetail.NoteImages),f.Ob(5),f.Ac("src",t.images)("config",t.viewProdOptions))},directives:[B.v,B.l,B.m,B.p,B.b,B.k,B.n,h.c,D.k,D.l,tt.a],pipes:[V.a,H.a,H.b],styles:[""]}),at),lt=o("Gdn9"),dt=o("tk/3"),ht=o("qfBg"),gt=o("Kj3r"),mt=o("vkgz"),pt=((st=function(){function e(t,i){d(this,e),this.formBuilder=t,this.ngForm=i,this.placeholder="",this.delayTimeSpan=1e3,this.searchTextInvoke=new f.q,this.onChange=function(e){},this.onTouched=function(){},this.searchContent=new B.d,this.searchForm=this.formBuilder.group({searchContent:this.searchContent})}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.searchContent.valueChanges.pipe(Object(gt.a)(this.delayTimeSpan),Object(mt.a)()).subscribe((function(t){e.searchTextInvoke.emit(t)}))}},{key:"preventEvent",value:function(e){e.stopPropagation()}},{key:"writeValue",value:function(e){e!==this.value&&(this.value=e)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"updateChanges",value:function(){this.onChange(this.value)}}]),e}()).\u0275fac=function(e){return new(e||st)(f.bc(B.c),f.bc(B.m,8))},st.\u0275cmp=f.Vb({type:st,selectors:[["mobile-search-box"]],inputs:{placeholder:"placeholder",delayTimeSpan:"delayTimeSpan"},outputs:{searchTextInvoke:"searchTextInvoke"},features:[f.Nb([{provide:B.j,useExisting:Object(f.fb)((function(){return st})),multi:!0}])],decls:2,vars:1,consts:[[3,"formGroup"],["type","text","placeholder","placeholder","formControlName","searchContent",1,"form-control"]],template:function(e,t){1&e&&(f.hc(0,"form",0),f.cc(1,"input",1),f.gc()),2&e&&f.Ac("formGroup",t.searchForm)},directives:[B.v,B.l,B.f,B.b,B.k,B.e],styles:[""]}),st);function ft(e,t){if(1&e){var i=f.ic();f.hc(0,"li",71),f.hc(1,"app-status-point",72),f.pc("onClicked",(function(e){return f.Jc(i),f.tc(2).openDetailInfo(e)})),f.gc(),f.hc(2,"div",73),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit;return f.tc(2).updateOrderDetailState(c.OrderDetailId)})),f.cc(3,"img",74),f.uc(4,"ImgPipe"),f.hc(5,"div",75),f.hc(6,"h5",76),f.Rc(7),f.gc(),f.hc(8,"span",77),f.Rc(9),f.uc(10,"myCurrPipe"),f.gc(),f.hc(11,"span",78),f.Rc(12),f.gc(),f.hc(13,"span",79),f.Rc(14),f.uc(15,"myTimePipe"),f.gc(),f.hc(16,"span",64),f.Rc(17),f.uc(18,"myDatePipe"),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var c=t.$implicit;f.Ob(1),f.Ac("state",c.State)("id",c.OrderDetailId)("index",c.Index+1),f.Ob(2),f.Bc("src",f.wc(4,9,c.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(c.ProductName),f.Ob(2),f.Tc("Ph\u1ee5 ph\xed: ",f.vc(10,12,c.AdditionalFee),""),f.Ob(3),f.Sc(c.DeliveryInfo.Address),f.Ob(2),f.Sc(f.vc(15,14,c.DeliveryInfo.DateTime)),f.Ob(3),f.Sc(f.vc(18,16,c.DeliveryInfo.DateTime))}}function vt(e,t){if(1&e){var i=f.ic();f.hc(0,"li",57),f.hc(1,"div",58),f.hc(2,"span",59),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit;return f.tc().viewPurchase(c.OrderId)})),f.Rc(3),f.gc(),f.hc(4,"div",60),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit;return f.tc().selectOrder(c)})),f.hc(5,"h4",61),f.Rc(6),f.gc(),f.hc(7,"h4",62),f.Rc(8),f.gc(),f.hc(9,"span",63),f.Rc(10),f.uc(11,"myCurrPipe"),f.gc(),f.hc(12,"span",64),f.Rc(13),f.uc(14,"myDatePipe"),f.gc(),f.gc(),f.hc(15,"button",65),f.Rc(16,"m\u1edf"),f.gc(),f.gc(),f.hc(17,"div",66),f.hc(18,"ul",67),f.Pc(19,ft,19,18,"li",68),f.gc(),f.hc(20,"a",69),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit;return f.tc().editOrder(c.OrderId)})),f.cc(21,"i",70),f.Rc(22," Ch\u1ec9nh s\u1eeda"),f.gc(),f.gc(),f.gc()}if(2&e){var c=t.$implicit,r=t.index;f.Ac("id","order"+r),f.Ob(1),f.Ac("id","heading"+r),f.Ob(2),f.Sc(c.OrderId),f.Ob(3),f.Sc(c.CustomerInfo.Name),f.Ob(2),f.Tc("tel: ",c.CustomerInfo.PhoneNumber,""),f.Ob(2),f.Tc("",f.vc(11,13,c.TotalAmount)," "),f.Ob(3),f.Sc(f.vc(14,15,c.DoneTime)),f.Ob(2),f.Pb("data-target","#collapse"+r)("aria-controls","collapse"+r),f.Ob(2),f.Ac("id","collapse"+r),f.Pb("aria-labelledby","heading"+r)("data-parent","#order"+r),f.Ob(2),f.Ac("ngForOf",c.OrderDetails)}}function bt(e,t){if(1&e&&(f.hc(0,"li",44),f.hc(1,"label"),f.Rc(2,"Ng\u01b0\u1eddi s\u1eeda hoa: "),f.gc(),f.hc(3,"span"),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.selectedDetail.FixingFloristName)}}function Ot(e,t){if(1&e&&(f.hc(0,"li",80),f.cc(1,"img",81),f.uc(2,"ImgPipe"),f.hc(3,"span",82),f.Rc(4),f.gc(),f.gc()),2&e){var i=t.$implicit;f.Bc("id",i.Id),f.Ob(1),f.Bc("src",f.wc(2,3,i.AvtUrl,"UserAvt"),f.Lc),f.Ob(3),f.Sc(i.FullName)}}function St(e,t){if(1&e&&(f.hc(0,"li",83),f.cc(1,"img",81),f.uc(2,"ImgPipe"),f.hc(3,"span",82),f.Rc(4),f.gc(),f.hc(5,"span",84),f.Rc(6),f.gc(),f.gc()),2&e){var i=t.$implicit;f.Bc("id",i.Id),f.Ob(1),f.Bc("src",f.wc(2,4,i.AvtUrl,"UserAvt"),f.Lc),f.Ob(3),f.Sc(i.FullName),f.Ob(2),f.Sc(i.IsExternalShipper?"Shipper ngo\xe0i":"Nh\xe2n vi\xean")}}var Dt,kt=((Dt=function(e){c(i,e);var t=n(i);function i(e,c,r,n,o,a,s,u,l,h,g){var m;return d(this,i),(m=t.call(this)).customerService=e,m.activatedRoute=c,m.router=r,m.orderService=n,m.storageService=o,m.productService=a,m.orderDetailService=s,m.http=u,m.datePipe=l,m.userService=h,m.printJobService=g,m.Title="Danh s\xe1ch \u0111\u01a1n",m.NavigateClass="nav-icon ",m.IsDataLosingWarning=!1,m.states=P.e,m.pageSize=20,m.currentPage=0,m.totalPage=0,m.statuses=[],m.searchTerm="",m.allStatuses=[P.e.Added,P.e.Comfirming,P.e.Deliveried,P.e.DeliverAssinged,P.e.DeliveryWaiting,P.e.Making,P.e.Waiting,P.e.SentBack,P.e.Fixing,P.e.FixingRequest,P.e.Completed,P.e.Canceled],m.selectedDetail={},m.globalService.currentOrderViewModel=new C.d,m.selectMakingRequestTime=new Date,m.orders=[],m.florists=[],m.shippers=[],m}return l(i,[{key:"OnBackNaviage",value:function(){customerSupport()}},{key:"filterByState",value:function(){var e=this,t=[];t.push({Name:"T\u1ea5t c\u1ea3",Value:"ALL"}),ce.e.forEach((function(e){t.push({Name:e.DisplayName,Value:e.State})})),filterOrderByState(t,(function(t){e.currentPage=0,e.statuses="ALL"==t?e.allStatuses:[t],e.orderService.searchOrders(e.currentPage,e.pageSize,e.statuses).then((function(t){e.totalPage=t.totalPages,e.orders=t.orders}))}))}},{key:"searchOrder",value:function(e){var t=this;this.currentPage=0,this.searchTerm=e,this.orderService.searchOrders(this.currentPage,this.pageSize,this.statuses,this.searchTerm).then((function(e){t.totalPage=e.totalPages,t.orders=e.orders}))}},{key:"goToPage",value:function(e){var t=this;e>=this.totalPage||e<0||(this.currentPage=e,this.orderService.searchOrders(this.currentPage,this.pageSize,this.statuses,this.searchTerm).then((function(e){t.totalPage=e.totalPages,t.orders=e.orders})))}},{key:"logout",value:function(){var e=this;this.authService.logOut((function(t){t&&e.router.navigate(["staff/login"])}))}},{key:"Init",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setStatusBarColor(!1),this.statuses=this.allStatuses,this.orderService.searchOrders(this.currentPage,this.pageSize,this.statuses).then((function(e){t.totalPage=e.totalPages,t.orders=e.orders})),this.userService.getByRole(P.h.Florist).then((function(e){t.florists=e})),this.userService.getByRole(P.h.Shipper).then((function(e){t.shippers=e})),this.askForRememberPassword();case 1:case"end":return e.stop()}}),e,this)})))}},{key:"doPrintJob",value:function(e){var t=this,i=0,c=[];e.OrderDetails.forEach((function(e){c.push({productName:e.ProductName,index:e.Index+1,price:e.ModifiedPrice,additionalFee:e.AdditionalFee,discount:t.getDetailDiscount(e.ModifiedPrice,e.PercentDiscount,e.AmountDiscount),quantity:e.Quantity}),i+=e.ModifiedPrice}));var r=[];e.PurchaseItems&&e.PurchaseItems.forEach((function(e){r.push({method:e.Method,amount:e.Amount})}));var n={Created:(new Date).getTime(),doneTime:new Date(e.DoneTime).toLocaleString("en-US",{hour12:!1}),Id:e.OrderId,Active:!0,IsDeleted:!1,saleItems:c,createdDate:e.CreatedDate.toLocaleString("en-US",{hour12:!1}),orderId:e.OrderId,summary:i,totalAmount:e.TotalAmount,totalPaidAmount:e.TotalPaidAmount,totalBalance:e.TotalAmount-e.TotalPaidAmount,vatIncluded:e.VATIncluded,memberDiscount:e.CustomerInfo.DiscountPercent,scoreUsed:e.CustomerInfo.ScoreUsed,gainedScore:e.CustomerInfo.GainedScore,totalScore:e.CustomerInfo.AvailableScore-e.CustomerInfo.ScoreUsed+e.CustomerInfo.GainedScore,customerName:e.CustomerInfo.Name,customerId:e.CustomerInfo.Id,discount:this.getDetailDiscount(e.TotalAmount,e.PercentDiscount,e.AmountDiscount),purchaseItems:r,isMemberDiscountApply:e.IsMemberDiscountApply};console.log(n),this.printJobService.addPrintJob(n)}},{key:"getDetailDiscount",value:function(e,t,i){var c=0;return t&&t>0&&(c=e/100*t),i&&i>0&&(c+=i),c}},{key:"selectOrder",value:function(e){var t=this;this.menuOpening((function(i){switch(+i){case 0:t.viewPurchase(e.OrderId);break;case 1:t.doPrintJob(e);break;case 2:t.orderDetailService.updateStatusByOrderId(e.OrderId,P.e.Completed,(new Date).getTime()).then((function(e){t.orderService.searchOrders(t.currentPage,t.pageSize,t.statuses).then((function(e){t.totalPage=e.totalPages,t.orders=e.orders}))}));break;case 3:t.orderDetailService.updateStatusByOrderId(e.OrderId,P.e.Canceled,0).then((function(e){t.orderService.searchOrders(t.currentPage,t.pageSize,t.statuses).then((function(e){t.totalPage=e.totalPages,t.orders=e.orders}))}))}}),["Th\xeam thanh to\xe1n","In ho\xe1 \u0111\u01a1n","Ho\xe0n t\u1ea5t \u0111\u01a1n","Hu\u1ef7 \u0111\u01a1n"])}},{key:"editOrder",value:function(e){var t=this;this.globalOrder=this.orders.filter((function(t){return t.OrderId===e}))[0],this.globalPurchases=this.globalOrder.PurchaseItems,this.isEdittingOrder=!0,this.customerService.getById(this.globalOrder.CustomerInfo.Id).then((function(e){e&&(t.globalOrder.CustomerInfo=t.orderService.getCustomerInfo(e,t.globalOrder)),t.router.navigate(["/staff/add-order"])}))}},{key:"viewPurchase",value:function(e){this.globalOrder=this.orders.filter((function(t){return t.OrderId===e}))[0],this.globalPurchases=this.globalOrder.PurchaseItems,this.router.navigate(["staff/view-purchase"])}},{key:"addOrder",value:function(){this.globalOrder=new C.d,this.globalOrderDetail=new C.c,this.isEdittingOrder=!1,this.globalPurchases=[],this.router.navigate(["/staff/add-order"])}},{key:"openDetailInfo",value:function(e){var t=this;this.orders.forEach((function(i){i.OrderDetails.forEach((function(i){i.OrderDetailId!==e||t.orderDetailService.getODFlorisAndShipper(i.OrderDetailId).then((function(e){t.selectedDetail.FloristName=e.Florist?e.Florist.FullName:"...",t.selectedDetail.ShipperName=e.Shipper?e.Shipper.FullName:"...",t.selectedDetail.State=i.State,t.selectedDetail.FixingFloristName=e.FixingFlorist?e.FixingFlorist.FullName:"",t.selectedDetail.StateDisplay=ce.e.filter((function(e){return e.State===i.State}))[0].DisplayName}))}))})),openColorBoard()}},{key:"updateOrderDetailState",value:function(e){var t=new C.c,i=new C.d;switch(this.orders.forEach((function(c){c.OrderDetails.forEach((function(r){if(r.OrderDetailId===e)return t=r,void(i=c)}))})),t.State){case P.e.Added:this.updateAddedDetailState(t,i);break;case P.e.Waiting:this.updateWaitingDetailState(t,i);break;case P.e.Making:this.updateMakingDetailState(t,i);break;case P.e.Comfirming:this.updatConfirmingDetailState(t,i);break;case P.e.Deliveried:this.updateDeliveriedDetailState(t,i);break;case P.e.DeliveryWaiting:this.updateDeliveryWaitingDetailState(t,i);break;case P.e.DeliverAssinged:this.updateDeliveringetailState(t,i);break;case P.e.SentBack:this.updateSentBackDetailState(t,i);break;case P.e.Completed:case P.e.Fixing:this.globalOrderDetail=t,this.globalOrder=i,this.router.navigate(["staff/order-detail-view"]);break;case P.e.FixingRequest:this.updateFixingRequestDetailState(t,i)}}},{key:"updateFixingRequestDetailState",value:function(e,t){var i=this;this.menuOpening((function(c){switch(+c){case 1:i.globalOrderDetail=e,i.globalOrder=t,i.router.navigate(["staff/order-detail-view"]);break;case 0:chooseFlorist((function(t){i.transferToFloristToFix(e,+t)}));break;case 2:i.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.Canceled,ShippingSortOrder:0,MakingSortOrder:0}).then((function(){e.State=P.e.Canceled}))}}),["Ch\u1ecdn Florist","Xem chi ti\u1ebft","Hu\u1ef7  \u0111\u01a1n"])}},{key:"updateSentBackDetailState",value:function(e,t){var i=this;this.menuOpening((function(c){switch(+c){case 2:i.globalOrderDetail=e,i.globalOrder=t,i.router.navigate(["staff/order-detail-view"]);break;case 0:i.orderDetailService.getNextShippingSortOrder().then((function(t){i.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.DeliveryWaiting,ShippingSortOrder:t}).then((function(){e.State=P.e.DeliveryWaiting}))}));break;case 1:i.selectDeliveryTime=i.datePipe.transform(e.DeliveryInfo.DateTime,"hh:mm a dd-MM-yyyy"),i.selectMakingRequestTime=new Date,i.makingNote=e.MakingNote,makingTimeRequest((function(){i.transferToFloristToFix(e)}),(function(){chooseFlorist((function(t){i.transferToFloristToFix(e,+t)}))}));break;case 3:i.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.Canceled,ShippingSortOrder:0}).then((function(){e.State=P.e.Canceled}))}}),["Giao sau","L\xe0m l\u1ea1i \u0111\u01a1n","Xem chi ti\u1ebft","Hu\u1ef7  \u0111\u01a1n"])}},{key:"updateDeliveringetailState",value:function(e,t){var i=this;this.menuOpening((function(c){switch(+c){case 0:i.globalOrderDetail=e,i.globalOrder=t,i.router.navigate(["staff/order-detail-view"]);break;case 1:i.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.Deliveried,ShippingSortOrder:0}).then((function(){e.State=P.e.Deliveried}));break;case 2:i.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.Canceled,ShippingSortOrder:0}).then((function(){e.State=P.e.Canceled}))}}),["Xem chi ti\u1ebft","Ho\xe0n th\xe0nh \u0111\u01a1n","Hu\u1ef7 chi ti\u1ebft \u0111\u01a1n"])}},{key:"updateDeliveryWaitingDetailState",value:function(e,t){var i=this;this.menuOpening((function(c){switch(+c){case 0:chooseShipper((function(t){i.orderDetailService.assignSingleOD(e.OrderDetailId,t,(new Date).getTime()).then((function(t){e.State=P.e.DeliverAssinged}))}));break;case 1:i.globalOrderDetail=e,i.globalOrder=t,i.router.navigate(["staff/order-detail-view"]);break;case 2:i.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.Canceled,ShippingSortOrder:0}).then((function(){e.State=P.e.Canceled}))}}),["Ch\u1ecdn Shipper","Xem chi ti\u1ebft","Hu\u1ef7 chi ti\u1ebft \u0111\u01a1n"])}},{key:"updateMakingDetailState",value:function(e,t){var i=this;this.menuOpening((function(c){switch(+c){case 0:i.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.Added,MakingSortOrder:0,MakingRequestTime:0,FloristId:null}).then((function(){e.State=P.e.Added,e.MakingSortOrder=0,e.MakingRequestTime=0,e.FloristInfo=new w.b}));break;case 1:i.globalOrderDetail=e,i.globalOrder=t,i.router.navigate(["staff/order-detail-view"]);break;case 2:i.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.Canceled,MakingSortOrder:0}).then((function(){e.State=P.e.Canceled}))}}),["X\u1eed l\xfd sau","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}},{key:"updatConfirmingDetailState",value:function(e,t){var i=this;this.menuOpening((function(c){switch(+c){case 0:i.globalOrderDetail=e,i.router.navigate(["staff/order-detail-confirming"]);break;case 1:i.selectDeliveryTime=i.datePipe.transform(e.DeliveryInfo.DateTime,"hh:mm a dd-MM-yyyy"),i.selectMakingRequestTime=e.DeliveryInfo.DateTime,i.makingNote="",makingTimeRequest((function(){i.transferToFlorist(e,t)}),(function(){chooseFlorist((function(c){i.transferToFlorist(e,t,+c)}))}));break;case 2:i.globalOrderDetail=e,i.globalOrder=t,i.router.navigate(["staff/order-detail-view"]);break;case 3:i.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.Canceled,MakingSortOrder:0,MakingRequestTime:0}).then((function(){e.State=P.e.Canceled,e.MakingSortOrder=0,e.MakingRequestTime=0,i.deleteOrderDetail(e,t)}))}}),["X\xe1c nh\u1eadn th\xe0nh ph\u1ea9m","L\xe0m l\u1ea1i \u0111\u01a1n","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}},{key:"updateDeliveriedDetailState",value:function(e,t){var i=this;this.menuOpening((function(c){switch(+c){case 0:i.globalOrderDetail=e,i.globalOrder=t,i.router.navigate(["staff/final-confirm"]);break;case 1:i.globalOrderDetail=e,i.globalOrder=t,i.router.navigate(["staff/order-detail-view"]);break;case 2:i.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.Canceled,MakingSortOrder:0,MakingRequestTime:0}).then((function(){e.State=P.e.Canceled,e.MakingSortOrder=0,e.MakingRequestTime=0,i.deleteOrderDetail(e,t)}))}}),["X\xe1c nh\u1eadn giao","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}},{key:"updateWaitingDetailState",value:function(e,t){var i=this;this.menuOpening((function(c){switch(+c){case 0:i.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.Added,MakingSortOrder:0,MakingRequestTime:0}).then((function(){e.State=P.e.Added,e.MakingSortOrder=0,e.FloristInfo=new w.b,e.MakingRequestTime=0}));break;case 1:i.globalOrderDetail=e,i.globalOrder=t,i.router.navigate(["staff/order-detail-view"]);break;case 2:i.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.Canceled,MakingSortOrder:0,MakingRequestTime:0}).then((function(){e.State=P.e.Canceled,e.MakingSortOrder=0,e.MakingRequestTime=0,i.deleteOrderDetail(e,t)}))}}),["X\u1eed l\xfd sau","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}},{key:"transferToFlorist",value:function(e,t,i){var c=this;console.log("edit:",e),i?this.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.Making,MakingSortOrder:0,MakingRequestTime:this.selectMakingRequestTime.getTime(),MakingNote:this.makingNote,FloristId:i}).then((function(){e.MakingSortOrder=0,e.State=P.e.Making,e.MakingRequestTime=c.selectMakingRequestTime.getTime(),e.MakingNote=c.makingNote})):this.orderDetailService.getNextMakingSortOrder().then((function(t){c.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.Waiting,MakingSortOrder:t,MakingRequestTime:c.selectMakingRequestTime.getTime(),MakingNote:c.makingNote}).then((function(){e.MakingSortOrder=t,e.State=P.e.Waiting,e.MakingRequestTime=c.selectMakingRequestTime.getTime(),e.MakingNote=c.makingNote}))}))}},{key:"transferToFloristToFix",value:function(e,t){var i=this;this.orderDetailService.getNextMakingSortOrder().then((function(c){var r;r=t?{State:P.e.Fixing,MakingSortOrder:0,MakingRequestTime:i.selectMakingRequestTime.getTime(),MakingNote:i.makingNote,FixingFloristId:t}:{State:P.e.FixingRequest,MakingSortOrder:c,MakingRequestTime:i.selectMakingRequestTime.getTime(),MakingNote:i.makingNote},i.orderDetailService.updateFields(e.OrderDetailId,r).then((function(){e.State=t?P.e.Fixing:P.e.FixingRequest,e.MakingSortOrder=t?0:c,e.MakingRequestTime=i.selectMakingRequestTime.getTime(),e.MakingNote=i.makingNote}))}))}},{key:"updateAddedDetailState",value:function(e,t){var i=this;this.menuOpening((function(c){switch(+c){case 0:i.selectDeliveryTime=i.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd/MM/yyyy"),i.selectMakingRequestTime=e.MakingRequestTime?new Date(e.MakingRequestTime):e.DeliveryInfo.DateTime,i.makingNote=e.MakingNote?e.MakingNote:"",makingTimeRequest((function(){i.transferToFlorist(e,t)}),(function(){chooseFlorist((function(c){i.transferToFlorist(e,t,+c)}))}));break;case 1:i.globalOrderDetail=e,i.globalOrder=t,i.router.navigate(["staff/order-detail-view"]);break;case 2:i.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.Canceled,MakingSortOrder:0}).then((function(){e.State=P.e.Canceled,e.MakingSortOrder=0,i.deleteOrderDetail(e,t)}))}}),["Chuy\u1ec3n cho Florist","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}},{key:"deleteOrderDetail",value:function(e,t){var i=t.OrderDetails.indexOf(e);if(t.OrderDetails.splice(i,1),t.OrderDetails.length<=0){var c=this.orders.filter((function(e){return e.OrderId==t.OrderId}))[0];this.orders.splice(this.orders.indexOf(c),1)}}}]),i}(y)).\u0275fac=function(e){return new(e||Dt)(f.bc(x.a),f.bc(h.a),f.bc(h.b),f.bc(F.a),f.bc(re),f.bc(lt.a),f.bc(X.a),f.bc(dt.a),f.bc(H.b),f.bc(ht.a),f.bc(N.a))},Dt.\u0275cmp=f.Vb({type:Dt,selectors:[["app-orders-manage"]],features:[f.Lb],decls:92,vars:22,consts:[["id","order",1,"page-content"],[1,"container","order-add"],[1,"row"],[1,"col-2"],[1,"col-8","text-center"],["href","javascript:void(0);",1,"btn","main-btn",3,"click"],[1,"col-2","order-noti","text-right"],["routerLink","/staff/add-purchse"],["src","../../../assets/images/money.svg","alt","",1,"main-filter"],[1,"container","order-list"],[1,"row","order-list-top"],[1,"col-2","order-filter","text-left",3,"click"],[1,"main-bg"],["src","../../../assets/images/filter.svg","alt","",1,"main-filter"],[1,"col-8","order-search"],["placeholder","T\xean ho\u1eb7c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i KH...",3,"delayTimeSpan","searchTextInvoke"],[1,"col-2","order-check","text-right"],["routerLink","/staff/sort-order-changing",1,"main-bg"],["src","../../../assets/images/check.svg","alt","",1,"main-filter"],[1,"paging"],[1,"paging-arrow","paging-prev","main-bg",3,"click"],[1,"fa","fa-angle-left"],[1,"paging-arrow","paging-next","main-bg",3,"click"],[1,"fa","fa-angle-right"],[1,"row","order-list-bot"],["id","accordionOrder",1,"col-12","order-content","accordion","cusScroll"],["class","order-content-item",3,"id",4,"ngFor","ngForOf"],["id","makingTimeRequest",1,"popup-content"],[2,"font-weight","bold","font-size","15px","margin-left","3px"],[1,"form-group"],[1,"custom-label"],["id","request-time","name","DateTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],["id","makingNote","name","makingNote",1,"mainForm",2,"width","100%","height","130px",3,"ngModel","ngModelChange"],[1,"col-12","mx-auto","text-center"],["type","button","id","choose-florist-btn",1,"btn","main-btn","w-100","mt-3"],[1,"col-6","mx-auto","text-center"],["type","button","id","submit-btn",1,"btn","main-btn","w-100","mt-3"],["type","button","id","cancel-btn",1,"btn","grey-btn","w-100","mt-3"],["id","colorBoard",1,"popup-content"],[1,"colorList"],[1,"colorInfo","colorItem"],[3,"state"],[1,"colorInfo"],["class","colorInfo",4,"ngIf"],["id","viewed",1,"popup-content","florist"],[1,"viewedList"],["class","viewItem",3,"id",4,"ngFor","ngForOf"],["id","viewed",1,"popup-content","shipper"],["class","viewItem-three-column",3,"id",4,"ngFor","ngForOf"],[1,"customer-support"],["alt","",1,"customer-avatar",3,"src"],[1,"customer-name"],["href","tel:0000",1,"customer-phone"],[1,"customer-position"],["id","logoutBtn",1,"customer-position",3,"click"],[1,"order-content-item",3,"id"],[1,"item-top",3,"id"],[1,"item-code",3,"click"],[1,"item-info",3,"click"],[1,"item-name"],[1,"item-name",2,"font-size","12px","margin-top","1px"],[1,"item-price"],[1,"item-date"],["data-toggle","collapse","aria-expanded","false",1,"collapsed"],[1,"item-bot","collapse",3,"id"],[1,"order-product-list","cusScroll"],["class","order-product-item",4,"ngFor","ngForOf"],["href","javascript:void(0);",1,"order-edit",3,"click"],[1,"fa","fa-pencil"],[1,"order-product-item"],[3,"state","id","index","onClicked"],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"item-quantity"],[1,"item-address"],[1,"item-time"],[1,"viewItem",3,"id"],["alt","",1,"itemAva",3,"src"],[1,"itemName"],[1,"viewItem-three-column",3,"id"],[1,"itemRole"]],template:function(e,t){if(1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.cc(3,"div",3),f.hc(4,"div",4),f.hc(5,"a",5),f.pc("click",(function(e){return t.addOrder()})),f.Rc(6,"Th\xeam \u0111\u01a1n"),f.gc(),f.gc(),f.hc(7,"div",6),f.hc(8,"a",7),f.cc(9,"img",8),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(10,"div",9),f.hc(11,"div",10),f.hc(12,"div",11),f.pc("click",(function(e){return t.filterByState()})),f.hc(13,"a",12),f.cc(14,"img",13),f.gc(),f.gc(),f.hc(15,"div",14),f.hc(16,"mobile-search-box",15),f.pc("searchTextInvoke",(function(e){return t.searchOrder(e)})),f.gc(),f.gc(),f.hc(17,"div",16),f.hc(18,"a",17),f.cc(19,"img",18),f.gc(),f.gc(),f.gc(),f.hc(20,"ul",19),f.hc(21,"li",20),f.pc("click",(function(e){return t.goToPage(t.currentPage-1)})),f.cc(22,"i",21),f.gc(),f.hc(23,"li",22),f.pc("click",(function(e){return t.goToPage(t.currentPage+1)})),f.cc(24,"i",23),f.gc(),f.gc(),f.hc(25,"div",24),f.hc(26,"ul",25),f.Pc(27,vt,23,17,"li",26),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(28,"div",27),f.hc(29,"label"),f.Rc(30,"Th\u1eddi gian giao: "),f.gc(),f.hc(31,"span",28),f.Rc(32),f.gc(),f.hc(33,"div",29),f.hc(34,"label",30),f.Rc(35,"Th\u1eddi gian ho\xe0n th\xe0nh: "),f.gc(),f.hc(36,"input",31),f.pc("ngModelChange",(function(e){return t.selectMakingRequestTime=e})),f.gc(),f.cc(37,"owl-date-time",32,33),f.gc(),f.hc(39,"div",29),f.hc(40,"label",30),f.Rc(41,"Ghi ch\xfa: "),f.gc(),f.hc(42,"textarea",34),f.pc("ngModelChange",(function(e){return t.makingNote=e})),f.gc(),f.gc(),f.hc(43,"div",2),f.hc(44,"div",35),f.hc(45,"button",36),f.Rc(46,"Ch\u1ec9 \u0111\u1ecbnh Florist"),f.gc(),f.gc(),f.gc(),f.hc(47,"div",2),f.hc(48,"div",37),f.hc(49,"button",38),f.Rc(50,"L\u01b0u"),f.gc(),f.gc(),f.hc(51,"div",37),f.hc(52,"button",39),f.Rc(53,"H\u1ee7y"),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(54,"div",40),f.hc(55,"ul",41),f.hc(56,"li",42),f.cc(57,"app-status-point",43),f.hc(58,"label"),f.Rc(59),f.gc(),f.gc(),f.hc(60,"li",44),f.hc(61,"label"),f.Rc(62,"Ng\u01b0\u1eddi c\u1eafm hoa: "),f.gc(),f.hc(63,"span"),f.Rc(64),f.gc(),f.gc(),f.hc(65,"li",44),f.hc(66,"label"),f.Rc(67,"Ng\u01b0\u1eddi giao hoa: "),f.gc(),f.hc(68,"span"),f.Rc(69),f.gc(),f.gc(),f.Pc(70,bt,5,1,"li",45),f.gc(),f.gc(),f.hc(71,"div",46),f.hc(72,"h3",12),f.Rc(73,"Ch\u1ecdn Florist"),f.gc(),f.hc(74,"ul",47),f.Pc(75,Ot,5,6,"li",48),f.gc(),f.gc(),f.hc(76,"div",49),f.hc(77,"h3",12),f.Rc(78,"Ch\u1ecdn Shipper"),f.gc(),f.hc(79,"ul",47),f.Pc(80,St,7,7,"li",50),f.gc(),f.gc(),f.hc(81,"div",51),f.cc(82,"img",52),f.uc(83,"ImgPipe"),f.hc(84,"p",53),f.Rc(85),f.gc(),f.hc(86,"a",54),f.Rc(87),f.gc(),f.hc(88,"p",55),f.Rc(89),f.gc(),f.hc(90,"p",56),f.pc("click",(function(e){return t.logout()})),f.Rc(91,"\u0110\u0103ng xu\u1ea5t"),f.gc(),f.gc()),2&e){var i=f.Hc(38);f.Ob(16),f.Ac("delayTimeSpan",1e3),f.Ob(11),f.Ac("ngForOf",t.orders),f.Ob(5),f.Sc(t.selectDeliveryTime),f.Ob(4),f.Ac("owlDateTime",i)("owlDateTimeTrigger",i)("ngModel",t.selectMakingRequestTime),f.Ob(1),f.Ac("stepMinute",5),f.Ob(5),f.Ac("ngModel",t.makingNote),f.Ob(15),f.Ac("state",t.selectedDetail.State),f.Ob(2),f.Sc(t.selectedDetail.StateDisplay),f.Ob(5),f.Sc(t.selectedDetail.FloristName),f.Ob(5),f.Sc(t.selectedDetail.ShipperName),f.Ob(1),f.Ac("ngIf",t.selectedDetail&&void 0!==t.selectedDetail.FixingFloristName&&""!==t.selectedDetail.FixingFloristName),f.Ob(5),f.Ac("ngForOf",t.florists),f.Ob(5),f.Ac("ngForOf",t.shippers),f.Ob(2),f.Bc("src",f.wc(83,19,t.CurrentUser.Avt,"UserAvt"),f.Lc),f.Ob(3),f.Sc(t.CurrentUser.FullName),f.Ob(2),f.Sc(t.CurrentUser.PhoneNumber),f.Ob(2),f.Sc(t.CurrentUser.Role)}},directives:[h.c,pt,D.k,q.c,B.b,q.f,B.k,B.n,q.b,qe,D.l],pipes:[V.a,H.a,H.b,H.c],styles:[".item-detail-info[_ngcontent-%COMP%]   .item-date[_ngcontent-%COMP%]{margin-left:7px}"]}),Dt);function It(e,t){if(1&e&&(f.hc(0,"div",40),f.hc(1,"div",10),f.Rc(2),f.gc(),f.hc(3,"div",11),f.Rc(4),f.gc(),f.hc(5,"div",12),f.Rc(6),f.gc(),f.gc()),2&e){var i=t.$implicit;f.Pb("data-id",i.Id),f.Ob(2),f.Sc(i.FullName),f.Ob(2),f.Sc(i.PhoneNumber),f.Ob(2),f.Sc(i.MembershipInfo.MembershipType)}}function yt(e,t){1&e&&(f.hc(0,"div"),f.Rc(1," M\xe3 l\xe0 b\u1eaft bu\u1ed9c "),f.gc())}function Ct(e,t){1&e&&(f.hc(0,"div"),f.Rc(1," T\xean t\u1ed1i thi\u1ec3u 3 k\xfd t\u1ef1 "),f.gc())}function Pt(e,t){if(1&e&&(f.hc(0,"div",41),f.Pc(1,yt,2,0,"div",42),f.Pc(2,Ct,2,0,"div",42),f.gc()),2&e){f.tc();var i=f.Hc(27);f.Ob(1),f.Ac("ngIf",i.errors.required),f.Ob(1),f.Ac("ngIf",i.errors.minlength)}}function At(e,t){1&e&&(f.hc(0,"div"),f.Rc(1," T\xean t\u1ed1i thi\u1ec3u 1 k\xfd t\u1ef1 "),f.gc())}function wt(e,t){if(1&e&&(f.hc(0,"div",41),f.Pc(1,At,2,0,"div",42),f.gc()),2&e){f.tc();var i=f.Hc(31);f.Ob(1),f.Ac("ngIf",i.errors.minlength)}}function Rt(e,t){1&e&&(f.hc(0,"div"),f.Rc(1," SDT t\u1ed1i thi\u1ec3u 3 k\xfd t\u1ef1 "),f.gc())}function Tt(e,t){if(1&e&&(f.hc(0,"div",41),f.Pc(1,Rt,2,0,"div",42),f.gc()),2&e){f.tc();var i=f.Hc(43);f.Ob(1),f.Ac("ngIf",i.errors.minlength)}}function Mt(e,t){if(1&e&&(f.hc(0,"li",38),f.hc(1,"label"),f.Rc(2,"Ng\xe0y sinh: "),f.gc(),f.hc(3,"span"),f.Rc(4),f.uc(5,"myDatePipe"),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(f.vc(5,1,i.selectedCustomer.Birthday))}}function Ft(e,t){if(1&e&&(f.hc(0,"li",38),f.hc(1,"label"),f.Rc(2,"Facebook: "),f.gc(),f.hc(3,"span"),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.selectedCustomer.ContactInfo.Facebook)}}function xt(e,t){if(1&e&&(f.hc(0,"li",38),f.hc(1,"label"),f.Rc(2,"Zalo: "),f.gc(),f.hc(3,"span"),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.selectedCustomer.ContactInfo.Zalo)}}function Nt(e,t){if(1&e&&(f.hc(0,"li",38),f.hc(1,"label"),f.Rc(2,"Instagram: "),f.gc(),f.hc(3,"span"),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.selectedCustomer.ContactInfo.Instagram)}}function Lt(e,t){if(1&e&&(f.hc(0,"li",38),f.hc(1,"label"),f.Rc(2,"Skype: "),f.gc(),f.hc(3,"span"),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.selectedCustomer.ContactInfo.Skype)}}var Ut,Bt,qt=((Ut=function(e){c(i,e);var t=n(i);function i(e,c){var r;return d(this,i),(r=t.call(this)).customerService=e,r._ngZone=c,r.Title="Ch\u1ecdn kh\xe1ch h\xe0ng",r.IsDataLosingWarning=!1,r.totalCount=0,r.newCustomer=new M.a,r.customers=[],r.selectedCustomer=new M.a,window.searchProdReference={component:a(r),zone:r._ngZone,itemSelected:function(e){return r.setSelectedCustomer(e)}},r}return l(i,[{key:"setSelectedCustomer",value:function(e){var t=this;this.selectedCustomer=this.customers.filter((function(t){return t.Id===e}))[0],this.menuOpening((function(e){switch(+e){case 0:t.selectConfirm();break;case 1:viewCustomerInfo()}}),["Ch\u1ecdn Kh\xe1ch h\xe0ng","Xem th\xf4ng tin chi ti\u1ebft"])}},{key:"Init",value:function(){var e=this;this.customerService.getCount().then((function(t){e.totalCount=t+1,e.newCustomer=new M.a,e.newCustomer.Id=A.a.detectCustomerId(e.totalCount)})),this.selectedCustomer=new M.a,this.globalOrder.CustomerInfo&&this.searchCustomer(this.globalOrder.CustomerInfo.PhoneNumber)}},{key:"addCustomer",value:function(e){var t=this;if(e.valid){this.selectedCustomer=null;var i=new M.a;i.FullName=this.newCustomer.FullName,i.PhoneNumber=this.newCustomer.PhoneNumber,i.Sex=this.newCustomer.Sex,i.MembershipInfo.MembershipType=P.c.NewCustomer,i.MembershipInfo.AccumulatedAmount=0,i.MembershipInfo.AvailableScore=0,i.MembershipInfo.UsedScoreTotal=0,i.Id=this.newCustomer.Id,this.customerService.createCustomer(i).then((function(e){t.newCustomer=new M.a,t.selectedCustomer=i,t.customers.push(i),t.globalOrder.CustomerInfo=C.a.toViewModel(t.selectedCustomer),setSelectedCustomerItem(t.globalOrder.CustomerInfo.Id),closeAddCustomerDialog(),t.totalCount+=1,t.newCustomer=new M.a,t.newCustomer.Id=A.a.detectCustomerId(t.totalCount)}))}}},{key:"selectConfirm",value:function(){null!=this.selectedCustomer?this.globalOrder.CustomerInfo.Id!==this.selectedCustomer.Id?(this.globalOrder.CustomerInfo=C.a.toViewModel(this.selectedCustomer),this.OnBackNaviage()):this.OnBackNaviage():this.showError("Ch\u01b0a ch\u1ecdn kh\xe1ch h\xe0ng n\xe0o c\u1ea3!!!")}},{key:"searchCustomer",value:function(e){var t=this;e&&""!=e?this.customerService.getList(-1,-1,P.c.All,e).then((function(e){t.customers=e.Customers,setTimeout((function(){t.globalOrder.CustomerInfo.Id&&(setSelectedCustomerItem(t.globalOrder.CustomerInfo.Id),t.selectedCustomer=e.Customers.find((function(e){return e.Id===t.globalOrder.CustomerInfo.Id})))}),50)})):this.customers=[]}}]),i}(y)).\u0275fac=function(e){return new(e||Ut)(f.bc(x.a),f.bc(f.H))},Ut.\u0275cmp=f.Vb({type:Ut,selectors:[["app-select-customer"]],features:[f.Lb],decls:74,vars:19,consts:[["id","customerInfo",1,"page-content"],[1,"container"],[1,"row","checkTop","search"],[1,"col-10","filterSearch"],["placeholder","T\xean ho\u1eb7c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i KH...",3,"delayTimeSpan","searchTextInvoke"],[1,"col-2","filterAdd","text-right"],["onclick","openAddInfo()",1,"main-bg"],["src","../../../../assets/images/addnew.svg","alt","",1,"main-filter"],[1,"nameTable"],[1,"tableHead"],[1,"tableLeft"],[1,"tableCenter"],[1,"tableRight"],["id","customer-list",1,"tableBody","cusScroll"],["class","tableRow main-bg customer-item","onclick","selectItem(this,'.customer-item')",4,"ngFor","ngForOf"],[1,"row","prodDone"],[1,"col-8","mx-auto","text-center"],["href","javascript:void(0);",1,"btn","main-btn","w-100",3,"click"],["id","infoAdd",1,"popup-content"],["autocomplete","on",1,"addInfoForm",3,"submit"],["form","ngForm"],[1,"form-group"],["type","text","name","Id","id","Id","required","","minlength","3","placeholder","M\xe3 KH...",1,"mainForm",3,"ngModel","ngModelChange"],["Id","ngModel"],["class","alert alert-danger",4,"ngIf"],["type","text","name","FullName","id","FullName","minlength","1","placeholder","T\xean \u0111\u1ea7y \u0111\u1ee7 ...",1,"mainForm",3,"ngModel","ngModelChange"],["FullName","ngModel"],["id","newCustomer.Sex","name","newCustomer.Sex",1,"mainForm",3,"ngModel","ngModelChange"],["selected",""],[3,"ngValue"],["type","tel","name","PhoneNumber","id","PhoneNumber","minlength","3","placeholder","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i...",1,"mainForm",3,"ngModel","ngModelChange"],["PhoneNumber","ngModel"],[1,"row"],[1,"col-6","mx-auto","text-center"],["type","button","id","cancel-button",1,"btn","grey-btn","w-100","mt-3"],["type","submit",1,"btn","main-btn","w-100","mt-3","btn-success"],["id","colorBoard",1,"popup-content"],[1,"colorList"],[1,"colorInfo"],["class","colorInfo",4,"ngIf"],["onclick","selectItem(this,'.customer-item')",1,"tableRow","main-bg","customer-item"],[1,"alert","alert-danger"],[4,"ngIf"]],template:function(e,t){if(1&e){var i=f.ic();f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.hc(4,"mobile-search-box",4),f.pc("searchTextInvoke",(function(e){return t.searchCustomer(e)})),f.gc(),f.gc(),f.hc(5,"div",5),f.hc(6,"button",6),f.cc(7,"img",7),f.gc(),f.gc(),f.gc(),f.hc(8,"div",8),f.hc(9,"div",9),f.hc(10,"div",10),f.Rc(11,"H\u1ecd t\xean"),f.gc(),f.hc(12,"div",11),f.Rc(13,"SDT"),f.gc(),f.hc(14,"div",12),f.Rc(15,"Th\xe0nh vi\xean"),f.gc(),f.gc(),f.hc(16,"div",13),f.Pc(17,It,7,4,"div",14),f.gc(),f.gc(),f.hc(18,"div",15),f.hc(19,"div",16),f.hc(20,"a",17),f.pc("click",(function(e){return t.selectConfirm()})),f.Rc(21,"Xong"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(22,"div",18),f.hc(23,"form",19,20),f.pc("submit",(function(e){f.Jc(i);var c=f.Hc(24);return t.addCustomer(c)})),f.hc(25,"div",21),f.hc(26,"input",22,23),f.pc("ngModelChange",(function(e){return t.newCustomer.Id=e})),f.gc(),f.Pc(28,Pt,3,2,"div",24),f.gc(),f.hc(29,"div",21),f.hc(30,"input",25,26),f.pc("ngModelChange",(function(e){return t.newCustomer.FullName=e})),f.gc(),f.Pc(32,wt,2,1,"div",24),f.gc(),f.hc(33,"div",21),f.hc(34,"select",27),f.pc("ngModelChange",(function(e){return t.newCustomer.Sex=e})),f.hc(35,"option",28),f.Rc(36,"Danh x\u01b0ng"),f.gc(),f.hc(37,"option",29),f.Rc(38,"Anh"),f.gc(),f.hc(39,"option",29),f.Rc(40,"Ch\u1ecb"),f.gc(),f.gc(),f.gc(),f.hc(41,"div",21),f.hc(42,"input",30,31),f.pc("ngModelChange",(function(e){return t.newCustomer.PhoneNumber=e})),f.gc(),f.Pc(44,Tt,2,1,"div",24),f.gc(),f.hc(45,"div",32),f.hc(46,"div",33),f.hc(47,"button",34),f.Rc(48,"H\u1ee7y"),f.gc(),f.gc(),f.hc(49,"div",33),f.hc(50,"button",35),f.Rc(51,"L\u01b0u"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(52,"div",36),f.hc(53,"ul",37),f.hc(54,"li",38),f.hc(55,"label"),f.Rc(56,"H\u1ecd t\xean:"),f.gc(),f.hc(57,"span"),f.Rc(58),f.gc(),f.gc(),f.hc(59,"li",38),f.hc(60,"label"),f.Rc(61,"SDT: "),f.gc(),f.hc(62,"span"),f.Rc(63),f.gc(),f.gc(),f.hc(64,"li",38),f.hc(65,"label"),f.Rc(66,"Danh x\u01b0ng: "),f.gc(),f.hc(67,"span"),f.Rc(68),f.gc(),f.gc(),f.Pc(69,Mt,6,3,"li",39),f.Pc(70,Ft,5,1,"li",39),f.Pc(71,xt,5,1,"li",39),f.Pc(72,Nt,5,1,"li",39),f.Pc(73,Lt,5,1,"li",39),f.gc(),f.gc()}if(2&e){var c=f.Hc(27),r=f.Hc(31),n=f.Hc(43);f.Ob(4),f.Ac("delayTimeSpan",1e3),f.Ob(13),f.Ac("ngForOf",t.customers),f.Ob(9),f.Ac("ngModel",t.newCustomer.Id),f.Ob(2),f.Ac("ngIf",c.invalid&&(c.dirty||c.touched)),f.Ob(2),f.Ac("ngModel",t.newCustomer.FullName),f.Ob(2),f.Ac("ngIf",r.invalid&&(r.dirty||r.touched)),f.Ob(2),f.Ac("ngModel",t.newCustomer.Sex),f.Ob(3),f.Ac("ngValue","Male"),f.Ob(2),f.Ac("ngValue","Female"),f.Ob(3),f.Ac("ngModel",t.newCustomer.PhoneNumber),f.Ob(2),f.Ac("ngIf",n.invalid&&(n.dirty||n.touched)),f.Ob(14),f.Sc(t.selectedCustomer.FullName),f.Ob(5),f.Sc(t.selectedCustomer.PhoneNumber),f.Ob(5),f.Sc(t.selectedCustomer.Sex),f.Ob(1),f.Ac("ngIf",t.selectedCustomer.Birthday&&t.selectedCustomer.Birthday>0),f.Ob(1),f.Ac("ngIf",t.selectedCustomer.ContactInfo&&t.selectedCustomer.ContactInfo.Facebook),f.Ob(1),f.Ac("ngIf",t.selectedCustomer.ContactInfo&&t.selectedCustomer.ContactInfo.Zalo),f.Ob(1),f.Ac("ngIf",t.selectedCustomer.ContactInfo&&t.selectedCustomer.ContactInfo.Instagram),f.Ob(1),f.Ac("ngIf",t.selectedCustomer.ContactInfo&&t.selectedCustomer.ContactInfo.Skype)}},directives:[pt,D.k,B.v,B.l,B.m,B.b,B.r,B.h,B.k,B.n,D.l,B.s,B.o,B.u],pipes:[H.b],styles:[""]}),Ut),Et=o("nAti"),Ht=o("kLqA"),Vt=function(e){c(i,e);var t=n(i);function i(){var e;return d(this,i),(e=t.call(this)).FolderName="/tempProduct",e}return i}(function(e){c(i,e);var t=n(i);function i(){return d(this,i),t.apply(this,arguments)}return i}(o("sWfF").a)),Jt=((Bt=function(e){c(i,e);var t=n(i);function i(){return d(this,i),t.call(this)}return l(i,[{key:"deleteFile",value:function(e){var t=new Vt;return this.storageService.deleteFile(e,t.FolderName)}},{key:"addFile",value:function(e,t,i){this.storageService.pushFileToStorage(e,t,(function(e){null===e&&i("ERROR"),i(e.Url)}))}},{key:"addFileFromBase64String",value:function(e,t,i){this.storageService.pushStringToStorage(e,t,(function(e){null===e&&i("ERROR"),i(e.Url)}))}},{key:"tableName",get:function(){return"/tempProducts"}}]),i}(function(){function t(){d(this,t);var e=v.a.getInjector();this.globalService=e.get(b.a),this.storageService=e.get(re)}return l(t,[{key:"startLoading",value:function(){this.globalService.startLoading()}},{key:"stopLoading",value:function(){this.globalService.stopLoading()}},{key:"errorToast",value:function(e){this.globalService.showError(e)}},{key:"infoToast",value:function(e){this.globalService.showInfo(e)}},{key:"warningToast",value:function(e){this.globalService.showWarning(e)}},{key:"successToast",value:function(e){this.globalService.showSuccess(e)}},{key:"deleteFileByUrl",value:function(e,t){var i=this;e&&""!==e?(this.startLoading(),this.tableRef.orderByChild("Url").equalTo(e).once("value").then((function(e){var c;if(e.forEach((function(e){c=e.val()})),!c)return i.stopLoading(),void t(!0);i.storageService.deleteFile(c.Name,c.FolderName).then((function(){i.stopLoading(),t(!0),i.delete(c.Id)})).catch((function(e){t(!1),i.stopLoading(),i.errorToast(e)}))}))):t(!0)}},{key:"updateList",value:function(e,t){var i=this;return this.tableRef.update(e,(function(e){e?i.errorToast(e.message):t()}))}},{key:"getByFieldName",value:function(e,t){var i=this;return this.globalService.startLoading(),this.tableRef.orderByChild(e).equalTo(t).once("value").then((function(e){i.globalService.stopLoading();var t=[];return e.forEach((function(e){var i=e.val();t.push(i)})),t})).catch((function(e){return i.globalService.stopLoading(),i.globalService.showError(e),[]}))}},{key:"setAnotherEntity",value:function(e,t){return this.db.ref("".concat(t,"/").concat(e.Id)).set(e).then((function(t){if(t)return e}))}},{key:"set",value:function(e){var t=this;return e.Id&&""!=e.Id||(e.Id=Ht.Guid.create().toString()),this.startLoading(),this.db.ref("".concat(this.tableName,"/").concat(e.Id)).set(e).then((function(i){return t.stopLoading(),e})).catch((function(e){throw t.errorToast(e.message),t.stopLoading(),new e}))}},{key:"insert",value:function(e){this.startLoading();var t=this.tableRef.push(e);return e.Id=t.key,this.update(e)}},{key:"setListSeperate",value:function(t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var c,r,n;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:c=e(t);try{for(c.s();!(r=c.n()).done;)n=r.value,this.set(n).catch((function(e){throw e}))}catch(o){c.e(o)}finally{c.f()}return i.abrupt("return",[]);case 3:case"end":return i.stop()}}),i,this)})))}},{key:"setList",value:function(t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var c,r,n,o,a;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:c=[],r=e(t),i.prev=2,r.s();case 4:if((n=r.n()).done){i.next=12;break}return o=n.value,i.next=8,this.set(o).catch((function(e){throw e}));case 8:(a=i.sent)&&c.push(a);case 10:i.next=4;break;case 12:i.next=17;break;case 14:i.prev=14,i.t0=i.catch(2),r.e(i.t0);case 17:return i.prev=17,r.f(),i.finish(17);case 20:return i.abrupt("return",c);case 21:case"end":return i.stop()}}),i,this,[[2,14,17,20]])})))}},{key:"insertList",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,c,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=[],this.startLoading(),c=0;case 3:if(!(c<e.length)){t.next=11;break}return t.next=6,this.insert(e[c]);case 6:(r=t.sent)?i.push(r):console.log("error insert");case 8:c++,t.next=3;break;case 11:return t.abrupt("return",i);case 12:case"end":return t.stop()}}),t,this)})))}},{key:"getById",value:function(e){var t=this;return this.startLoading(),this.db.ref("".concat(this.tableName,"/").concat(e)).once("value").then((function(e){return t.stopLoading(),e?e.val():null})).catch((function(e){return t.stopLoading(),console.log(e),null}))}},{key:"updateSingleField",value:function(e,t,i){var c=this;this.startLoading();var r={};return r["/".concat(e,"/").concat(t)]=i,this.tableRef.update(r,(function(e){c.stopLoading(),null!=e&&c.errorToast(e.message)}))}},{key:"updateFields",value:function(e){var t=this;return this.startLoading(),this.tableRef.update(e,(function(e){t.stopLoading(),null!=e&&t.errorToast(e.message)}))}},{key:"update",value:function(e){var t=this;return this.tableRef.child(e.Id).set(e).then((function(){return t.stopLoading(),e}))}},{key:"delete",value:function(e){var t=this;return this.startLoading(),this.db.ref("".concat(this.tableName,"/").concat(e)).remove().then((function(){t.stopLoading()}))}},{key:"deleteMany",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.startLoading(),e.forEach((function(e){return Object(p.a)(i,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.db.ref("".concat(this.tableName,"/").concat(e)).remove();case 2:case"end":return t.stop()}}),t,this)})))})),this.stopLoading();case 1:case"end":return t.stop()}}),t,this)})))}},{key:"getAllWithOrder",value:function(e){var t=this;return this.startLoading(),this.tableRef.orderByChild(e).once("value").then((function(e){var i=[];return e.forEach((function(e){i.push(e.val())})),t.stopLoading(),i})).catch((function(e){return t.errorToast(e),t.stopLoading(),[]}))}},{key:"getAll",value:function(){var e=this;return this.startLoading(),this.tableRef.once("value").then((function(t){var i=[];return t.forEach((function(e){i.push(e.val())})),e.stopLoading(),i})).catch((function(t){return e.errorToast(t),e.stopLoading(),[]}))}},{key:"deleteAll",value:function(){var e=this;return this.startLoading(),this.tableRef.remove().then((function(){e.stopLoading()}))}},{key:"tableRef",get:function(){return this.db.ref(this.tableName)}},{key:"db",get:function(){return null}}]),t}())).\u0275fac=function(e){return new(e||Bt)},Bt.\u0275prov=f.Xb({token:Bt,factory:Bt.\u0275fac,providedIn:"root"}),Bt),Wt=o("lBcp");function jt(e,t){if(1&e&&(f.hc(0,"div",26),f.hc(1,"div",27),f.cc(2,"img",28),f.uc(3,"ImgPipe"),f.hc(4,"h4"),f.Rc(5),f.gc(),f.hc(6,"span"),f.Rc(7),f.uc(8,"myCurrPipe"),f.gc(),f.gc(),f.gc()),2&e){var i=t.$implicit;f.Pb("data-id",i.Id),f.Ob(2),f.Bc("src",f.wc(3,4,i.ImageUrl,"ProductImg"),f.Lc),f.Ob(3),f.Sc(i.Name),f.Ob(2),f.Sc(f.vc(8,7,i.Price))}}function Gt(e,t){if(1&e){var i=f.ic();f.hc(0,"div",29),f.hc(1,"label",30),f.hc(2,"input",31),f.pc("ngModelChange",(function(e){return f.Jc(i),t.$implicit.IsSelected=e})),f.gc(),f.cc(3,"span",32),f.Rc(4),f.gc(),f.gc()}if(2&e){var c=t.$implicit;f.Ob(2),f.Ac("ngModel",c.IsSelected),f.Ob(2),f.Tc("",c.Tag.Name," ")}}var Xt,$t=((Xt=function(e){c(i,e);var t=n(i);function i(e,c,r,n,o,a,s,u){var l;return d(this,i),(l=t.call(this)).route=e,l.router=c,l.orderDetailService=r,l.productService=n,l._ngZone=o,l.tempProductService=a,l.tagService=s,l.categoryService=u,l.Title="Ch\u1ecdn s\u1ea3n ph\u1ea9m",l.currentPage=1,l.itemsPerPage=18,l.currentMaxPage=1,l.categoryName="",l.currentHardcodeUsedCount=-1,l.searchTerm="",l.priceSearchTerm=0,l.IsDataLosingWarning=!1,l.pagingProducts=[],l.categories=[],l.globalTags=[],l.productSearchingMode=P.f.None,l.images=[],l}return l(i,[{key:"Init",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.selectedProduct=new Et.a,this.route.queryParams.subscribe((function(e){t.categoryService.getAll().then((function(i){t.categories.push({Value:-1,Name:"T\u1ea5t c\u1ea3"}),i.forEach((function(e){t.categories.push({Value:e.Id,Name:e.Name})})),t.tagService.getAll().then((function(i){i.forEach((function(e){t.globalTags.push({Tag:e,IsSelected:!1})})),t.getProductByCategory(+e.category)}))}))})),window.searchProdReference={component:this,zone:this._ngZone,itemSelected:function(e){return t.setSelectedProduct(e)},tagsSelected:function(){return t.tagsSelected()}};case 1:case"end":return e.stop()}}),e,this)})))}},{key:"tagsSelected",value:function(){var e=[];this.globalTags.forEach((function(t){t.IsSelected&&e.push(t.Tag.Id)})),e.length<=0||(this.currentPage=1,this.filterByTags(e))}},{key:"filterByTags",value:function(e){this.searchTerm="",this.priceSearchTerm=0,this.productSearchingMode=P.f.Name,this.getProductsByPage(1,e)}},{key:"setSelectedProduct",value:function(e){var t=this;this.selectedProduct=this.pagingProducts.filter((function(t){return t.Id==e}))[0];var i=["Xem h\xecnh S\u1ea3n ph\u1ea3m"];(!this.selectedProduct.PriceList||this.selectedProduct.PriceList.length<=0)&&(this.selectedProduct.PriceList=[this.selectedProduct.Price]),this.selectedProduct.PriceList.forEach((function(e){i.push(H.a.currencyFormat(e))})),this.menuOpening((function(e){switch(+e){case 0:var i=V.a.getImgUrl(t.selectedProduct.ImageUrl,ce.c.ProductImg);t.images=[i],setTimeout((function(){viewProductImg(i,(function(){t.images=[]}))}),200);break;default:t.selectedProduct.Price=t.selectedProduct.PriceList[e-1],t.selectProduct()}}),i)}},{key:"getProductByCategory",value:function(e){var t=this;this.productCategory=e,this.searchTerm="",this.priceSearchTerm=0,this.productSearchingMode=P.f.Name,this.categoryName=this.categories.filter((function(e){return e.Value===t.productCategory}))[0].Name,this.getProductsByPage(this.currentPage)}},{key:"filter",value:function(){var e=this;selectProductCategory(this.categories,(function(t){filterFocus(),e.getProductByCategory(+t)}))}},{key:"getProductsByPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var c,r=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(this.globalTags.forEach((function(e){e.IsSelected=!1})),!(e<=0)){i.next=2;break}return i.abrupt("return");case 2:if(!(this.currentMaxPage<e&&this.currentMaxPage>0)){i.next=4;break}return i.abrupt("return");case 4:if(this.pagingProducts=[],this.currentPage=e,this.selectedProduct=new Et.a,this.productSearchingMode==P.f.Price){i.next=13;break}return i.next=10,this.productService.getRecords(e,this.itemsPerPage,this.productCategory,t,this.searchTerm);case 10:i.t0=i.sent,i.next=16;break;case 13:return i.next=15,this.productService.getRecordsByPrice(e,this.itemsPerPage,this.productCategory,this.priceSearchTerm);case 15:i.t0=i.sent;case 16:(c=i.t0)&&c.products?(c.products.forEach((function(e){r.pagingProducts.push(e.Product)})),this.currentMaxPage=c.totalPages):this.currentMaxPage=1;case 18:case"end":return i.stop()}}),i,this)})))}},{key:"searchProduct",value:function(e){if(e.indexOf("k")==e.length-1||e.indexOf("K")==e.length-1){var t=e.toLowerCase().split("k")[0],i=parseInt(t);NaN!=i&&i>0?(this.productSearchingMode=P.f.Price,this.priceSearchTerm=1e3*i,this.searchTerm="",console.log(this.priceSearchTerm)):(this.productSearchingMode=P.f.Name,this.searchTerm="",this.priceSearchTerm=0)}else this.productSearchingMode=P.f.Name,this.priceSearchTerm=0,this.searchTerm=e;this.getProductsByPage(1)}},{key:"selectProduct",value:function(){this.selectedProduct.Id?(this.globalOrderDetail.ProductName=this.selectedProduct.Name,this.globalOrderDetail.ProductImageUrl=this.selectedProduct.ImageUrl,this.globalOrderDetail.ProductId=this.selectedProduct.Id,this.globalOrderDetail.IsFromHardCodeProduct=!1,this.globalOrderDetail.OriginalPrice=this.selectedProduct.Price,this.globalOrderDetail.ModifiedPrice=this.selectedProduct.Price,this.OnBackNaviage()):this.showError("Ch\u01b0a c\xf3 s\u1ea3n ph\u1ea9m n\xe0o \u0111\u01b0\u1ee3c ch\u1ecdn!!")}}]),i}(y)).\u0275fac=function(e){return new(e||Xt)(f.bc(h.a),f.bc(h.b),f.bc(X.a),f.bc(lt.a),f.bc(f.H),f.bc(Jt),f.bc(Wt.a),f.bc(et.a))},Xt.\u0275cmp=f.Vb({type:Xt,selectors:[["app-search-product"]],features:[f.Lb],decls:31,vars:6,consts:[["id","prodCate",1,"page-content"],[1,"container"],[1,"prodFilter"],[1,"filterCate"],["href","javascript:void(0)",1,"main-bg",3,"click"],["src","../../../../assets/images/filter2.png","alt",""],["onclick","searchFocus(this)",1,"filterSearch"],["placeholder","M\xe3 s\u1ea3n ph\u1ea9m...",3,"delayTimeSpan","searchTextInvoke"],[1,"filterAdd"],[1,"main-bg"],["src","../../../../assets/images/attach.svg","alt","",1,"main-filter"],["src","../../../../assets/images/price.svg","alt","","onClick","openTagMenu()",1,"main-filter"],[1,"row","prodList","cusScroll"],["onclick","selectItem(this,'.product-item')","class","col-4 product-item",4,"ngFor","ngForOf"],[1,"paging"],[1,"paging-arrow","paging-prev","main-bg",3,"click"],[1,"fa","fa-angle-left"],[1,"paging-arrow","paging-next","main-bg",3,"click"],[1,"fa","fa-angle-right"],[1,"row","prodDone"],[1,"col-8","mx-auto","text-center"],["href","javascript:void(0);",1,"btn","main-btn",3,"click"],["id","tagsMenu",1,"tagMenu","checkMenu","tagMenu"],["class","form-check",4,"ngFor","ngForOf"],["id","view-product",1,"popup-content","view-img-popup-content"],[3,"src","config"],["onclick","selectItem(this,'.product-item')",1,"col-4","product-item"],[1,"prodItem"],["alt","",3,"src"],[1,"form-check"],[1,"form-check-label"],["type","checkbox","name","IsSelected","id","IsSelected","value","checkedValue",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"main-bg","vatCustom"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.hc(4,"a",4),f.pc("click",(function(e){return t.filter()})),f.cc(5,"img",5),f.hc(6,"span"),f.Rc(7),f.gc(),f.gc(),f.gc(),f.hc(8,"div",6),f.hc(9,"mobile-search-box",7),f.pc("searchTextInvoke",(function(e){return t.searchProduct(e)})),f.gc(),f.gc(),f.hc(10,"div",8),f.hc(11,"button",9),f.cc(12,"img",10),f.gc(),f.gc(),f.hc(13,"div",8),f.hc(14,"button",9),f.cc(15,"img",11),f.gc(),f.gc(),f.gc(),f.hc(16,"div",12),f.Pc(17,jt,9,9,"div",13),f.gc(),f.hc(18,"ul",14),f.hc(19,"li",15),f.pc("click",(function(e){return t.getProductsByPage(t.currentPage-1)})),f.cc(20,"i",16),f.gc(),f.hc(21,"li",17),f.pc("click",(function(e){return t.getProductsByPage(t.currentPage+1)})),f.cc(22,"i",18),f.gc(),f.gc(),f.hc(23,"div",19),f.hc(24,"div",20),f.hc(25,"a",21),f.pc("click",(function(e){return t.selectProduct()})),f.Rc(26,"Xong"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(27,"div",22),f.Pc(28,Gt,5,2,"div",23),f.gc(),f.hc(29,"div",24),f.cc(30,"angular-image-viewer",25),f.gc()),2&e&&(f.Ob(7),f.Sc(t.categoryName),f.Ob(2),f.Ac("delayTimeSpan",1600),f.Ob(8),f.Ac("ngForOf",t.pagingProducts),f.Ob(11),f.Ac("ngForOf",t.globalTags),f.Ob(2),f.Ac("src",t.images)("config",t.viewProdOptions))},directives:[pt,D.k,tt.a,B.a,B.k,B.n],pipes:[V.a,H.a],styles:[""]}),Xt);function _t(e,t){if(1&e&&(f.hc(0,"li",24),f.hc(1,"p",25),f.Rc(2),f.gc(),f.hc(3,"span",26),f.Rc(4),f.gc(),f.hc(5,"span",27),f.Rc(6),f.uc(7,"myDatePipe"),f.gc(),f.hc(8,"span",28),f.Rc(9),f.gc(),f.gc()),2&e){var i=t.$implicit;f.Pb("data-index",t.index),f.Ob(2),f.Sc(i.FullName),f.Ob(2),f.Sc(i.PhoneNumber),f.Ob(2),f.Sc(f.wc(7,5,i.DateTime,"HH:mm d/M/yyyy")),f.Ob(3),f.Sc(i.Address)}}var zt,Qt=((zt=function(e){c(r,e);var t=n(r);function r(e,i){var c;return d(this,r),(c=t.call(this)).route=e,c._ngZone=i,c.Title="Th\xf4ng tin ng\u01b0\u1eddi nh\u1eadn",c.IsDataLosingWarning=!1,c.currentList=[],c.deliveryInfo=new C.b,c}return l(r,[{key:"addressChoosing",value:function(){var e=this;this.selectAddress((function(t){console.log("selected"),e.deliveryInfo.Address=t}))}},{key:"Init",value:function(){var e=this;this.route.params.subscribe((function(t){e.deliveryInfo=C.b.DeepCopy(e.globalOrderDetail.DeliveryInfo),e.deliveryInfo.DateTime.setSeconds(0)})),window.DeliveryInfoReference={component:this,zone:this._ngZone,selectDeliveryInfo:function(t){return e.selectDeliveryInfo(t)}},setTimeout((function(){e.globalOrder.OrderDetails.forEach((function(t){var i=C.b.DeepCopy(t.DeliveryInfo),c=!0;e.currentList.forEach((function(e){A.a.deliveryInfoCompare(i,e)&&(c=!1)})),c&&e.currentList.push(i)})),e.globalOrder.CustomerInfo&&e.globalOrder.CustomerInfo.ReceiverInfos.forEach((function(t){var i=!0;e.currentList.forEach((function(e){A.a.receiverInfoCompare(t,{FullName:e.FullName,PhoneNumber:e.PhoneNumber,Address:e.Address})&&(i=!1)})),i&&e.currentList.push({FullName:t.FullName,PhoneNumber:t.PhoneNumber,Address:t.Address,DateTime:new Date})}))}),200)}},{key:"selectDeliveryInfo",value:function(e){console.log("selected"),this.deliveryInfo=C.b.DeepCopy(this.currentList[e])}},{key:"addReceiver",value:function(e){e.valid&&(this.globalOrderDetail.DeliveryInfo=C.b.DeepCopy(this.deliveryInfo),i(s(r.prototype),"OnBackNaviage",this).call(this))}}]),r}(y)).\u0275fac=function(e){return new(e||zt)(f.bc(h.a),f.bc(f.H))},zt.\u0275cmp=f.Vb({type:zt,selectors:[["app-select-receiver"]],features:[f.Lb],decls:30,vars:8,consts:[["id","custInfo",1,"page-content"],[1,"container"],[1,"custInfo"],[1,"currentInfo"],["href","javascript:void(0)","onclick","openCustMenu()",1,"main-bg"],["src","../../../../assets/images/view.svg",1,"white-filter"],[1,"newInfo"],["autocomplete","on",1,"addInfoForm",3,"submit"],["form","ngForm"],[1,"form-group"],["type","text","name","FullName","id","FullName","value","","placeholder","T\xean...",1,"mainForm",3,"ngModel","ngModelChange"],["FullName","ngModel"],["type","tel","name","PhoneNumber","id","PhoneNumber","value","","placeholder","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i...",1,"mainForm",3,"ngModel","ngModelChange"],["type","text","name","Address","id","Address","placeholder","\u0110\u1ecba ch\u1ec9...",1,"mainForm",3,"ngModel","ngModelChange"],["href","javascript:void(0)",1,"viewMore","btn","main-btn",3,"click"],[1,"fa","fa-location-arrow"],["name","DateTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],[1,"row"],[1,"col-8","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-3"],["id","recentInfo",1,"actionMenu"],["onclick","selectSavedDeliveryInfo(this)",4,"ngFor","ngForOf"],["onclick","selectSavedDeliveryInfo(this)"],[1,"recentInfo-name"],[1,"recentInfo-phone"],[1,"recentInfo-date"],[1,"recentInfo-add"]],template:function(e,t){if(1&e){var i=f.ic();f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.hc(4,"span"),f.Rc(5,"Th\xf4ng tin ng\u01b0\u1eddi nh\u1eadn \u0111\xe3 l\u01b0u"),f.gc(),f.hc(6,"a",4),f.cc(7,"img",5),f.gc(),f.gc(),f.hc(8,"div",6),f.hc(9,"form",7,8),f.pc("submit",(function(e){f.Jc(i);var c=f.Hc(10);return t.addReceiver(c)})),f.hc(11,"div",9),f.hc(12,"input",10,11),f.pc("ngModelChange",(function(e){return t.deliveryInfo.FullName=e})),f.gc(),f.gc(),f.hc(14,"div",9),f.hc(15,"input",12),f.pc("ngModelChange",(function(e){return t.deliveryInfo.PhoneNumber=e})),f.gc(),f.gc(),f.hc(16,"div",9),f.hc(17,"input",13),f.pc("ngModelChange",(function(e){return t.deliveryInfo.Address=e})),f.gc(),f.hc(18,"a",14),f.pc("click",(function(e){return t.addressChoosing()})),f.cc(19,"i",15),f.gc(),f.gc(),f.hc(20,"input",16),f.pc("ngModelChange",(function(e){return t.deliveryInfo.DateTime=e})),f.gc(),f.cc(21,"owl-date-time",17,18),f.hc(23,"div",19),f.hc(24,"div",20),f.hc(25,"button",21),f.Rc(26,"Xong"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(27,"div",22),f.hc(28,"ul"),f.Pc(29,_t,10,8,"li",23),f.gc(),f.gc()}if(2&e){var c=f.Hc(22);f.Ob(12),f.Ac("ngModel",t.deliveryInfo.FullName),f.Ob(3),f.Ac("ngModel",t.deliveryInfo.PhoneNumber),f.Ob(2),f.Ac("ngModel",t.deliveryInfo.Address),f.Ob(3),f.Ac("owlDateTime",c)("owlDateTimeTrigger",c)("ngModel",t.deliveryInfo.DateTime),f.Ob(1),f.Ac("stepMinute",5),f.Ob(8),f.Ac("ngForOf",t.currentList)}},directives:[B.v,B.l,B.m,B.b,B.k,B.n,q.c,q.f,q.b,D.k],pipes:[H.b],styles:[""]}),zt);function Kt(e,t){if(1&e){var i=f.ic();f.hc(0,"div",18),f.hc(1,"div",19),f.hc(2,"span",20),f.Rc(3),f.gc(),f.hc(4,"div",21),f.hc(5,"h4",22),f.Rc(6),f.gc(),f.hc(7,"span",23),f.Rc(8),f.gc(),f.gc(),f.cc(9,"app-status-point",24),f.gc(),f.hc(10,"div",25),f.hc(11,"ul",26),f.hc(12,"li",27),f.hc(13,"div",28),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit;return f.tc().getMenu(c)})),f.cc(14,"img",29),f.uc(15,"ImgPipe"),f.hc(16,"div",30),f.hc(17,"span",31),f.Rc(18),f.uc(19,"myCurrPipe"),f.gc(),f.hc(20,"span",32),f.Rc(21),f.uc(22,"myCurrPipe"),f.gc(),f.hc(23,"span",33),f.Rc(24),f.uc(25,"myCurrPipe"),f.gc(),f.hc(26,"span",34),f.Rc(27),f.gc(),f.hc(28,"span",35),f.Rc(29),f.uc(30,"myTimePipe"),f.gc(),f.hc(31,"span",36),f.Rc(32),f.uc(33,"myDatePipe"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var c=t.$implicit,r=t.index;f.Ob(3),f.Uc("",c.OrderId,"_",c.Index+1,""),f.Ob(3),f.Sc(c.ProductName),f.Ob(2),f.Uc("",c.DeliveryInfo.FullName,"-",c.DeliveryInfo.PhoneNumber,""),f.Ob(1),f.Ac("state",c.State)("id",c.OrderDetailId)("index",r+1),f.Ob(5),f.Bc("src",f.wc(15,15,c.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(f.vc(19,18,c.OriginalPrice)),f.Ob(3),f.Sc(f.vc(22,20,c.AdditionalFee)),f.Ob(3),f.Sc(f.vc(25,22,c.ModifiedPrice)),f.Ob(3),f.Sc(c.DeliveryInfo.Address),f.Ob(2),f.Sc(f.vc(30,24,c.DeliveryInfo.DateTime)),f.Ob(3),f.Sc(f.vc(33,26,c.DeliveryInfo.DateTime))}}function Zt(e,t){if(1&e){var i=f.ic();f.hc(0,"div",37),f.hc(1,"div",19),f.hc(2,"span",20),f.Rc(3),f.gc(),f.hc(4,"div",21),f.hc(5,"h4",22),f.Rc(6),f.gc(),f.hc(7,"span",23),f.Rc(8),f.gc(),f.gc(),f.cc(9,"app-status-point",24),f.gc(),f.hc(10,"div",25),f.hc(11,"ul",26),f.hc(12,"li",27),f.hc(13,"div",28),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit;return f.tc().getMenu(c)})),f.cc(14,"img",29),f.uc(15,"ImgPipe"),f.hc(16,"div",30),f.hc(17,"span",31),f.Rc(18),f.uc(19,"myCurrPipe"),f.gc(),f.hc(20,"span",32),f.Rc(21),f.uc(22,"myCurrPipe"),f.gc(),f.hc(23,"span",33),f.Rc(24),f.uc(25,"myCurrPipe"),f.gc(),f.hc(26,"span",34),f.Rc(27),f.gc(),f.hc(28,"span",35),f.Rc(29),f.uc(30,"myTimePipe"),f.gc(),f.hc(31,"span",36),f.Rc(32),f.uc(33,"myDatePipe"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var c=t.$implicit,r=t.index;f.Ac("ngClass","OnTheWay"===c.State?"selected-order-detail":""),f.Ob(3),f.Uc("",c.OrderId,"_",c.Index+1,""),f.Ob(3),f.Sc(c.ProductName),f.Ob(2),f.Uc("",c.DeliveryInfo.FullName,"-",c.DeliveryInfo.PhoneNumber,""),f.Ob(1),f.Ac("state",c.State)("id",c.OrderDetailId)("index",r+1),f.Ob(5),f.Bc("src",f.wc(15,16,c.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(f.vc(19,19,c.OriginalPrice)),f.Ob(3),f.Sc(f.vc(22,21,c.AdditionalFee)),f.Ob(3),f.Sc(f.vc(25,23,c.ModifiedPrice)),f.Ob(3),f.Sc(c.DeliveryInfo.Address),f.Ob(2),f.Sc(f.vc(30,25,c.DeliveryInfo.DateTime)),f.Ob(3),f.Sc(f.vc(33,27,c.DeliveryInfo.DateTime))}}var Yt,ei=((Yt=function(e){c(i,e);var t=n(i);function i(e,c,r){var n;return d(this,i),(n=t.call(this)).router=e,n.orderService=c,n.orderDetailService=r,n.Title="Ng\u01b0\u1eddi giao h\xe0ng",n.NavigateClass="nav-icon ",n.IsDataLosingWarning=!1,n.waitingMenuItems=["Nh\u1eadn \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],n.shippingMenuItems=["Giao \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],n.onTheWayMenuItems=["Ho\xe0n th\xe0nh \u0111\u01a1n","Ch\u1ee5p \u1ea3nh giao h\xe0ng","Tr\u1ea3 h\xe0ng","Xem chi ti\u1ebft \u0111\u01a1n"],n.waitingOrderDetails=[],n.shippingOrderDetails=[],n}return l(i,[{key:"Init",value:function(){this.loadWaitingDetails(),this.loadShippingDetails(),this.askForRememberPassword()}},{key:"OnBackNaviage",value:function(){customerSupport()}},{key:"logout",value:function(){var e=this;this.authService.logOut((function(t){t&&e.router.navigate(["staff/login"])}))}},{key:"viewDetail",value:function(e){this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}},{key:"loadWaitingDetails",value:function(){var e=this;this.waitingOrderDetails=[],this.orderDetailService.getByState(P.e.DeliveryWaiting).then((function(t){e.waitingOrderDetails=t,e.waitingOrderDetails.sort((function(e,t){return e.ShippingSortOrder<t.ShippingSortOrder?-1:e.ShippingSortOrder>t.ShippingSortOrder?1:0}))}))}},{key:"loadShippingDetails",value:function(){var e=this;this.shippingOrderDetails=[],this.orderDetailService.getShippingOrderDetails(this.CurrentUser.Id).then((function(t){e.shippingOrderDetails=t,e.shippingOrderDetails.sort((function(e,t){return e.ShippingSortOrder<t.ShippingSortOrder?-1:e.ShippingSortOrder>t.ShippingSortOrder?1:0}))}))}},{key:"updateFinalState",value:function(e,t,i){var c=this;getShippingNoteDialog(t,(function(t){c.orderDetailService.updateFields(e.OrderDetailId,{DeliveryCompletedTime:(new Date).getTime(),State:i,MakingSortOrder:0,ShippingSortOrder:0,ShippingNote:t}).then((function(e){c.loadShippingDetails()}))}))}},{key:"getMenu",value:function(e){var t=this;menuOpen((function(i){switch(+i){case 0:switch(e.State){case P.e.DeliveryWaiting:t.orderDetailService.updateDetailSeen(e.OrderDetailId,t.CurrentUser.Id,(new Date).getTime()).then((function(i){t.orderDetailService.assignSingleOD(e.OrderDetailId,t.CurrentUser.Id,(new Date).getTime()).then((function(){t.loadShippingDetails(),t.loadWaitingDetails()}))}));break;case P.e.OnTheWay:t.openConfirm("Ho\xe0n th\xe0nh giao \u0111\u01a1n?",(function(){t.updateFinalState(e,"Ho\xe0n th\xe0nh",P.e.Deliveried)}));break;case P.e.DeliverAssinged:t.openConfirm("B\u1eaft \u0111\u1ea7u giao \u0111\u01a1n n\xe0y?",(function(){t.orderDetailService.updateFields(e.OrderDetailId,{State:P.e.OnTheWay}).then((function(){t.loadShippingDetails()}))}))}break;case 1:switch(e.State){case P.e.OnTheWay:t.globalOrderDetail=e,t.router.navigate(["staff/customer-confirming"]);break;default:t.globalOrderDetail=e,t.router.navigate(["staff/order-detail-view"])}break;case 2:t.openConfirm("Tr\u1ea3 \u0111\u01a1n n\xe0y?",(function(){t.updateFinalState(e,"Tr\u1ea3 \u0111\u01a1n",P.e.SentBack)}));break;case 3:t.globalOrderDetail=e,t.router.navigate(["staff/order-detail-view"])}}),e.State===P.e.DeliveryWaiting?this.waitingMenuItems:e.State===P.e.DeliverAssinged?this.shippingMenuItems:this.onTheWayMenuItems)}}]),i}(y)).\u0275fac=function(e){return new(e||Yt)(f.bc(h.b),f.bc(F.a),f.bc(X.a))},Yt.\u0275cmp=f.Vb({type:Yt,selectors:[["app-shipper-main"]],features:[f.Lb],decls:27,vars:9,consts:[["id","arrange",1,"page-content"],[1,"container"],["id","listNav","role","tablist",1,"nav","nav-tabs","row"],[1,"nav-item","col-6"],["id","nav1","data-toggle","tab","href","#camhoa","role","tab","aria-controls","camhoa","aria-selected","true",1,"active","main-bg"],["id","nav2","data-toggle","tab","href","#giaohoa","role","tab","aria-controls","giaohoa","aria-selected","false",1,"main-bg"],["id","listContent",1,"tab-content","order-list-bot"],["id","camhoa","role","tabpanel","aria-labelledby","nav1",1,"tab-pane","fade","show","active"],[1,"order-content","cusScroll"],["class","order-content-item product-item",4,"ngFor","ngForOf"],["id","giaohoa","role","tabpanel","aria-labelledby","nav2",1,"tab-pane","fade"],["class","order-content-item product-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"customer-support"],["alt","",1,"customer-avatar",3,"src"],[1,"customer-name"],["href","tel:0000",1,"customer-phone"],[1,"customer-position"],["id","logoutBtn",1,"customer-position",3,"click"],[1,"order-content-item","product-item"],[1,"item-top"],[1,"item-code"],[1,"item-info"],[1,"item-name"],[1,"item-quantity"],[3,"state","id","index"],[1,"item-bot"],[1,"order-product-list","cusScroll"],[1,""],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"prodPriceOld"],[1,"prodCharge"],[1,"prodPrice"],[1,"item-address"],[1,"item-time"],[1,"item-date"],[1,"order-content-item","product-item",3,"ngClass"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"ul",2),f.hc(3,"li",3),f.hc(4,"a",4),f.Rc(5,"Ch\u1edd giao"),f.gc(),f.gc(),f.hc(6,"li",3),f.hc(7,"a",5),f.Rc(8,"\u0110ang giao"),f.gc(),f.gc(),f.gc(),f.hc(9,"div",6),f.hc(10,"div",7),f.hc(11,"ul",8),f.Pc(12,Kt,34,28,"div",9),f.gc(),f.gc(),f.hc(13,"div",10),f.hc(14,"ul",8),f.Pc(15,Zt,34,29,"div",11),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(16,"div",12),f.cc(17,"img",13),f.uc(18,"ImgPipe"),f.hc(19,"p",14),f.Rc(20),f.gc(),f.hc(21,"a",15),f.Rc(22),f.gc(),f.hc(23,"p",16),f.Rc(24),f.gc(),f.hc(25,"p",17),f.pc("click",(function(e){return t.logout()})),f.Rc(26,"\u0110\u0103ng xu\u1ea5t"),f.gc(),f.gc()),2&e&&(f.Ob(12),f.Ac("ngForOf",t.waitingOrderDetails),f.Ob(3),f.Ac("ngForOf",t.shippingOrderDetails),f.Ob(2),f.Bc("src",f.wc(18,6,t.CurrentUser.Avt,"UserAvt"),f.Lc),f.Ob(3),f.Sc(t.CurrentUser.FullName),f.Ob(2),f.Sc(t.CurrentUser.PhoneNumber),f.Ob(2),f.Sc(t.CurrentUser.Role))},directives:[D.k,qe,D.j],pipes:[V.a,H.a,H.c,H.b],styles:[""]}),Yt),ti=o("5+WD");function ii(e,t){if(1&e){var i=f.ic();f.hc(0,"div",17),f.hc(1,"div",18),f.hc(2,"span",19),f.Rc(3),f.gc(),f.hc(4,"div",20),f.hc(5,"h4",21),f.Rc(6),f.gc(),f.hc(7,"span",22),f.Rc(8),f.gc(),f.gc(),f.cc(9,"app-status-point",23),f.gc(),f.hc(10,"div",24),f.hc(11,"ul",25),f.hc(12,"li",26),f.hc(13,"div",27),f.hc(14,"button",28),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit,r=t.index;return f.tc().move(c.State,r,!0)})),f.Rc(15,"t\u0103ng"),f.gc(),f.hc(16,"button",29),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit,r=t.index;return f.tc().move(c.State,r,!1)})),f.Rc(17,"gi\u1ea3m"),f.gc(),f.gc(),f.hc(18,"div",30),f.pc("click",(function(e){f.Jc(i);var c=t.index;return f.tc().viewMakingDetail(c)})),f.cc(19,"img",31),f.uc(20,"ImgPipe"),f.hc(21,"div",32),f.hc(22,"span",33),f.Rc(23),f.uc(24,"myCurrPipe"),f.gc(),f.hc(25,"span",34),f.Rc(26),f.uc(27,"myCurrPipe"),f.gc(),f.hc(28,"span",35),f.Rc(29),f.uc(30,"myCurrPipe"),f.gc(),f.hc(31,"span",36),f.Rc(32),f.gc(),f.hc(33,"span",37),f.Rc(34),f.uc(35,"myTimePipe"),f.gc(),f.hc(36,"span",38),f.Rc(37),f.uc(38,"myDatePipe"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var c=t.$implicit,r=t.index;f.Ob(3),f.Uc("",c.OrderId,"_",c.Index+1,""),f.Ob(3),f.Sc(c.ProductName),f.Ob(2),f.Uc("",c.CustomerName,"-",c.CustomerPhoneNumber,""),f.Ob(1),f.Ac("state",c.State)("id",c.OrderDetailId)("index",r+1),f.Ob(10),f.Bc("src",f.wc(20,15,c.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(f.vc(24,18,c.OriginalPrice)),f.Ob(3),f.Sc(f.vc(27,20,c.AdditionalFee)),f.Ob(3),f.Sc(f.vc(30,22,c.ModifiedPrice)),f.Ob(3),f.Sc(c.DeliveryInfo.Address),f.Ob(2),f.Tc("",f.vc(35,24,c.MakingRequestTime)," "),f.Ob(3),f.Tc(" ",f.vc(38,26,c.MakingRequestTime),"")}}function ci(e,t){if(1&e){var i=f.ic();f.hc(0,"div",39),f.hc(1,"div",18),f.hc(2,"span",19),f.Rc(3),f.gc(),f.hc(4,"div",20),f.hc(5,"h4",21),f.Rc(6),f.gc(),f.hc(7,"span",22),f.Rc(8),f.gc(),f.gc(),f.cc(9,"app-status-point",23),f.gc(),f.hc(10,"div",24),f.hc(11,"ul",25),f.hc(12,"li",26),f.hc(13,"div",27),f.hc(14,"button",28),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit,r=t.index;return f.tc().move(c.ShippingOrderDetail.State,r,!0)})),f.Rc(15,"t\u0103ng"),f.gc(),f.hc(16,"button",29),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit,r=t.index;return f.tc().move(c.ShippingOrderDetail.State,r,!1)})),f.Rc(17,"gi\u1ea3m"),f.gc(),f.gc(),f.hc(18,"div",30),f.pc("click",(function(e){f.Jc(i);var c=t.index;return f.tc().viewShippingDetail(c)})),f.cc(19,"img",31),f.uc(20,"ImgPipe"),f.hc(21,"div",32),f.hc(22,"span",33),f.Rc(23),f.uc(24,"myCurrPipe"),f.gc(),f.hc(25,"span",34),f.Rc(26),f.uc(27,"myCurrPipe"),f.gc(),f.hc(28,"span",35),f.Rc(29),f.uc(30,"myCurrPipe"),f.gc(),f.hc(31,"span",36),f.Rc(32),f.gc(),f.hc(33,"span",37),f.Rc(34),f.uc(35,"myTimePipe"),f.gc(),f.hc(36,"span",38),f.Rc(37),f.uc(38,"myDatePipe"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var c=t.$implicit,r=t.index;f.Ac("ngClass",c.IsSelect?"selected-order-detail":""),f.Ob(3),f.Uc("",c.ShippingOrderDetail.OrderId,"_",c.ShippingOrderDetail.Index+1,""),f.Ob(3),f.Sc(c.ShippingOrderDetail.ProductName),f.Ob(2),f.Uc("",c.ShippingOrderDetail.CustomerName,"-",c.ShippingOrderDetail.CustomerPhoneNumber,""),f.Ob(1),f.Ac("state",c.ShippingOrderDetail.State)("id",c.ShippingOrderDetail.OrderDetailId)("index",r+1),f.Ob(10),f.Bc("src",f.wc(20,16,c.ShippingOrderDetail.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(f.vc(24,19,c.ShippingOrderDetail.OriginalPrice)),f.Ob(3),f.Sc(f.vc(27,21,c.ShippingOrderDetail.AdditionalFee)),f.Ob(3),f.Sc(f.vc(30,23,c.ShippingOrderDetail.ModifiedPrice)),f.Ob(3),f.Sc(c.ShippingOrderDetail.DeliveryInfo.Address),f.Ob(2),f.Sc(f.vc(35,25,c.ShippingOrderDetail.DeliveryInfo.DateTime)),f.Ob(3),f.Sc(f.vc(38,27,c.ShippingOrderDetail.DeliveryInfo.DateTime))}}function ri(e,t){if(1&e){var i=f.ic();f.hc(0,"div",40),f.hc(1,"div",41),f.hc(2,"button",42),f.pc("click",(function(e){return f.Jc(i),f.tc().selectShipperDialogOpen()})),f.Rc(3,"Ch\u1ecdn Shipper"),f.gc(),f.gc(),f.hc(4,"div",43),f.pc("click",(function(e){return f.Jc(i),f.tc().cancelSelectMode()})),f.hc(5,"button",44),f.Rc(6,"Hu\u1ef7"),f.gc(),f.gc(),f.gc()}}function ni(e,t){if(1&e){var i=f.ic();f.hc(0,"div",40),f.hc(1,"div",41),f.hc(2,"button",42),f.pc("click",(function(e){return f.Jc(i),f.tc().gotoSelectMode()})),f.Rc(3,"Ch\u1ecdn nhi\u1ec1u"),f.gc(),f.gc(),f.gc()}}function oi(e,t){if(1&e){var i=f.ic();f.hc(0,"li",45),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit;return f.tc().selectShipper(c)})),f.cc(1,"img",46),f.uc(2,"ImgPipe"),f.hc(3,"span",47),f.Rc(4),f.gc(),f.hc(5,"span",48),f.Rc(6),f.gc(),f.gc()}if(2&e){var c=t.$implicit;f.Ob(1),f.Bc("src",f.wc(2,3,c.AvtUrl,"UserAvt"),f.Lc),f.Ob(3),f.Sc(c.FullName),f.Ob(2),f.Sc(c.IsExternalShipper?"Shipper ngo\xe0i":"Nh\xe2n vi\xean")}}var ai,si,ui,li=((ai=function(e){c(i,e);var t=n(i);function i(e,c,r){var n;return d(this,i),(n=t.call(this)).orderDetailService=e,n.userService=c,n.router=r,n.Title="Th\u1ee9 t\u1ef1 \u01b0u ti\xean",n.IsDataLosingWarning=!1,n.isAssigningShipper=!1,n.shippingODs=[],n.shippers=[],n}return l(i,[{key:"Init",value:function(){var e=this;this.loadMakingDetails(),this.loadShippingDetails(),this.userService.getByRole(P.h.Shipper).then((function(t){e.shippers=t}))}},{key:"loadMakingDetails",value:function(){var e=this;this.makingOrderDetails=[],this.orderDetailService.getByState(P.e.Waiting).then((function(t){e.makingOrderDetails=t,e.makingOrderDetails.sort((function(e,t){return e.MakingSortOrder<t.MakingSortOrder?-1:e.MakingSortOrder>t.MakingSortOrder?1:0}))}))}},{key:"loadShippingDetails",value:function(){var e=this;this.shippingODs=[],this.orderDetailService.getByState(P.e.DeliveryWaiting).then((function(t){t.forEach((function(t){e.shippingODs.push({ShippingOrderDetail:t,IsSelect:!1})})),e.shippingODs.sort((function(e,t){return e.ShippingOrderDetail.ShippingSortOrder<t.ShippingOrderDetail.ShippingSortOrder?-1:e.ShippingOrderDetail.ShippingSortOrder>t.ShippingOrderDetail.ShippingSortOrder?1:0}))}))}},{key:"viewShippingDetail",value:function(e){this.isAssigningShipper?this.shippingODs[e].IsSelect=!this.shippingODs[e].IsSelect:(this.globalOrderDetail=this.shippingODs[e].ShippingOrderDetail,this.router.navigate(["staff/order-detail-view"]))}},{key:"viewMakingDetail",value:function(e){this.globalOrderDetail=this.makingOrderDetails[e],this.router.navigate(["staff/order-detail-view"])}},{key:"dropMakingList",value:function(e){var t=this,i=this.makingOrderDetails[e.previousIndex].MakingSortOrder,c=this.makingOrderDetails[e.currentIndex].MakingSortOrder;if(console.log(i,c),i!==c){var r=[];this.makingOrderDetails.forEach((function(e){e.MakingSortOrder>=c&&e.MakingSortOrder<=i&&(e.MakingSortOrder=e.MakingSortOrder<i?e.MakingSortOrder+1:c,r.push({Id:e.OrderDetailId,MarkingSortOrder:e.MakingSortOrder})),e.MakingSortOrder<=c&&e.MakingSortOrder>=i&&(e.MakingSortOrder=e.MakingSortOrder>i?e.MakingSortOrder-1:c,r.push({Id:e.OrderDetailId,MarkingSortOrder:e.MakingSortOrder}))})),this.orderDetailService.updateMakingSortOrders(r).then((function(){t.makingOrderDetails.sort((function(e,t){return e.MakingSortOrder<t.MakingSortOrder?-1:e.MakingSortOrder>t.MakingSortOrder?1:0}))}))}}},{key:"dropShippingList",value:function(e){var t=this,i=this.shippingODs[e.previousIndex].ShippingOrderDetail.ShippingSortOrder,c=this.shippingODs[e.currentIndex].ShippingOrderDetail.ShippingSortOrder;if(i!==c){var r=[];this.shippingODs.forEach((function(e){var t=e.ShippingOrderDetail;t.ShippingSortOrder>=c&&t.ShippingSortOrder<=i&&(t.ShippingSortOrder=t.ShippingSortOrder<i?t.ShippingSortOrder+1:c,r.push({Id:t.OrderDetailId,ShippingSortOrder:t.ShippingSortOrder})),t.ShippingSortOrder<=c&&t.ShippingSortOrder>=i&&(t.ShippingSortOrder=t.ShippingSortOrder>i?t.ShippingSortOrder-1:c,r.push({Id:t.OrderDetailId,ShippingSortOrder:t.ShippingSortOrder}))})),this.orderDetailService.updateMakingSortOrders(r).then((function(){t.shippingODs.sort((function(e,t){return e.ShippingOrderDetail.ShippingSortOrder<t.ShippingOrderDetail.ShippingSortOrder?-1:e.ShippingOrderDetail.ShippingSortOrder>t.ShippingOrderDetail.ShippingSortOrder?1:0}))}))}}},{key:"move",value:function(e,t,i){var c,r,n=this;switch(e){case P.e.Waiting:if(c=this.makingOrderDetails[t],i&&t<=0||!i&&t>=this.makingOrderDetails.length-1)return;if(r=this.makingOrderDetails[i?t-1:t+1]){var o=[];o.push({Id:r.OrderDetailId,MakingSortOrder:c.MakingSortOrder}),o.push({Id:c.OrderDetailId,MakingSortOrder:r.MakingSortOrder}),this.orderDetailService.updateMakingSortOrders(o).then((function(){var e=r.MakingSortOrder;r.MakingSortOrder=c.MakingSortOrder,c.MakingSortOrder=e,n.makingOrderDetails.sort((function(e,t){return e.MakingSortOrder<t.MakingSortOrder?-1:e.MakingSortOrder>t.MakingSortOrder?1:0}))}))}break;case P.e.DeliveryWaiting:if(c=this.shippingODs[t].ShippingOrderDetail,i&&t<=0||!i&&t>=this.shippingODs.length-1)return;if(r=this.shippingODs[i?t-1:t+1].ShippingOrderDetail){var a=[];a.push({Id:r.OrderDetailId,ShippingSortOrder:c.ShippingSortOrder}),a.push({Id:c.OrderDetailId,ShippingSortOrder:r.ShippingSortOrder}),this.orderDetailService.updateShippingSortOrders(a).then((function(){var e=r.ShippingSortOrder;r.ShippingSortOrder=c.ShippingSortOrder,c.ShippingSortOrder=e,n.shippingODs.sort((function(e,t){return e.ShippingOrderDetail.ShippingSortOrder<t.ShippingOrderDetail.ShippingSortOrder?-1:e.ShippingOrderDetail.ShippingSortOrder>t.ShippingOrderDetail.ShippingSortOrder?1:0}))}))}}}},{key:"gotoSelectMode",value:function(){this.isAssigningShipper=!0}},{key:"cancelSelectMode",value:function(){this.shippingODs.forEach((function(e){e.IsSelect=!1})),this.isAssigningShipper=!1}},{key:"selectShipper",value:function(e){var t=this;dismissShipperSelecting((function(){t.openConfirm("X\xe1c nh\u1eadn giao \u0111\u01a1n cho shipper?",(function(){var i=[];t.shippingODs.forEach((function(e){e.IsSelect&&i.push(e.ShippingOrderDetail.OrderDetailId)})),t.orderDetailService.assignOrderDetails(i,e.Id,(new Date).getTime()).then((function(e){t.isAssigningShipper=!1,t.loadMakingDetails(),t.loadShippingDetails()}))}))}))}},{key:"selectShipperDialogOpen",value:function(){var e=!1;this.shippingODs.forEach((function(t){t.IsSelect&&(e=!0)})),e&&openViewed()}}]),i}(y)).\u0275fac=function(e){return new(e||ai)(f.bc(X.a),f.bc(ht.a),f.bc(h.b))},ai.\u0275cmp=f.Vb({type:ai,selectors:[["app-sort-order-changing"]],features:[f.Lb],decls:23,vars:5,consts:[["id","orderList",1,"page-content"],[1,"container"],["id","listNav","role","tablist",1,"nav","nav-tabs","row"],[1,"nav-item","col-6"],["id","nav1","data-toggle","tab","href","#camhoa","role","tab","aria-controls","camhoa","aria-selected","true",1,"active","main-bg"],["id","nav2","data-toggle","tab","href","#giaohoa","role","tab","aria-controls","giaohoa","aria-selected","false",1,"main-bg"],["id","listContent",1,"tab-content","order-list-bot"],["id","camhoa","role","tabpanel","aria-labelledby","nav1",1,"tab-pane","fade","show","active"],["cdkDropList","",1,"order-content","cusScroll",3,"cdkDropListDropped"],["cdkDrag","","cdkDragStartDelay","300","class","order-content-item product-item",4,"ngFor","ngForOf"],["id","giaohoa","role","tabpanel","aria-labelledby","nav2",1,"tab-pane","fade"],["class","order-content-item product-item","cdkDrag","","cdkDragStartDelay","300",3,"ngClass",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],["id","viewed",1,"popup-content"],[1,"main-bg"],[1,"viewedList"],["class","viewItem-three-column",3,"click",4,"ngFor","ngForOf"],["cdkDrag","","cdkDragStartDelay","300",1,"order-content-item","product-item"],[1,"item-top"],[1,"item-code"],[1,"item-info"],[1,"item-name"],[1,"item-quantity"],[3,"state","id","index"],[1,"item-bot"],[1,"order-product-list","cusScroll"],[1,""],[1,"changeOrder"],[1,"inOrder","navOrder",3,"click"],[1,"deOrder","navOrder",3,"click"],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"prodPriceOld"],[1,"prodCharge"],[1,"prodPrice"],[1,"item-address"],[1,"item-time"],[1,"item-date"],["cdkDrag","","cdkDragStartDelay","300",1,"order-content-item","product-item",3,"ngClass"],[1,"row"],[1,"col-6","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-3","exchange-confirm",3,"click"],[1,"col-6","mx-auto","text-center",3,"click"],["type","submit",1,"btn","main-btn","w-100","mt-3","exchange-confirm"],[1,"viewItem-three-column",3,"click"],["alt","",1,"itemAva",3,"src"],[1,"itemName"],[1,"itemRole"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"ul",2),f.hc(3,"li",3),f.hc(4,"a",4),f.Rc(5,"C\u1eafm hoa"),f.gc(),f.gc(),f.hc(6,"li",3),f.hc(7,"a",5),f.Rc(8,"Giao hoa"),f.gc(),f.gc(),f.gc(),f.hc(9,"div",6),f.hc(10,"div",7),f.hc(11,"ul",8),f.pc("cdkDropListDropped",(function(e){return t.dropMakingList(e)})),f.Pc(12,ii,39,28,"div",9),f.gc(),f.gc(),f.hc(13,"div",10),f.hc(14,"ul",8),f.pc("cdkDropListDropped",(function(e){return t.dropShippingList(e)})),f.Pc(15,ci,39,29,"div",11),f.gc(),f.Pc(16,ri,7,0,"div",12),f.Pc(17,ni,4,0,"div",12),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(18,"div",13),f.hc(19,"h3",14),f.Rc(20,"Ch\u1ecdn Shipper"),f.gc(),f.hc(21,"ul",15),f.Pc(22,oi,7,6,"li",16),f.gc(),f.gc()),2&e&&(f.Ob(12),f.Ac("ngForOf",t.makingOrderDetails),f.Ob(3),f.Ac("ngForOf",t.shippingODs),f.Ob(1),f.Ac("ngIf",t.isAssigningShipper&&t.shippingODs.length>0),f.Ob(1),f.Ac("ngIf",!t.isAssigningShipper&&t.shippingODs.length>0),f.Ob(5),f.Ac("ngForOf",t.shippers))},directives:[ti.b,D.k,D.l,ti.a,qe,D.j],pipes:[V.a,H.a,H.c,H.b],styles:[""]}),ai),di=o("TG2U"),hi=o("3oHN"),gi=((ui=function(e){c(i,e);var t=n(i);function i(e,c){var r;return d(this,i),(r=t.call(this)).router=e,r.realtimeService=c,r.Title="",r.NavigateClass="",r.model=new di.a,I.a.clear(),r}return l(i,[{key:"Init",value:function(){this.setStatusBarColor(!0),this.globalService.isOnMobile()&&savedLoginInforGettingRequest()}},{key:"savedLoginInforReturn",value:function(e,t){this.model.passcode=t,this.model.userName=e}},{key:"afterLogin",value:function(){switch(this.globalService.isOnMobile()&&(this.globalService.isRememberPassWillCheck=!0,mobileLogin(this.model.userName,this.model.passcode)),I.a.getRole()){case P.h.Admin:case P.h.Account:this.router.navigate(["/staff/orders-manage"]);break;case P.h.Florist:this.router.navigate(["staff/florist-main"]);break;case P.h.Shipper:this.router.navigate(["staff/shipper-main"])}}},{key:"login",value:function(e){var t=this;e.valid&&this.authService.login(this.model,(function(e){e&&t.ngZone.run((function(){t.afterLogin()}))}))}}]),i}(y)).\u0275fac=function(e){return new(e||ui)(f.bc(h.b),f.bc(hi.a))},ui.\u0275cmp=f.Vb({type:ui,selectors:[["app-login"]],features:[f.Lb],decls:11,vars:2,consts:[["id","login",1,"page-content"],[1,"logo"],["href","#"],["autocomplete","on","id","loginform",3,"submit"],["form","ngForm"],[1,"form-group"],["name","userName","placeholder","T\xean \u0111\u0103ng nh\u1eadp...",1,"form-control",3,"ngModel","ngModelChange"],["type","password","name","passcode","placeholder","M\u1eadt kh\u1ea9u...",1,"form-control",3,"ngModel","ngModelChange"],["type","submit","value","\u0110\u0103ng nh\u1eadp",1,"btn","btn-default"]],template:function(e,t){if(1&e){var i=f.ic();f.hc(0,"div",0),f.hc(1,"h1",1),f.hc(2,"a",2),f.Rc(3,"Login to Florid"),f.gc(),f.gc(),f.hc(4,"form",3,4),f.pc("submit",(function(e){f.Jc(i);var c=f.Hc(5);return t.login(c)})),f.hc(6,"div",5),f.hc(7,"input",6),f.pc("ngModelChange",(function(e){return t.model.userName=e})),f.gc(),f.gc(),f.hc(8,"div",5),f.hc(9,"input",7),f.pc("ngModelChange",(function(e){return t.model.passcode=e})),f.gc(),f.gc(),f.cc(10,"input",8),f.gc(),f.gc()}2&e&&(f.Ob(7),f.Ac("ngModel",t.model.userName),f.Ob(2),f.Ac("ngModel",t.model.passcode))},directives:[B.v,B.l,B.m,B.b,B.k,B.n],styles:[""]}),ui),mi=((si=function(){function e(t,i,c,r,n){var o=this;d(this,e),this.router=t,this.globalService=i,this.authService=c,this.printJobService=r,this.realtimeService=n,this.navigateClass="",this.title="",this.headerUpdate=this.globalService.mobileUpdateHeader.subscribe((function(e){null!==e&&e&&o.updateHeaderBar(e.Title,e.NavigateClass)}))}return l(e,[{key:"ngOnInit",value:function(){var e=I.a.getUserId(),t=I.a.isPrinter();e&&this.realtimeService.connect(+e,t,(function(){})),this.globalService.setStatusBarColor(!1)}},{key:"updateHeaderBar",value:function(e,t){var i=this;setTimeout((function(){i.navigateClass=t,i.title=e}),100)}},{key:"ngOnDestroy",value:function(){this.headerUpdate.unsubscribe()}},{key:"navigateOnClick",value:function(){this.globalService.clickOnNavigateButton()}}]),e}()).\u0275fac=function(e){return new(e||si)(f.bc(h.b),f.bc(b.a),f.bc(O.a),f.bc(N.a),f.bc(hi.a))},si.\u0275cmp=f.Vb({type:si,selectors:[["app-staff-main-layout"]],decls:6,vars:3,consts:[[1,"breadcrumb"],[3,"click"],[1,"breadcrumb-title"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"a",1),f.pc("click",(function(e){return t.navigateOnClick()})),f.gc(),f.hc(2,"div",2),f.hc(3,"span"),f.Rc(4),f.gc(),f.gc(),f.gc(),f.cc(5,"router-outlet")),2&e&&(f.Ob(1),f.Qb(t.navigateClass),f.Ob(3),f.Sc(t.title))},directives:[h.e],styles:[""]}),si);function pi(e,t){if(1&e&&(f.hc(0,"div",27),f.hc(1,"span",12),f.Rc(2,"T\xean KH"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.order.CustomerInfo.Name)}}function fi(e,t){if(1&e&&(f.hc(0,"div",27),f.hc(1,"span",12),f.Rc(2,"SDT KH"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.order.CustomerInfo.PhoneNumber)}}function vi(e,t){if(1&e&&(f.hc(0,"div",27),f.hc(1,"span",12),f.Rc(2,"T\xean ng\u01b0\u1eddi nh\u1eadn:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.orderDetail.DeliveryInfo.FullName)}}function bi(e,t){if(1&e&&(f.hc(0,"div",28),f.hc(1,"span",12),f.Rc(2,"SDT ng\u01b0\u1eddi nh\u1eadn:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.orderDetail.DeliveryInfo.PhoneNumber)}}function Oi(e,t){if(1&e&&(f.hc(0,"div",28),f.hc(1,"span",12),f.Rc(2,"\u0110\u1ecba ch\u1ec9 giao:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.orderDetail.DeliveryInfo.Address)}}function Si(e,t){if(1&e&&(f.hc(0,"div",29),f.hc(1,"span",12),f.Rc(2,"Y\xeau c\u1ea7u xong tr\u01b0\u1edbc:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.uc(5,"myDatePipe"),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(f.wc(5,1,i.orderDetail.MakingRequestTime,"HH:mm dd/MM/yyyy"))}}function Di(e,t){if(1&e&&(f.hc(0,"div",30),f.hc(1,"span",12),f.Rc(2,"M\xf4 t\u1ea3 KH:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.orderDetail.Description)}}function ki(e,t){if(1&e&&(f.hc(0,"div",30),f.hc(1,"span",12),f.Rc(2,"Ghi ch\xfa th\u1ef1c hi\u1ec7n:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.orderDetail.MakingNote)}}function Ii(e,t){if(1&e&&(f.hc(0,"div",30),f.hc(1,"span",12),f.Rc(2,"Ghi ch\xfa giao h\xe0ng:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var i=f.tc();f.Ob(4),f.Sc(i.orderDetail.ShippingNote)}}function yi(e,t){if(1&e){var i=f.ic();f.hc(0,"div",31),f.pc("click",(function(e){return f.Jc(i),f.tc().openViewed()})),f.cc(1,"img",32),f.Rc(2,"\u0110\xe3 xem "),f.gc()}}function Ci(e,t){if(1&e){var i=f.ic();f.hc(0,"div",33),f.pc("click",(function(e){return f.Jc(i),f.tc().openNoteImages()})),f.cc(1,"img",32),f.Rc(2,"\u1ea2nh ghi ch\xfa "),f.gc()}}function Pi(e,t){if(1&e&&(f.hc(0,"li",34),f.cc(1,"img",35),f.uc(2,"ImgPipe"),f.hc(3,"span",36),f.Rc(4),f.gc(),f.hc(5,"span",37),f.Rc(6),f.gc(),f.gc()),2&e){var i=t.$implicit;f.Ob(1),f.Bc("src",f.wc(2,3,i.Avt,"UserAvt"),f.Lc),f.Ob(3),f.Sc(i.FullName),f.Ob(2),f.Sc(i.Role)}}var Ai,wi,Ri=((wi=function(e){c(i,e);var t=n(i);function i(e){var c;return d(this,i),(c=t.call(this)).orderDetailService=e,c.Title="Chi ti\u1ebft \u0111\u01a1n",c.IsDataLosingWarning=!1,c.states=P.e,c.canSeen=!0,console.log(c.globalOrder),c.orderDetail=new C.c,c.orderDetail.SeenUsers=[],c.order=new C.d,c.noteImgs=[],c}return l(i,[{key:"Init",value:function(){var e=this;this.orderDetail=this.globalOrderDetail,this.order=this.globalOrder,this.state=ce.e.filter((function(t){return t.State===e.orderDetail.State}))[0].DisplayName,this.orderDetail.NoteImages.forEach((function(t){var i=V.a.getImgUrl(t,ce.c.NoteImg);e.noteImgs.push(i)})),setTimeout((function(){e.canSeen&&(e.CurrentUser.Role!=P.h.Florist&&e.CurrentUser.Role!==P.h.Shipper||e.orderDetailService.updateDetailSeen(e.orderDetail.OrderDetailId,e.CurrentUser.Id,(new Date).getTime(),!1).then((function(e){})))}),2e3)}},{key:"getDetailDiscount",value:function(e){return A.a.getDetailDiscount(e)}},{key:"destroy",value:function(){this.canSeen=!1}},{key:"openViewed",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e=this;this.orderDetailService.getODSeeners(this.orderDetail.OrderDetailId).then((function(t){e.orderDetail.SeenUsers=t,openViewed()}))}))},{key:"openNoteImages",value:function(){viewImages((function(){}))}}]),i}(y)).\u0275fac=function(e){return new(e||wi)(f.bc(X.a))},wi.\u0275cmp=f.Vb({type:wi,selectors:[["app-view-order-detail"]],features:[f.Lb],decls:51,vars:35,consts:[["id","prodDetail",1,"page-content"],[1,"container"],[1,"prodDetail"],[1,"prodGen"],[3,"state"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPrice"],[1,"prodCharge"],[1,"prodInfo","cusScroll"],[1,"prodQuan","infoGroup"],[1,"itemlabel"],[1,"itemVal"],["class","prodName infoGroup",4,"ngIf"],["class","prodAddr infoGroup",4,"ngIf"],[1,"prodTime","infoGroup"],["class","prodMakingTime infoGroup",4,"ngIf"],["class","prodDesc infoGroup",4,"ngIf"],["style","right:150px;","class","viewed",3,"click",4,"ngIf"],["class","viewed",3,"click",4,"ngIf"],["id","viewed",1,"popup-content"],[1,"main-bg"],[1,"viewedList"],["class","viewItem-three-column",4,"ngFor","ngForOf"],["id","view-product",1,"popup-content","view-img-popup-content",2,"z-index","1000"],[3,"src","config"],[1,"prodName","infoGroup"],[1,"prodAddr","infoGroup"],[1,"prodMakingTime","infoGroup"],[1,"prodDesc","infoGroup"],[1,"viewed",2,"right","150px",3,"click"],["src","../../../assets/images/eye.svg","alt","",1,"main-filter"],[1,"viewed",3,"click"],[1,"viewItem-three-column"],["alt","",1,"itemAva",3,"src"],[1,"itemName"],[1,"itemRole"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.cc(4,"app-status-point",4),f.cc(5,"img",5),f.uc(6,"ImgPipe"),f.hc(7,"div",6),f.hc(8,"h5",7),f.Rc(9),f.gc(),f.hc(10,"span",8),f.Rc(11),f.uc(12,"myCurrPipe"),f.gc(),f.hc(13,"span",9),f.Rc(14),f.uc(15,"myCurrPipe"),f.gc(),f.hc(16,"span",9),f.Rc(17),f.uc(18,"myCurrPipe"),f.gc(),f.hc(19,"span",9),f.Rc(20),f.gc(),f.gc(),f.gc(),f.hc(21,"div",10),f.hc(22,"div",11),f.hc(23,"span",12),f.Rc(24,"Tr\u1ea1ng th\xe1i:"),f.gc(),f.hc(25,"span",13),f.Rc(26),f.gc(),f.gc(),f.Pc(27,pi,5,1,"div",14),f.Pc(28,fi,5,1,"div",14),f.Pc(29,vi,5,1,"div",14),f.Pc(30,bi,5,1,"div",15),f.Pc(31,Oi,5,1,"div",15),f.hc(32,"div",16),f.hc(33,"span",12),f.Rc(34,"Th\u1eddi gian giao:"),f.gc(),f.hc(35,"span",13),f.Rc(36),f.uc(37,"myDatePipe"),f.gc(),f.gc(),f.Pc(38,Si,6,4,"div",17),f.Pc(39,Di,5,1,"div",18),f.Pc(40,ki,5,1,"div",18),f.Pc(41,Ii,5,1,"div",18),f.gc(),f.Pc(42,yi,3,0,"div",19),f.Pc(43,Ci,3,0,"div",20),f.gc(),f.gc(),f.gc(),f.hc(44,"div",21),f.hc(45,"h3",22),f.Rc(46,"Nh\u1eefng ng\u01b0\u1eddi \u0111\xe3 xem"),f.gc(),f.hc(47,"ul",23),f.Pc(48,Pi,7,6,"li",24),f.gc(),f.gc(),f.hc(49,"div",25),f.cc(50,"angular-image-viewer",26),f.gc()),2&e&&(f.Ob(4),f.Ac("state",t.orderDetail.State),f.Ob(1),f.Bc("src",f.wc(6,23,t.orderDetail.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(t.orderDetail.ProductName),f.Ob(2),f.Sc(f.vc(12,26,t.orderDetail.ModifiedPrice)),f.Ob(3),f.Tc("Ph\u1ee5 ph\xed: ",f.vc(15,28,t.getDetailDiscount(t.orderDetail)),""),f.Ob(3),f.Tc("Gi\u1ea3m gi\xe1: ",f.vc(18,30,t.orderDetail.AdditionalFee),""),f.Ob(3),f.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",t.orderDetail.Quantity,""),f.Ob(6),f.Sc(t.state),f.Ob(1),f.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Florist"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Florist"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Florist"!=t.CurrentUser.Role),f.Ob(5),f.Sc(f.wc(37,32,t.orderDetail.DeliveryInfo.DateTime,"HH:mm dd/MM/yyyy")),f.Ob(2),f.Ac("ngIf","Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf",""!=t.orderDetail.Description),f.Ob(1),f.Ac("ngIf",""!=t.orderDetail.MakingNote),f.Ob(1),f.Ac("ngIf",""!=t.orderDetail.ShippingNote),f.Ob(1),f.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),f.Ob(5),f.Ac("ngForOf",t.orderDetail.SeenUsers),f.Ob(2),f.Ac("src",t.noteImgs)("config",t.viewProdOptions))},directives:[qe,D.l,D.k,tt.a],pipes:[V.a,H.a,H.b],styles:[""]}),wi),Ti=((Ai=function(e){c(i,e);var t=n(i);function i(){var e;return d(this,i),(e=t.call(this)).Title="Trang ch\u1ee7",e}return l(i,[{key:"Init",value:function(){}}]),i}(y)).\u0275fac=function(e){return new(e||Ai)},Ai.\u0275cmp=f.Vb({type:Ai,selectors:[["app-home"]],features:[f.Lb],decls:2,vars:0,template:function(e,t){1&e&&(f.hc(0,"p"),f.Rc(1,"home works!"),f.gc())},styles:[""]}),Ai),Mi=function(e){return[e,"VND","symbol-narrow","","vi-VN"]};function Fi(e,t){if(1&e){var i=f.ic();f.hc(0,"div",34),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit;return f.tc().selectItem(c)})),f.hc(1,"div",7),f.Rc(2),f.uc(3,"currency"),f.gc(),f.hc(4,"div",8),f.Rc(5),f.gc(),f.hc(6,"div",9),f.Rc(7),f.uc(8,"myDatePipe"),f.gc(),f.gc()}if(2&e){var c=t.$implicit;f.Ob(2),f.Sc(f.xc(3,3,f.Cc(11,Mi,c.Amount))),f.Ob(3),f.Sc(c.Method),f.Ob(2),f.Sc(f.vc(8,9,c.AddingTime))}}var xi,Ni=((xi=function(e){c(i,e);var t=n(i);function i(e){var c;return d(this,i),(c=t.call(this)).purchaseService=e,c.Title="C\u1eadp nh\u1eadt thanh to\xe1n",c.purchaseType=P.g,c.IsDataLosingWarning=!1,c.qrContentTemplate="",c.currTotalPaidAmount=0,c.purchaseItems=[],c.order=c.globalOrder,c.qrContent="",c.currentPurchase=new T.a,c}return l(i,[{key:"Init",value:function(){console.log(this.globalPurchases),this.purchaseItems=this.globalPurchases}},{key:"selectItem",value:function(e){var t=this;this.currTotalPaidAmount=this.order.TotalPaidAmount,this.order.TotalPaidAmount-=e.Amount,this.currentPurchase=new T.a,this.currentPurchase.Id=e.Id,this.currentPurchase.Amount=e.Amount,this.currentPurchase.Method=e.Method,this.currentPurchase.Note=e.Note,purchaseDoing((function(){t.order.TotalPaidAmount=t.currTotalPaidAmount}))}},{key:"addPurchase",value:function(){this.currTotalPaidAmount=this.order.TotalPaidAmount,this.currentPurchase=new T.a,this.currentPurchase.Id=-1,this.currentPurchase.Amount=this.totalBalance,this.currentPurchase.Method=P.g.Cash,this.currentPurchase.Note="",purchaseDoing((function(){}))}},{key:"onPayChanged",value:function(e){this.currentPurchase.Amount<10&&(this.currentPurchase.Amount*=1e3,this.moveCursor(this.currentPurchase.Amount.toString().length,"Amount")),this.currentPurchase.Amount=+this.currentPurchase.Amount}},{key:"onPayFocus",value:function(){this.currentPurchase.Amount||(this.currentPurchase.Amount=0),this.moveCursor(this.currentPurchase.Amount.toString().length,"Amount")}},{key:"purchaseConfirm",value:function(){var e=this;if(this.currentPurchase.Amount>this.totalBalance||this.currentPurchase.Amount<=0)this.showError("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!");else{var t=new T.a;t.OrderId=this.order.OrderId,t.Id=this.currentPurchase.Id,t.Amount=+this.currentPurchase.Amount,t.Method=this.currentPurchase.Method,t.AddingTime=(new Date).getTime(),t.Note=this.currentPurchase.Note,this.order.TotalPaidAmount+=t.Amount,this.purchaseService.createOrUpdate(t,this.order.TotalPaidAmount).then((function(i){if(t.Id>0){var c=e.purchaseItems.filter((function(e){return e.Id==t.Id}))[0];c.OrderId=t.OrderId,c.Id=t.Id,c.Amount=+t.Amount,c.Method=t.Method,e.showSuccess("\u0110\xe3 c\u1eadp nh\u1eadt 1 thanh to\xe1n!"),dismissPurchaseDialog()}else e.globalPurchases.push(t),e.showSuccess("\u0110\xe3 th\xeam 1 thanh to\xe1n!"),e.currentPurchase.Amount=0,e.totalBalance<=0&&dismissPurchaseDialog()}))}}},{key:"selectPurType",value:function(e){this.currentPurchase.Method=e,e==P.g.Momo&&this.currentPurchase.Amount>0&&(this.qrContent=this.qrContentTemplate+this.currentPurchase.Amount.toString(),openQR())}},{key:"totalBalance",get:function(){return this.order?this.order.TotalAmount-this.order.TotalPaidAmount:0}}]),i}(y)).\u0275fac=function(e){return new(e||xi)(f.bc(U.a))},xi.\u0275cmp=f.Vb({type:xi,selectors:[["app-view-purchase"]],features:[f.Lb],decls:74,vars:21,consts:[["id","customerInfo",1,"page-content"],[1,"container"],[1,"row","checkTop","search"],[1,"col-12","mx-auto","text-center"],["type","button",1,"btn","main-btn","w-100",3,"click"],[1,"nameTable"],[1,"tableHead"],[1,"tableCenter"],[1,"tableLeft"],[1,"tableRight"],["id","customer-list",1,"tableBody","cusScroll"],["class","tableRow main-bg customer-item",3,"click",4,"ngFor","ngForOf"],[1,"orderTotal"],[1,"totalOld"],[1,"orderPrice"],[1,"totalNew"],["id","purchase-dialog",1,"popup-content"],[1,"checkOut",2,"margin-top","0px","padding","0px"],[1,"checkOutTotal"],[1,"checkOutLeft","mb-2"],[1,"form-group"],["for","currentPayAmount",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Amount","id","Amount",1,"mainForm",3,"ngModel","input","focus","ngModelChange"],["for","Note",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Note","id","Note",1,"mainForm",3,"ngModel","ngModelChange"],[1,"form-group","methodGrid","mb-0"],["href","javascript:void(0)",1,"methodItem",3,"ngClass","click"],["src","../../../../assets/images/momo.jpg","alt",""],["src","../../../../assets/images/banking.jpg","alt",""],["src","../../../../assets/images/cash.png","alt",""],[1,"row"],["id","codeQR",1,"popup-content"],[3,"value","size"],["type","button","id","submit-btn","onClick","qrDone()",1,"btn","main-btn","w-100","mt-3"],[1,"tableRow","main-bg","customer-item",3,"click"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.hc(4,"button",4),f.pc("click",(function(e){return t.addPurchase()})),f.Rc(5,"Th\xeam thanh to\xe1n"),f.gc(),f.gc(),f.gc(),f.hc(6,"div",5),f.hc(7,"div",6),f.hc(8,"div",7),f.Rc(9,"S\u1ed1 ti\u1ec1n"),f.gc(),f.hc(10,"div",8),f.Rc(11,"H\xecnh th\u1ee9c"),f.gc(),f.hc(12,"div",9),f.Rc(13,"Th\u1eddi gian"),f.gc(),f.gc(),f.hc(14,"div",10),f.Pc(15,Fi,9,13,"div",11),f.gc(),f.gc(),f.hc(16,"div",12),f.hc(17,"p",13),f.Rc(18,"M\xe3 \u0111\u01a1n: "),f.hc(19,"span",14),f.Rc(20),f.gc(),f.gc(),f.hc(21,"p",13),f.Rc(22,"C\xf2n l\u1ea1i: "),f.hc(23,"span",14),f.Rc(24),f.uc(25,"myCurrPipe"),f.gc(),f.gc(),f.hc(26,"p",15),f.Rc(27,"Th\xe0nh ti\u1ec1n: "),f.hc(28,"span",14),f.Rc(29),f.uc(30,"myCurrPipe"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(31,"div",16),f.hc(32,"div",1),f.hc(33,"div",17),f.hc(34,"div",18),f.hc(35,"h3"),f.Rc(36,"T\u1ed5ng"),f.gc(),f.hc(37,"p"),f.Rc(38),f.uc(39,"myCurrPipe"),f.gc(),f.gc(),f.hc(40,"div",19),f.hc(41,"h4"),f.Rc(42,"S\u1ed1 ti\u1ec1n c\xf2n l\u1ea1i"),f.gc(),f.hc(43,"p"),f.Rc(44),f.uc(45,"myCurrPipe"),f.gc(),f.gc(),f.hc(46,"div",20),f.hc(47,"label",21),f.Rc(48,"S\u1ed1 ti\u1ec1n thanh to\xe1n"),f.gc(),f.hc(49,"input",22),f.pc("input",(function(e){return t.onPayChanged(e.target.value)}))("focus",(function(e){return t.onPayFocus()}))("ngModelChange",(function(e){return t.currentPurchase.Amount=e})),f.gc(),f.gc(),f.hc(50,"div",20),f.hc(51,"label",23),f.Rc(52,"Ghi Ch\xfa"),f.gc(),f.hc(53,"input",24),f.pc("ngModelChange",(function(e){return t.currentPurchase.Note=e})),f.gc(),f.gc(),f.hc(54,"div",25),f.hc(55,"a",26),f.pc("click",(function(e){return t.selectPurType(t.purchaseType.Momo)})),f.cc(56,"img",27),f.gc(),f.hc(57,"a",26),f.pc("click",(function(e){return t.selectPurType(t.purchaseType.Banking)})),f.cc(58,"img",28),f.gc(),f.hc(59,"a",26),f.pc("click",(function(e){return t.selectPurType(t.purchaseType.Cash)})),f.cc(60,"img",29),f.gc(),f.gc(),f.hc(61,"div",30),f.hc(62,"div",3),f.hc(63,"button",4),f.pc("click",(function(e){return t.purchaseConfirm()})),f.Rc(64,"X\xe1c nh\u1eadn"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(65,"div",31),f.hc(66,"span"),f.Rc(67,"Qu\xe9t m\xe3 QR \u0111\u1ec3 thanh to\xe1n"),f.gc(),f.hc(68,"div"),f.cc(69,"qr-code",32),f.gc(),f.hc(70,"div",30),f.hc(71,"div",3),f.hc(72,"button",33),f.Rc(73,"Xong"),f.gc(),f.gc(),f.gc(),f.gc()),2&e&&(f.Ob(15),f.Ac("ngForOf",t.purchaseItems),f.Ob(5),f.Tc("",t.order.OrderId," "),f.Ob(4),f.Tc("",f.vc(25,13,t.totalBalance)," "),f.Ob(5),f.Tc("",f.vc(30,15,t.order.TotalAmount)," "),f.Ob(9),f.Sc(f.vc(39,17,t.order.TotalAmount)),f.Ob(6),f.Sc(f.vc(45,19,t.totalBalance)),f.Ob(5),f.Ac("ngModel",t.currentPurchase.Amount),f.Ob(4),f.Ac("ngModel",t.currentPurchase.Note),f.Ob(2),f.Ac("ngClass","Momo"===t.currentPurchase.Method?" img-purchase-selected":""),f.Ob(2),f.Ac("ngClass","Banking"===t.currentPurchase.Method?" img-purchase-selected":""),f.Ob(2),f.Ac("ngClass","Cash"===t.currentPurchase.Method?" img-purchase-selected":""),f.Ob(10),f.Ac("value",t.qrContent)("size",290))},directives:[D.k,B.b,B.k,B.n,D.j,E.a],pipes:[H.a,D.c,H.b],styles:[""]}),xi);function Li(e,t){if(1&e){var i=f.ic();f.hc(0,"div",34),f.pc("click",(function(e){f.Jc(i);var c=t.$implicit,r=t.index;return f.tc().selectItem(c,r)})),f.hc(1,"div",7),f.Rc(2),f.gc(),f.hc(3,"div",8),f.Rc(4),f.uc(5,"myCurrPipe"),f.gc(),f.hc(6,"div",9),f.Rc(7),f.uc(8,"myDatePipe"),f.gc(),f.gc()}if(2&e){var c=t.$implicit;f.Ob(2),f.Sc(c.Method),f.Ob(2),f.Sc(f.vc(5,3,c.Amount)),f.Ob(3),f.Tc("",f.wc(8,5,c.AddingTime,"HH:mm dd/MM/yyyy")," ")}}function Ui(e,t){1&e&&(f.hc(0,"div"),f.Rc(1," S\u1ed1 ti\u1ec1n l\xe0 b\u1eaft bu\u1ed9c "),f.gc())}function Bi(e,t){1&e&&(f.hc(0,"div"),f.Rc(1," S\u1ed1 ti\u1ec1n t\u1ed1i thi\u1ec3u 3 k\xfd t\u1ef1 "),f.gc())}function qi(e,t){if(1&e&&(f.hc(0,"div",35),f.Pc(1,Ui,2,0,"div",36),f.Pc(2,Bi,2,0,"div",36),f.gc()),2&e){f.tc();var i=f.Hc(27);f.Ob(1),f.Ac("ngIf",i.errors.required),f.Ob(1),f.Ac("ngIf",i.errors.minlength)}}var Ei,Hi,Vi=[{path:"login",component:gi},{path:"",component:mi,children:[{path:"",component:Ti,canActivate:[g.f]},{path:"add-purchse",component:(Ei=function(e){c(i,e);var t=n(i);function i(e){var c;return d(this,i),(c=t.call(this)).purchaseService=e,c.Title="Thanh to\xe1n n\u1eb7c danh",c.currentIndex=-1,c.purchaseMethod=P.g,c.currPurchase=new T.a,c.purchases=[],c.currentAddingTime=new Date,c}return l(i,[{key:"Init",value:function(){}},{key:"selectItem",value:function(e,t){this.currentIndex=t,this.currPurchase=new T.a,this.currPurchase.Amount=e.Amount,this.currentAddingTime=new Date(e.AddingTime),this.currPurchase.Id=e.Id,this.currPurchase.Method=e.Method,this.currPurchase.OrderId=e.OrderId,this.currPurchase.Note=e.Note,openAddPurchaseDialog()}},{key:"addPurchase",value:function(){this.currPurchase=new T.a,this.currPurchase.Amount=0,this.currentAddingTime=new Date,this.currPurchase.Id=0,this.currPurchase.Method=P.g.Banking,this.currPurchase.OrderId="",this.currPurchase.Note="",openAddPurchaseDialog()}},{key:"onAmountChanged",value:function(e){this.currPurchase.Amount<10&&(this.currPurchase.Amount*=1e3,this.moveCursor(this.currPurchase.Amount.toString().length,"Amount")),this.currPurchase.Amount=+this.currPurchase.Amount}},{key:"onAmountFocus",value:function(){this.currPurchase.Amount||(this.currPurchase.Amount=0),this.moveCursor(this.currPurchase.Amount.toString().length,"Amount")}},{key:"purchaseSaving",value:function(e){e.valid&&(this.currentIndex>-1?(Object.assign(this.purchases[this.currentIndex],this.currPurchase),this.purchases[this.currentIndex].AddingTime=this.currentAddingTime.getTime(),this.currentIndex=-1):(this.currPurchase.AddingTime=this.currentAddingTime.getTime(),this.purchases.push(this.currPurchase)),dissmissAddPurchaseDialog())}},{key:"saveChanges",value:function(){var e=this;this.purchases.length<=0||this.purchaseService.bulkCreate(this.purchases,"",(function(){e.purchases=[]}))}}]),i}(y),Ei.\u0275fac=function(e){return new(e||Ei)(f.bc(U.a))},Ei.\u0275cmp=f.Vb({type:Ei,selectors:[["app-add-purchase"]],features:[f.Lb],decls:57,vars:12,consts:[["id","customerInfo",1,"page-content"],[1,"container"],[1,"row","checkTop","search"],[1,"col-12","mx-auto","text-center"],["type","button",1,"btn","main-btn","w-100",3,"click"],[1,"nameTable"],[1,"tableHead"],[1,"tableLeft","small-width"],[1,"tableCenter"],[1,"tableRight","large-width"],["id","customer-list",1,"tableBody","cusScroll"],["class","tableRow main-bg customer-item",3,"click",4,"ngFor","ngForOf"],["id","addPurchase",1,"popup-content"],["autocomplete","on",1,"addInfoForm",3,"submit"],["form","ngForm"],[1,"form-group"],["for","Amount",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Amount","id","Amount","required","","minlength","3","placeholder","S\xf4 ti\u1ec1n...",1,"mainForm",3,"ngModel","input","focus","ngModelChange"],["Amount","ngModel"],["class","alert alert-danger",4,"ngIf"],["for","Note",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Note","id","Note",1,"mainForm",3,"ngModel","ngModelChange"],["for","Method",2,"width","100%","text-align","left","margin-bottom","0px"],["id","Method","name","Method",1,"mainForm",3,"ngModel","ngModelChange"],["selected",""],[3,"ngValue"],["for","currentAddingTime",2,"width","100%","text-align","left","margin-bottom","0px"],["name","currentAddingTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],[1,"row"],[1,"col-6","mx-auto","text-center"],["type","button","id","cancel-button","onClick","dissmissAddPurchaseDialog()",1,"btn","grey-btn","w-100","mt-3"],["type","submit",1,"btn","main-btn","w-100","mt-3","btn-success"],[1,"tableRow","main-bg","customer-item",3,"click"],[1,"alert","alert-danger"],[4,"ngIf"]],template:function(e,t){if(1&e){var i=f.ic();f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.hc(4,"button",4),f.pc("click",(function(e){return t.addPurchase()})),f.Rc(5,"Th\xeam thanh to\xe1n"),f.gc(),f.gc(),f.gc(),f.hc(6,"div",5),f.hc(7,"div",6),f.hc(8,"div",7),f.Rc(9,"H\xecnh th\u1ee9c"),f.gc(),f.hc(10,"div",8),f.Rc(11,"S\u1ed1 ti\u1ec1n"),f.gc(),f.hc(12,"div",9),f.Rc(13,"Th\u1eddi gian"),f.gc(),f.gc(),f.hc(14,"div",10),f.Pc(15,Li,9,8,"div",11),f.gc(),f.gc(),f.hc(16,"div",2),f.hc(17,"div",3),f.hc(18,"button",4),f.pc("click",(function(e){return t.saveChanges()})),f.Rc(19,"L\u01b0u"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(20,"div",12),f.hc(21,"form",13,14),f.pc("submit",(function(e){f.Jc(i);var c=f.Hc(22);return t.purchaseSaving(c)})),f.hc(23,"div",15),f.hc(24,"label",16),f.Rc(25,"S\u1ed1 ti\u1ec1n"),f.gc(),f.hc(26,"input",17,18),f.pc("input",(function(e){return t.onAmountChanged(e.target.value)}))("focus",(function(e){return t.onAmountFocus()}))("ngModelChange",(function(e){return t.currPurchase.Amount=e})),f.gc(),f.Pc(28,qi,3,2,"div",19),f.gc(),f.hc(29,"div",15),f.hc(30,"label",20),f.Rc(31,"Ghi Ch\xfa"),f.gc(),f.hc(32,"input",21),f.pc("ngModelChange",(function(e){return t.currPurchase.Note=e})),f.gc(),f.gc(),f.hc(33,"div",15),f.hc(34,"label",22),f.Rc(35,"H\xecnh th\u1ee9c thanh to\xe1n"),f.gc(),f.hc(36,"select",23),f.pc("ngModelChange",(function(e){return t.currPurchase.Method=e})),f.hc(37,"option",24),f.Rc(38,"Ch\u1ecdn..."),f.gc(),f.hc(39,"option",25),f.Rc(40,"Ti\u1ec1n m\u1eb7t"),f.gc(),f.hc(41,"option",25),f.Rc(42,"Chuy\u1ec3n kho\u1ea3n"),f.gc(),f.hc(43,"option",25),f.Rc(44,"V\xed Momo"),f.gc(),f.gc(),f.gc(),f.hc(45,"label",26),f.Rc(46,"Th\u1eddi gian"),f.gc(),f.hc(47,"input",27),f.pc("ngModelChange",(function(e){return t.currentAddingTime=e})),f.gc(),f.cc(48,"owl-date-time",28,29),f.hc(50,"div",30),f.hc(51,"div",31),f.hc(52,"button",32),f.Rc(53,"H\u1ee7y"),f.gc(),f.gc(),f.hc(54,"div",31),f.hc(55,"button",33),f.Rc(56,"L\u01b0u"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var c=f.Hc(27),r=f.Hc(49);f.Ob(15),f.Ac("ngForOf",t.purchases),f.Ob(11),f.Ac("ngModel",t.currPurchase.Amount),f.Ob(2),f.Ac("ngIf",c.invalid&&(c.dirty||c.touched)),f.Ob(4),f.Ac("ngModel",t.currPurchase.Note),f.Ob(4),f.Ac("ngModel",t.currPurchase.Method),f.Ob(3),f.Ac("ngValue",t.purchaseMethod.Cash),f.Ob(2),f.Ac("ngValue",t.purchaseMethod.Banking),f.Ob(2),f.Ac("ngValue",t.purchaseMethod.Momo),f.Ob(4),f.Ac("owlDateTime",r)("owlDateTimeTrigger",r)("ngModel",t.currentAddingTime),f.Ob(1),f.Ac("stepMinute",5)}},directives:[D.k,B.v,B.l,B.m,B.b,B.r,B.h,B.k,B.n,D.l,B.s,B.o,B.u,q.c,q.f,q.b],pipes:[H.a,H.b],styles:[""]}),Ei),canActivate:[g.b]},{path:"final-confirm",component:se,canActivate:[g.b]},{path:"view-purchase",component:Ni,canActivate:[g.b]},{path:"customer-confirming",component:te,canActivate:[g.a]},{path:"shipper-main",component:ei,canActivate:[g.a]},{path:"sort-order-changing",component:li,canActivate:[g.b]},{path:"florist-main",component:Je,canActivate:[g.d]},{path:"order-detail-confirming",component:Ye,canActivate:[g.a]},{path:"orders-manage",canActivate:[g.b],component:kt},{path:"select-customer",component:qt,canActivate:[g.b]},{path:"order-detail/:id",component:ut,canActivate:[g.b]},{path:"search-product",component:$t,canActivate:[g.b]},{path:"add-order",component:G,canActivate:[g.b]},{path:"select-receiver",component:Qt,canActivate:[g.b]},{path:"order-detail-view",component:Ri,canActivate:[g.e]}]}],Ji=((Hi=function e(){d(this,e)}).\u0275mod=f.Zb({type:Hi}),Hi.\u0275inj=f.Yb({factory:function(e){return new(e||Hi)},imports:[[h.d.forChild(Vi),m.a],h.d]}),Hi)}}])}();