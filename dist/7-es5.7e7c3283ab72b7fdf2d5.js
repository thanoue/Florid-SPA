!function(){function e(e,c){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,c){if(!e)return;if("string"==typeof e)return t(e,c);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(e,c)}(e))||c&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var c=0,i=new Array(t);c<t;c++)i[c]=e[c];return i}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,c){var n=i(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(arguments.length<3?e:c):r.value}}).apply(this,arguments)}function i(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var c,i=u(e);if(t){var n=u(this).constructor;c=Reflect.construct(i,arguments,n)}else c=i.apply(this,arguments);return a(this,c)}}function a(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){for(var c=0;c<t.length;c++){var i=t[c];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,c){return t&&l(e.prototype,t),c&&l(e,c),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"711k":function(t,i,r){"use strict";r.r(i),r.d(i,"ROUTES",(function(){return Lc})),r.d(i,"StaffModule",(function(){return Bc}));var a,l=r("tyNb"),g=r("+XmF"),m=r("d2mR"),p=r("mrSG"),f=r("fXoL"),v=r("IAJr"),b=r("F2nW"),O=r("QGCU"),y=d((function e(t,c){h(this,e),this.Title=t,this.NavigateClass=c})),D=r("ofXK"),I=r("CVMR"),S=r("oz8C"),k=r("LQcV"),C=((a=function(){function e(){h(this,e),this.IsDataLosingWarning=!0,this.NavigateClass="prev-icon",this.viewProdOptions={btnClass:"default",zoomFactor:.1,containerBackgroundColor:"#ccc",wheelZoom:!0,allowDrag:!0,btnIcons:{zoomIn:"fa fa-plus",zoomOut:"fa fa-minus",rotateClockwise:"fa fa-repeat",rotateCounterClockwise:"fa fa-undo",next:"fa fa-arrow-right",prev:"fa fa-arrow-left",fullscreen:"fa fa-arrows-alt"},btnShow:{zoomIn:!0,zoomOut:!0,rotateClockwise:!0,rotateCounterClockwise:!0,next:!0,prev:!0}};var t=v.a.getInjector();this.globalService=t.get(b.a),this.authService=t.get(O.a),this.location=t.get(D.h),this.ngZone=t.get(f.H),this.addressService=t.get(I.a)}return d(e,[{key:"isEdittingOrder",get:function(){return this.globalService.isEdittingOrder},set:function(e){this.globalService.isEdittingOrder=e}},{key:"globalPurchases",get:function(){return this.globalService.currentPurchases},set:function(e){this.globalService.currentPurchases=e}},{key:"globalOrder",get:function(){return this.globalService.currentOrderViewModel},set:function(e){this.globalService.currentOrderViewModel=e}},{key:"globalOrderDetail",get:function(){return this.globalService.currentOrderDetailViewModel},set:function(e){this.globalService.currentOrderDetailViewModel=e}},{key:"globalDistricts",get:function(){return this.globalService.currentDistricts},set:function(e){this.globalService.currentDistricts=e}},{key:"globalwards",get:function(){return this.globalService.currentWards},set:function(e){this.globalService.currentWards=e}},{key:"CurrentUser",get:function(){return{FullName:S.a.getUserName(),Role:S.a.getRole(),Avt:S.a.getUserAvtUrl(),Id:S.a.getUserId(),PhoneNumber:S.a.getPhoneNumber()}}},{key:"getDetailDiscount",value:function(e){return k.a.getDetailDiscount(e)}},{key:"ngOnInit",value:function(){var e=this;window.BaseReference={component:this,zone:this.ngZone,dateTimeSelected:function(t,c,i,n,r){return e.dateTimeSelected(t,c,i,n,r)},forceBackNavigate:function(){return e.backNavigateOnClick()},fileChosen:function(t){return e.fileChosen(t)},printConfirm:function(t){return e.printConfirm(t)},rememberPassConfirm:function(){return e.rememberPassConfirm()},savedLoginInforReturn:function(t,c){return e.savedLoginInforReturn(t,c)}},this.IsOnTerminal=this.globalService.isRunOnTerimal(),this.Init()}},{key:"menuOpening",value:function(e,t){menuOpen(e,t)}},{key:"savedLoginInforReturn",value:function(e,t){}},{key:"moveCursor",value:function(e){function t(t,c){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){setTimeout((function(){e>3&&moveCursor(t,e-3)}),10)}))},{key:"askForRememberPassword",value:function(){this.globalService.isRememberPassWillCheck&&(this.globalService.isRememberPassWillCheck=!1,this.globalService.isOnMobile()&&isRememberPassChecking())}},{key:"rememberPassConfirm",value:function(){this.openConfirm("B\u1ea1n mu\u1ed1n l\u01b0u th\xf4ng tin \u0111\u0103ng nh\u1eadp?",(function(){passwordSaving()}),(function(){passwordClearing()}))}},{key:"ngOnDestroy",value:function(){this.navigateOnClick.unsubscribe(),this.destroy()}},{key:"ngAfterViewInit",value:function(){var e=this;this.globalService.updaterMobileHeaderInfo(new y(this.Title,this.NavigateClass)),this.navigateOnClick=this.globalService.navigateOnClick.subscribe((function(t){t&&e.backNavigateOnClick()}))}},{key:"printConfirm",value:function(e){this.openConfirm("In th\xeam b\u1ea3n?",(function(){e()}),(function(){}))}},{key:"selectAddress",value:function(e){var t=this;this.globalwards.length<=0?this.addressService.getAllDistrict().then((function(c){t.globalDistricts=c,t.addressService.getAllWards().then((function(c){t.globalwards=c,t.addressRequest(e)}))})):this.addressRequest(e)}},{key:"addressRequest",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=this;addressRequest(this.globalDistricts,e,(function(e,c){c(t.globalwards.filter((function(t){return t.DistrictId===e})))}))}))},{key:"dateTimeSelected",value:function(e,t,c,i,n){}},{key:"showError",value:function(e){this.globalService.showError(e)}},{key:"showInfo",value:function(e){this.globalService.showInfo(e)}},{key:"showSuccess",value:function(e){this.globalService.showSuccess(e)}},{key:"showWarning",value:function(e){this.globalService.showWarning(e)}},{key:"openFile",value:function(){pickFile(!1)}},{key:"openFileForShare",value:function(){pickFile(!0)}},{key:"startLoading",value:function(){this.globalService.startLoading()}},{key:"stopLoading",value:function(){this.globalService.stopLoading()}},{key:"setStatusBarColor",value:function(e){this.globalService.setStatusBarColor(e)}},{key:"OnBackNaviage",value:function(){this.location.back()}},{key:"backNavigateOnClick",value:function(){var e=this;this.IsDataLosingWarning?this.openConfirm("D\u1eef li\u1ec7u hi\u1ec7n t\u1ea1i s\u1ebd b\u1ecb m\u1ea5t! B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn?",(function(){e.OnBackNaviage()})):this.OnBackNaviage()}},{key:"destroy",value:function(){}},{key:"fileChosen",value:function(e){}},{key:"openConfirm",value:function(e,t,c,i,n,r){this.globalService.openMobileConfirm(e,t,c,i,n,r)}}]),e}()).\u0275fac=function(e){return new(e||a)},a.\u0275dir=f.Wb({type:a}),a),P=r("r5y0"),A=r("2pNN"),T=r("jXcA"),w=r("TjQO"),R=r("Abtb"),M=r("kVqo"),F=r("0zL+"),N=r("kGcc"),x=r("EeL4"),L=r("NWHx"),B=r("3Pt+"),U=r("z17N"),H=r("O0x4"),E=r("wRGf"),q=r("jjJn");function V(e,t){if(1&e){var c=f.ic();f.hc(0,"li",72),f.hc(1,"div",73),f.hc(2,"span"),f.Rc(3),f.gc(),f.gc(),f.hc(4,"div",74),f.cc(5,"img",75),f.uc(6,"ImgPipe"),f.hc(7,"div",76),f.hc(8,"h5",77),f.Rc(9),f.gc(),f.hc(10,"span",78),f.Rc(11),f.uc(12,"myCurrPipe"),f.gc(),f.hc(13,"span",79),f.Rc(14),f.gc(),f.hc(15,"span",79),f.Rc(16),f.uc(17,"myCurrPipe"),f.gc(),f.hc(18,"span",79),f.Rc(19),f.uc(20,"myCurrPipe"),f.gc(),f.gc(),f.gc(),f.hc(21,"div",80),f.hc(22,"a",81),f.pc("click",(function(){f.Jc(c);var e=t.$implicit;return f.tc().deleteOrderDetail(e.Index)})),f.cc(23,"img",82),f.gc(),f.hc(24,"a",81),f.pc("click",(function(){f.Jc(c);var e=t.$implicit;return f.tc().editOrderDetail(e.Index)})),f.cc(25,"img",83),f.gc(),f.gc(),f.gc()}if(2&e){var i=t.$implicit,n=f.tc();f.Ob(3),f.Sc(i.Index+1),f.Ob(2),f.Bc("src",f.wc(6,7,i.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(i.ProductName),f.Ob(2),f.Tc("",f.vc(12,10,i.ModifiedPrice)," "),f.Ob(3),f.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",i.Quantity," "),f.Ob(2),f.Tc("Ph\u1ee5 ph\xed: ",f.vc(17,12,i.AdditionalFee)," "),f.Ob(3),f.Tc("Gi\u1ea3m gi\xe1: ",f.vc(20,14,n.getDetailDiscount(i)),"")}}function j(e,t){if(1&e){var c=f.ic();f.hc(0,"li",84),f.pc("click",(function(){f.Jc(c);var e=t.index;return f.tc().selectPromotion(e)})),f.hc(1,"p",85),f.Rc(2),f.gc(),f.hc(3,"span",86),f.Rc(4),f.gc(),f.hc(5,"span",87),f.Rc(6),f.uc(7,"myDatePipe"),f.uc(8,"myDatePipe"),f.gc(),f.gc()}if(2&e){var i=t.$implicit,n=t.index,r=f.tc();f.Pb("data-index",n),f.Ob(2),f.Sc(i.Name),f.Ob(2),f.Sc(r.getPromotionAmount(i)),f.Ob(2),f.Uc("",f.vc(7,5,i.StartTime),"-",f.vc(8,7,i.EndTime),"")}}var J,G=((J=function(e){n(c,e);var t=o(c);function c(e,i,n,r,o,a){var s;return h(this,c),(s=t.call(this)).router=e,s.orderService=i,s.customerService=n,s.printJobService=r,s.promotionService=o,s.purchaseService=a,s.Title="Th\xeam \u0110\u01a1n",s.memberShipTitle="",s.totalBalance=0,s.orderDiscount=0,s.isPurchased=!1,s.purchaseType=A.h,s.qrContentTemplate="",s.purchaseNote="",s.isCompleting=!1,s.promotions=[],s.currentPayAmount=0,s.qrContent="",s.wishingDoneTime=new Date,s}return d(c,[{key:"AcctualBalance",get:function(){return this.order?this.order.TotalAmount-this.order.TotalPaidAmount:0}},{key:"Init",value:function(){var e=this;if(this.promotionService.getAvailablePromotions((new Date).getTime(),!1).then((function(t){e.promotions=t})),this.order=this.globalOrder,this.isEdittingOrder)this.wishingDoneTime=new Date(this.order.DoneTime);else if(this.memberShipTitle="New Customer",!this.order.OrderId){var t=(new Date).getFullYear();this.orderService.getMaxNumberId(t).then((function(c){null==c&&(c=0),e.order.OrderId="".concat(t%100,".").concat((c+1).toString())}))}switch(this.onVATIncludedChange(),this.order.CustomerInfo.MembershipType){case A.d.NewCustomer:this.memberShipTitle="New Customer";break;case A.d.Member:this.memberShipTitle="Member";break;case A.d.Vip:this.memberShipTitle="VIP";break;case A.d.VVip:this.memberShipTitle="VVIP";break;default:this.memberShipTitle="New Customer"}this.totalBalance=this.order.TotalAmount-this.order.TotalPaidAmount}},{key:"onMemberDiscountChange",value:function(){this.totalAmountCalculate()}},{key:"getPromotionAmount",value:function(e){return e.PromotionType===w.b.Amount?e.Amount+" \u20ab":e.Amount+" %"}},{key:"selectPromotion",value:function(e){this.order.AmountDiscount=this.order.PercentDiscount=0;var t=this.promotions[e];t.PromotionType===w.b.Amount?this.order.AmountDiscount=t.Amount:this.order.PercentDiscount=t.Amount,hideReceiverPopup(),this.onVATIncludedChange()}},{key:"completingOrder",value:function(){this.placeOrder(!0)}},{key:"editOrder",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.order.OrderDetails.forEach((function(e){e.NoteImages&&e.NoteImages.length>0&&e.NoteImages.forEach((function(e){k.a.isBase64(e)||t.push(e)}))})),e.prev=2,e.next=5,this.orderService.deleteOrderDetailByOrderId(this.order.OrderId,t);case 5:this.orderConfirm(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error(e.t0);case 11:case"end":return e.stop()}}),e,this,[[2,8]])})))}},{key:"refundChecking",value:function(){var e=this;this.totalBalance<0?this.openConfirm("S\u1ed1 ti\u1ec1n c\u1ea7n tr\u1ea3 l\u1ea1i cho KH l\xe0 "+k.a.toFormatCurrency(-1*this.totalBalance),(function(){e.purchaseService.refund(e.totalBalance,e.order.OrderId).then((function(){e.order.TotalPaidAmount=e.order.TotalAmount,e.totalBalance=0,e.editOrder()}))}),(function(){e.editOrder()}),(function(){}),"X\xe1c nh\u1eadn \u0111\xe3 tr\u1ea3","\u0110\u1ec3 sau"):0==this.totalBalance?this.editOrder():this.openConfirm("Th\xeam thanh to\xe1n cho \u0111\u01a1n n\xe0y?",(function(){e.addPurchase()}),(function(){e.editOrder()}),null,"Th\xeam","\u0110\u1ec3 sau")}},{key:"placeOrder",value:function(e){var t=this;this.isCompleting=e,this.currentPayAmount=this.order.TotalAmount-this.order.TotalPaidAmount,this.order.DoneTime=this.wishingDoneTime.getTime(),this.order.CustomerInfo&&this.order.CustomerInfo.Id||(this.order.CustomerInfo=new P.a,this.order.CustomerInfo.Id="KHACH_LE",this.order.CustomerInfo.Name="Kh\xe1ch l\u1ebb"),!this.order.OrderDetails||this.order.OrderDetails.length<=0?this.showError("Ch\u01b0a ch\u1ecdn s\u1ea3n ph\u1ea9m n\xe0o!"):!this.order.TotalAmount||this.order.TotalAmount<=0?this.showError("Th\xe0nh ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!"):(this.order.CustomerInfo.GainedScore=k.a.getScoreFromOrder(this.order),this.isEdittingOrder?this.refundChecking():this.AcctualBalance>0?this.openConfirm("Th\xeam thanh to\xe1n cho \u0111\u01a1n n\xe0y?",(function(){t.addPurchase()}),(function(){t.printConfirmation()}),null,"Th\xeam","\u0110\u1ec3 sau"):this.printConfirmation())}},{key:"addPurchase",value:function(){this.currentPayAmount=this.totalBalance,this.currentPurType=A.h.Cash,this.purchaseNote="",purchaseDoing()}},{key:"printConfirmation",value:function(){var e=this;this.order.CreatedDate||(this.order.CreatedDate=new Date),this.openConfirm("In ho\xe1 \u0111\u01a1n?",(function(){e.doPrintJob()}),(function(){e.orderConfirm()}),(function(){e.orderConfirm()}))}},{key:"getDetailDiscount",value:function(e){return k.a.getDetailDiscount(e)}},{key:"doPrintJob",value:function(){var e=0,t=[];this.order.OrderDetails.forEach((function(c){t.push({productName:c.ProductName,index:c.Index+1,price:c.ModifiedPrice,additionalFee:c.AdditionalFee,discount:k.a.getDetailDiscount(c),quantity:c.Quantity}),e+=c.ModifiedPrice*c.Quantity}));var c=[];this.globalPurchases.forEach((function(e){c.push({method:e.Method,amount:e.Amount})}));var i={Created:(new Date).getTime(),doneTime:new Date(this.order.DoneTime).toLocaleString("en-US",{hour12:!1}),Id:this.order.OrderId,Active:!0,IsDeleted:!1,saleItems:t,createdDate:this.order.CreatedDate.toLocaleString("en-US",{hour12:!1}),orderId:this.order.OrderId,summary:e,totalAmount:this.order.TotalAmount,totalPaidAmount:this.order.TotalAmount-this.AcctualBalance,totalBalance:this.totalBalance,vatIncluded:this.order.VATIncluded,memberDiscount:this.order.CustomerInfo.DiscountPercent,scoreUsed:this.order.CustomerInfo.ScoreUsed,gainedScore:this.order.CustomerInfo.GainedScore,totalScore:this.order.CustomerInfo.AvailableScore-this.order.CustomerInfo.ScoreUsed+this.order.CustomerInfo.GainedScore,customerName:this.order.CustomerInfo.Name,customerId:this.order.CustomerInfo.Id,discount:this.orderDiscount,isMemberDiscountApply:this.order.IsMemberDiscountApply,purchaseItems:c};this.printJobService.addPrintJob(i),this.orderConfirm()}},{key:"orderConfirm",value:function(){var e=this;this.startLoading();var t=new T.d;t.CustomerId=this.order.CustomerInfo.Id,t.Id=this.order.OrderId,t.Created=this.order.CreatedDate.getTime(),t.VATIncluded=this.order.VATIncluded,t.TotalAmount=this.order.TotalAmount,t.TotalPaidAmount=this.order.TotalPaidAmount,t.GainedScore=this.order.CustomerInfo.GainedScore,t.ScoreUsed=this.order.CustomerInfo.ScoreUsed,t.Index=this.order.Index,t.OrderType=this.order.OrderType,t.PercentDiscount=this.order.PercentDiscount,t.AmountDiscount=this.order.AmountDiscount,t.IsMemberDiscountApply=this.order.IsMemberDiscountApply,t.DoneTime=this.order.DoneTime,t.IsFinished=this.isCompleting,this.orderService.addOrEditOrder(t,this.isEdittingOrder).then((function(c){return Object(p.a)(e,void 0,void 0,regeneratorRuntime.mark((function e(){var c,i,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.globalPurchases.length>0&&this.purchaseService.bulkCreate(this.globalPurchases,t.Id,(function(){n.globalPurchases=[]})),c=[],i=[],this.order.OrderDetails.forEach((function(e){var r=new T.e;r.OrderId=t.Id,r.IsHardcodeProduct=e.IsFromHardCodeProduct,r.HardcodeProductImageName=e.HardcodeImageName,r.ProductId=e.ProductId,r.ProductImageUrl=e.ProductImageUrl,r.ProductPrice=e.ModifiedPrice,r.AdditionalFee=e.AdditionalFee,r.ProductName=e.ProductName,r.Description=e.Description,r.State=n.isCompleting?A.f.Completed:A.f.Added,r.IsVATIncluded=t.VATIncluded,r.PurposeOf=e.PurposeOf,r.Index=e.Index,r.PercentDiscount=e.PercentDiscount,r.AmountDiscount=e.AmountDiscount,r.Quantity=e.Quantity,r.NoteImages=e.NoteImages,r.CustomerName=n.order.CustomerInfo.Name,r.CustomerPhoneNumber=n.order.CustomerInfo.PhoneNumber;var o=new T.a;o.Address=e.DeliveryInfo.Address?e.DeliveryInfo.Address:n.order.CustomerInfo.Address?n.order.CustomerInfo.Address:"",o.FullName=e.DeliveryInfo.FullName?e.DeliveryInfo.FullName:n.order.CustomerInfo.Name?n.order.CustomerInfo.Name:"",o.PhoneNumber=e.DeliveryInfo.PhoneNumber?e.DeliveryInfo.PhoneNumber:n.order.CustomerInfo.PhoneNumber?n.order.CustomerInfo.PhoneNumber:"",r.DeliveryInfo.ReceivingTime=e.DeliveryInfo.DateTime?e.DeliveryInfo.DateTime.getTime():n.order.DoneTime,r.DeliveryInfo.ReceiverDetail=o,c.push(r);var a=!0;i.forEach((function(e){k.a.receiverInfoCompare(e,o)&&(a=!1)})),a&&i.push(o)})),this.globalOrder.CustomerInfo.ReceiverInfos.forEach((function(e){var t=!0;i.forEach((function(c){k.a.receiverInfoCompare(e,c)&&(t=!1)})),t&&i.push(e)})),this.uploadImage(c).then((function(e){n.orderService.addOrderDetails(c).then((function(){"KHACH_LE"!==t.CustomerId?n.customerService.updateReceiverList(t.CustomerId,i).then((function(e){n.stopLoading(),e&&n.completeOrder()})):(n.stopLoading(),n.completeOrder())})).catch((function(e){console.log(e),n.globalService.stopLoading(),n.showError(e.toString())}))})).catch((function(e){n.showError(e.toString())}));case 3:case"end":return e.stop()}}),e,this)})))}))}},{key:"selectPurType",value:function(e){this.currentPurType=e,e===A.h.Momo&&this.currentPayAmount>0&&(this.qrContent=this.qrContentTemplate+this.currentPayAmount.toString(),openQR())}},{key:"purchaseConfirm",value:function(){var e=this;if(this.currentPayAmount>this.totalBalance||this.currentPayAmount<=0)this.showError("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!");else{var t=new R.a;t.OrderId=this.order.OrderId,t.Amount=+this.currentPayAmount,t.Method=this.currentPurType,t.Note=this.purchaseNote,t.AddingTime=(new Date).getTime(),this.globalPurchases.push(t),this.order.TotalPaidAmount+=t.Amount,this.currentPayAmount=0,this.showSuccess("\u0110\xe3 th\xeam 1 thanh to\xe1n!"),this.totalAmountCalculate(),this.totalBalance<=0?dismissPurchaseDialog((function(){e.isEdittingOrder?e.editOrder():e.printConfirmation()})):(this.currentPayAmount=this.totalBalance,this.currentPurType=A.h.Cash)}}},{key:"uploadImages",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t,i){return Object(p.a)(c,void 0,void 0,regeneratorRuntime.mark((function c(){var n,r,o,a,s,u,l,d=this;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:n="",r=0;case 2:if(!(r<e.NoteImages.length)){c.next=22;break}if(o=e.NoteImages[r],k.a.isBase64(o)){c.next=7;break}return n=r===e.NoteImages.length-1?n+o:n+o+",",c.abrupt("continue",19);case 7:return c.next=9,fetch(o);case 9:return a=c.sent,c.next=12,a.blob();case 12:if(null==(s=c.sent)){c.next=19;break}return u=new File([s],"result.png",{type:"image/png"}),c.next=17,this.orderService.uploadNoteImg(u).catch((function(e){d.showError(e),i(e)}));case 17:l=c.sent,n=r===e.NoteImages.length-1?n+l:n+l+",";case 19:r++,c.next=2;break;case 22:t(n);case 23:case"end":return c.stop()}}),c,this)})))})).then((function(e){return e}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))}},{key:"uploadImage",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t,i){return Object(p.a)(c,void 0,void 0,regeneratorRuntime.mark((function c(){var n,r,o;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:c.prev=0,n=0;case 2:if(!(n<e.length)){c.next=12;break}if(!((r=e[n]).NoteImages&&r.NoteImages.length>0)){c.next=9;break}return c.next=7,this.uploadImages(r).catch((function(e){i(e)}));case 7:(o=c.sent)&&(console.log(o),r.NoteImages=[],r.NoteImagesBlobbed=o);case 9:n++,c.next=2;break;case 12:t("added"),c.next=18;break;case 15:c.prev=15,c.t0=c.catch(0),i(c.t0);case 18:case"end":return c.stop()}}),c,this,[[0,15]])})))})).then((function(e){return e}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))}},{key:"totalAmountCalculate",value:function(){var e=this;this.order.TotalAmount=0,this.order.OrderDetails.forEach((function(t){t.AdditionalFee||(t.AdditionalFee=0);var c=t.ModifiedPrice*t.Quantity,i=c;t.PercentDiscount&&t.PercentDiscount>0&&(i-=i/100*t.PercentDiscount),t.AmountDiscount&&t.AmountDiscount>0&&(i-=t.AmountDiscount),e.order.TotalAmount+=e.order.CustomerInfo&&e.order.CustomerInfo.DiscountPercent&&e.order.CustomerInfo.DiscountPercent>0&&e.order.IsMemberDiscountApply?i-c/100*e.order.CustomerInfo.DiscountPercent+t.AdditionalFee:i+t.AdditionalFee})),this.orderDiscount=0,this.order.PercentDiscount&&this.order.PercentDiscount>0&&(this.orderDiscount=this.order.TotalAmount/100*this.order.PercentDiscount,this.order.TotalAmount-=this.orderDiscount),this.order.AmountDiscount&&this.order.AmountDiscount>0&&(this.order.TotalAmount=this.order.TotalAmount-this.order.AmountDiscount,this.orderDiscount+=this.order.AmountDiscount),this.order.VATIncluded&&(this.order.TotalAmount=this.order.TotalAmount+.1*this.order.TotalAmount),this.order.TotalAmount-=k.a.geExchangableAmount(this.order.CustomerInfo.ScoreUsed),this.totalBalance=this.order.TotalAmount-this.order.TotalPaidAmount}},{key:"onDiscountChanged",value:function(e){this.onVATIncludedChange()}},{key:"onPayChanged",value:function(e){this.currentPayAmount<10&&this.currentPayAmount>0&&(this.currentPayAmount*=1e3,this.moveCursor(this.currentPayAmount.toString().length,"currentPayAmount")),this.currentPayAmount=+this.currentPayAmount}},{key:"onPayFocus",value:function(){this.currentPayAmount||(this.currentPayAmount=0),this.moveCursor(this.currentPayAmount.toString().length,"currentPayAmount")}},{key:"onAmountDiscountChanged",value:function(e){this.order.AmountDiscount<10&&this.order.AmountDiscount>0&&(this.order.AmountDiscount*=1e3,this.moveCursor(this.order.AmountDiscount.toString().length,"AmountDiscount")),this.order.AmountDiscount=+this.order.AmountDiscount,this.onVATIncludedChange()}},{key:"onAmountDiscountFocus",value:function(){this.order.AmountDiscount||(this.order.AmountDiscount=0),this.moveCursor(this.order.AmountDiscount.toString().length,"AmountDiscount")}},{key:"onVATIncludedChange",value:function(){this.totalAmountCalculate()}},{key:"scoreExchange",value:function(){var e=this;openExcForm((function(t,c){return e.order.CustomerInfo.AvailableScore<t?(e.showError("V\u01b0\u1ee3t qu\xe1 \u0111i\u1ec3m t\xedch l\u0169y!!"),void c.call(e,!1)):k.a.geExchangableAmount(t)>=e.totalBalance?(e.showError("V\u01b0\u1ee3t qu\xe1 t\u1ed5ng ti\u1ec1n thanh to\xe1n!"),void c.call(e,!1)):(c.call(e,!0),e.order.CustomerInfo.ScoreUsed=t,void e.onVATIncludedChange())}))}},{key:"addNewOrderDetail",value:function(){this.globalOrderDetail=new P.c,this.router.navigate(["/staff/order-detail/-1"])}},{key:"editOrderDetail",value:function(e){var t=this;menuOpen((function(c){var i=P.c.DeepCopy(t.order.OrderDetails[e]);switch(+c){case 0:t.globalOrderDetail=i,t.router.navigate(["/staff/order-detail/"+e]);break;case 1:i.Index=t.order.OrderDetails.length,t.order.OrderDetails.push(i),t.onVATIncludedChange()}}),["Ch\u1ec9nh s\u1eeda","Sao ch\xe9p"])}},{key:"deleteOrderDetail",value:function(e){var t=this;this.openConfirm("Ch\u1eafc ch\u1eafn xo\xe1?",(function(){t.order.OrderDetails.splice(e,1);var c=0;t.order.OrderDetails.forEach((function(e){e.Index=c,c++})),t.onVATIncludedChange()}))}},{key:"completeOrder",value:function(){var e=this;"KHACH_LE"!==this.order.CustomerInfo.Id&&this.isCompleting?this.orderService.addScoreToCustomer(this.order).then((function(t){e.OnBackNaviage()})):this.OnBackNaviage()}}]),c}(C)).\u0275fac=function(e){return new(e||J)(f.bc(l.b),f.bc(M.a),f.bc(F.a),f.bc(N.a),f.bc(x.a),f.bc(L.a))},J.\u0275cmp=f.Vb({type:J,selectors:[["app-add-order"]],features:[f.Lb],decls:136,vars:36,consts:[["id","confirm",1,"page-content"],[1,"container"],[1,"row","custBrow",2,"margin-bottom","1vh"],[1,"col-10","custList"],["routerLink","/staff/select-customer",1,"main-bg","custListButton"],["src","../../../../assets/images/cust.png","alt",""],["behavior","scroll","direction","left"],[1,"col-2","prodAdd","text-right","pl-0"],[1,"main-bg",3,"click"],["src","../../../../assets/images/add.svg","alt","",1,"main-filter"],[1,"vatStatus"],[1,"vatScope"],["type","checkbox","id","IsMemberDiscountApply","name","IsMemberDiscountApply","value","1",1,"custom-checkbox",3,"ngModel","change","ngModelChange"],[1,"main-bg","vatCustom"],[1,"title-field"],[1,"form-group","orderInfo","borderless-field"],["type","text","name","OrderId","id","OrderId","placeholder","M\xe3 \u0111\u01a1n...",1,"orderField","small-height",3,"ngModel","readonly","ngModelChange"],["href","javascript:void(0)","onclick","openCustMenu()","type","button",1,"btn","main-btn","w-100",2,"margin-bottom","1vh"],[1,"row","col-xs-12",2,"height","62px","padding-left","15px","padding-right","15px"],[1,"addInfo",2,"width","50%","padding-right","5px"],[1,"form-group","orderInfo","borderless-field",2,"margin-bottom","1vh"],["type","number","name","PercentDiscount","id","PercentDiscount","placeholder","%",1,"orderField","small-height",3,"ngModel","input","ngModelChange"],[1,"addInfo",2,"width","50%","padding-left","5px"],["type","tel","name","AmountDiscount","id","AmountDiscount","placeholder","0",1,"orderField","small-height",3,"ngModel","ngModelChange","input","focus"],["type","text","name","wishingDoneTime","id","wishingDoneTime","placeholder","",1,"orderField","small-height",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],[1,"orderDetail","cusScroll"],["class","orderDetailItem",4,"ngFor","ngForOf"],["type","checkbox","id","VATIncluded","name","VATIncluded","value","1",1,"custom-checkbox",3,"ngModel","change","ngModelChange"],[1,"orderTotal"],[1,"totalOld"],[1,"orderPrice"],[1,"totalNew"],[1,"totalExc"],["href","javascript:void(0)","type","button",1,"btn","main-btn","w-100",2,"margin-top","2vh",3,"click"],[1,"row","orderConfirm","text-center"],[1,"col-4","exchange"],[1,"btn","main-bg","w-100",3,"click"],["src","../../../../assets/images/money.svg","alt","\u0110\u1ed5i \u0111i\u1ec3m",1,"main-filter"],[1,"col-8","pl-0"],["href","javascript:void(0)","type","submit",1,"btn","main-btn","w-100",3,"click"],["id","exchangeAdd",1,"popup-content"],["action","",1,""],[1,"form-group"],["for","",1,"excLabel"],[1,"memberLevel","v"],[1,""],["type","number","name","","id","exchange-val","placeholder","S\u1ed1 \u0111i\u1ec3m mu\u1ed1n \u0111\u1ed5i...",1,"mainForm"],[1,"row"],[1,"col-8","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-3","exchange-confirm"],["id","recentInfo",1,"actionMenu2"],["style","height: 69px;text-align: left;",3,"click",4,"ngFor","ngForOf"],["id","purchase-dialog",1,"popup-content"],[1,"checkOut",2,"margin-top","0px","padding","0px"],[1,"checkOutTotal"],[1,"checkOutLeft","mb-2"],["for","currentPayAmount",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","currentPayAmount","id","currentPayAmount",1,"mainForm",3,"ngModel","input","focus","ngModelChange"],["for","Note",2,"width","100%","text-align","left","margin-bottom","0px"],["type","text","name","purchaseNote","id","purchaseNote",1,"mainForm",3,"ngModel","ngModelChange"],[1,"form-group","methodGrid","mb-0"],["href","javascript:void(0)",1,"methodItem",3,"ngClass","click"],["src","../../../../assets/images/momo.jpg","alt",""],["src","../../../../assets/images/banking.jpg","alt",""],["src","../../../../assets/images/cash.png","alt",""],[1,"col-12","mx-auto","text-center"],["type","button",1,"btn","main-btn","w-100",3,"click"],["id","codeQR",1,"popup-content"],[3,"value","size"],["type","button","id","submit-btn","onClick","qrDone()",1,"btn","main-btn","w-100","mt-3"],[1,"orderDetailItem"],[1,"itemNumb"],[1,"itemDetail"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPrice"],[1,"prodCharge"],[1,"itemAction"],[3,"click"],["src","../../../../assets/images/delete.svg","alt","",1,"white-filter"],["src","../../../../assets/images/edit.svg","alt","",1,"white-filter"],[2,"height","69px","text-align","left",3,"click"],[1,"recentInfo-name"],[1,"recentInfo-phone",2,"width","25%"],[1,"recentInfo-date",2,"width","75%"]],template:function(e,t){if(1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.hc(4,"a",4),f.cc(5,"img",5),f.hc(6,"marquee",6),f.Rc(7),f.gc(),f.gc(),f.gc(),f.hc(8,"div",7),f.hc(9,"a",8),f.pc("click",(function(){return t.addNewOrderDetail()})),f.cc(10,"img",9),f.gc(),f.gc(),f.gc(),f.hc(11,"div",10),f.hc(12,"p"),f.Rc(13,"\xc1p d\u1ee5ng khuy\u1ebfn m\xe3i th\xe0nh vi\xean"),f.gc(),f.hc(14,"div",11),f.hc(15,"input",12),f.pc("change",(function(){return t.onMemberDiscountChange()}))("ngModelChange",(function(e){return t.order.IsMemberDiscountApply=e})),f.gc(),f.cc(16,"span",13),f.gc(),f.gc(),f.hc(17,"label",14),f.Rc(18,"M\xe3 \u0111\u01a1n "),f.gc(),f.hc(19,"div",15),f.hc(20,"input",16),f.pc("ngModelChange",(function(e){return t.order.OrderId=e})),f.gc(),f.gc(),f.hc(21,"a",17),f.Rc(22,"\xc1p d\u1ee5ng khuy\u1ebfn m\xe3i"),f.gc(),f.hc(23,"div",18),f.hc(24,"div",19),f.hc(25,"label",14),f.Rc(26,"Gi\u1ea3m gi\xe1 ph\u1ea7n tr\u0103m"),f.gc(),f.hc(27,"div",20),f.hc(28,"input",21),f.pc("input",(function(e){return t.onDiscountChanged(e.target.value)}))("ngModelChange",(function(e){return t.order.PercentDiscount=e})),f.gc(),f.gc(),f.gc(),f.hc(29,"div",22),f.hc(30,"label",14),f.Rc(31,"Gi\u1ea3 gi\xe1 ti\u1ec1n"),f.gc(),f.hc(32,"div",15),f.hc(33,"input",23),f.pc("ngModelChange",(function(e){return t.order.AmountDiscount=e}))("input",(function(e){return t.onAmountDiscountChanged(e.target.value)}))("focus",(function(){return t.onAmountDiscountFocus()})),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(34,"label",14),f.Rc(35,"Th\u1eddi gian nh\u1eadn d\u1ef1 ki\u1ebfn"),f.gc(),f.hc(36,"div",15),f.hc(37,"input",24),f.pc("ngModelChange",(function(e){return t.wishingDoneTime=e})),f.gc(),f.cc(38,"owl-date-time",25,26),f.gc(),f.hc(40,"ul",27),f.Pc(41,V,26,16,"li",28),f.gc(),f.hc(42,"div",10),f.hc(43,"p"),f.Rc(44,"Bao g\u1ed3m VAT"),f.gc(),f.hc(45,"div",11),f.hc(46,"input",29),f.pc("change",(function(){return t.onVATIncludedChange()}))("ngModelChange",(function(e){return t.order.VATIncluded=e})),f.gc(),f.cc(47,"span",13),f.gc(),f.gc(),f.hc(48,"div",30),f.hc(49,"p",31),f.Rc(50,"C\xf2n l\u1ea1i: "),f.hc(51,"span",32),f.Rc(52),f.uc(53,"myCurrPipe"),f.gc(),f.gc(),f.hc(54,"p",33),f.Rc(55,"Th\xe0nh ti\u1ec1n: "),f.hc(56,"span",32),f.Rc(57),f.uc(58,"myCurrPipe"),f.gc(),f.gc(),f.hc(59,"p",34),f.Rc(60,"\u0110\u1ed5i \u0111i\u1ec3m: "),f.hc(61,"span",32),f.Rc(62),f.gc(),f.gc(),f.gc(),f.hc(63,"a",35),f.pc("click",(function(){return t.completingOrder()})),f.Rc(64," K\u1ebft th\xfac \u0111\u01a1n"),f.gc(),f.hc(65,"div",36),f.hc(66,"div",37),f.hc(67,"button",38),f.pc("click",(function(){return t.scoreExchange()})),f.cc(68,"img",39),f.gc(),f.gc(),f.hc(69,"div",40),f.hc(70,"a",41),f.pc("click",(function(){return t.placeOrder(!1)})),f.Rc(71,"L\u01b0u"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(72,"div",42),f.hc(73,"form",43),f.hc(74,"div",44),f.hc(75,"label",45),f.Rc(76,"Th\xe0nh vi\xean: "),f.gc(),f.hc(77,"span",46),f.Rc(78),f.gc(),f.gc(),f.hc(79,"div",44),f.hc(80,"label",45),f.Rc(81,"\u0110i\u1ec3m t\xedch l\u0169y: "),f.gc(),f.hc(82,"span",47),f.Rc(83),f.gc(),f.gc(),f.hc(84,"div",44),f.cc(85,"input",48),f.gc(),f.hc(86,"div",49),f.hc(87,"div",50),f.hc(88,"button",51),f.Rc(89,"\u0110\u1ed5i \u0111i\u1ec3m"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(90,"div",52),f.hc(91,"ul"),f.Pc(92,j,9,9,"li",53),f.gc(),f.gc(),f.hc(93,"div",54),f.hc(94,"div",1),f.hc(95,"div",55),f.hc(96,"div",56),f.hc(97,"h3"),f.Rc(98,"T\u1ed5ng"),f.gc(),f.hc(99,"p"),f.Rc(100),f.uc(101,"myCurrPipe"),f.gc(),f.gc(),f.hc(102,"div",57),f.hc(103,"h4"),f.Rc(104,"S\u1ed1 ti\u1ec1n c\xf2n l\u1ea1i"),f.gc(),f.hc(105,"p"),f.Rc(106),f.uc(107,"myCurrPipe"),f.gc(),f.gc(),f.hc(108,"div",44),f.hc(109,"label",58),f.Rc(110,"S\u1ed1 ti\u1ec1n thanh to\xe1n"),f.gc(),f.hc(111,"input",59),f.pc("input",(function(e){return t.onPayChanged(e.target.value)}))("focus",(function(){return t.onPayFocus()}))("ngModelChange",(function(e){return t.currentPayAmount=e})),f.gc(),f.gc(),f.hc(112,"div",44),f.hc(113,"label",60),f.Rc(114,"Ghi Ch\xfa"),f.gc(),f.hc(115,"input",61),f.pc("ngModelChange",(function(e){return t.purchaseNote=e})),f.gc(),f.gc(),f.hc(116,"div",62),f.hc(117,"a",63),f.pc("click",(function(){return t.selectPurType(t.purchaseType.Momo)})),f.cc(118,"img",64),f.gc(),f.hc(119,"a",63),f.pc("click",(function(){return t.selectPurType(t.purchaseType.Banking)})),f.cc(120,"img",65),f.gc(),f.hc(121,"a",63),f.pc("click",(function(){return t.selectPurType(t.purchaseType.Cash)})),f.cc(122,"img",66),f.gc(),f.gc(),f.hc(123,"div",49),f.hc(124,"div",67),f.hc(125,"button",68),f.pc("click",(function(){return t.purchaseConfirm()})),f.Rc(126,"X\xe1c nh\u1eadn"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(127,"div",69),f.hc(128,"span"),f.Rc(129,"Qu\xe9t m\xe3 QR \u0111\u1ec3 thanh to\xe1n "),f.gc(),f.hc(130,"div"),f.cc(131,"qr-code",70),f.gc(),f.hc(132,"div",49),f.hc(133,"div",67),f.hc(134,"button",71),f.Rc(135,"Xong"),f.gc(),f.gc(),f.gc(),f.gc()),2&e){var c=f.Hc(39);f.Ob(7),f.Uc("",t.order.CustomerInfo.Name," (-",t.order.CustomerInfo.DiscountPercent,"%)"),f.Ob(8),f.Ac("ngModel",t.order.IsMemberDiscountApply),f.Ob(5),f.Ac("ngModel",t.order.OrderId)("readonly",t.isEdittingOrder),f.Ob(8),f.Ac("ngModel",t.order.PercentDiscount),f.Ob(5),f.Ac("ngModel",t.order.AmountDiscount),f.Ob(4),f.Ac("owlDateTime",c)("owlDateTimeTrigger",c)("ngModel",t.wishingDoneTime),f.Ob(1),f.Ac("stepMinute",5),f.Ob(3),f.Ac("ngForOf",t.order.OrderDetails),f.Ob(5),f.Ac("ngModel",t.order.VATIncluded),f.Ob(6),f.Tc("",f.vc(53,28,t.AcctualBalance)," "),f.Ob(5),f.Tc("",f.vc(58,30,t.order.TotalAmount)," "),f.Ob(5),f.Sc(t.order.CustomerInfo.ScoreUsed),f.Ob(16),f.Sc(t.memberShipTitle),f.Ob(5),f.Sc(t.order.CustomerInfo.AvailableScore),f.Ob(9),f.Ac("ngForOf",t.promotions),f.Ob(8),f.Sc(f.vc(101,32,t.order.TotalAmount)),f.Ob(6),f.Sc(f.vc(107,34,t.totalBalance)),f.Ob(5),f.Ac("ngModel",t.currentPayAmount),f.Ob(4),f.Ac("ngModel",t.purchaseNote),f.Ob(2),f.Ac("ngClass","Momo"===t.currentPurType?" img-purchase-selected":""),f.Ob(2),f.Ac("ngClass","Banking"===t.currentPurType?" img-purchase-selected":""),f.Ob(2),f.Ac("ngClass","Cash"===t.currentPurType?" img-purchase-selected":""),f.Ob(10),f.Ac("value",t.qrContent)("size",290)}},directives:[l.c,B.a,B.k,B.n,B.b,B.p,U.c,U.f,U.b,D.k,B.v,B.l,B.m,D.j,H.a],pipes:[E.a,q.a,E.b],styles:[""]}),J),W=r("uP5C"),X=r("e6qa");function Q(e,t){if(1&e){var c=f.ic();f.hc(0,"a",7),f.pc("click",(function(){return f.Jc(c),f.tc().openFileForShare()})),f.Rc(1,"Ch\u1ecdn h\xecnh"),f.gc()}}function $(e,t){if(1&e){var c=f.ic();f.hc(0,"a",7),f.pc("click",(function(){return f.Jc(c),f.tc().openFile()})),f.Rc(1,"Ch\u1ecdn h\xecnh"),f.gc()}}function z(e,t){if(1&e){var c=f.ic();f.hc(0,"div"),f.hc(1,"input",8,9),f.pc("change",(function(e){return f.Jc(c),f.tc().onChange(e)})),f.gc(),f.hc(3,"a",7),f.pc("click",(function(){return f.Jc(c),f.Hc(2).click()})),f.Rc(4,"Ch\u1ecdn h\xecnh"),f.gc(),f.gc()}}function _(e,t){if(1&e){var c=f.ic();f.hc(0,"a",7),f.pc("click",(function(){return f.Jc(c),f.tc().shareForCus()})),f.Rc(1,"Share cho KH"),f.gc()}}function K(e,t){if(1&e){var c=f.ic();f.hc(0,"a",7),f.pc("click",(function(){return f.Jc(c),f.tc().confirm("")})),f.Rc(1,"X\xe1c nh\u1eadn"),f.gc()}}function Z(e,t){if(1&e){var c=f.ic();f.hc(0,"a",7),f.pc("click",(function(){return f.Jc(c),f.tc().shipperCofirm()})),f.Rc(1,"X\xe1c nh\u1eadn"),f.gc()}}var Y,ee,te=((Y=function(e){n(i,e);var t=o(i);function i(e,c,n,r){var o;return h(this,i),(o=t.call(this)).orderDetailService=e,o.customerService=c,o.router=n,o.orderService=r,o.Title="X\xe1c nh\u1eadn v\u1edbi kh\xe1ch h\xe0ng",o.edittingImageUrl="",o.orderDetail=new P.c,o.order=new P.d,o.customer=new W.a,o}return d(i,[{key:"Init",value:function(){var e=this;this.orderDetail=this.globalOrderDetail,this.orderService.getById(this.orderDetail.OrderId).then((function(t){e.order=t,e.customerService.getById(e.order.CustomerInfo.Id).then((function(t){e.customer=t}))}))}},{key:"fileChosen",value:function(e){this.edittingImageUrl="data:image/png;base64,"+e}},{key:"onChange",value:function(e){var t=this,c=e.target.files[0];if(c)if(null!=c.type.match(/image\/*/)){var i=new FileReader;i.readAsDataURL(c),i.onload=function(e){t.edittingImageUrl=i.result.toString()}}else this.showError("Ph\u1ea3i ch\u1ecdn h\xecnh !!")}},{key:"destroy",value:function(){c(u(i.prototype),"destroy",this).call(this),deleteTempImage()}},{key:"shipperCofirm",value:function(){var e=this;getShippingNoteDialog("X\xe1c nh\u1eadn",(function(t){e.confirm(t)}))}},{key:"confirm",value:function(e){var t=this;switch(this.CurrentUser.Role){case A.i.Account:case A.i.Admin:""!==this.edittingImageUrl?fetch(this.edittingImageUrl).then((function(e){return e.blob()})).then((function(e){var c=new File([e],"result.png",{type:"image/png"});t.orderDetailService.resultConfirm(t.orderDetail.OrderDetailId,t.orderDetailService.getLastestMaking(t.orderDetail).Id,c).then((function(e){t.router.navigate(["staff/account-main"])}))})):this.orderDetailService.resultConfirm(this.orderDetail.OrderDetailId,this.orderDetailService.getLastestMaking(this.orderDetail).Id,null).then((function(e){t.router.navigate(["staff/account-main"])}));break;case A.i.Shipper:""!==this.edittingImageUrl?fetch(this.edittingImageUrl).then((function(e){return e.blob()})).then((function(c){var i=new File([c],"shipping.png",{type:"image/png"});t.shippingConfirm(i,e)})):this.shippingConfirm(null,e)}}},{key:"shippingConfirm",value:function(e,t){var c=this;this.orderDetailService.shippingConfirm(this.orderDetail,null,t).then((function(e){c.orderDetailService.completeOD(c.orderDetail,c.order).then((function(){c.router.navigate(["staff/shipper-main"])}))}))}},{key:"shareForCus",value:function(){""!==this.edittingImageUrl&&(this.IsOnTerminal?shareImageCus(k.a.getMainContact(this.customer)):shareImageCusWithData(this.edittingImageUrl,k.a.getMainContact(this.customer)))}}]),i}(C)).\u0275fac=function(e){return new(e||Y)(f.bc(X.a),f.bc(F.a),f.bc(l.b),f.bc(M.a))},Y.\u0275cmp=f.Vb({type:Y,selectors:[["app-customer-confirm"]],features:[f.Lb],decls:11,vars:7,consts:[["id","staff",1,"page-content"],[1,"container"],[1,"image-top"],["id","selected-image","onclick","rotateImage()","alt","",3,"src"],[1,"image-action"],["href","javascript:void(0)","class","main-bg",3,"click",4,"ngIf"],[4,"ngIf"],["href","javascript:void(0)",1,"main-bg",3,"click"],["type","file","id","resultFile","name","uploadedFile","hidden","",1,"img-cover","file-upload-default",3,"change"],["imageUpload",""]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.cc(3,"img",3),f.gc(),f.hc(4,"div",4),f.Pc(5,Q,2,0,"a",5),f.Pc(6,$,2,0,"a",5),f.Pc(7,z,5,0,"div",6),f.Pc(8,_,2,0,"a",5),f.Pc(9,K,2,0,"a",5),f.Pc(10,Z,2,0,"a",5),f.gc(),f.gc(),f.gc()),2&e&&(f.Ob(3),f.Ac("src",t.edittingImageUrl,f.Lc),f.Ob(2),f.Ac("ngIf",t.IsOnTerminal&&"Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf",t.IsOnTerminal&&"Shipper"==t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf",!t.IsOnTerminal),f.Ob(1),f.Ac("ngIf","Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Shipper"==t.CurrentUser.Role))},directives:[D.l],styles:[""]}),Y),ce=r("AytR"),ie=r("dkQB"),ne=((ee=function(){function e(t){h(this,e),this.globalService=t}return d(e,[{key:"pushFileToStorage",value:function(e,t,c){}},{key:"push",value:function(e,t,c){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","");case 1:case"end":return e.stop()}}),e)})))}},{key:"deleteFile",value:function(e,t){}},{key:"downloadFIle",value:function(e,t){var c=new XMLHttpRequest;c.responseType="blob",c.onload=function(e){t(c.response)},c.open("GET",e),c.send()}},{key:"pushStringToStorage",value:function(e,t,c){}}]),e}()).\u0275fac=function(e){return new(e||ee)(f.lc(b.a))},ee.\u0275prov=f.Xb({token:ee,factory:ee.\u0275fac,providedIn:"root"}),ee);function re(e,t){if(1&e&&(f.hc(0,"div",21),f.hc(1,"span",11),f.Rc(2,"SDT ng\u01b0\u1eddi nh\u1eadn:"),f.gc(),f.hc(3,"span",12),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(4),f.Sc(c.orderDetail.DeliveryInfo.PhoneNumber)}}function oe(e,t){if(1&e&&(f.hc(0,"div",21),f.hc(1,"span",11),f.Rc(2,"\u0110\u1ecba ch\u1ec9 giao:"),f.gc(),f.hc(3,"span",12),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(4),f.Sc(c.orderDetail.DeliveryInfo.Address)}}var ae,se=((ae=function(e){n(i,e);var t=o(i);function i(e,c,n,r,o){var a;return h(this,i),(a=t.call(this)).router=e,a.orderService=c,a.orderDetailService=n,a.storageService=r,a.customerService=o,a.Title="X\xe1c nh\u1eadn giao h\xe0ng",a.sharingImage="",a}return d(i,[{key:"Init",value:function(){var e=this;this.orderDetail=this.globalOrderDetail,this.customerService.getById(this.globalOrder.CustomerInfo.Id).then((function(t){e.customer=t}))}},{key:"destroy",value:function(){c(u(i.prototype),"destroy",this).call(this),deleteTempImage()}},{key:"confirmOrderDetail",value:function(){var e=this;this.orderDetailService.completeOD(this.orderDetail,this.globalOrder).then((function(t){return Object(p.a)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.router.navigate(["staff/orders-manage"]);case 1:case"end":return e.stop()}}),e,this)})))}))}},{key:"getShippingImg",value:function(){var e=this.orderDetailService.getLastestShipping(this.orderDetail);return null!=e?e.DeliveryImageUrl:""}},{key:"getResultImg",value:function(){var e=this.orderDetailService.getLastestMaking(this.orderDetail);return null!=e?e.ResultImageUrl:""}},{key:"shareToCus",value:function(){var e=this;this.startLoading(),this.storageService.downloadFIle("".concat(ce.a.base_domain).concat(ie.b.shipping_img).concat(this.getShippingImg()),(function(t){e.stopLoading();var c=new FileReader;c.readAsDataURL(t),c.onloadend=function(){var t=c.result.toString();e.sharingImage=t,shareImageCusWithData(e.sharingImage,k.a.getMainContact(e.customer))}}))}}]),i}(C)).\u0275fac=function(e){return new(e||ae)(f.bc(l.b),f.bc(M.a),f.bc(X.a),f.bc(ne),f.bc(F.a))},ae.\u0275cmp=f.Vb({type:ae,selectors:[["app-final-confirm"]],features:[f.Lb],decls:63,vars:31,consts:[["id","deliConfirm",1,"page-content"],[1,"container"],[1,"prodDetail"],[1,"prodGen"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPrice"],[1,"prodCharge"],[1,"prodInfo","cusScroll"],[1,"prodQuan","infoGroup"],[1,"itemlabel"],[1,"itemVal"],[1,"prodName","infoGroup"],[1,"prodTime","infoGroup"],["class","prodAddr infoGroup",4,"ngIf"],[1,"prodDesc","infoGroup"],[1,"row"],[1,"col-10","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-2",3,"click"],["type","submit",1,"btn","grey-btn","w-100","mt-2",3,"click"],[1,"prodAddr","infoGroup"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.cc(4,"img",4),f.uc(5,"ImgPipe"),f.cc(6,"img",4),f.uc(7,"ImgPipe"),f.hc(8,"div",5),f.hc(9,"h5",6),f.Rc(10),f.gc(),f.hc(11,"span",7),f.Rc(12),f.uc(13,"myCurrPipe"),f.gc(),f.hc(14,"span",8),f.Rc(15),f.gc(),f.hc(16,"span",8),f.Rc(17),f.uc(18,"myCurrPipe"),f.gc(),f.hc(19,"span",8),f.Rc(20),f.uc(21,"myCurrPipe"),f.gc(),f.gc(),f.gc(),f.hc(22,"div",9),f.hc(23,"div",10),f.hc(24,"span",11),f.Rc(25,"M\xe3 \u0111\u01a1n: "),f.gc(),f.hc(26,"span",12),f.Rc(27),f.gc(),f.gc(),f.hc(28,"div",13),f.hc(29,"span",11),f.Rc(30,"T\xean KH"),f.gc(),f.hc(31,"span",12),f.Rc(32),f.gc(),f.gc(),f.hc(33,"div",13),f.hc(34,"span",11),f.Rc(35,"SDT KH"),f.gc(),f.hc(36,"span",12),f.Rc(37),f.gc(),f.gc(),f.hc(38,"div",14),f.hc(39,"span",11),f.Rc(40,"Th\u1eddi gian giao:"),f.gc(),f.hc(41,"span",12),f.Rc(42),f.uc(43,"date"),f.gc(),f.gc(),f.hc(44,"div",13),f.hc(45,"span",11),f.Rc(46,"T\xean ng\u01b0\u1eddi nh\u1eadn:"),f.gc(),f.hc(47,"span",12),f.Rc(48),f.gc(),f.gc(),f.Pc(49,re,5,1,"div",15),f.Pc(50,oe,5,1,"div",15),f.hc(51,"div",16),f.hc(52,"span",11),f.Rc(53,"M\xf4 t\u1ea3:"),f.gc(),f.hc(54,"span",12),f.Rc(55),f.gc(),f.gc(),f.gc(),f.hc(56,"div",17),f.hc(57,"div",18),f.hc(58,"button",19),f.pc("click",(function(){return t.shareToCus()})),f.Rc(59,"X\xe1c nh\u1eadn Kh\xe1ch h\xe0ng"),f.gc(),f.gc(),f.hc(60,"div",18),f.hc(61,"button",20),f.pc("click",(function(){return t.confirmOrderDetail()})),f.Rc(62,"X\xe1c nh\u1eadn"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()),2&e&&(f.Ob(4),f.Bc("src",f.wc(5,16,t.getResultImg(),"ResultImg"),f.Lc),f.Ob(2),f.Bc("src",f.wc(7,19,t.getShippingImg(),"ShippingImg"),f.Lc),f.Ob(4),f.Sc(t.orderDetail.ProductName),f.Ob(2),f.Sc(f.vc(13,22,t.orderDetail.ModifiedPrice)),f.Ob(3),f.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",t.orderDetail.Quantity,""),f.Ob(2),f.Tc("Gi\u1ea3m gi\xe1: ",f.vc(18,24,t.getDetailDiscount(t.orderDetail)),""),f.Ob(3),f.Tc("Ph\u1ee5 ph\xed: ",f.vc(21,26,t.orderDetail.AdditionalFee),""),f.Ob(7),f.Uc("",t.orderDetail.OrderId,"_",t.orderDetail.Index+1,""),f.Ob(5),f.Sc(t.orderDetail.CustomerName),f.Ob(5),f.Sc(t.orderDetail.CustomerPhoneNumber),f.Ob(5),f.Sc(f.wc(43,28,t.orderDetail.DeliveryInfo.DateTime,"HH:mm dd/MM/yyyy")),f.Ob(6),f.Sc(t.orderDetail.DeliveryInfo.FullName),f.Ob(1),f.Ac("ngIf","Florist"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Florist"!=t.CurrentUser.Role),f.Ob(5),f.Sc(t.orderDetail.Description))},directives:[D.l],pipes:[q.a,E.a,D.e],styles:[""]}),ae);function ue(e,t){if(1&e){var c=f.ic();f.hc(0,"div",10),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var i=f.tc(2);f.Ob(2),f.Sc(i.index)}}function le(e,t){if(1&e){var c=f.ic();f.hc(0,"div",11),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var i=f.tc(2);f.Ob(2),f.Sc(i.index)}}function de(e,t){if(1&e){var c=f.ic();f.hc(0,"div",12),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var i=f.tc(2);f.Ob(2),f.Sc(i.index)}}function he(e,t){if(1&e){var c=f.ic();f.hc(0,"div",13),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var i=f.tc(2);f.Ob(2),f.Sc(i.index)}}function ge(e,t){if(1&e){var c=f.ic();f.hc(0,"div",14),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var i=f.tc(2);f.Ob(2),f.Sc(i.index)}}function me(e,t){if(1&e){var c=f.ic();f.hc(0,"div",15),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var i=f.tc(2);f.Ob(2),f.Sc(i.index)}}function pe(e,t){if(1&e){var c=f.ic();f.hc(0,"div",16),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var i=f.tc(2);f.Ob(2),f.Sc(i.index)}}function fe(e,t){if(1&e){var c=f.ic();f.hc(0,"div",17),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.hc(1,"span"),f.Rc(2),f.gc(),f.gc()}if(2&e){var i=f.tc(2);f.Ob(2),f.Sc(i.index)}}function ve(e,t){if(1&e&&(f.hc(0,"div",1),f.Pc(1,ue,3,1,"div",2),f.Pc(2,le,3,1,"div",3),f.Pc(3,de,3,1,"div",4),f.Pc(4,he,3,1,"div",5),f.Pc(5,ge,3,1,"div",6),f.Pc(6,me,3,1,"div",7),f.Pc(7,pe,3,1,"div",8),f.Pc(8,fe,3,1,"div",9),f.gc()),2&e){var c=f.tc();f.Ac("ngSwitch",c.state),f.Ob(1),f.Ac("ngSwitchCase",c.states.Added),f.Ob(1),f.Ac("ngSwitchCase",c.states.Making),f.Ob(1),f.Ac("ngSwitchCase",c.states.Comfirming),f.Ob(1),f.Ac("ngSwitchCase",c.states.Completed),f.Ob(1),f.Ac("ngSwitchCase",c.states.Canceled),f.Ob(1),f.Ac("ngSwitchCase",c.states.OnTheWay),f.Ob(1),f.Ac("ngSwitchCase",c.states.SentBack),f.Ob(1),f.Ac("ngSwitchCase",c.states.Fixing)}}function be(e,t){if(1&e){var c=f.ic();f.hc(0,"div",10),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function Oe(e,t){if(1&e){var c=f.ic();f.hc(0,"div",11),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function ye(e,t){if(1&e){var c=f.ic();f.hc(0,"div",12),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function De(e,t){if(1&e){var c=f.ic();f.hc(0,"div",13),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function Ie(e,t){if(1&e){var c=f.ic();f.hc(0,"div",14),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function Se(e,t){if(1&e){var c=f.ic();f.hc(0,"div",15),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function ke(e,t){if(1&e){var c=f.ic();f.hc(0,"div",16),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function Ce(e,t){if(1&e){var c=f.ic();f.hc(0,"div",17),f.pc("click",(function(){return f.Jc(c),f.tc(2).pointClicked()})),f.cc(1,"span"),f.gc()}}function Pe(e,t){if(1&e&&(f.hc(0,"div",1),f.Pc(1,be,2,0,"div",2),f.Pc(2,Oe,2,0,"div",3),f.Pc(3,ye,2,0,"div",4),f.Pc(4,De,2,0,"div",5),f.Pc(5,Ie,2,0,"div",6),f.Pc(6,Se,2,0,"div",7),f.Pc(7,ke,2,0,"div",8),f.Pc(8,Ce,2,0,"div",9),f.gc()),2&e){var c=f.tc();f.Ac("ngSwitch",c.state),f.Ob(1),f.Ac("ngSwitchCase",c.states.Added),f.Ob(1),f.Ac("ngSwitchCase",c.states.Making),f.Ob(1),f.Ac("ngSwitchCase",c.states.Comfirming),f.Ob(1),f.Ac("ngSwitchCase",c.states.Completed),f.Ob(1),f.Ac("ngSwitchCase",c.states.Canceled),f.Ob(1),f.Ac("ngSwitchCase",c.states.OnTheWay),f.Ob(1),f.Ac("ngSwitchCase",c.states.SentBack),f.Ob(1),f.Ac("ngSwitchCase",c.states.Fixing)}}var Ae,Te=((Ae=function(){function e(){h(this,e),this.states=A.f,this.index=-1,this.id="",this.onClicked=new f.q,this.onChange=function(){},this.onTouched=function(){}}return d(e,[{key:"ngOnInit",value:function(){}},{key:"pointClicked",value:function(){this.onClicked.emit(this.id)}},{key:"preventEvent",value:function(e){e.stopPropagation()}},{key:"writeValue",value:function(e){}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"updateChanges",value:function(){this.onChange()}}]),e}()).\u0275fac=function(e){return new(e||Ae)},Ae.\u0275cmp=f.Vb({type:Ae,selectors:[["app-status-point"]],inputs:{state:"state",index:"index",id:"id"},outputs:{onClicked:"onClicked"},features:[f.Nb([{provide:B.j,useExisting:Object(f.fb)((function(){return Ae})),multi:!0}])],decls:2,vars:2,consts:[[3,"ngSwitch",4,"ngIf"],[3,"ngSwitch"],["class","item-status pi",3,"click",4,"ngSwitchCase"],["class","item-status o",3,"click",4,"ngSwitchCase"],["class","item-status y",3,"click",4,"ngSwitchCase"],["class","item-status g",3,"click",4,"ngSwitchCase"],["class","item-status x",3,"click",4,"ngSwitchCase"],["class","item-status on-the-way",3,"click",4,"ngSwitchCase"],["class","item-status send-back",3,"click",4,"ngSwitchCase"],["class","item-status fixing",3,"click",4,"ngSwitchCase"],[1,"item-status","pi",3,"click"],[1,"item-status","o",3,"click"],[1,"item-status","y",3,"click"],[1,"item-status","g",3,"click"],[1,"item-status","x",3,"click"],[1,"item-status","on-the-way",3,"click"],[1,"item-status","send-back",3,"click"],[1,"item-status","fixing",3,"click"]],template:function(e,t){1&e&&(f.Pc(0,ve,9,9,"div",0),f.Pc(1,Pe,9,9,"div",0)),2&e&&(f.Ac("ngIf",t.index>-1),f.Ob(1),f.Ac("ngIf",-1==t.index))},directives:[D.l,D.n,D.o],styles:[""]}),Ae);function we(e,t){if(1&e){var c=f.ic();f.hc(0,"div",18),f.hc(1,"div",19),f.hc(2,"span",20),f.Rc(3),f.gc(),f.hc(4,"div",21),f.hc(5,"h4",22),f.Rc(6),f.gc(),f.hc(7,"span",23),f.Rc(8),f.gc(),f.gc(),f.cc(9,"app-status-point",24),f.gc(),f.hc(10,"div",25),f.hc(11,"ul",26),f.hc(12,"li",27),f.hc(13,"div",28),f.pc("click",(function(){f.Jc(c);var e=t.$implicit;return f.tc().getMenu(e)})),f.cc(14,"img",29),f.uc(15,"ImgPipe"),f.hc(16,"div",30),f.hc(17,"span",31),f.Rc(18),f.uc(19,"myCurrPipe"),f.gc(),f.hc(20,"span",32),f.Rc(21),f.uc(22,"myCurrPipe"),f.gc(),f.hc(23,"span",32),f.Rc(24),f.uc(25,"myCurrPipe"),f.gc(),f.hc(26,"span",33),f.Rc(27),f.gc(),f.hc(28,"span",34),f.Rc(29),f.uc(30,"myTimePipe"),f.gc(),f.hc(31,"span",35),f.Rc(32),f.uc(33,"myDatePipe"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var i=t.$implicit,n=t.index,r=f.tc();f.Ob(3),f.Uc("",i.OrderId,"_",i.Index+1,""),f.Ob(3),f.Sc(i.ProductName),f.Ob(2),f.Uc("",i.CustomerName,"-",i.CustomerPhoneNumber,""),f.Ob(1),f.Ac("state",i.State)("id",i.OrderDetailId)("index",n+1),f.Ob(5),f.Bc("src",f.wc(15,15,i.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(f.vc(19,18,i.ModifiedPrice)),f.Ob(3),f.Tc("Ph\u1ee5 ph\xed: ",f.vc(22,20,i.AdditionalFee),""),f.Ob(3),f.Tc("Gi\u1ea3m gi\xe1: ",f.vc(25,22,r.getDetailDiscount(i)),""),f.Ob(3),f.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",i.Quantity,""),f.Ob(2),f.Tc("",f.vc(30,24,i.MakingRequestTime)," "),f.Ob(3),f.Tc(" ",f.vc(33,26,i.MakingRequestTime),"")}}function Re(e,t){if(1&e){var c=f.ic();f.hc(0,"div",36),f.hc(1,"div",19),f.hc(2,"span",20),f.Rc(3),f.gc(),f.hc(4,"div",21),f.hc(5,"h4",22),f.Rc(6),f.gc(),f.hc(7,"span",23),f.Rc(8),f.gc(),f.gc(),f.cc(9,"app-status-point",24),f.gc(),f.hc(10,"div",25),f.hc(11,"ul",26),f.hc(12,"li",27),f.hc(13,"div",28),f.pc("click",(function(){f.Jc(c);var e=t.$implicit;return f.tc().getMenu(e)})),f.cc(14,"img",29),f.uc(15,"ImgPipe"),f.hc(16,"div",30),f.hc(17,"span",31),f.Rc(18),f.uc(19,"myCurrPipe"),f.gc(),f.hc(20,"span",32),f.Rc(21),f.uc(22,"myCurrPipe"),f.gc(),f.hc(23,"span",32),f.Rc(24),f.uc(25,"myCurrPipe"),f.gc(),f.hc(26,"span",33),f.Rc(27),f.gc(),f.hc(28,"span",34),f.Rc(29),f.uc(30,"myTimePipe"),f.gc(),f.hc(31,"span",35),f.Rc(32),f.uc(33,"myDatePipe"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var i=t.$implicit,n=t.index,r=f.tc();f.Ac("ngClass","Making"===i.State||"Fixing"===i.State?"selected-order-detail":""),f.Ob(3),f.Uc("",i.OrderId,"_",i.Index+1,""),f.Ob(3),f.Sc(i.ProductName),f.Ob(2),f.Uc("",i.CustomerName,"-",i.CustomerPhoneNumber,""),f.Ob(1),f.Ac("state",i.State)("id",i.OrderDetailId)("index",n+1),f.Ob(5),f.Bc("src",f.wc(15,16,i.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(f.vc(19,19,i.ModifiedPrice)),f.Ob(3),f.Tc("Ph\u1ee5 ph\xed: ",f.vc(22,21,i.AdditionalFee),""),f.Ob(3),f.Tc("Gi\u1ea3m gi\xe1: ",f.vc(25,23,r.getDetailDiscount(i)),""),f.Ob(3),f.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",i.Quantity,""),f.Ob(2),f.Tc("",f.vc(30,25,i.MakingRequestTime)," "),f.Ob(3),f.Tc(" ",f.vc(33,27,i.MakingRequestTime),"")}}var Me,Fe=((Me=function(e){n(c,e);var t=o(c);function c(e,i){var n;return h(this,c),(n=t.call(this)).router=e,n.orderDetailService=i,n.Title="Th\u1ee3 c\u1eafm hoa",n.NavigateClass="nav-icon ",n.IsDataLosingWarning=!1,n.waitingMenuItems=["Nh\u1eadn \u0111\u01a1n","Ho\xe0n th\xe0nh \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],n.makingMenuItems=["Ho\xe0n th\xe0nh \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],n}return d(c,[{key:"OnBackNaviage",value:function(){customerSupport()}},{key:"logout",value:function(){var e=this;this.authService.logOut((function(t){t&&e.router.navigate(["staff/login"])}))}},{key:"Init",value:function(){this.loadWaitingDetails(),this.loadMakingDetails(),this.askForRememberPassword()}},{key:"viewDetail",value:function(e){this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}},{key:"loadWaitingDetails",value:function(){var e=this;this.waitingOrderDetails=[],this.orderDetailService.getDetailWithTimeSort([A.f.Added,A.f.SentBack],"MakingRequestTime").then((function(t){e.waitingOrderDetails=t}))}},{key:"loadMakingDetails",value:function(){var e=this;this.makingOrderDetails=[],this.orderDetailService.getMakingOrderDetails(this.CurrentUser.Id).then((function(t){e.makingOrderDetails=t}))}},{key:"completeOD",value:function(e){var t=this;this.openConfirm("ch\u1eafc ch\u1eafn ho\xe0n th\xe0nh \u0111\u01a1n?",(function(){t.orderDetailService.updateMakingFields(t.orderDetailService.getLastestMaking(e).Id,{CompleteTime:(new Date).getTime()}).then((function(){t.orderDetailService.updateFields(e.OrderDetailId,{State:A.f.Comfirming}).then((function(){t.loadMakingDetails(),t.loadWaitingDetails()}))}))}))}},{key:"getMenu",value:function(e){var t,c=this;switch(console.log(e.State),e.State){case A.f.Added:case A.f.SentBack:t=this.waitingMenuItems;break;case A.f.Making:case A.f.Fixing:t=this.makingMenuItems}menuOpen((function(t){switch(+t){case 0:switch(e.State){case A.f.Added:case A.f.SentBack:c.orderDetailService.updateDetailSeen(e.OrderDetailId,c.CurrentUser.Id,(new Date).getTime()).then((function(t){var i=A.c.Making;i=e.State==A.f.Added?A.c.Making:A.c.Fixing,c.orderDetailService.assignSingleMaking(e.OrderDetailId,c.CurrentUser.Id,(new Date).getTime(),i).then((function(){c.loadMakingDetails(),c.loadWaitingDetails()}))}));break;case A.f.Making:case A.f.Fixing:c.completeOD(e)}break;case 1:switch(e.State){case A.f.Added:case A.f.SentBack:c.orderDetailService.updateDetailSeen(e.OrderDetailId,c.CurrentUser.Id,(new Date).getTime()).then((function(t){var i=A.c.Making;i=e.State==A.f.Added?A.c.Making:A.c.Fixing,c.orderDetailService.assignSingleMaking(e.OrderDetailId,c.CurrentUser.Id,(new Date).getTime(),i).then((function(t){c.orderDetailService.updateMakingFields(t.Id,{CompleteTime:(new Date).getTime()}).then((function(){c.orderDetailService.updateFields(e.OrderDetailId,{State:A.f.Comfirming}).then((function(){c.loadMakingDetails(),c.loadWaitingDetails()}))}))}))}));break;default:c.globalOrderDetail=e,c.router.navigate(["staff/order-detail-view"])}break;case 2:c.globalOrderDetail=e,c.router.navigate(["staff/order-detail-view"])}}),t)}}]),c}(C)).\u0275fac=function(e){return new(e||Me)(f.bc(l.b),f.bc(X.a))},Me.\u0275cmp=f.Vb({type:Me,selectors:[["app-florist-main"]],features:[f.Lb],decls:27,vars:9,consts:[["id","arrange",1,"page-content"],[1,"container"],["id","listNav","role","tablist",1,"nav","nav-tabs","row"],[1,"nav-item","col-6"],["id","nav1","data-toggle","tab","href","#camhoa","role","tab","aria-controls","camhoa","aria-selected","true",1,"active","main-bg"],["id","nav2","data-toggle","tab","href","#giaohoa","role","tab","aria-controls","giaohoa","aria-selected","false",1,"main-bg"],["id","listContent",1,"tab-content","order-list-bot"],["id","camhoa","role","tabpanel","aria-labelledby","nav1",1,"tab-pane","fade","show","active"],[1,"order-content","cusScroll"],["class","order-content-item product-item",4,"ngFor","ngForOf"],["id","giaohoa","role","tabpanel","aria-labelledby","nav2",1,"tab-pane","fade"],["class","order-content-item product-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"customer-support"],["alt","",1,"customer-avatar",3,"src"],[1,"customer-name"],["href","tel:0000",1,"customer-phone"],[1,"customer-position"],["id","logoutBtn",1,"customer-position",3,"click"],[1,"order-content-item","product-item"],[1,"item-top"],[1,"item-code"],[1,"item-info"],[1,"item-name"],[1,"item-quantity"],[3,"state","id","index"],[1,"item-bot"],[1,"order-product-list","cusScroll"],[1,""],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"prodPrice"],[1,"prodCharge"],[1,"item-address"],[1,"item-time"],[1,"item-date"],[1,"order-content-item","product-item",3,"ngClass"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"ul",2),f.hc(3,"li",3),f.hc(4,"a",4),f.Rc(5,"Ch\u1edd c\u1eafm"),f.gc(),f.gc(),f.hc(6,"li",3),f.hc(7,"a",5),f.Rc(8,"\u0110ang c\u1eafm"),f.gc(),f.gc(),f.gc(),f.hc(9,"div",6),f.hc(10,"div",7),f.hc(11,"ul",8),f.Pc(12,we,34,28,"div",9),f.gc(),f.gc(),f.hc(13,"div",10),f.hc(14,"ul",8),f.Pc(15,Re,34,29,"div",11),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(16,"div",12),f.cc(17,"img",13),f.uc(18,"ImgPipe"),f.hc(19,"p",14),f.Rc(20),f.gc(),f.hc(21,"a",15),f.Rc(22),f.gc(),f.hc(23,"p",16),f.Rc(24),f.gc(),f.hc(25,"p",17),f.pc("click",(function(){return t.logout()})),f.Rc(26,"\u0110\u0103ng xu\u1ea5t"),f.gc(),f.gc()),2&e&&(f.Ob(12),f.Ac("ngForOf",t.waitingOrderDetails),f.Ob(3),f.Ac("ngForOf",t.makingOrderDetails),f.Ob(2),f.Bc("src",f.wc(18,6,t.CurrentUser.Avt,"UserAvt"),f.Lc),f.Ob(3),f.Sc(t.CurrentUser.FullName),f.Ob(2),f.Sc(t.CurrentUser.PhoneNumber),f.Ob(2),f.Sc(t.CurrentUser.Role))},directives:[D.k,Te,D.j],pipes:[q.a,E.a,E.c,E.b],styles:[""]}),Me);function Ne(e,t){1&e&&(f.hc(0,"span",15),f.Rc(1,"\u0110\xe3 bao g\u1ed3m"),f.gc())}function xe(e,t){1&e&&(f.hc(0,"span",15),f.Rc(1,"Ch\u01b0a bao g\u1ed3m"),f.gc())}function Le(e,t){if(1&e&&(f.hc(0,"div",22),f.hc(1,"span",14),f.Rc(2,"VAT: "),f.gc(),f.Pc(3,Ne,2,0,"span",23),f.Pc(4,xe,2,0,"span",23),f.gc()),2&e){var c=f.tc();f.Ob(3),f.Ac("ngIf",c.orderDetail.IsVATIncluded),f.Ob(1),f.Ac("ngIf",!c.orderDetail.IsVATIncluded)}}function Be(e,t){if(1&e&&(f.hc(0,"div",24),f.hc(1,"span",14),f.Rc(2,"T\xean KH"),f.gc(),f.hc(3,"span",15),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(4),f.Sc(c.orderDetail.CustomerName)}}function Ue(e,t){if(1&e&&(f.hc(0,"div",24),f.hc(1,"span",14),f.Rc(2,"T\xean ng\u01b0\u1eddi nh\u1eadn"),f.gc(),f.hc(3,"span",15),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(4),f.Sc(c.orderDetail.DeliveryInfo.FullName)}}function He(e,t){if(1&e&&(f.hc(0,"div",24),f.hc(1,"span",14),f.Rc(2,"SDT KH"),f.gc(),f.hc(3,"span",15),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(4),f.Sc(c.orderDetail.CustomerPhoneNumber)}}function Ee(e,t){if(1&e&&(f.hc(0,"div",24),f.hc(1,"span",14),f.Rc(2,"SDT ng\u01b0\u1eddi nh\u1eadn"),f.gc(),f.hc(3,"span",15),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(4),f.Sc(c.orderDetail.DeliveryInfo.PhoneNumber)}}function qe(e,t){if(1&e){var c=f.ic();f.hc(0,"button",25),f.pc("click",(function(){return f.Jc(c),f.tc().gotToCusConfirm()})),f.Rc(1,"X\xe1c nh\u1eadn v\u1edbi Kh\xe1ch h\xe0ng"),f.gc()}}function Ve(e,t){if(1&e){var c=f.ic();f.hc(0,"button",25),f.pc("click",(function(){return f.Jc(c),f.tc().gotToCusConfirm()})),f.Rc(1,"Ch\u1ee5p \u1ea3nh"),f.gc()}}var je,Je=((je=function(e){n(c,e);var t=o(c);function c(e,i){var n;return h(this,c),(n=t.call(this)).router=e,n.orderDetailService=i,n.Title="X\xe1c nh\u1eadn th\xe0nh ph\u1ea9m",n.IsDataLosingWarning=!1,n}return d(c,[{key:"Init",value:function(){this.orderDetail=this.globalOrderDetail}},{key:"gotToCusConfirm",value:function(){this.router.navigate(["staff/customer-confirming"])}},{key:"confirm",value:function(){var e=this;switch(this.CurrentUser.Role){case A.i.Account:case A.i.Admin:this.orderDetailService.resultConfirm(this.globalOrderDetail.OrderDetailId,this.orderDetailService.getLastestMaking(this.globalOrderDetail).Id,null).then((function(){e.router.navigate(["staff/account-main"])}));break;case A.i.Shipper:this.orderDetailService.updateFields(this.globalOrderDetail.OrderDetailId,{State:A.f.Completed,DeliveryCompletedTime:(new Date).getTime()}).then((function(){e.router.navigate(["staff/shipper-main"])}))}}}]),c}(C)).\u0275fac=function(e){return new(e||je)(f.bc(l.b),f.bc(X.a))},je.\u0275cmp=f.Vb({type:je,selectors:[["app-order-detail-confirming"]],features:[f.Lb],decls:49,vars:29,consts:[["id","orderConfirm",1,"page-content"],[1,"container"],[1,"prodDetail"],[1,"prodGen"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPriceOld"],[1,"prodCharge"],[1,"prodPrice"],[1,"prodInfo","cusScroll"],["class","prodQuan infoGroup",4,"ngIf"],["class","prodName infoGroup",4,"ngIf"],[1,"prodAddr","infoGroup"],[1,"itemlabel"],[1,"itemVal"],[1,"prodTime","infoGroup"],[1,"prodDesc","infoGroup"],[1,"row"],[1,"col-10","mx-auto","text-center"],["type","button","class","btn main-btn w-100 mt-2",3,"click",4,"ngIf"],["type","button",1,"btn","grey-btn","w-100","mt-2",3,"click"],[1,"prodQuan","infoGroup"],["class","itemVal",4,"ngIf"],[1,"prodName","infoGroup"],["type","button",1,"btn","main-btn","w-100","mt-2",3,"click"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.cc(4,"img",4),f.uc(5,"ImgPipe"),f.hc(6,"div",5),f.hc(7,"h5",6),f.Rc(8),f.gc(),f.hc(9,"h5",6),f.Rc(10),f.gc(),f.hc(11,"span",7),f.Rc(12),f.uc(13,"myCurrPipe"),f.gc(),f.hc(14,"span",8),f.Rc(15),f.uc(16,"myCurrPipe"),f.gc(),f.hc(17,"span",9),f.Rc(18),f.uc(19,"myCurrPipe"),f.gc(),f.gc(),f.gc(),f.hc(20,"div",10),f.Pc(21,Le,5,2,"div",11),f.Pc(22,Be,5,1,"div",12),f.Pc(23,Ue,5,1,"div",12),f.Pc(24,He,5,1,"div",12),f.Pc(25,Ee,5,1,"div",12),f.hc(26,"div",13),f.hc(27,"span",14),f.Rc(28,"\u0110\u1ecba ch\u1ec9 giao:"),f.gc(),f.hc(29,"span",15),f.Rc(30),f.gc(),f.gc(),f.hc(31,"div",16),f.hc(32,"span",14),f.Rc(33,"Th\u1eddi gian giao:"),f.gc(),f.hc(34,"span",15),f.Rc(35),f.uc(36,"date"),f.gc(),f.gc(),f.hc(37,"div",17),f.hc(38,"span",14),f.Rc(39,"M\xf4 t\u1ea3:"),f.gc(),f.hc(40,"span",15),f.Rc(41),f.gc(),f.gc(),f.gc(),f.hc(42,"div",18),f.hc(43,"div",19),f.Pc(44,qe,2,0,"button",20),f.Pc(45,Ve,2,0,"button",20),f.gc(),f.hc(46,"div",19),f.hc(47,"button",21),f.pc("click",(function(){return t.confirm()})),f.Rc(48,"Xong"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()),2&e&&(f.Ob(4),f.Bc("src",f.wc(5,17,t.orderDetail.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Uc("",t.orderDetail.OrderId,"_",t.orderDetail.Index+1,""),f.Ob(2),f.Sc(t.orderDetail.ProductName),f.Ob(2),f.Sc(f.vc(13,20,t.orderDetail.OriginalPrice)),f.Ob(3),f.Tc("Ph\u1ee5 ph\xed: ",f.vc(16,22,t.orderDetail.AdditionalFee),""),f.Ob(3),f.Sc(f.vc(19,24,t.orderDetail.ModifiedPrice)),f.Ob(3),f.Ac("ngIf","Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Shipper"==t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Shipper"==t.CurrentUser.Role),f.Ob(5),f.Sc(t.orderDetail.DeliveryInfo.Address),f.Ob(5),f.Sc(f.wc(36,26,t.orderDetail.DeliveryInfo.DateTime,"hh:mm a dd/MM/yyyy")),f.Ob(6),f.Sc(t.orderDetail.Description),f.Ob(3),f.Ac("ngIf","Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Shipper"==t.CurrentUser.Role))},directives:[D.l],pipes:[q.a,E.a,D.e],styles:[""]}),je),Ge=r("cPV5"),We=r("ftz2");function Xe(e,t){if(1&e){var c=f.ic();f.hc(0,"li",51),f.pc("click",(function(){f.Jc(c);var e=t.index;return f.tc().selectPromotion(e)})),f.hc(1,"p",52),f.Rc(2),f.gc(),f.hc(3,"span",53),f.Rc(4),f.gc(),f.hc(5,"span",54),f.Rc(6),f.uc(7,"myDatePipe"),f.uc(8,"myDatePipe"),f.gc(),f.gc()}if(2&e){var i=t.$implicit,n=t.index,r=f.tc();f.Pb("data-index",n),f.Ob(2),f.Sc(i.Name),f.Ob(2),f.Sc(r.getPromotionAmount(i)),f.Ob(2),f.Uc("",f.vc(7,5,i.StartTime),"-",f.vc(8,7,i.EndTime),"")}}function Qe(e,t){if(1&e){var c=f.ic();f.hc(0,"div",55),f.pc("click",(function(){return f.Jc(c),f.tc().addNoteImage()})),f.cc(1,"img",56),f.gc()}}function $e(e,t){if(1&e){var c=f.ic();f.hc(0,"div",55),f.pc("click",(function(){return f.Jc(c),f.Hc(3).click()})),f.cc(1,"img",56),f.hc(2,"input",57,58),f.pc("change",(function(e){return f.Jc(c),f.tc(2).onChange(e)})),f.gc(),f.gc()}}function ze(e,t){if(1&e&&(f.hc(0,"div"),f.Pc(1,$e,4,0,"div",45),f.gc()),2&e){var c=f.tc();f.Ob(1),f.Ac("ngIf",!c.IsOnTerminal)}}function _e(e,t){if(1&e){var c=f.ic();f.hc(0,"div",44),f.hc(1,"div",59),f.pc("click",(function(){f.Jc(c);var e=t.index;return f.tc().selectNoteImage(e)})),f.cc(2,"img",60),f.uc(3,"ImgPipe"),f.gc(),f.gc()}if(2&e){var i=t.$implicit;f.Ob(2),f.Bc("src",f.wc(3,1,i,"NoteImg"),f.Lc)}}var Ke,Ze,Ye=((Ke=function(e){n(i,e);var t=o(i);function i(e,c,n,r){var o;return h(this,i),(o=t.call(this)).route=e,o.router=c,o.categoryService=n,o.promotionService=r,o.Title="Chi ti\u1ebft \u0111\u01a1n",o.isAddingNoteImage=!1,o.promotions=[],o.images=[],o.globalOrderDetail.NoteImages||(o.globalOrderDetail.NoteImages=[]),o}return d(i,[{key:"Init",value:function(){var e=this;this.promotionService.getAvailablePromotions((new Date).getTime(),!1).then((function(t){e.promotions=t})),this.route.params.subscribe((function(t){e.detailIndex=+t.id,e.globalOrderDetail.PurposeOf||(e.globalOrderDetail.PurposeOf="Mua t\u1eb7ng"),e.globalOrderDetail.ProductName||(e.globalOrderDetail.ProductName="...."),createNumbericElement(!1,(function(t){e.globalOrderDetail.Quantity=t}))}))}},{key:"getPromotionAmount",value:function(e){return e.PromotionType===w.b.Amount?e.Amount+" \u20ab":e.Amount+" %"}},{key:"onAmountDiscountChanged",value:function(e){this.globalOrderDetail.AmountDiscount<10&&(this.globalOrderDetail.AmountDiscount*=1e3,this.moveCursor(this.globalOrderDetail.AmountDiscount.toString().length,"AmountDiscount")),this.globalOrderDetail.AmountDiscount=+this.globalOrderDetail.AmountDiscount}},{key:"onAcmountDiscountFocus",value:function(){this.globalOrderDetail.AmountDiscount||(this.globalOrderDetail.AmountDiscount=0),this.moveCursor(this.globalOrderDetail.AmountDiscount.toString().length,"AmountDiscount")}},{key:"addNoteImage",value:function(){this.isAddingNoteImage=!0,c(u(i.prototype),"openFileForShare",this).call(this)}},{key:"fileChosen",value:function(e){this.globalOrderDetail.NoteImages.push("data:image/png;base64,"+e)}},{key:"onChange",value:function(e){var t=this,c=e.target.files[0];if(c)if(null!=c.type.match(/image\/*/)){var i=new FileReader;i.readAsDataURL(c),i.onload=function(e){t.globalOrderDetail.NoteImages.push(i.result.toString())}}else this.showError("Ph\u1ea3i ch\u1ecdn h\xecnh !!")}},{key:"selectNoteImage",value:function(e){var t=this;this.menuOpening((function(c){switch(+c){case 0:t.globalOrderDetail.NoteImages.splice(e,1);break;case 1:var i=q.a.getImgUrl(t.globalOrderDetail.NoteImages[e],ie.c.NoteImg);t.images=[i],setTimeout((function(){viewImages((function(){t.images=[]}))}),100)}}),["Xo\xe1 \u1ea3nh","Xem chi ti\u1ebft \u1ea3nh"])}},{key:"onAddFeeChanged",value:function(e){this.globalOrderDetail.AdditionalFee<10&&(this.globalOrderDetail.AdditionalFee*=1e3,this.moveCursor(this.globalOrderDetail.AdditionalFee.toString().length,"AdditionalFee")),this.globalOrderDetail.AdditionalFee=+this.globalOrderDetail.AdditionalFee}},{key:"onAddFeeFocus",value:function(){this.globalOrderDetail.AdditionalFee||(this.globalOrderDetail.AdditionalFee=0),this.moveCursor(this.globalOrderDetail.AdditionalFee.toString().length,"AdditionalFee")}},{key:"onNewPriceChanged",value:function(e){this.newPrice<10&&(this.newPrice*=1e3,this.moveCursor(this.newPrice.toString().length,"NewPrice")),this.newPrice=+this.newPrice}},{key:"onNewPriceFocus",value:function(){this.newPrice||(this.newPrice=0),this.moveCursor(this.newPrice.toString().length,"NewPrice")}},{key:"clearProductImg",value:function(){var e=this;this.globalOrderDetail.ProductImageUrl&&(this.globalOrderDetail.IsFromHardCodeProduct?this.globalOrderDetail.ProductImageUrl="":this.openConfirm("Ch\u1eafc ch\u0103c xo\xe1 \u1ea3nh n\xe0y? ",(function(){e.globalOrderDetail.ProductImageUrl=""})))}},{key:"productNameChangeRequest",value:function(){var e=this;getInputWithType((function(t){""!==t&&(e.globalOrderDetail.ProductName=t,e.globalOrderDetail.IsFromHardCodeProduct=!0)}),"C\u1eadp nh\u1eadt t\xean s\u1ea3n ph\u1ea9m...","...."===this.globalOrderDetail.ProductName?"":this.globalOrderDetail.ProductName,"text")}},{key:"insertModifiedValue",value:function(){this.newPrice=this.globalOrderDetail.ModifiedPrice,openFixPriceDialog()}},{key:"quantityChangeRequest",value:function(){var e=this;getInputWithType((function(t){t&&(e.globalOrderDetail.Quantity=+t)}),"C\u1eadp nh\u1eadt s\u1ed1 l\u01b0\u1ee3ng...",this.globalOrderDetail.Quantity.toString(),"number")}},{key:"submitPrice",value:function(){this.newPrice<0?this.showError("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!!"):(this.globalOrderDetail.ModifiedPrice=this.newPrice,dismissFixPriceDialog())}},{key:"searchProduct",value:function(){this.router.navigate(["/staff/search-product"],{queryParams:{category:-1},queryParamsHandling:"merge"})}},{key:"submitOrderDetail",value:function(e){if(e.valid)if(this.globalOrderDetail.ModifiedPrice<=0)this.showError("Ch\u01b0a nh\u1eadp gi\xe1 ti\u1ec1n!");else{this.globalOrderDetail.Index=this.detailIndex>-1?this.detailIndex:this.globalOrder.OrderDetails.length;var t=P.c.DeepCopy(this.globalOrderDetail);this.insertOrderDetail(t)}}},{key:"insertOrderDetail",value:function(e){this.detailIndex>-1?this.globalOrder.OrderDetails[this.detailIndex]=e:this.globalOrder.OrderDetails.push(e),c(u(i.prototype),"OnBackNaviage",this).call(this)}},{key:"selectPromotion",value:function(e){this.globalOrderDetail.PercentDiscount=this.globalOrderDetail.AmountDiscount=0;var t=this.promotions[e];t.PromotionType===w.b.Amount?this.globalOrderDetail.AmountDiscount=t.Amount:this.globalOrderDetail.PercentDiscount=t.Amount,hideReceiverPopup()}}]),i}(C)).\u0275fac=function(e){return new(e||Ke)(f.bc(l.a),f.bc(l.b),f.bc(Ge.a),f.bc(x.a))},Ke.\u0275cmp=f.Vb({type:Ke,selectors:[["app-order-detail"]],features:[f.Lb],decls:88,vars:21,consts:[["id","orderAdd",1,"page-content"],[1,"container"],["autocomplete","on",1,"addOrderForm",3,"submit"],["form","ngForm"],[1,"form-group","prodInfo"],[1,"prodImg"],["alt","",3,"src"],["src","../../../../assets/images/delete_white.svg","alt","",1,"close-img",3,"click"],[1,"prodContent"],[1,"prodCode"],[1,"prodPrice"],[1,"prodQuantity"],["type","number","readonly","","name","Quantity","id","Quantity","step","1","min","1",3,"ngModel","ngModelChange"],[1,"prodBrowser",3,"click"],[1,"fa","fa-search","main-bg"],[1,"row","col-xs-12",2,"margin-bottom","10px","padding-left","15px","padding-right","15px"],[1,"addInfo",2,"width","100%","padding-right","5px"],["href","javascript:void(0);",1,"btn","main-btn",3,"click"],[1,"addInfo",2,"width","50%","padding-right","5px"],[1,"addInfo",2,"width","50%","padding-left","5px"],[1,"form-group","addInfo"],["routerLink","/staff/select-receiver",1,"btn","main-btn"],[1,"title-field"],[1,"form-group","orderInfo"],["type","text","name","AdditionalFee","id","AdditionalFee","placeholder","Ph\u1ee5 ph\xed (k)...",1,"orderField",3,"ngModel","ngModelChange","input","focus"],["href","javascript:void(0)","onclick","openCustMenu()","type","button",1,"btn","main-btn","w-100",2,"margin-bottom","1vh","font-size","16px"],[1,"row","col-xs-12",2,"padding-left","15px","padding-right","15px"],["type","number","name","PercentDiscount","id","PercentDiscount","placeholder","%",1,"orderField",3,"ngModel","ngModelChange"],["type","tel","name","AmountDiscount","id","AmountDiscount","placeholder","0",1,"orderField",3,"ngModel","ngModelChange","input","focus"],["type","text","name","PurposeOf","id","PurposeOf","placeholder","M\u1ee5c \u0111\xedch mua h\xe0ng...",1,"orderField",3,"ngModel","ngModelChange"],["type","text","name","Description","id","Description","placeholder","M\xf4 t\u1ea3 giao h\xe0ng...",1,"orderField","col-xs-6",3,"ngModel","ngModelChange"],["href","javascript:void(0)","onClick","openImgsDialog()",1,"btn","main-btn"],["type","submit",1,"btn","main-btn","w-100"],["id","recentInfo",1,"actionMenu2"],["style","height: 69px;text-align: left;",3,"click",4,"ngFor","ngForOf"],["id","inputDialog",1,"popup-content","dialog-popup"],[1,"form-group"],["type","tel","name","newPrice","id","NewPrice","placeholder","c\u1eadp nh\u1eadt gi\xe1 ti\u1ec1n...",1,"mainForm",3,"ngModel","ngModelChange","input","focus"],[1,"row"],[1,"col-6"],["id","confirm-button",1,"main-btn","btn",3,"click"],["id","cancel-button","onClick","dismissFixPriceDialog()",1,"main-bg","border","btn"],["id","imgsDialog",1,"popup-content","dialog-popup"],[1,"row","imageList","cusScroll",2,"max-height","450px"],[1,"col-6","product-item-big"],["class","prodItem-tall","style","height: 220px;position: relative;",3,"click",4,"ngIf"],[4,"ngIf"],["class","col-6 product-item-big",4,"ngFor","ngForOf"],["id","confirm-button","onClick","closeImgsDialog()",1,"main-btn","btn"],["id","view-product",1,"popup-content","view-img-popup-content",2,"z-index","1000"],[3,"src","config"],[2,"height","69px","text-align","left",3,"click"],[1,"recentInfo-name"],[1,"recentInfo-phone",2,"width","25%"],[1,"recentInfo-date",2,"width","75%"],[1,"prodItem-tall",2,"height","220px","position","relative",3,"click"],["src","../../../../assets/images/add.svg","alt","",2,"margin-bottom","0px","width","64px","height","64px","position","absolute","top","50%","left","50%","transform","translate(-50%, -50%)"],["type","file","name","uploadedFile","hidden","",1,"img-cover","file-upload-default",3,"change"],["imageUpload",""],[1,"prodItem-tall",3,"click"],["alt","",2,"margin-bottom","0px",3,"src"]],template:function(e,t){if(1&e){var c=f.ic();f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"form",2,3),f.pc("submit",(function(){f.Jc(c);var e=f.Hc(3);return t.submitOrderDetail(e)})),f.hc(4,"div",4),f.hc(5,"div",5),f.cc(6,"img",6),f.uc(7,"ImgPipe"),f.hc(8,"img",7),f.pc("click",(function(){return t.clearProductImg()})),f.gc(),f.gc(),f.hc(9,"div",8),f.hc(10,"h5",9),f.Rc(11),f.gc(),f.hc(12,"span",10),f.Rc(13),f.uc(14,"myCurrPipe"),f.gc(),f.hc(15,"div",11),f.hc(16,"input",12),f.pc("ngModelChange",(function(e){return t.globalOrderDetail.Quantity=e})),f.gc(),f.gc(),f.gc(),f.hc(17,"div",13),f.pc("click",(function(){return t.searchProduct()})),f.cc(18,"i",14),f.gc(),f.gc(),f.hc(19,"div",15),f.hc(20,"div",16),f.hc(21,"a",17),f.pc("click",(function(){return t.quantityChangeRequest()})),f.Rc(22,"C\u1eadp nh\u1eadt S\u1ed1 l\u01b0\u1ee3ng"),f.gc(),f.gc(),f.gc(),f.hc(23,"div",15),f.hc(24,"div",18),f.hc(25,"a",17),f.pc("click",(function(){return t.productNameChangeRequest()})),f.Rc(26,"C\u1eadp nh\u1eadt T\xean"),f.gc(),f.gc(),f.hc(27,"div",19),f.hc(28,"a",17),f.pc("click",(function(){return t.insertModifiedValue()})),f.Rc(29,"C\u1eadp nh\u1eadt gi\xe1"),f.gc(),f.gc(),f.gc(),f.hc(30,"div",20),f.hc(31,"a",21),f.Rc(32,"Th\xf4ng tin ng\u01b0\u1eddi nh\u1eadn"),f.gc(),f.gc(),f.hc(33,"label",22),f.Rc(34,"Ph\u1ee5 ph\xed"),f.gc(),f.hc(35,"div",23),f.hc(36,"input",24),f.pc("ngModelChange",(function(e){return t.globalOrderDetail.AdditionalFee=e}))("input",(function(e){return t.onAddFeeChanged(e.target.value)}))("focus",(function(){return t.onAddFeeFocus()})),f.gc(),f.gc(),f.hc(37,"a",25),f.Rc(38,"\xc1p d\u1ee5ng khuy\u1ebfn m\xe3i"),f.gc(),f.hc(39,"div",26),f.hc(40,"div",18),f.hc(41,"label",22),f.Rc(42,"Gi\u1ea3m gi\xe1 ph\u1ea7n tr\u0103m "),f.gc(),f.hc(43,"div",23),f.hc(44,"input",27),f.pc("ngModelChange",(function(e){return t.globalOrderDetail.PercentDiscount=e})),f.gc(),f.gc(),f.gc(),f.hc(45,"div",19),f.hc(46,"label",22),f.Rc(47,"Gi\u1ea3m gi\xe1 ti\u1ec1n"),f.gc(),f.hc(48,"div",23),f.hc(49,"input",28),f.pc("ngModelChange",(function(e){return t.globalOrderDetail.AmountDiscount=e}))("input",(function(e){return t.onAmountDiscountChanged(e.target.value)}))("focus",(function(){return t.onAcmountDiscountFocus()})),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(50,"label",22),f.Rc(51,"M\u1ee5c \u0111\xedch mua h\xe0ng"),f.gc(),f.hc(52,"div",23),f.hc(53,"input",29),f.pc("ngModelChange",(function(e){return t.globalOrderDetail.PurposeOf=e})),f.gc(),f.gc(),f.hc(54,"label",22),f.Rc(55,"M\xf4 t\u1ea3"),f.gc(),f.hc(56,"div",23),f.hc(57,"input",30),f.pc("ngModelChange",(function(e){return t.globalOrderDetail.Description=e})),f.gc(),f.gc(),f.hc(58,"div",20),f.hc(59,"a",31),f.Rc(60,"\u1ea2nh m\xf4 t\u1ea3"),f.gc(),f.gc(),f.hc(61,"div",20),f.hc(62,"button",32),f.Rc(63,"Xong"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(64,"div",33),f.hc(65,"ul"),f.Pc(66,Xe,9,9,"li",34),f.gc(),f.gc(),f.hc(67,"div",35),f.hc(68,"div",36),f.hc(69,"input",37),f.pc("ngModelChange",(function(e){return t.newPrice=e}))("input",(function(e){return t.onNewPriceChanged(e.target.value)}))("focus",(function(){return t.onNewPriceFocus()})),f.gc(),f.gc(),f.hc(70,"div",38),f.hc(71,"div",39),f.hc(72,"button",40),f.pc("click",(function(){return t.submitPrice()})),f.Rc(73,"X\xe1c nh\u1eadn"),f.gc(),f.gc(),f.hc(74,"div",39),f.hc(75,"button",41),f.Rc(76,"H\u1ee7y"),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(77,"div",42),f.hc(78,"div",43),f.hc(79,"div",44),f.Pc(80,Qe,2,0,"div",45),f.Pc(81,ze,2,1,"div",46),f.gc(),f.Pc(82,_e,4,4,"div",47),f.gc(),f.hc(83,"div",38),f.hc(84,"button",48),f.Rc(85,"\u0110\xf3ng"),f.gc(),f.gc(),f.gc(),f.hc(86,"div",49),f.cc(87,"angular-image-viewer",50),f.gc()}2&e&&(f.Ob(6),f.Bc("src",f.wc(7,16,t.globalOrderDetail.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(5),f.Tc("",t.globalOrderDetail.ProductName," "),f.Ob(2),f.Sc(f.vc(14,19,t.globalOrderDetail.ModifiedPrice)),f.Ob(3),f.Ac("ngModel",t.globalOrderDetail.Quantity),f.Ob(20),f.Ac("ngModel",t.globalOrderDetail.AdditionalFee),f.Ob(8),f.Ac("ngModel",t.globalOrderDetail.PercentDiscount),f.Ob(5),f.Ac("ngModel",t.globalOrderDetail.AmountDiscount),f.Ob(4),f.Ac("ngModel",t.globalOrderDetail.PurposeOf),f.Ob(4),f.Ac("ngModel",t.globalOrderDetail.Description),f.Ob(9),f.Ac("ngForOf",t.promotions),f.Ob(3),f.Ac("ngModel",t.newPrice),f.Ob(11),f.Ac("ngIf",t.IsOnTerminal),f.Ob(1),f.Ac("ngIf",!t.IsOnTerminal),f.Ob(1),f.Ac("ngForOf",t.globalOrderDetail.NoteImages),f.Ob(5),f.Ac("src",t.images)("config",t.viewProdOptions))},directives:[B.v,B.l,B.m,B.p,B.b,B.k,B.n,l.c,D.k,D.l,We.a],pipes:[q.a,E.a,E.b],styles:[""]}),Ke),et=r("Gdn9"),tt=r("tk/3"),ct=r("qfBg"),it=r("Kj3r"),nt=r("vkgz"),rt=((Ze=function(){function e(t,c){h(this,e),this.formBuilder=t,this.ngForm=c,this.placeholder="",this.delayTimeSpan=1e3,this.searchTextInvoke=new f.q,this.onChange=function(e){},this.onTouched=function(){},this.searchContent=new B.d,this.searchForm=this.formBuilder.group({searchContent:this.searchContent})}return d(e,[{key:"ngOnInit",value:function(){var e=this;this.searchContent.valueChanges.pipe(Object(it.a)(this.delayTimeSpan),Object(nt.a)()).subscribe((function(t){e.searchTextInvoke.emit(t)}))}},{key:"preventEvent",value:function(e){e.stopPropagation()}},{key:"writeValue",value:function(e){e!==this.value&&(this.value=e)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"updateChanges",value:function(){this.onChange(this.value)}}]),e}()).\u0275fac=function(e){return new(e||Ze)(f.bc(B.c),f.bc(B.m,8))},Ze.\u0275cmp=f.Vb({type:Ze,selectors:[["mobile-search-box"]],inputs:{placeholder:"placeholder",delayTimeSpan:"delayTimeSpan"},outputs:{searchTextInvoke:"searchTextInvoke"},features:[f.Nb([{provide:B.j,useExisting:Object(f.fb)((function(){return Ze})),multi:!0}])],decls:2,vars:1,consts:[[3,"formGroup"],["type","text","placeholder","placeholder","formControlName","searchContent",1,"form-control"]],template:function(e,t){1&e&&(f.hc(0,"form",0),f.cc(1,"input",1),f.gc()),2&e&&f.Ac("formGroup",t.searchForm)},directives:[B.v,B.l,B.f,B.b,B.k,B.e],styles:[""]}),Ze);function ot(e,t){if(1&e){var c=f.ic();f.hc(0,"li",73),f.hc(1,"app-status-point",74),f.pc("onClicked",(function(e){return f.Jc(c),f.tc(2).openDetailInfo(e)})),f.gc(),f.hc(2,"div",75),f.pc("click",(function(){f.Jc(c);var e=t.$implicit;return f.tc(2).updateOrderDetailState(e.OrderDetailId)})),f.cc(3,"img",76),f.uc(4,"ImgPipe"),f.hc(5,"div",77),f.hc(6,"h5",78),f.Rc(7),f.gc(),f.hc(8,"span",79),f.Rc(9),f.uc(10,"myCurrPipe"),f.gc(),f.hc(11,"span",80),f.Rc(12),f.gc(),f.hc(13,"span",81),f.Rc(14),f.uc(15,"myTimePipe"),f.gc(),f.hc(16,"span",67),f.Rc(17),f.uc(18,"myDatePipe"),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var i=t.$implicit;f.Ob(1),f.Ac("state",i.State)("id",i.OrderDetailId)("index",i.Index+1),f.Ob(2),f.Bc("src",f.wc(4,9,i.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(i.ProductName),f.Ob(2),f.Sc(f.vc(10,12,i.ModifiedPrice)),f.Ob(3),f.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",i.Quantity,""),f.Ob(2),f.Sc(f.vc(15,14,i.DeliveryInfo.DateTime)),f.Ob(3),f.Sc(f.vc(18,16,i.DeliveryInfo.DateTime))}}function at(e,t){if(1&e){var c=f.ic();f.hc(0,"a",82),f.pc("click",(function(){f.Jc(c);var e=f.tc().$implicit;return f.tc().editOrder(e.OrderId)})),f.cc(1,"i",83),f.Rc(2," Ch\u1ec9nh s\u1eeda"),f.gc()}}function st(e,t){if(1&e){var c=f.ic();f.hc(0,"li",60),f.hc(1,"div",61),f.hc(2,"span",62),f.pc("click",(function(){f.Jc(c);var e=t.$implicit;return f.tc().viewPurchase(e.OrderId)})),f.Rc(3),f.gc(),f.hc(4,"div",63),f.pc("click",(function(){f.Jc(c);var e=t.$implicit;return f.tc().selectOrder(e)})),f.hc(5,"h4",64),f.Rc(6),f.gc(),f.hc(7,"h4",65),f.Rc(8),f.gc(),f.hc(9,"span",66),f.Rc(10),f.uc(11,"myCurrPipe"),f.gc(),f.hc(12,"span",67),f.Rc(13),f.uc(14,"myDatePipe"),f.gc(),f.gc(),f.hc(15,"button",68),f.pc("click",(function(){f.Jc(c);var e=t.$implicit;return f.tc().openOrder(e)})),f.Rc(16,"m\u1edf"),f.gc(),f.gc(),f.hc(17,"div",69),f.hc(18,"ul",70),f.Pc(19,ot,19,18,"li",71),f.gc(),f.Pc(20,at,3,0,"a",72),f.gc(),f.gc()}if(2&e){var i=t.$implicit,n=t.index;f.Ac("id","order"+n),f.Ob(1),f.Ac("id","heading"+n),f.Ob(2),f.Sc(i.OrderId),f.Ob(3),f.Sc(i.CustomerInfo.Name),f.Ob(2),f.Tc("tel: ",i.CustomerInfo.PhoneNumber,""),f.Ob(2),f.Tc("",f.vc(11,15,i.TotalAmount)," "),f.Ob(3),f.Sc(f.vc(14,17,i.DoneTime)),f.Ob(2),f.Ac("id","arrowBtn"+i.OrderId),f.Pb("data-target","#collapse"+n)("aria-controls","collapse"+n),f.Ob(2),f.Ac("id","collapse"+n),f.Pb("aria-labelledby","heading"+n)("data-parent","#order"+n),f.Ob(2),f.Ac("ngForOf",i.OrderDetails),f.Ob(1),f.Ac("ngIf",!i.IsFinished)}}function ut(e,t){if(1&e&&(f.hc(0,"span"),f.Rc(1),f.gc()),2&e){var c=t.$implicit;f.Ob(1),f.Sc(c.FullName)}}function lt(e,t){if(1&e&&(f.hc(0,"span",84),f.Rc(1),f.gc()),2&e){var c=t.$implicit;f.Ob(1),f.Sc(c.FullName)}}function dt(e,t){if(1&e&&(f.hc(0,"li",85),f.cc(1,"img",86),f.uc(2,"ImgPipe"),f.hc(3,"span",87),f.Rc(4),f.gc(),f.gc()),2&e){var c=t.$implicit;f.Bc("id",c.Id),f.Ob(1),f.Bc("src",f.wc(2,3,c.AvtUrl,"UserAvt"),f.Lc),f.Ob(3),f.Sc(c.FullName)}}function ht(e,t){if(1&e&&(f.hc(0,"li",88),f.cc(1,"img",86),f.uc(2,"ImgPipe"),f.hc(3,"span",87),f.Rc(4),f.gc(),f.hc(5,"span",89),f.Rc(6),f.gc(),f.gc()),2&e){var c=t.$implicit;f.Bc("id",c.Id),f.Ob(1),f.Bc("src",f.wc(2,4,c.AvtUrl,"UserAvt"),f.Lc),f.Ob(3),f.Sc(c.FullName),f.Ob(2),f.Sc(c.IsExternalShipper?"Shipper ngo\xe0i":"Nh\xe2n vi\xean")}}var gt,mt=((gt=function(e){n(c,e);var t=o(c);function c(e,i,n,r,o,a,s,u,l,d,g){var m;return h(this,c),(m=t.call(this)).customerService=e,m.activatedRoute=i,m.router=n,m.orderService=r,m.storageService=o,m.productService=a,m.orderDetailService=s,m.http=u,m.datePipe=l,m.userService=d,m.printJobService=g,m.Title="Danh s\xe1ch \u0111\u01a1n",m.NavigateClass="nav-icon ",m.IsDataLosingWarning=!1,m.states=A.f,m.pageSize=20,m.totalPage=0,m.searchTerm="",m.allStatuses=[A.f.Added,A.f.Making,A.f.Comfirming,A.f.OnTheWay,A.f.SentBack,A.f.Fixing,A.f.Completed,A.f.Canceled],m.selectedDetail={},m.globalService.currentOrderViewModel=new P.d,m.selectMakingRequestTime=new Date,m.orders=[],m.florists=[],m.shippers=[],m}return d(c,[{key:"selectedOrderId",get:function(){return this.globalService.selectedOrderId},set:function(e){this.globalService.selectedOrderId=e}},{key:"currentPage",get:function(){return this.globalService.currentOrderPage},set:function(e){this.globalService.currentOrderPage=e}},{key:"currentOrderListScrollPos",get:function(){return this.globalService.currentOrderListScrollPos},set:function(e){this.globalService.currentOrderListScrollPos=e}},{key:"displayStatuses",get:function(){return this.globalService.displayStatuses},set:function(e){this.globalService.displayStatuses=e}},{key:"OnBackNaviage",value:function(){customerSupport()}},{key:"updateOrderDetailState",value:function(e){var t=new P.c,c=new P.d;switch(this.orders.forEach((function(i){i.OrderDetails.forEach((function(n){if(n.OrderDetailId===e)return t=n,void(c=i)}))})),t.State){case A.f.Added:this.updateAddedDetailState(t,c);break;case A.f.Making:case A.f.Fixing:this.updateMakingDetailState(t,c);break;case A.f.Comfirming:this.updatConfirmingDetailState(t,c);break;case A.f.OnTheWay:this.updateShippingDetail(t,c);break;case A.f.SentBack:this.updateSentBackDetailState(t,c);break;case A.f.Completed:this.globalOrderDetail=t,this.globalOrder=c,this.router.navigate(["staff/order-detail-view"])}}},{key:"filterByState",value:function(){var e=this,t=[];t.push({Name:"T\u1ea5t c\u1ea3",Value:"ALL"}),ie.e.forEach((function(e){t.push({Name:e.DisplayName,Value:e.State})})),filterOrderByState(t,(function(t){e.currentPage=0,e.displayStatuses="ALL"===t?e.allStatuses:t===A.f.Making?[A.f.Making,A.f.Fixing]:[t],e.getOrders()}))}},{key:"getOrders",value:function(){var e=this;this.orders=[],this.orderService.searchOrders(this.currentPage,this.pageSize,this.displayStatuses,this.searchTerm).then((function(t){e.totalPage=t.totalPages,e.orders=t.orders}))}},{key:"searchOrder",value:function(e){this.currentPage=0,this.searchTerm=e,this.getOrders()}},{key:"goToPage",value:function(e){var t=this;e>=this.totalPage||e<0||(this.currentPage=e,this.orderService.searchOrders(this.currentPage,this.pageSize,this.displayStatuses,this.searchTerm).then((function(e){t.totalPage=e.totalPages,t.orders=e.orders})))}},{key:"logout",value:function(){var e=this;this.authService.logOut((function(t){t&&e.router.navigate(["staff/login"])}))}},{key:"Init",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setStatusBarColor(!1),this.displayStatuses=this.displayStatuses.length>0?this.displayStatuses:this.allStatuses,this.orderService.searchOrders(this.currentPage,this.pageSize,this.displayStatuses).then((function(e){t.totalPage=e.totalPages,t.orders=e.orders,t.selectedOrderId&&scrollToOrder(t.selectedOrderId,t.currentOrderListScrollPos)})),this.askForRememberPassword(),this.userService.getByRole(A.i.Florist).then((function(e){t.florists=e})),this.userService.getByRole(A.i.Shipper).then((function(e){t.shippers=e}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"doPrintJob",value:function(e){var t=this,c=0,i=[];e.OrderDetails.forEach((function(e){i.push({productName:e.ProductName,index:e.Index+1,price:e.ModifiedPrice,additionalFee:e.AdditionalFee,discount:t.getDiscount(e.ModifiedPrice,e.PercentDiscount,e.AmountDiscount),quantity:e.Quantity}),c+=e.ModifiedPrice}));var n=[];e.PurchaseItems&&e.PurchaseItems.forEach((function(e){n.push({method:e.Method,amount:e.Amount})}));var r={Created:(new Date).getTime(),doneTime:new Date(e.DoneTime).toLocaleString("en-US",{hour12:!1}),Id:e.OrderId,Active:!0,IsDeleted:!1,saleItems:i,createdDate:e.CreatedDate.toLocaleString("en-US",{hour12:!1}),orderId:e.OrderId,summary:c,totalAmount:e.TotalAmount,totalPaidAmount:e.TotalPaidAmount,totalBalance:e.TotalAmount-e.TotalPaidAmount,vatIncluded:e.VATIncluded,memberDiscount:e.CustomerInfo.DiscountPercent,scoreUsed:e.CustomerInfo.ScoreUsed,gainedScore:e.CustomerInfo.GainedScore,totalScore:e.IsFinished?e.CustomerInfo.AvailableScore:e.CustomerInfo.AvailableScore-e.CustomerInfo.ScoreUsed+e.CustomerInfo.GainedScore,customerName:e.CustomerInfo.Name,customerId:e.CustomerInfo.Id,discount:this.getDiscount(e.TotalAmount,e.PercentDiscount,e.AmountDiscount),purchaseItems:n,isMemberDiscountApply:e.IsMemberDiscountApply};this.printJobService.addPrintJob(r)}},{key:"getDiscount",value:function(e,t,c){var i=0;return t&&t>0&&(i=e/100*t),c&&c>0&&(i+=c),i}},{key:"selectOrder",value:function(e){var t=this;this.menuOpening((function(c){switch(+c){case 0:t.viewPurchase(e.OrderId);break;case 1:t.doPrintJob(e);break;case 2:if(e.IsFinished)return;t.orderDetailService.completeOrder(e).then((function(c){t.orderService.addScoreToCustomer(e).then((function(){t.orderService.searchOrders(t.currentPage,t.pageSize,t.displayStatuses).then((function(e){t.totalPage=e.totalPages,t.orders=e.orders}))}))}));break;case 3:t.openConfirm("Thao t\xe1c n\xe0y kh\xf4ng h\u1ec3 ho\xe0n l\u1ea1i, ch\u1eafc ch\u1eafn xo\xe1?",(function(){e.IsFinished?t.orderService.revertUsedScore(e.OrderId).then((function(c){t.orderService.deleteOrder(e.OrderId).then((function(e){t.orderService.searchOrders(t.currentPage,t.pageSize,t.displayStatuses).then((function(e){t.totalPage=e.totalPages,t.orders=e.orders}))}))})):t.orderService.deleteOrder(e.OrderId).then((function(e){t.orderService.searchOrders(t.currentPage,t.pageSize,t.displayStatuses).then((function(e){t.totalPage=e.totalPages,t.orders=e.orders}))}))}))}}),["Th\xeam thanh to\xe1n","In ho\xe1 \u0111\u01a1n","Ho\xe0n t\u1ea5t \u0111\u01a1n","Xo\xe1 \u0111\u01a1n"])}},{key:"editOrder",value:function(e){var t=this;this.globalOrder=this.orders.filter((function(t){return t.OrderId===e}))[0],this.globalPurchases=this.globalOrder.PurchaseItems,this.isEdittingOrder=!0,this.customerService.getById(this.globalOrder.CustomerInfo.Id).then((function(e){e&&(t.globalOrder.CustomerInfo=t.orderService.getCustomerInfo(e,t.globalOrder)),t.router.navigate(["/staff/add-order"])}))}},{key:"viewPurchase",value:function(e){this.globalOrder=this.orders.filter((function(t){return t.OrderId===e}))[0],this.globalPurchases=this.globalOrder.PurchaseItems,this.router.navigate(["staff/view-purchase"])}},{key:"addOrder",value:function(){this.globalOrder=new P.d,this.globalOrderDetail=new P.c,this.isEdittingOrder=!1,this.globalPurchases=[],this.router.navigate(["/staff/add-order"])}},{key:"getDetailById",value:function(e){return this.orders.filter((function(t){return t.OrderDetails.filter((function(t){return t.OrderDetailId===e})).length>0}))[0].OrderDetails.filter((function(t){return t.OrderDetailId===e}))[0]}},{key:"openDetailInfo",value:function(e){var t=this.getDetailById(e);t&&(this.selectedDetail.Shippers=t.Shippers?t.Shippers:[],this.selectedDetail.Florists=t.Florists?t.Florists:[],this.selectedDetail.State=t.State,this.selectedDetail.StateDisplay=ie.f.filter((function(e){return e.State===t.State}))[0].DisplayName,openColorBoard())}},{key:"openOrder",value:function(e){var t=this;getTopScrollPosition((function(c){t.currentOrderListScrollPos=+c,t.selectedOrderId=e.OrderId}))}},{key:"updateShippingDetail",value:function(e,t){var c=this;this.menuOpening((function(i){switch(+i){case 0:c.selectDeliveryTime=c.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd-MM-yyyy"),c.selectReceiveRequestTime=e.DeliveryInfo.DateTime,c.shippingNote=e.ShippingNote;var n={State:e.State,ReceivingTime:c.selectReceiveRequestTime.getTime(),ShippingNote:c.shippingNote};shippingRequest((function(){chooseShipper((function(t){n.State=A.f.OnTheWay,n.ShippingNote=c.shippingNote,n.ReceivingTime=c.selectReceiveRequestTime.getTime(),c.orderDetailService.updateFields(e.OrderDetailId,n).then((function(i){c.orderDetailService.replaceShipper(e.OrderDetailId,c.orderDetailService.getLastestShipping(e).Id,+t).then((function(){c.getOrders()}))}))}))}));break;case 1:c.openConfirm("Ho\xe0n t\u1ea5t giao \u0111\u01a1n n\xe0y?",(function(){getShippingNoteDialog("Ho\xe0n t\u1ea5t",(function(i){c.orderDetailService.shippingConfirm(e,null,i).then((function(i){c.orderDetailService.completeOD(e,t).then((function(){c.getOrders()}))}))}))}));break;case 2:if(e.State!==A.f.OnTheWay)return void c.showInfo("\u0110\u01a1n ch\u01b0a b\u1eaft \u0111\u1ea7u giao!");c.openConfirm("Tr\u1ea3 l\u1ea1i c\u1eeba h\xe0ng \u0111\u01a1n n\xe0y?",(function(){getShippingNoteDialog("Tr\u1ea3 \u0111\u01a1n",(function(t){c.orderDetailService.updateShippingFields(c.orderDetailService.getLastestShipping(e).Id,{Note:t,CompleteTime:(new Date).getTime(),DeliveryImageUrl:""}).then((function(t){c.orderDetailService.updateFields(e.OrderDetailId,{State:A.f.SentBack}).then((function(e){c.getOrders()}))})).catch((function(e){c.showError(e)}))}))}));break;case 4:c.orderDetailService.updateFields(e.OrderDetailId,{State:A.f.Canceled}).then((function(){c.getOrders()}));break;case 3:c.globalOrderDetail=e,c.globalOrder=t,c.router.navigate(["staff/order-detail-view"])}}),["Ch\u1ecdn l\u1ea1i Shipper","Ho\xe0n th\xe0nh giao","Tr\u1ea3 \u0111\u01a1n v\u1ec1","Xem chi ti\u1ebft","Hu\u1ef7  \u0111\u01a1n"])}},{key:"updateSentBackDetailState",value:function(e,t){var c=this;this.menuOpening((function(i){switch(+i){case 2:c.globalOrderDetail=e,c.globalOrder=t,c.router.navigate(["staff/order-detail-view"]);break;case 0:c.assignShipper(e);break;case 1:c.selectDeliveryTime=c.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd-MM-yyyy"),c.selectMakingRequestTime=new Date,c.makingNote=e.MakingNote,makingTimeRequest((function(){chooseFlorist((function(t){c.transferToFlorist(e,A.c.Fixing,+t)}))}));break;case 3:c.orderDetailService.updateFields(e.OrderDetailId,{State:A.f.Canceled}).then((function(){c.getOrders()}))}}),["Ch\u1ecdn l\u1ea1i shipper","L\xe0m l\u1ea1i \u0111\u01a1n","Xem chi ti\u1ebft","Hu\u1ef7  \u0111\u01a1n"])}},{key:"assignShipper",value:function(e){var t=this;this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd-MM-yyyy"),this.selectReceiveRequestTime=e.DeliveryInfo.DateTime,this.shippingNote="";var c={State:A.f.OnTheWay,ReceivingTime:this.selectReceiveRequestTime.getTime(),ShippingNote:this.shippingNote};shippingRequest((function(){chooseShipper((function(i){c.State=A.f.OnTheWay,c.ReceivingTime=t.selectReceiveRequestTime.getTime(),c.ShippingNote=t.shippingNote,t.orderDetailService.updateFields(e.OrderDetailId,c).then((function(c){t.orderDetailService.assignSingleShipper(e.OrderDetailId,+i,(new Date).getTime()).then((function(){t.getOrders()}))}))}))}))}},{key:"updateMakingDetailState",value:function(e,t){var c=this;this.menuOpening((function(i){switch(+i){case 0:c.orderDetailService.updateFields(e.OrderDetailId,{State:e.State===A.f.Making?A.f.Added:A.f.SentBack,MakingRequestTime:0,FloristId:null}).then((function(){c.getOrders()}));break;case 1:c.selectDeliveryTime=c.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd-MM-yyyy"),c.selectMakingRequestTime=new Date(e.MakingRequestTime),c.makingNote=e.MakingNote;var n={State:e.State,MakingRequestTime:c.selectMakingRequestTime.getTime(),MakingNote:c.makingNote};makingTimeRequest((function(){chooseFlorist((function(t){n.MakingNote=c.makingNote,n.MakingRequestTime=c.selectMakingRequestTime.getTime(),c.orderDetailService.updateFields(e.OrderDetailId,n).then((function(i){c.orderDetailService.replaceFlorist(e.OrderDetailId,c.orderDetailService.getLastestMaking(e).Id,+t).then((function(){c.getOrders()}))}))}))}));break;case 2:c.openConfirm("Ho\xe0n th\xe0nh \u0111\u01a1n n\xe0y?",(function(){c.orderDetailService.updateMakingFields(c.orderDetailService.getLastestMaking(e).Id,{CompleteTime:(new Date).getTime()}).then((function(){c.orderDetailService.updateFields(e.OrderDetailId,{State:A.f.Comfirming}).then((function(){c.assignShipper(e)}))}))}));break;case 3:c.globalOrderDetail=e,c.globalOrder=t,c.router.navigate(["staff/order-detail-view"]);break;case 4:c.orderDetailService.updateFields(e.OrderDetailId,{State:A.f.Canceled}).then((function(){c.getOrders()}))}}),["X\u1eed l\xfd sau","\u0110\u1ed5i florist","Giao h\xe0ng","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}},{key:"updatConfirmingDetailState",value:function(e,t){var c=this;this.menuOpening((function(i){switch(+i){case 0:c.assignShipper(e);break;case 1:c.selectDeliveryTime=c.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd-MM-yyyy"),c.selectMakingRequestTime=e.DeliveryInfo.DateTime,c.makingNote="",makingTimeRequest((function(){chooseFlorist((function(t){c.transferToFlorist(e,A.c.Fixing,+t)}))}));break;case 2:c.globalOrderDetail=e,c.globalOrder=t,c.router.navigate(["staff/order-detail-view"]);break;case 3:c.orderDetailService.updateFields(e.OrderDetailId,{State:A.f.Canceled,MakingRequestTime:0}).then((function(){c.getOrders()}))}}),["Giao h\xe0ng","S\u1eeda l\u1ea1i \u0111\u01a1n","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}},{key:"transferToFlorist",value:function(e,t,c){var i=this;this.orderDetailService.assignSingleMaking(e.OrderDetailId,c,(new Date).getTime(),t).then((function(){i.orderDetailService.updateFields(e.OrderDetailId,{MakingNote:i.makingNote,State:t===A.c.Making?A.f.Making:A.f.Fixing,MakingRequestTime:i.selectMakingRequestTime.getTime()}).then((function(){i.getOrders()}))}))}},{key:"updateAddedDetailState",value:function(e,t){var c=this;this.menuOpening((function(i){switch(+i){case 0:c.selectDeliveryTime=c.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd/MM/yyyy"),c.selectMakingRequestTime=e.MakingRequestTime?new Date(e.MakingRequestTime):e.DeliveryInfo.DateTime,c.makingNote=e.MakingNote?e.MakingNote:"",makingTimeRequest((function(){chooseFlorist((function(t){c.transferToFlorist(e,A.c.Making,+t)}))}));break;case 1:c.globalOrderDetail=e,c.globalOrder=t,c.router.navigate(["staff/order-detail-view"]);break;case 2:c.assignShipper(e);break;case 3:c.orderDetailService.completeOD(e,t).then((function(e){return Object(p.a)(c,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.getOrders();case 1:case"end":return e.stop()}}),e,this)})))}))}}),["Chuy\u1ec3n cho Florist","Xem chi ti\u1ebft","Giao h\xe0ng","K\u1ebft th\xfac chi ti\u1ebft \u0111\u01a1n"])}},{key:"deleteOrderDetail",value:function(e,t){var c=t.OrderDetails.indexOf(e);if(t.OrderDetails.splice(c,1),t.OrderDetails.length<=0){var i=this.orders.filter((function(e){return e.OrderId===t.OrderId}))[0];this.orders.splice(this.orders.indexOf(i),1)}}}]),c}(C)).\u0275fac=function(e){return new(e||gt)(f.bc(F.a),f.bc(l.a),f.bc(l.b),f.bc(M.a),f.bc(ne),f.bc(et.a),f.bc(X.a),f.bc(tt.a),f.bc(E.b),f.bc(ct.a),f.bc(N.a))},gt.\u0275cmp=f.Vb({type:gt,selectors:[["app-orders-manage"]],features:[f.Lb],decls:107,vars:27,consts:[["id","order",1,"page-content"],[1,"container","order-add"],[1,"row"],[1,"col-2"],[1,"col-8","text-center"],["href","javascript:void(0);",1,"btn","main-btn",3,"click"],[1,"col-2","order-noti","text-right"],["routerLink","/staff/add-purchse"],["src","../../../assets/images/money.svg","alt","",1,"main-filter"],[1,"container","order-list"],[1,"row","order-list-top"],[1,"col-2","order-filter","text-left",3,"click"],[1,"main-bg"],["src","../../../assets/images/filter.svg","alt","",1,"main-filter"],[1,"col-8","order-search"],["placeholder","T\xean ho\u1eb7c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i KH...",3,"delayTimeSpan","searchTextInvoke"],[1,"col-2","order-check","text-right"],["routerLink","/staff/sort-order-changing",1,"main-bg"],["src","../../../assets/images/check.svg","alt","",1,"main-filter"],[1,"paging"],[1,"paging-arrow","paging-prev","main-bg",3,"click"],[1,"fa","fa-angle-left"],[1,"paging-arrow","paging-next","main-bg",3,"click"],[1,"fa","fa-angle-right"],[1,"row","order-list-bot"],["id","accordionOrder",1,"col-12","order-content","accordion","cusScroll"],["class","order-content-item",3,"id",4,"ngFor","ngForOf"],["id","makingTimeRequest",1,"popup-content"],[2,"font-weight","bold","font-size","15px","margin-left","3px"],[1,"form-group"],[1,"custom-label"],["id","selectMakingRequestTime","name","selectMakingRequestTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],["id","makingNote","name","makingNote",1,"mainForm",2,"width","100%","height","130px",3,"ngModel","ngModelChange"],[1,"col-6","mx-auto","text-center"],["type","button","id","choose-florist-btn",1,"btn","main-btn","w-100","mt-3"],["type","button","id","cancel-btn",1,"btn","grey-btn","w-100","mt-3"],["id","shippingRequest",1,"popup-content"],["id","selectReceiveRequestTime","name","selectReceiveRequestTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],["dt2",""],["id","shippingNote","name","shippingNote",1,"mainForm",2,"width","100%","height","130px",3,"ngModel","ngModelChange"],["id","colorBoard",1,"popup-content"],[1,"colorList"],[1,"colorInfo","colorItem"],[3,"state"],[1,"colorInfo"],[4,"ngFor","ngForOf"],["style","margin-left: 5px;",4,"ngFor","ngForOf"],["id","viewed",1,"popup-content","florist"],[1,"viewedList"],["class","viewItem",3,"id",4,"ngFor","ngForOf"],["id","viewed",1,"popup-content","shipper"],["class","viewItem-three-column",3,"id",4,"ngFor","ngForOf"],[1,"customer-support"],["alt","",1,"customer-avatar",3,"src"],[1,"customer-name"],["href","tel:0000",1,"customer-phone"],[1,"customer-position"],["id","logoutBtn",1,"customer-position",3,"click"],[1,"order-content-item",3,"id"],[1,"item-top",3,"id"],[1,"item-code",3,"click"],[1,"item-info",3,"click"],[1,"item-name"],[1,"item-name",2,"font-size","12px","margin-top","1px"],[1,"item-price"],[1,"item-date"],["data-toggle","collapse","aria-expanded","false",1,"collapsed",3,"id","click"],[1,"item-bot","collapse",3,"id"],[1,"order-product-list","cusScroll"],["class","order-product-item",4,"ngFor","ngForOf"],["href","javascript:void(0);","class","order-edit",3,"click",4,"ngIf"],[1,"order-product-item"],[3,"state","id","index","onClicked"],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPrice"],[1,"item-quantity"],[1,"item-time"],["href","javascript:void(0);",1,"order-edit",3,"click"],[1,"fa","fa-pencil"],[2,"margin-left","5px"],[1,"viewItem",3,"id"],["alt","",1,"itemAva",3,"src"],[1,"itemName"],[1,"viewItem-three-column",3,"id"],[1,"itemRole"]],template:function(e,t){if(1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.cc(3,"div",3),f.hc(4,"div",4),f.hc(5,"a",5),f.pc("click",(function(){return t.addOrder()})),f.Rc(6,"Th\xeam \u0111\u01a1n"),f.gc(),f.gc(),f.hc(7,"div",6),f.hc(8,"a",7),f.cc(9,"img",8),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(10,"div",9),f.hc(11,"div",10),f.hc(12,"div",11),f.pc("click",(function(){return t.filterByState()})),f.hc(13,"a",12),f.cc(14,"img",13),f.gc(),f.gc(),f.hc(15,"div",14),f.hc(16,"mobile-search-box",15),f.pc("searchTextInvoke",(function(e){return t.searchOrder(e)})),f.gc(),f.gc(),f.hc(17,"div",16),f.hc(18,"a",17),f.cc(19,"img",18),f.gc(),f.gc(),f.gc(),f.hc(20,"ul",19),f.hc(21,"li",20),f.pc("click",(function(){return t.goToPage(t.currentPage-1)})),f.cc(22,"i",21),f.gc(),f.hc(23,"li",22),f.pc("click",(function(){return t.goToPage(t.currentPage+1)})),f.cc(24,"i",23),f.gc(),f.gc(),f.hc(25,"div",24),f.hc(26,"ul",25),f.Pc(27,st,21,19,"li",26),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(28,"div",27),f.hc(29,"label"),f.Rc(30,"Th\u1eddi gian giao: "),f.gc(),f.hc(31,"span",28),f.Rc(32),f.gc(),f.hc(33,"div",29),f.hc(34,"label",30),f.Rc(35,"Th\u1eddi gian ho\xe0n th\xe0nh: "),f.gc(),f.hc(36,"input",31),f.pc("ngModelChange",(function(e){return t.selectMakingRequestTime=e})),f.gc(),f.cc(37,"owl-date-time",32,33),f.gc(),f.hc(39,"div",29),f.hc(40,"label",30),f.Rc(41,"Ghi ch\xfa: "),f.gc(),f.hc(42,"textarea",34),f.pc("ngModelChange",(function(e){return t.makingNote=e})),f.gc(),f.gc(),f.hc(43,"div",2),f.hc(44,"div",35),f.hc(45,"button",36),f.Rc(46,"Ch\u1ecdn Florist"),f.gc(),f.gc(),f.hc(47,"div",35),f.hc(48,"button",37),f.Rc(49,"H\u1ee7y"),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(50,"div",38),f.hc(51,"label"),f.Rc(52,"Th\u1eddi nh\u1eadn d\u1ef1 ki\u1ebfn: "),f.gc(),f.hc(53,"span",28),f.Rc(54),f.gc(),f.hc(55,"div",29),f.hc(56,"label",30),f.Rc(57,"Th\u1eddi gian nh\u1eadn: "),f.gc(),f.hc(58,"input",39),f.pc("ngModelChange",(function(e){return t.selectReceiveRequestTime=e})),f.gc(),f.cc(59,"owl-date-time",32,40),f.gc(),f.hc(61,"div",29),f.hc(62,"label",30),f.Rc(63,"Ghi ch\xfa giao h\xe0ng: "),f.gc(),f.hc(64,"textarea",41),f.pc("ngModelChange",(function(e){return t.shippingNote=e})),f.gc(),f.gc(),f.hc(65,"div",2),f.hc(66,"div",35),f.hc(67,"button",36),f.Rc(68,"Ch\u1ecdn Shipper"),f.gc(),f.gc(),f.hc(69,"div",35),f.hc(70,"button",37),f.Rc(71,"H\u1ee7y"),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(72,"div",42),f.hc(73,"ul",43),f.hc(74,"li",44),f.cc(75,"app-status-point",45),f.hc(76,"label"),f.Rc(77),f.gc(),f.gc(),f.hc(78,"li",46),f.hc(79,"label"),f.Rc(80,"Th\u1ee3 c\u1eafm hoa: "),f.gc(),f.Pc(81,ut,2,1,"span",47),f.gc(),f.hc(82,"li",46),f.hc(83,"label"),f.Rc(84,"Ng\u01b0\u1eddi giao hoa: "),f.gc(),f.Pc(85,lt,2,1,"span",48),f.gc(),f.gc(),f.gc(),f.hc(86,"div",49),f.hc(87,"h3",12),f.Rc(88,"Ch\u1ecdn Florist"),f.gc(),f.hc(89,"ul",50),f.Pc(90,dt,5,6,"li",51),f.gc(),f.gc(),f.hc(91,"div",52),f.hc(92,"h3",12),f.Rc(93,"Ch\u1ecdn Shipper"),f.gc(),f.hc(94,"ul",50),f.Pc(95,ht,7,7,"li",53),f.gc(),f.gc(),f.hc(96,"div",54),f.cc(97,"img",55),f.uc(98,"ImgPipe"),f.hc(99,"p",56),f.Rc(100),f.gc(),f.hc(101,"a",57),f.Rc(102),f.gc(),f.hc(103,"p",58),f.Rc(104),f.gc(),f.hc(105,"p",59),f.pc("click",(function(){return t.logout()})),f.Rc(106,"\u0110\u0103ng xu\u1ea5t"),f.gc(),f.gc()),2&e){var c=f.Hc(38),i=f.Hc(60);f.Ob(16),f.Ac("delayTimeSpan",1e3),f.Ob(11),f.Ac("ngForOf",t.orders),f.Ob(5),f.Sc(t.selectDeliveryTime),f.Ob(4),f.Ac("owlDateTime",c)("owlDateTimeTrigger",c)("ngModel",t.selectMakingRequestTime),f.Ob(1),f.Ac("stepMinute",5),f.Ob(5),f.Ac("ngModel",t.makingNote),f.Ob(12),f.Sc(t.selectDeliveryTime),f.Ob(4),f.Ac("owlDateTime",i)("owlDateTimeTrigger",i)("ngModel",t.selectReceiveRequestTime),f.Ob(1),f.Ac("stepMinute",5),f.Ob(5),f.Ac("ngModel",t.shippingNote),f.Ob(11),f.Ac("state",t.selectedDetail.State),f.Ob(2),f.Sc(t.selectedDetail.StateDisplay),f.Ob(4),f.Ac("ngForOf",t.selectedDetail.Florists),f.Ob(4),f.Ac("ngForOf",t.selectedDetail.Shippers),f.Ob(5),f.Ac("ngForOf",t.florists),f.Ob(5),f.Ac("ngForOf",t.shippers),f.Ob(2),f.Bc("src",f.wc(98,24,t.CurrentUser.Avt,"UserAvt"),f.Lc),f.Ob(3),f.Sc(t.CurrentUser.FullName),f.Ob(2),f.Sc(t.CurrentUser.PhoneNumber),f.Ob(2),f.Sc(t.CurrentUser.Role)}},directives:[l.c,rt,D.k,U.c,B.b,U.f,B.k,B.n,U.b,Te,D.l],pipes:[q.a,E.a,E.b,E.c],styles:[".item-detail-info[_ngcontent-%COMP%]   .item-date[_ngcontent-%COMP%]{margin-left:7px}"]}),gt);function pt(e,t){if(1&e&&(f.hc(0,"div",37),f.hc(1,"div",10),f.Rc(2),f.gc(),f.hc(3,"div",11),f.Rc(4),f.gc(),f.hc(5,"div",12),f.Rc(6),f.gc(),f.gc()),2&e){var c=t.$implicit;f.Pb("data-id",c.Id),f.Ob(2),f.Sc(c.FullName),f.Ob(2),f.Sc(c.PhoneNumber),f.Ob(2),f.Sc(c.MembershipInfo.MembershipType)}}function ft(e,t){1&e&&(f.hc(0,"div"),f.Rc(1," M\xe3 l\xe0 b\u1eaft bu\u1ed9c "),f.gc())}function vt(e,t){1&e&&(f.hc(0,"div"),f.Rc(1," T\xean t\u1ed1i thi\u1ec3u 3 k\xfd t\u1ef1 "),f.gc())}function bt(e,t){if(1&e&&(f.hc(0,"div",38),f.Pc(1,ft,2,0,"div",39),f.Pc(2,vt,2,0,"div",39),f.gc()),2&e){f.tc();var c=f.Hc(27);f.Ob(1),f.Ac("ngIf",c.errors.required),f.Ob(1),f.Ac("ngIf",c.errors.minlength)}}function Ot(e,t){1&e&&(f.hc(0,"div"),f.Rc(1," T\xean t\u1ed1i thi\u1ec3u 1 k\xfd t\u1ef1 "),f.gc())}function yt(e,t){if(1&e&&(f.hc(0,"div",38),f.Pc(1,Ot,2,0,"div",39),f.gc()),2&e){f.tc();var c=f.Hc(31);f.Ob(1),f.Ac("ngIf",c.errors.minlength)}}function Dt(e,t){1&e&&(f.hc(0,"div"),f.Rc(1," SDT t\u1ed1i thi\u1ec3u 3 k\xfd t\u1ef1 "),f.gc())}function It(e,t){if(1&e&&(f.hc(0,"div",38),f.Pc(1,Dt,2,0,"div",39),f.gc()),2&e){f.tc();var c=f.Hc(43);f.Ob(1),f.Ac("ngIf",c.errors.minlength)}}function St(e,t){if(1&e&&(f.hc(0,"li",42),f.hc(1,"label"),f.Rc(2,"Ng\xe0y sinh: "),f.gc(),f.hc(3,"span"),f.Rc(4),f.uc(5,"myDatePipe"),f.gc(),f.gc()),2&e){var c=f.tc(2);f.Ob(4),f.Sc(f.vc(5,1,c.selectedCustomer.Birthday))}}function kt(e,t){if(1&e&&(f.hc(0,"li",42),f.hc(1,"label"),f.Rc(2,"Facebook: "),f.gc(),f.hc(3,"span"),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc(2);f.Ob(4),f.Sc(c.selectedCustomer.ContactInfo.Facebook)}}function Ct(e,t){if(1&e&&(f.hc(0,"li",42),f.hc(1,"label"),f.Rc(2,"Zalo: "),f.gc(),f.hc(3,"span"),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc(2);f.Ob(4),f.Sc(c.selectedCustomer.ContactInfo.Zalo)}}function Pt(e,t){if(1&e&&(f.hc(0,"li",42),f.hc(1,"label"),f.Rc(2,"Instagram: "),f.gc(),f.hc(3,"span"),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc(2);f.Ob(4),f.Sc(c.selectedCustomer.ContactInfo.Instagram)}}function At(e,t){if(1&e&&(f.hc(0,"li",42),f.hc(1,"label"),f.Rc(2,"Skype: "),f.gc(),f.hc(3,"span"),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc(2);f.Ob(4),f.Sc(c.selectedCustomer.ContactInfo.Skype)}}function Tt(e,t){if(1&e&&(f.hc(0,"div",40),f.hc(1,"ul",41),f.hc(2,"li",42),f.hc(3,"label"),f.Rc(4,"H\u1ecd t\xean:"),f.gc(),f.hc(5,"span"),f.Rc(6),f.gc(),f.gc(),f.hc(7,"li",42),f.hc(8,"label"),f.Rc(9,"SDT: "),f.gc(),f.hc(10,"span"),f.Rc(11),f.gc(),f.gc(),f.hc(12,"li",42),f.hc(13,"label"),f.Rc(14,"Danh x\u01b0ng: "),f.gc(),f.hc(15,"span"),f.Rc(16),f.gc(),f.gc(),f.Pc(17,St,6,3,"li",43),f.Pc(18,kt,5,1,"li",43),f.Pc(19,Ct,5,1,"li",43),f.Pc(20,Pt,5,1,"li",43),f.Pc(21,At,5,1,"li",43),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(6),f.Sc(c.selectedCustomer.FullName),f.Ob(5),f.Sc(c.selectedCustomer.PhoneNumber),f.Ob(5),f.Sc(c.selectedCustomer.Sex),f.Ob(1),f.Ac("ngIf",c.selectedCustomer.Birthday&&c.selectedCustomer.Birthday>0),f.Ob(1),f.Ac("ngIf",c.selectedCustomer.ContactInfo&&c.selectedCustomer.ContactInfo.Facebook),f.Ob(1),f.Ac("ngIf",c.selectedCustomer.ContactInfo&&c.selectedCustomer.ContactInfo.Zalo),f.Ob(1),f.Ac("ngIf",c.selectedCustomer.ContactInfo&&c.selectedCustomer.ContactInfo.Instagram),f.Ob(1),f.Ac("ngIf",c.selectedCustomer.ContactInfo&&c.selectedCustomer.ContactInfo.Skype)}}var wt,Rt,Mt=((wt=function(e){n(c,e);var t=o(c);function c(e,i){var n;return h(this,c),(n=t.call(this)).customerService=e,n._ngZone=i,n.Title="Ch\u1ecdn kh\xe1ch h\xe0ng",n.IsDataLosingWarning=!1,n.totalCount=0,n.newCustomer=new W.a,n.customers=[],n.selectedCustomer=new W.a,window.searchProdReference={component:s(n),zone:n._ngZone,itemSelected:function(e){return n.setSelectedCustomer(e)}},n}return d(c,[{key:"setSelectedCustomer",value:function(e){var t=this,c=this.customers.filter((function(t){return t.Id===e}))[0],i=[],n=!0;this.selectedCustomer&&this.selectedCustomer.Id===c.Id?(i.push("B\u1ecf ch\u1ecdn"),n=!1):(this.selectedCustomer=c,i.push("Ch\u1ecdn")),i.push("Xem th\xf4ng tin chi ti\u1ebft"),this.menuOpening((function(e){switch(+e){case 0:n?t.selectConfirm():t.unSelectCustomer();break;case 1:viewCustomerInfo()}}),i)}},{key:"Init",value:function(){var e=this;this.customerService.getCount().then((function(t){e.totalCount=t+1,e.newCustomer.Id=k.a.detectCustomerId(e.totalCount)})),this.selectedCustomer=new W.a,this.globalOrder.CustomerInfo&&this.searchCustomer(this.globalOrder.CustomerInfo.PhoneNumber?this.globalOrder.CustomerInfo.PhoneNumber:this.globalOrder.CustomerInfo.Name)}},{key:"addCustomer",value:function(e){var t=this;if(e.valid){this.selectedCustomer=new W.a;var c=new W.a;c.FullName=this.newCustomer.FullName,c.PhoneNumber=this.newCustomer.PhoneNumber,c.Sex=this.newCustomer.Sex,c.MembershipInfo.MembershipType=A.d.NewCustomer,c.MembershipInfo.AccumulatedAmount=0,c.MembershipInfo.AvailableScore=0,c.MembershipInfo.UsedScoreTotal=0,c.Id=this.newCustomer.Id,this.customerService.createCustomer(c).then((function(e){t.newCustomer=new W.a,t.selectedCustomer=c,t.customers.push(c),t.globalOrder.CustomerInfo=P.a.toViewModel(t.selectedCustomer),closeAddCustomerDialog(),t.totalCount+=1,t.newCustomer=new W.a,t.newCustomer.Id=k.a.detectCustomerId(t.totalCount),setTimeout((function(){setSelectedCustomerItem(t.selectedCustomer.Id)}),500)}))}}},{key:"unSelectCustomer",value:function(){this.globalOrder.CustomerInfo=new P.a,this.selectedCustomer=null,this.newCustomer=new W.a,setSelectedCustomerItem("")}},{key:"selectConfirm",value:function(){null!=this.selectedCustomer?this.globalOrder.CustomerInfo.Id!==this.selectedCustomer.Id?(this.globalOrder.CustomerInfo=P.a.toViewModel(this.selectedCustomer),this.OnBackNaviage()):this.OnBackNaviage():this.showError("Ch\u01b0a ch\u1ecdn kh\xe1ch h\xe0ng n\xe0o c\u1ea3!!!")}},{key:"searchCustomer",value:function(e){var t=this;e&&""!==e?this.customerService.getList(-1,-1,A.d.All,e).then((function(e){t.customers=e.Customers,setTimeout((function(){null!=t.globalOrder.CustomerInfo.Id&&(setSelectedCustomerItem(t.globalOrder.CustomerInfo.Id),t.selectedCustomer=e.Customers.find((function(e){return e.Id===t.globalOrder.CustomerInfo.Id})))}),50)})):this.customers=[]}}]),c}(C)).\u0275fac=function(e){return new(e||wt)(f.bc(F.a),f.bc(f.H))},wt.\u0275cmp=f.Vb({type:wt,selectors:[["app-select-customer"]],features:[f.Lb],decls:53,vars:12,consts:[["id","customerInfo",1,"page-content"],[1,"container"],[1,"row","checkTop","search"],[1,"col-10","filterSearch"],["placeholder","T\xean ho\u1eb7c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i KH...",3,"delayTimeSpan","searchTextInvoke"],[1,"col-2","filterAdd","text-right"],["onclick","openAddInfo()",1,"main-bg"],["src","../../../../assets/images/addnew.svg","alt","",1,"main-filter"],[1,"nameTable"],[1,"tableHead"],[1,"tableLeft"],[1,"tableCenter"],[1,"tableRight"],["id","customer-list",1,"tableBody","cusScroll"],["class","tableRow main-bg customer-item","onclick","selectItem(this,'.customer-item')",4,"ngFor","ngForOf"],[1,"row","prodDone"],[1,"col-8","mx-auto","text-center"],["href","javascript:void(0);",1,"btn","main-btn","w-100",3,"click"],["id","infoAdd",1,"popup-content"],["autocomplete","on",1,"addInfoForm",3,"submit"],["form","ngForm"],[1,"form-group"],["type","text","name","Id","id","Id","required","","minlength","3","placeholder","M\xe3 KH...",1,"mainForm",3,"ngModel","ngModelChange"],["Id","ngModel"],["class","alert alert-danger",4,"ngIf"],["type","text","name","FullName","id","FullName","minlength","1","placeholder","T\xean \u0111\u1ea7y \u0111\u1ee7 ...",1,"mainForm",3,"ngModel","ngModelChange"],["FullName","ngModel"],["id","newCustomer.Sex","name","newCustomer.Sex",1,"mainForm",3,"ngModel","ngModelChange"],["selected",""],[3,"ngValue"],["type","tel","name","PhoneNumber","id","PhoneNumber","minlength","3","placeholder","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i...",1,"mainForm",3,"ngModel","ngModelChange"],["PhoneNumber","ngModel"],[1,"row"],[1,"col-6","mx-auto","text-center"],["type","button","id","cancel-button",1,"btn","grey-btn","w-100","mt-3"],["type","submit",1,"btn","main-btn","w-100","mt-3","btn-success"],["id","colorBoard","class","popup-content",4,"ngIf"],["onclick","selectItem(this,'.customer-item')",1,"tableRow","main-bg","customer-item"],[1,"alert","alert-danger"],[4,"ngIf"],["id","colorBoard",1,"popup-content"],[1,"colorList"],[1,"colorInfo"],["class","colorInfo",4,"ngIf"]],template:function(e,t){if(1&e){var c=f.ic();f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.hc(4,"mobile-search-box",4),f.pc("searchTextInvoke",(function(e){return t.searchCustomer(e)})),f.gc(),f.gc(),f.hc(5,"div",5),f.hc(6,"button",6),f.cc(7,"img",7),f.gc(),f.gc(),f.gc(),f.hc(8,"div",8),f.hc(9,"div",9),f.hc(10,"div",10),f.Rc(11,"H\u1ecd t\xean"),f.gc(),f.hc(12,"div",11),f.Rc(13,"SDT"),f.gc(),f.hc(14,"div",12),f.Rc(15,"Th\xe0nh vi\xean"),f.gc(),f.gc(),f.hc(16,"div",13),f.Pc(17,pt,7,4,"div",14),f.gc(),f.gc(),f.hc(18,"div",15),f.hc(19,"div",16),f.hc(20,"a",17),f.pc("click",(function(){return t.selectConfirm()})),f.Rc(21,"Xong"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(22,"div",18),f.hc(23,"form",19,20),f.pc("submit",(function(){f.Jc(c);var e=f.Hc(24);return t.addCustomer(e)})),f.hc(25,"div",21),f.hc(26,"input",22,23),f.pc("ngModelChange",(function(e){return t.newCustomer.Id=e})),f.gc(),f.Pc(28,bt,3,2,"div",24),f.gc(),f.hc(29,"div",21),f.hc(30,"input",25,26),f.pc("ngModelChange",(function(e){return t.newCustomer.FullName=e})),f.gc(),f.Pc(32,yt,2,1,"div",24),f.gc(),f.hc(33,"div",21),f.hc(34,"select",27),f.pc("ngModelChange",(function(e){return t.newCustomer.Sex=e})),f.hc(35,"option",28),f.Rc(36,"Danh x\u01b0ng"),f.gc(),f.hc(37,"option",29),f.Rc(38,"Anh"),f.gc(),f.hc(39,"option",29),f.Rc(40,"Ch\u1ecb"),f.gc(),f.gc(),f.gc(),f.hc(41,"div",21),f.hc(42,"input",30,31),f.pc("ngModelChange",(function(e){return t.newCustomer.PhoneNumber=e})),f.gc(),f.Pc(44,It,2,1,"div",24),f.gc(),f.hc(45,"div",32),f.hc(46,"div",33),f.hc(47,"button",34),f.Rc(48,"H\u1ee7y"),f.gc(),f.gc(),f.hc(49,"div",33),f.hc(50,"button",35),f.Rc(51,"L\u01b0u"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.Pc(52,Tt,22,8,"div",36)}if(2&e){var i=f.Hc(27),n=f.Hc(31),r=f.Hc(43);f.Ob(4),f.Ac("delayTimeSpan",1e3),f.Ob(13),f.Ac("ngForOf",t.customers),f.Ob(9),f.Ac("ngModel",t.newCustomer.Id),f.Ob(2),f.Ac("ngIf",i.invalid&&(i.dirty||i.touched)),f.Ob(2),f.Ac("ngModel",t.newCustomer.FullName),f.Ob(2),f.Ac("ngIf",n.invalid&&(n.dirty||n.touched)),f.Ob(2),f.Ac("ngModel",t.newCustomer.Sex),f.Ob(3),f.Ac("ngValue","Male"),f.Ob(2),f.Ac("ngValue","Female"),f.Ob(3),f.Ac("ngModel",t.newCustomer.PhoneNumber),f.Ob(2),f.Ac("ngIf",r.invalid&&(r.dirty||r.touched)),f.Ob(8),f.Ac("ngIf",t.selectedCustomer)}},directives:[rt,D.k,B.v,B.l,B.m,B.b,B.r,B.h,B.k,B.n,D.l,B.s,B.o,B.u],pipes:[E.b],styles:[""]}),wt),Ft=r("nAti"),Nt=r("kLqA"),xt=function(e){n(c,e);var t=o(c);function c(){var e;return h(this,c),(e=t.call(this)).FolderName="/tempProduct",e}return d(c)}(function(e){n(c,e);var t=o(c);function c(){return h(this,c),t.apply(this,arguments)}return d(c)}(r("sWfF").a)),Lt=((Rt=function(e){n(c,e);var t=o(c);function c(){return h(this,c),t.call(this)}return d(c,[{key:"tableName",get:function(){return"/tempProducts"}},{key:"deleteFile",value:function(e){var t=new xt;return this.storageService.deleteFile(e,t.FolderName)}},{key:"addFile",value:function(e,t,c){this.storageService.pushFileToStorage(e,t,(function(e){null===e&&c("ERROR"),c(e.Url)}))}},{key:"addFileFromBase64String",value:function(e,t,c){this.storageService.pushStringToStorage(e,t,(function(e){null===e&&c("ERROR"),c(e.Url)}))}}]),c}(function(){function t(){h(this,t);var e=v.a.getInjector();this.globalService=e.get(b.a),this.storageService=e.get(ne)}return d(t,[{key:"tableRef",get:function(){return this.db.ref(this.tableName)}},{key:"startLoading",value:function(){this.globalService.startLoading()}},{key:"stopLoading",value:function(){this.globalService.stopLoading()}},{key:"errorToast",value:function(e){this.globalService.showError(e)}},{key:"infoToast",value:function(e){this.globalService.showInfo(e)}},{key:"warningToast",value:function(e){this.globalService.showWarning(e)}},{key:"successToast",value:function(e){this.globalService.showSuccess(e)}},{key:"db",get:function(){return null}},{key:"deleteFileByUrl",value:function(e,t){var c=this;e&&""!==e?(this.startLoading(),this.tableRef.orderByChild("Url").equalTo(e).once("value").then((function(e){var i;if(e.forEach((function(e){i=e.val()})),!i)return c.stopLoading(),void t(!0);c.storageService.deleteFile(i.Name,i.FolderName).then((function(){c.stopLoading(),t(!0),c.delete(i.Id)})).catch((function(e){t(!1),c.stopLoading(),c.errorToast(e)}))}))):t(!0)}},{key:"updateList",value:function(e,t){var c=this;return this.tableRef.update(e,(function(e){e?c.errorToast(e.message):t()}))}},{key:"getByFieldName",value:function(e,t){var c=this;return this.globalService.startLoading(),this.tableRef.orderByChild(e).equalTo(t).once("value").then((function(e){c.globalService.stopLoading();var t=[];return e.forEach((function(e){var c=e.val();t.push(c)})),t})).catch((function(e){return c.globalService.stopLoading(),c.globalService.showError(e),[]}))}},{key:"setAnotherEntity",value:function(e,t){return this.db.ref("".concat(t,"/").concat(e.Id)).set(e).then((function(t){if(t)return e}))}},{key:"set",value:function(e){var t=this;return e.Id&&""!=e.Id||(e.Id=Nt.Guid.create().toString()),this.startLoading(),this.db.ref("".concat(this.tableName,"/").concat(e.Id)).set(e).then((function(c){return t.stopLoading(),e})).catch((function(e){throw t.errorToast(e.message),t.stopLoading(),new e}))}},{key:"insert",value:function(e){this.startLoading();var t=this.tableRef.push(e);return e.Id=t.key,this.update(e)}},{key:"setListSeperate",value:function(t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function c(){var i,n,r;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:i=e(t);try{for(i.s();!(n=i.n()).done;)r=n.value,this.set(r).catch((function(e){throw e}))}catch(o){i.e(o)}finally{i.f()}return c.abrupt("return",[]);case 3:case"end":return c.stop()}}),c,this)})))}},{key:"setList",value:function(t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function c(){var i,n,r,o,a;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:i=[],n=e(t),c.prev=2,n.s();case 4:if((r=n.n()).done){c.next=12;break}return o=r.value,c.next=8,this.set(o).catch((function(e){throw e}));case 8:(a=c.sent)&&i.push(a);case 10:c.next=4;break;case 12:c.next=17;break;case 14:c.prev=14,c.t0=c.catch(2),n.e(c.t0);case 17:return c.prev=17,n.f(),c.finish(17);case 20:return c.abrupt("return",i);case 21:case"end":return c.stop()}}),c,this,[[2,14,17,20]])})))}},{key:"insertList",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var c,i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=[],this.startLoading(),i=0;case 3:if(!(i<e.length)){t.next=11;break}return t.next=6,this.insert(e[i]);case 6:(n=t.sent)?c.push(n):console.log("error insert");case 8:i++,t.next=3;break;case 11:return t.abrupt("return",c);case 12:case"end":return t.stop()}}),t,this)})))}},{key:"getById",value:function(e){var t=this;return this.startLoading(),this.db.ref("".concat(this.tableName,"/").concat(e)).once("value").then((function(e){return t.stopLoading(),e?e.val():null})).catch((function(e){return t.stopLoading(),console.log(e),null}))}},{key:"updateSingleField",value:function(e,t,c){var i=this;this.startLoading();var n={};return n["/".concat(e,"/").concat(t)]=c,this.tableRef.update(n,(function(e){i.stopLoading(),null!=e&&i.errorToast(e.message)}))}},{key:"updateFields",value:function(e){var t=this;return this.startLoading(),this.tableRef.update(e,(function(e){t.stopLoading(),null!=e&&t.errorToast(e.message)}))}},{key:"update",value:function(e){var t=this;return this.tableRef.child(e.Id).set(e).then((function(){return t.stopLoading(),e}))}},{key:"delete",value:function(e){var t=this;return this.startLoading(),this.db.ref("".concat(this.tableName,"/").concat(e)).remove().then((function(){t.stopLoading()}))}},{key:"deleteMany",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.startLoading(),e.forEach((function(e){return Object(p.a)(c,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.db.ref("".concat(this.tableName,"/").concat(e)).remove();case 2:case"end":return t.stop()}}),t,this)})))})),this.stopLoading();case 1:case"end":return t.stop()}}),t,this)})))}},{key:"getAllWithOrder",value:function(e){var t=this;return this.startLoading(),this.tableRef.orderByChild(e).once("value").then((function(e){var c=[];return e.forEach((function(e){c.push(e.val())})),t.stopLoading(),c})).catch((function(e){return t.errorToast(e),t.stopLoading(),[]}))}},{key:"getAll",value:function(){var e=this;return this.startLoading(),this.tableRef.once("value").then((function(t){var c=[];return t.forEach((function(e){c.push(e.val())})),e.stopLoading(),c})).catch((function(t){return e.errorToast(t),e.stopLoading(),[]}))}},{key:"deleteAll",value:function(){var e=this;return this.startLoading(),this.tableRef.remove().then((function(){e.stopLoading()}))}}]),t}())).\u0275fac=function(e){return new(e||Rt)},Rt.\u0275prov=f.Xb({token:Rt,factory:Rt.\u0275fac,providedIn:"root"}),Rt),Bt=r("lBcp");function Ut(e,t){if(1&e&&(f.hc(0,"div",26),f.hc(1,"div",27),f.cc(2,"img",28),f.uc(3,"ImgPipe"),f.hc(4,"h4"),f.Rc(5),f.gc(),f.hc(6,"span"),f.Rc(7),f.uc(8,"myCurrPipe"),f.gc(),f.gc(),f.gc()),2&e){var c=t.$implicit;f.Pb("data-id",c.Id),f.Ob(2),f.Bc("src",f.wc(3,4,c.ImageUrl,"ProductImg"),f.Lc),f.Ob(3),f.Sc(c.Name),f.Ob(2),f.Sc(f.vc(8,7,c.Price))}}function Ht(e,t){if(1&e){var c=f.ic();f.hc(0,"div",29),f.hc(1,"label",30),f.hc(2,"input",31),f.pc("ngModelChange",(function(e){return f.Jc(c),t.$implicit.IsSelected=e})),f.gc(),f.cc(3,"span",32),f.Rc(4),f.gc(),f.gc()}if(2&e){var i=t.$implicit;f.Ob(2),f.Ac("ngModel",i.IsSelected),f.Ob(2),f.Tc("",i.Tag.Name," ")}}var Et,qt=((Et=function(e){n(c,e);var t=o(c);function c(e,i,n,r,o,a,s,u){var l;return h(this,c),(l=t.call(this)).route=e,l.router=i,l.orderDetailService=n,l.productService=r,l._ngZone=o,l.tempProductService=a,l.tagService=s,l.categoryService=u,l.Title="Ch\u1ecdn s\u1ea3n ph\u1ea9m",l.currentPage=1,l.itemsPerPage=18,l.currentMaxPage=1,l.categoryName="",l.currentHardcodeUsedCount=-1,l.searchTerm="",l.priceSearchTerm=0,l.IsDataLosingWarning=!1,l.pagingProducts=[],l.categories=[],l.globalTags=[],l.productSearchingMode=A.g.None,l.images=[],l}return d(c,[{key:"Init",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.selectedProduct=new Ft.a,this.route.queryParams.subscribe((function(e){t.categoryService.getAll().then((function(c){t.categories.push({Value:-1,Name:"T\u1ea5t c\u1ea3"}),c.forEach((function(e){t.categories.push({Value:e.Id,Name:e.Name})})),t.tagService.getAll().then((function(c){c.forEach((function(e){t.globalTags.push({Tag:e,IsSelected:!1})})),t.getProductByCategory(+e.category)}))}))})),window.searchProdReference={component:this,zone:this._ngZone,itemSelected:function(e){return t.setSelectedProduct(e)},tagsSelected:function(){return t.tagsSelected()}};case 1:case"end":return e.stop()}}),e,this)})))}},{key:"tagsSelected",value:function(){var e=[];this.globalTags.forEach((function(t){t.IsSelected&&e.push(t.Tag.Id)})),e.length<=0||(this.currentPage=1,this.filterByTags(e))}},{key:"filterByTags",value:function(e){this.searchTerm="",this.priceSearchTerm=0,this.productSearchingMode=A.g.Name,this.getProductsByPage(1,e)}},{key:"setSelectedProduct",value:function(e){var t=this;this.selectedProduct=this.pagingProducts.filter((function(t){return t.Id==e}))[0];var c=["Xem h\xecnh S\u1ea3n ph\u1ea3m"];(!this.selectedProduct.PriceList||this.selectedProduct.PriceList.length<=0)&&(this.selectedProduct.PriceList=[this.selectedProduct.Price]),this.selectedProduct.PriceList.forEach((function(e){c.push(E.a.currencyFormat(e))})),this.menuOpening((function(e){switch(+e){case 0:var c=q.a.getImgUrl(t.selectedProduct.ImageUrl,ie.c.ProductImg);t.images=[c],setTimeout((function(){viewProductImg(c,(function(){t.images=[]}))}),200);break;default:t.selectedProduct.Price=t.selectedProduct.PriceList[e-1],t.selectProduct()}}),c)}},{key:"getProductByCategory",value:function(e){var t=this;this.productCategory=e,this.searchTerm="",this.priceSearchTerm=0,this.productSearchingMode=A.g.Name,this.categoryName=this.categories.filter((function(e){return e.Value===t.productCategory}))[0].Name,this.getProductsByPage(this.currentPage)}},{key:"filter",value:function(){var e=this;selectProductCategory(this.categories,(function(t){filterFocus(),e.getProductByCategory(+t)}))}},{key:"getProductsByPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function c(){var i,n=this;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(this.globalTags.forEach((function(e){e.IsSelected=!1})),!(e<=0)){c.next=2;break}return c.abrupt("return");case 2:if(!(this.currentMaxPage<e&&this.currentMaxPage>0)){c.next=4;break}return c.abrupt("return");case 4:if(this.pagingProducts=[],this.currentPage=e,this.selectedProduct=new Ft.a,this.productSearchingMode===A.g.Price){c.next=13;break}return c.next=10,this.productService.getRecords(e,this.itemsPerPage,this.productCategory,t,this.searchTerm);case 10:c.t0=c.sent,c.next=16;break;case 13:return c.next=15,this.productService.getRecordsByPrice(e,this.itemsPerPage,this.productCategory,this.priceSearchTerm);case 15:c.t0=c.sent;case 16:(i=c.t0)&&i.products?(i.products.forEach((function(e){n.pagingProducts.push(e.Product)})),this.currentMaxPage=i.totalPages):this.currentMaxPage=1;case 18:case"end":return c.stop()}}),c,this)})))}},{key:"searchProduct",value:function(e){if(e.indexOf("k")===e.length-1||e.indexOf("K")===e.length-1){var t=e.toLowerCase().split("k")[0],c=parseInt(t);NaN!==c&&c>0?(this.productSearchingMode=A.g.Price,this.priceSearchTerm=1e3*c,this.searchTerm="",console.log(this.priceSearchTerm)):(this.productSearchingMode=A.g.Name,this.searchTerm="",this.priceSearchTerm=0)}else this.productSearchingMode=A.g.Name,this.priceSearchTerm=0,this.searchTerm=e;this.getProductsByPage(1)}},{key:"selectProduct",value:function(){this.selectedProduct.Id?(this.globalOrderDetail.ProductName=this.selectedProduct.Name,this.globalOrderDetail.ProductImageUrl=this.selectedProduct.ImageUrl,this.globalOrderDetail.ProductId=this.selectedProduct.Id,this.globalOrderDetail.IsFromHardCodeProduct=!1,this.globalOrderDetail.OriginalPrice=this.selectedProduct.Price,this.globalOrderDetail.ModifiedPrice=this.selectedProduct.Price,this.OnBackNaviage()):this.showError("Ch\u01b0a c\xf3 s\u1ea3n ph\u1ea9m n\xe0o \u0111\u01b0\u1ee3c ch\u1ecdn!!")}}]),c}(C)).\u0275fac=function(e){return new(e||Et)(f.bc(l.a),f.bc(l.b),f.bc(X.a),f.bc(et.a),f.bc(f.H),f.bc(Lt),f.bc(Bt.a),f.bc(Ge.a))},Et.\u0275cmp=f.Vb({type:Et,selectors:[["app-search-product"]],features:[f.Lb],decls:31,vars:6,consts:[["id","prodCate",1,"page-content"],[1,"container"],[1,"prodFilter"],[1,"filterCate"],["href","javascript:void(0)",1,"main-bg",3,"click"],["src","../../../../assets/images/filter2.png","alt",""],["onclick","searchFocus(this)",1,"filterSearch"],["placeholder","M\xe3 s\u1ea3n ph\u1ea9m...",3,"delayTimeSpan","searchTextInvoke"],[1,"filterAdd"],[1,"main-bg"],["src","../../../../assets/images/attach.svg","alt","",1,"main-filter"],["src","../../../../assets/images/price.svg","alt","","onClick","openTagMenu()",1,"main-filter"],[1,"row","prodList","cusScroll"],["onclick","selectItem(this,'.product-item')","class","col-4 product-item","style","padding-left: 0px;padding-right: 0px;",4,"ngFor","ngForOf"],[1,"paging"],[1,"paging-arrow","paging-prev","main-bg",3,"click"],[1,"fa","fa-angle-left"],[1,"paging-arrow","paging-next","main-bg",3,"click"],[1,"fa","fa-angle-right"],[1,"row","prodDone"],[1,"col-8","mx-auto","text-center"],["href","javascript:void(0);",1,"btn","main-btn",3,"click"],["id","tagsMenu",1,"tagMenu","checkMenu","tagMenu"],["class","form-check",4,"ngFor","ngForOf"],["id","view-product",1,"popup-content","view-img-popup-content"],[3,"src","config"],["onclick","selectItem(this,'.product-item')",1,"col-4","product-item",2,"padding-left","0px","padding-right","0px"],[1,"prodItem"],["alt","",3,"src"],[1,"form-check"],[1,"form-check-label"],["type","checkbox","name","IsSelected","id","IsSelected","value","checkedValue",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"main-bg","vatCustom"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.hc(4,"a",4),f.pc("click",(function(){return t.filter()})),f.cc(5,"img",5),f.hc(6,"span"),f.Rc(7),f.gc(),f.gc(),f.gc(),f.hc(8,"div",6),f.hc(9,"mobile-search-box",7),f.pc("searchTextInvoke",(function(e){return t.searchProduct(e)})),f.gc(),f.gc(),f.hc(10,"div",8),f.hc(11,"button",9),f.cc(12,"img",10),f.gc(),f.gc(),f.hc(13,"div",8),f.hc(14,"button",9),f.cc(15,"img",11),f.gc(),f.gc(),f.gc(),f.hc(16,"div",12),f.Pc(17,Ut,9,9,"div",13),f.gc(),f.hc(18,"ul",14),f.hc(19,"li",15),f.pc("click",(function(){return t.getProductsByPage(t.currentPage-1)})),f.cc(20,"i",16),f.gc(),f.hc(21,"li",17),f.pc("click",(function(){return t.getProductsByPage(t.currentPage+1)})),f.cc(22,"i",18),f.gc(),f.gc(),f.hc(23,"div",19),f.hc(24,"div",20),f.hc(25,"a",21),f.pc("click",(function(){return t.selectProduct()})),f.Rc(26,"Xong"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(27,"div",22),f.Pc(28,Ht,5,2,"div",23),f.gc(),f.hc(29,"div",24),f.cc(30,"angular-image-viewer",25),f.gc()),2&e&&(f.Ob(7),f.Sc(t.categoryName),f.Ob(2),f.Ac("delayTimeSpan",1600),f.Ob(8),f.Ac("ngForOf",t.pagingProducts),f.Ob(11),f.Ac("ngForOf",t.globalTags),f.Ob(2),f.Ac("src",t.images)("config",t.viewProdOptions))},directives:[rt,D.k,We.a,B.a,B.k,B.n],pipes:[q.a,E.a],styles:[""]}),Et);function Vt(e,t){if(1&e&&(f.hc(0,"li",24),f.hc(1,"p",25),f.Rc(2),f.gc(),f.hc(3,"span",26),f.Rc(4),f.gc(),f.hc(5,"span",27),f.Rc(6),f.uc(7,"myDatePipe"),f.gc(),f.hc(8,"span",28),f.Rc(9),f.gc(),f.gc()),2&e){var c=t.$implicit;f.Pb("data-index",t.index),f.Ob(2),f.Sc(c.FullName),f.Ob(2),f.Sc(c.PhoneNumber),f.Ob(2),f.Sc(f.wc(7,5,c.DateTime,"HH:mm d/M/yyyy")),f.Ob(3),f.Sc(c.Address)}}var jt,Jt=((jt=function(e){n(i,e);var t=o(i);function i(e,c){var n;return h(this,i),(n=t.call(this)).route=e,n._ngZone=c,n.Title="Th\xf4ng tin ng\u01b0\u1eddi nh\u1eadn",n.IsDataLosingWarning=!1,n.currentList=[],n.deliveryInfo=new P.b,n}return d(i,[{key:"addressChoosing",value:function(){var e=this;this.selectAddress((function(t){console.log("selected"),e.deliveryInfo.Address=t}))}},{key:"Init",value:function(){var e=this;this.route.params.subscribe((function(t){e.deliveryInfo=P.b.DeepCopy(e.globalOrderDetail.DeliveryInfo),e.deliveryInfo.DateTime.setSeconds(0)})),window.DeliveryInfoReference={component:this,zone:this._ngZone,selectDeliveryInfo:function(t){return e.selectDeliveryInfo(t)}},setTimeout((function(){e.globalOrder.OrderDetails.forEach((function(t){var c=P.b.DeepCopy(t.DeliveryInfo),i=!0;e.currentList.forEach((function(e){k.a.deliveryInfoCompare(c,e)&&(i=!1)})),i&&e.currentList.push(c)})),e.globalOrder.CustomerInfo&&e.globalOrder.CustomerInfo.ReceiverInfos.forEach((function(t){var c=!0;e.currentList.forEach((function(e){k.a.receiverInfoCompare(t,{FullName:e.FullName,PhoneNumber:e.PhoneNumber,Address:e.Address})&&(c=!1)})),c&&e.currentList.push({FullName:t.FullName,PhoneNumber:t.PhoneNumber,Address:t.Address,DateTime:new Date})}))}),200)}},{key:"selectDeliveryInfo",value:function(e){console.log("selected"),this.deliveryInfo=P.b.DeepCopy(this.currentList[e])}},{key:"addReceiver",value:function(e){e.valid&&(this.globalOrderDetail.DeliveryInfo=P.b.DeepCopy(this.deliveryInfo),c(u(i.prototype),"OnBackNaviage",this).call(this))}}]),i}(C)).\u0275fac=function(e){return new(e||jt)(f.bc(l.a),f.bc(f.H))},jt.\u0275cmp=f.Vb({type:jt,selectors:[["app-select-receiver"]],features:[f.Lb],decls:30,vars:8,consts:[["id","custInfo",1,"page-content"],[1,"container"],[1,"custInfo"],[1,"currentInfo"],["href","javascript:void(0)","onclick","openCustMenu()",1,"main-bg"],["src","../../../../assets/images/view.svg",1,"white-filter"],[1,"newInfo"],["autocomplete","on",1,"addInfoForm",3,"submit"],["form","ngForm"],[1,"form-group"],["type","text","name","FullName","id","FullName","value","","placeholder","T\xean...",1,"mainForm",3,"ngModel","ngModelChange"],["FullName","ngModel"],["type","tel","name","PhoneNumber","id","PhoneNumber","value","","placeholder","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i...",1,"mainForm",3,"ngModel","ngModelChange"],["type","text","name","Address","id","Address","placeholder","\u0110\u1ecba ch\u1ec9...",1,"mainForm",3,"ngModel","ngModelChange"],["href","javascript:void(0)",1,"viewMore","btn","main-btn",3,"click"],[1,"fa","fa-location-arrow"],["name","DateTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],[1,"row"],[1,"col-8","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-3"],["id","recentInfo",1,"actionMenu"],["onclick","selectSavedDeliveryInfo(this)",4,"ngFor","ngForOf"],["onclick","selectSavedDeliveryInfo(this)"],[1,"recentInfo-name"],[1,"recentInfo-phone"],[1,"recentInfo-date"],[1,"recentInfo-add"]],template:function(e,t){if(1&e){var c=f.ic();f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.hc(4,"span"),f.Rc(5,"Th\xf4ng tin ng\u01b0\u1eddi nh\u1eadn \u0111\xe3 l\u01b0u"),f.gc(),f.hc(6,"a",4),f.cc(7,"img",5),f.gc(),f.gc(),f.hc(8,"div",6),f.hc(9,"form",7,8),f.pc("submit",(function(){f.Jc(c);var e=f.Hc(10);return t.addReceiver(e)})),f.hc(11,"div",9),f.hc(12,"input",10,11),f.pc("ngModelChange",(function(e){return t.deliveryInfo.FullName=e})),f.gc(),f.gc(),f.hc(14,"div",9),f.hc(15,"input",12),f.pc("ngModelChange",(function(e){return t.deliveryInfo.PhoneNumber=e})),f.gc(),f.gc(),f.hc(16,"div",9),f.hc(17,"input",13),f.pc("ngModelChange",(function(e){return t.deliveryInfo.Address=e})),f.gc(),f.hc(18,"a",14),f.pc("click",(function(){return t.addressChoosing()})),f.cc(19,"i",15),f.gc(),f.gc(),f.hc(20,"input",16),f.pc("ngModelChange",(function(e){return t.deliveryInfo.DateTime=e})),f.gc(),f.cc(21,"owl-date-time",17,18),f.hc(23,"div",19),f.hc(24,"div",20),f.hc(25,"button",21),f.Rc(26,"Xong"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(27,"div",22),f.hc(28,"ul"),f.Pc(29,Vt,10,8,"li",23),f.gc(),f.gc()}if(2&e){var i=f.Hc(22);f.Ob(12),f.Ac("ngModel",t.deliveryInfo.FullName),f.Ob(3),f.Ac("ngModel",t.deliveryInfo.PhoneNumber),f.Ob(2),f.Ac("ngModel",t.deliveryInfo.Address),f.Ob(3),f.Ac("owlDateTime",i)("owlDateTimeTrigger",i)("ngModel",t.deliveryInfo.DateTime),f.Ob(1),f.Ac("stepMinute",5),f.Ob(8),f.Ac("ngForOf",t.currentList)}},directives:[B.v,B.l,B.m,B.b,B.k,B.n,U.c,U.f,U.b,D.k],pipes:[E.b],styles:[""]}),jt);function Gt(e,t){if(1&e){var c=f.ic();f.hc(0,"div",18),f.hc(1,"div",19),f.hc(2,"span",20),f.Rc(3),f.gc(),f.hc(4,"div",21),f.hc(5,"h4",22),f.Rc(6),f.gc(),f.hc(7,"span",23),f.Rc(8),f.gc(),f.gc(),f.cc(9,"app-status-point",24),f.gc(),f.hc(10,"div",25),f.hc(11,"ul",26),f.hc(12,"li",27),f.hc(13,"div",28),f.pc("click",(function(){f.Jc(c);var e=t.$implicit;return f.tc().getMenu(e)})),f.cc(14,"img",29),f.uc(15,"ImgPipe"),f.hc(16,"div",30),f.hc(17,"span",31),f.Rc(18),f.uc(19,"myCurrPipe"),f.gc(),f.hc(20,"span",32),f.Rc(21),f.gc(),f.hc(22,"span",32),f.Rc(23),f.gc(),f.hc(24,"span",32),f.Rc(25),f.gc(),f.hc(26,"span",33),f.Rc(27),f.uc(28,"myTimePipe"),f.gc(),f.hc(29,"span",34),f.Rc(30),f.uc(31,"myDatePipe"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var i=t.$implicit,n=t.index;f.Ob(3),f.Uc("",i.OrderId,"_",i.Index+1,""),f.Ob(3),f.Sc(i.ProductName),f.Ob(2),f.Uc("",i.DeliveryInfo.FullName,"-",i.DeliveryInfo.PhoneNumber,""),f.Ob(1),f.Ac("state",i.State)("id",i.OrderDetailId)("index",n+1),f.Ob(5),f.Bc("src",f.wc(15,15,i.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(f.vc(19,18,i.ModifiedPrice)),f.Ob(3),f.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",i.Quantity,""),f.Ob(2),f.Tc("t\xean: ",i.DeliveryInfo.FullName,""),f.Ob(2),f.Tc("dc: ",i.DeliveryInfo.Address,""),f.Ob(2),f.Tc("th\u1eddi gian ",f.vc(28,20,i.DeliveryInfo.DateTime)," "),f.Ob(3),f.Tc(" ",f.vc(31,22,i.DeliveryInfo.DateTime),"")}}function Wt(e,t){if(1&e){var c=f.ic();f.hc(0,"div",35),f.hc(1,"div",19),f.hc(2,"span",20),f.Rc(3),f.gc(),f.hc(4,"div",21),f.hc(5,"h4",22),f.Rc(6),f.gc(),f.hc(7,"span",23),f.Rc(8),f.gc(),f.gc(),f.cc(9,"app-status-point",24),f.gc(),f.hc(10,"div",25),f.hc(11,"ul",26),f.hc(12,"li",27),f.hc(13,"div",28),f.pc("click",(function(){f.Jc(c);var e=t.$implicit;return f.tc().getMenu(e)})),f.cc(14,"img",29),f.uc(15,"ImgPipe"),f.hc(16,"div",30),f.hc(17,"span",31),f.Rc(18),f.uc(19,"myCurrPipe"),f.gc(),f.hc(20,"span",32),f.Rc(21),f.gc(),f.hc(22,"span",32),f.Rc(23),f.gc(),f.hc(24,"span",32),f.Rc(25),f.gc(),f.hc(26,"span",33),f.Rc(27),f.uc(28,"myTimePipe"),f.gc(),f.hc(29,"span",34),f.Rc(30),f.uc(31,"myDatePipe"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var i=t.$implicit,n=t.index;f.Ac("ngClass","OnTheWay"===i.State?"selected-order-detail":""),f.Ob(3),f.Uc("",i.OrderId,"_",i.Index+1,""),f.Ob(3),f.Sc(i.ProductName),f.Ob(2),f.Uc("",i.DeliveryInfo.FullName,"-",i.DeliveryInfo.PhoneNumber,""),f.Ob(1),f.Ac("state",i.State)("id",i.OrderDetailId)("index",n+1),f.Ob(5),f.Bc("src",f.wc(15,16,i.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(f.vc(19,19,i.ModifiedPrice)),f.Ob(3),f.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",i.Quantity,""),f.Ob(2),f.Tc("ng\u01b0\u1eddi nh\u1eadn: ",i.DeliveryInfo.FullName,""),f.Ob(2),f.Tc("dc nh\u1eadn: ",i.DeliveryInfo.Address,""),f.Ob(2),f.Tc("giao l\xfac ",f.vc(28,21,i.DeliveryInfo.DateTime)," "),f.Ob(3),f.Tc(" ",f.vc(31,23,i.DeliveryInfo.DateTime),"")}}var Xt,Qt=((Xt=function(e){n(c,e);var t=o(c);function c(e,i,n){var r;return h(this,c),(r=t.call(this)).router=e,r.orderService=i,r.orderDetailService=n,r.Title="Ng\u01b0\u1eddi giao h\xe0ng",r.NavigateClass="nav-icon ",r.IsDataLosingWarning=!1,r.selectDeliveryTime="",r.shippingNote="",r.waitingMenuItems=["Nh\u1eadn \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],r.onTheWayMenuItems=["Ho\xe0n th\xe0nh \u0111\u01a1n","Ch\u1ee5p \u1ea3nh giao h\xe0ng","Tr\u1ea3 h\xe0ng","Xem chi ti\u1ebft \u0111\u01a1n"],r.waitingOrderDetails=[],r.shippingOrderDetails=[],r}return d(c,[{key:"Init",value:function(){this.loadWaitingDetails(),this.loadShippingDetails(),this.askForRememberPassword()}},{key:"OnBackNaviage",value:function(){customerSupport()}},{key:"logout",value:function(){var e=this;this.authService.logOut((function(t){t&&e.router.navigate(["staff/login"])}))}},{key:"viewDetail",value:function(e){this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}},{key:"loadWaitingDetails",value:function(){var e=this;this.waitingOrderDetails=[],this.orderDetailService.getDetailWithTimeSort([A.f.Comfirming,A.f.SentBack],"ReceivingTime").then((function(t){e.waitingOrderDetails=t}))}},{key:"loadShippingDetails",value:function(){var e=this;this.shippingOrderDetails=[],this.orderDetailService.getShippingOrderDetails(this.CurrentUser.Id).then((function(t){e.shippingOrderDetails=t}))}},{key:"updateFinalState",value:function(e,t,c){var i=this;getShippingNoteDialog(t,(function(t){c===A.f.SentBack?i.orderDetailService.updateShippingFields(i.orderDetailService.getLastestShipping(e).Id,{Note:t,CompleteTime:(new Date).getTime(),DeliveryImageUrl:""}).then((function(t){i.orderDetailService.updateFields(e.OrderDetailId,{State:A.f.SentBack}).then((function(e){i.loadShippingDetails()}))})).catch((function(e){i.showError(e)})):i.orderService.getById(e.OrderId).then((function(c){i.orderDetailService.shippingConfirm(e,null,t).then((function(t){i.orderDetailService.completeOD(e,c).then((function(){i.loadShippingDetails()}))})).catch((function(e){i.showError(e)}))}))}))}},{key:"updateWaitingDetail",value:function(e,t){var c=this;switch(e){case 0:this.orderDetailService.updateDetailSeen(t.OrderDetailId,this.CurrentUser.Id,(new Date).getTime()).then((function(e){c.orderDetailService.assignSingleShipper(t.OrderDetailId,c.CurrentUser.Id,(new Date).getTime()).then((function(){c.loadShippingDetails(),c.loadWaitingDetails()}))}));break;case 1:this.viewDetail(t)}}},{key:"updateOnTheWayDetail",value:function(e,t){var c=this;switch(e){case 0:this.openConfirm("Ho\xe0n th\xe0nh giao \u0111\u01a1n?",(function(){c.updateFinalState(t,"Ho\xe0n th\xe0nh",A.f.Completed)}));break;case 1:this.globalOrderDetail=t,this.router.navigate(["staff/customer-confirming"]);break;case 2:this.openConfirm("Tr\u1ea3 \u0111\u01a1n n\xe0y?",(function(){c.updateFinalState(t,"Tr\u1ea3 \u0111\u01a1n",A.f.SentBack)}));break;case 3:this.viewDetail(t)}}},{key:"getMenu",value:function(e){var t,c=this;switch(e.State){case A.f.Comfirming:case A.f.SentBack:t=this.waitingMenuItems;break;case A.f.OnTheWay:t=this.onTheWayMenuItems}menuOpen((function(t){switch(e.State){case A.f.OnTheWay:c.updateOnTheWayDetail(+t,e);break;default:c.updateWaitingDetail(+t,e)}}),t)}}]),c}(C)).\u0275fac=function(e){return new(e||Xt)(f.bc(l.b),f.bc(M.a),f.bc(X.a))},Xt.\u0275cmp=f.Vb({type:Xt,selectors:[["app-shipper-main"]],features:[f.Lb],decls:27,vars:9,consts:[["id","arrange",1,"page-content"],[1,"container"],["id","listNav","role","tablist",1,"nav","nav-tabs","row"],[1,"nav-item","col-6"],["id","nav1","data-toggle","tab","href","#camhoa","role","tab","aria-controls","camhoa","aria-selected","true",1,"active","main-bg"],["id","nav2","data-toggle","tab","href","#giaohoa","role","tab","aria-controls","giaohoa","aria-selected","false",1,"main-bg"],["id","listContent",1,"tab-content","order-list-bot"],["id","camhoa","role","tabpanel","aria-labelledby","nav1",1,"tab-pane","fade","show","active"],[1,"order-content","cusScroll"],["class","order-content-item product-item",4,"ngFor","ngForOf"],["id","giaohoa","role","tabpanel","aria-labelledby","nav2",1,"tab-pane","fade"],["class","order-content-item product-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"customer-support"],["alt","",1,"customer-avatar",3,"src"],[1,"customer-name"],["href","tel:0000",1,"customer-phone"],[1,"customer-position"],["id","logoutBtn",1,"customer-position",3,"click"],[1,"order-content-item","product-item"],[1,"item-top"],[1,"item-code"],[1,"item-info"],[1,"item-name"],[1,"item-quantity"],[3,"state","id","index"],[1,"item-bot"],[1,"order-product-list","cusScroll"],[1,""],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"prodPrice"],[1,"item-address"],[1,"item-time"],[1,"item-date"],[1,"order-content-item","product-item",3,"ngClass"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"ul",2),f.hc(3,"li",3),f.hc(4,"a",4),f.Rc(5,"Ch\u1edd giao"),f.gc(),f.gc(),f.hc(6,"li",3),f.hc(7,"a",5),f.Rc(8,"\u0110ang giao"),f.gc(),f.gc(),f.gc(),f.hc(9,"div",6),f.hc(10,"div",7),f.hc(11,"ul",8),f.Pc(12,Gt,32,24,"div",9),f.gc(),f.gc(),f.hc(13,"div",10),f.hc(14,"ul",8),f.Pc(15,Wt,32,25,"div",11),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(16,"div",12),f.cc(17,"img",13),f.uc(18,"ImgPipe"),f.hc(19,"p",14),f.Rc(20),f.gc(),f.hc(21,"a",15),f.Rc(22),f.gc(),f.hc(23,"p",16),f.Rc(24),f.gc(),f.hc(25,"p",17),f.pc("click",(function(){return t.logout()})),f.Rc(26,"\u0110\u0103ng xu\u1ea5t"),f.gc(),f.gc()),2&e&&(f.Ob(12),f.Ac("ngForOf",t.waitingOrderDetails),f.Ob(3),f.Ac("ngForOf",t.shippingOrderDetails),f.Ob(2),f.Bc("src",f.wc(18,6,t.CurrentUser.Avt,"UserAvt"),f.Lc),f.Ob(3),f.Sc(t.CurrentUser.FullName),f.Ob(2),f.Sc(t.CurrentUser.PhoneNumber),f.Ob(2),f.Sc(t.CurrentUser.Role))},directives:[D.k,Te,D.j],pipes:[q.a,E.a,E.c,E.b],styles:[""]}),Xt);function $t(e,t){if(1&e){var c=f.ic();f.hc(0,"div",18),f.hc(1,"div",19),f.hc(2,"span",20),f.Rc(3),f.gc(),f.hc(4,"div",21),f.hc(5,"h4",22),f.Rc(6),f.gc(),f.hc(7,"span",23),f.Rc(8),f.gc(),f.hc(9,"span",23),f.Rc(10),f.gc(),f.gc(),f.cc(11,"app-status-point",24),f.gc(),f.hc(12,"div",25),f.hc(13,"ul",26),f.hc(14,"li",27),f.hc(15,"div",28),f.pc("click",(function(){f.Jc(c);var e=t.index;return f.tc().viewMakingDetail(e)})),f.cc(16,"img",29),f.uc(17,"ImgPipe"),f.hc(18,"div",30),f.hc(19,"span",31),f.Rc(20),f.uc(21,"myCurrPipe"),f.gc(),f.hc(22,"span",32),f.Rc(23),f.uc(24,"myCurrPipe"),f.gc(),f.hc(25,"span",32),f.Rc(26),f.uc(27,"myCurrPipe"),f.gc(),f.hc(28,"span",33),f.Rc(29),f.gc(),f.hc(30,"span",34),f.Rc(31),f.uc(32,"myTimePipe"),f.gc(),f.hc(33,"span",35),f.Rc(34),f.uc(35,"myDatePipe"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var i=t.$implicit,n=t.index,r=f.tc();f.Ac("ngClass",i.IsSelect?"selected-order-detail":""),f.Ob(3),f.Uc("",i.OrderDetail.OrderId,"_",i.OrderDetail.Index+1,""),f.Ob(3),f.Sc(i.OrderDetail.ProductName),f.Ob(2),f.Sc(i.OrderDetail.CustomerName),f.Ob(2),f.Sc(i.OrderDetail.CustomerPhoneNumber),f.Ob(1),f.Ac("state",i.OrderDetail.State)("id",i.OrderDetail.OrderDetailId)("index",n+1),f.Ob(5),f.Bc("src",f.wc(17,16,i.OrderDetail.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(f.vc(21,19,i.OrderDetail.ModifiedPrice)),f.Ob(3),f.Tc("Ph\u1ee5 ph\xed: ",f.vc(24,21,i.OrderDetail.AdditionalFee),""),f.Ob(3),f.Tc("Gi\u1ea3m gi\xe1: ",f.vc(27,23,r.getDetailDiscount(i.OrderDetail)),""),f.Ob(3),f.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",i.OrderDetail.Quantity,""),f.Ob(2),f.Tc("",f.vc(32,25,i.OrderDetail.MakingRequestTime)," "),f.Ob(3),f.Tc(" ",f.vc(35,27,i.OrderDetail.MakingRequestTime),"")}}function zt(e,t){if(1&e){var c=f.ic();f.hc(0,"div",36),f.hc(1,"div",37),f.hc(2,"button",38),f.pc("click",(function(){return f.Jc(c),f.tc().selectFloristDialogOpen()})),f.Rc(3,"Ch\u1ecdn Florist"),f.gc(),f.gc(),f.hc(4,"div",39),f.pc("click",(function(){return f.Jc(c),f.tc().cancelFloristSelectMode()})),f.hc(5,"button",40),f.Rc(6,"Hu\u1ef7"),f.gc(),f.gc(),f.gc()}}function _t(e,t){if(1&e){var c=f.ic();f.hc(0,"div",36),f.hc(1,"div",37),f.hc(2,"button",41),f.pc("click",(function(){return f.Jc(c),f.tc().gotoSelectFloristMode()})),f.Rc(3,"Ch\u1ecdn nhi\u1ec1u"),f.gc(),f.gc(),f.gc()}}function Kt(e,t){if(1&e){var c=f.ic();f.hc(0,"div",18),f.hc(1,"div",19),f.hc(2,"span",20),f.Rc(3),f.gc(),f.hc(4,"div",21),f.hc(5,"h4",22),f.Rc(6),f.gc(),f.hc(7,"span",23),f.Rc(8),f.gc(),f.gc(),f.cc(9,"app-status-point",24),f.gc(),f.hc(10,"div",25),f.hc(11,"ul",26),f.hc(12,"li",27),f.hc(13,"div",28),f.pc("click",(function(){f.Jc(c);var e=t.index;return f.tc().viewShippingDetail(e)})),f.cc(14,"img",29),f.uc(15,"ImgPipe"),f.hc(16,"div",30),f.hc(17,"span",31),f.Rc(18),f.uc(19,"myCurrPipe"),f.gc(),f.hc(20,"span",32),f.Rc(21),f.uc(22,"myCurrPipe"),f.gc(),f.hc(23,"span",32),f.Rc(24),f.uc(25,"myCurrPipe"),f.gc(),f.hc(26,"span",33),f.Rc(27),f.gc(),f.hc(28,"span",34),f.Rc(29),f.uc(30,"myTimePipe"),f.gc(),f.hc(31,"span",35),f.Rc(32),f.uc(33,"myDatePipe"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var i=t.$implicit,n=t.index,r=f.tc();f.Ac("ngClass",i.IsSelect?"selected-order-detail":""),f.Ob(3),f.Uc("",i.OrderDetail.OrderId,"_",i.OrderDetail.Index+1,""),f.Ob(3),f.Sc(i.OrderDetail.ProductName),f.Ob(2),f.Uc("",i.OrderDetail.CustomerName,"-",i.OrderDetail.CustomerPhoneNumber,""),f.Ob(1),f.Ac("state",i.OrderDetail.State)("id",i.OrderDetail.OrderDetailId)("index",n+1),f.Ob(5),f.Bc("src",f.wc(15,16,i.OrderDetail.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(f.vc(19,19,i.OrderDetail.ModifiedPrice)),f.Ob(3),f.Tc("Ph\u1ee5 ph\xed: ",f.vc(22,21,i.OrderDetail.AdditionalFee),""),f.Ob(3),f.Tc("Gi\u1ea3m gi\xe1: ",f.vc(25,23,r.getDetailDiscount(i.OrderDetail)),""),f.Ob(3),f.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",i.OrderDetail.Quantity,""),f.Ob(2),f.Tc("",f.vc(30,25,i.OrderDetail.DeliveryInfo.DateTime)," "),f.Ob(3),f.Tc(" ",f.vc(33,27,i.OrderDetail.DeliveryInfo.DateTime),"")}}function Zt(e,t){if(1&e){var c=f.ic();f.hc(0,"div",36),f.hc(1,"div",37),f.hc(2,"button",38),f.pc("click",(function(){return f.Jc(c),f.tc().selectShipperDialogOpen()})),f.Rc(3,"Ch\u1ecdn Shipper"),f.gc(),f.gc(),f.hc(4,"div",39),f.pc("click",(function(){return f.Jc(c),f.tc().cancelShipperSelectMode()})),f.hc(5,"button",40),f.Rc(6,"Hu\u1ef7"),f.gc(),f.gc(),f.gc()}}function Yt(e,t){if(1&e){var c=f.ic();f.hc(0,"div",36),f.hc(1,"div",37),f.hc(2,"button",38),f.pc("click",(function(){return f.Jc(c),f.tc().gotoSelectShipperMode()})),f.Rc(3,"Ch\u1ecdn nhi\u1ec1u"),f.gc(),f.gc(),f.gc()}}function ec(e,t){if(1&e&&(f.hc(0,"li",42),f.cc(1,"img",43),f.uc(2,"ImgPipe"),f.hc(3,"span",44),f.Rc(4),f.gc(),f.gc()),2&e){var c=t.$implicit;f.Bc("id",c.Id),f.Ob(1),f.Bc("src",f.wc(2,3,c.AvtUrl,"UserAvt"),f.Lc),f.Ob(3),f.Sc(c.FullName)}}function tc(e,t){if(1&e&&(f.hc(0,"li",45),f.cc(1,"img",43),f.uc(2,"ImgPipe"),f.hc(3,"span",44),f.Rc(4),f.gc(),f.hc(5,"span",46),f.Rc(6),f.gc(),f.gc()),2&e){var c=t.$implicit;f.Bc("id",c.Id),f.Ob(1),f.Bc("src",f.wc(2,4,c.AvtUrl,"UserAvt"),f.Lc),f.Ob(3),f.Sc(c.FullName),f.Ob(2),f.Sc(c.IsExternalShipper?"Shipper ngo\xe0i":"Nh\xe2n vi\xean")}}var cc,ic,nc,rc=((cc=function(e){n(c,e);var t=o(c);function c(e,i,n){var r;return h(this,c),(r=t.call(this)).orderDetailService=e,r.userService=i,r.router=n,r.Title="Th\u1ee9 t\u1ef1 \u01b0u ti\xean",r.IsDataLosingWarning=!1,r.isAssigningShipper=!1,r.isAssigningFlorist=!1,r.shippingODs=[],r.shippers=[],r.makingODs=[],r.florists=[],r}return d(c,[{key:"Init",value:function(){var e=this;this.loadMakingDetails(),this.loadShippingDetails(),this.userService.getByRole(A.i.Shipper).then((function(t){e.shippers=t})),this.userService.getByRole(A.i.Florist).then((function(t){e.florists=t}))}},{key:"loadMakingDetails",value:function(){var e=this;this.makingODs=[],this.orderDetailService.getDetailWithTimeSort([A.f.Added,A.f.SentBack],"MakingRequestTime").then((function(t){t.forEach((function(t){e.makingODs.push({OrderDetail:t,IsSelect:!1})}))}))}},{key:"loadShippingDetails",value:function(){var e=this;this.shippingODs=[],this.orderDetailService.getDetailWithTimeSort([A.f.OnTheWay,A.f.SentBack],"ReceivingTime").then((function(t){t.forEach((function(t){e.shippingODs.push({OrderDetail:t,IsSelect:!1})}))}))}},{key:"viewShippingDetail",value:function(e){this.isAssigningShipper?this.shippingODs[e].IsSelect=!this.shippingODs[e].IsSelect:(this.globalOrderDetail=this.shippingODs[e].OrderDetail,this.router.navigate(["staff/order-detail-view"]))}},{key:"viewMakingDetail",value:function(e){this.isAssigningFlorist?this.makingODs[e].IsSelect=!this.makingODs[e].IsSelect:(this.globalOrderDetail=this.makingODs[e].OrderDetail,this.router.navigate(["staff/order-detail-view"]))}},{key:"gotoSelectShipperMode",value:function(){this.isAssigningShipper=!0}},{key:"gotoSelectFloristMode",value:function(){this.isAssigningFlorist=!0}},{key:"cancelShipperSelectMode",value:function(){this.shippingODs.forEach((function(e){e.IsSelect=!1})),this.isAssigningShipper=!1}},{key:"cancelFloristSelectMode",value:function(){this.makingODs.forEach((function(e){e.IsSelect=!1})),this.isAssigningFlorist=!1}},{key:"assignUsers",value:function(e){var t=this;this.openConfirm(this.isAssigningShipper?"X\xe1c nh\u1eadn giao \u0111\u01a1n cho shipper?":"X\xe1c nh\u1eadn ph\xe2n c\xf4ng florist?",(function(){if(t.isAssigningShipper){var c=[];t.shippingODs.forEach((function(e){e.IsSelect&&c.push(e.OrderDetail.OrderDetailId)})),t.orderDetailService.assignShipperForOrderDetails(c,e,(new Date).getTime()).then((function(e){t.isAssigningShipper=!1,t.loadMakingDetails(),t.loadShippingDetails()}))}else{var i=[];t.makingODs.forEach((function(e){e.IsSelect&&i.push(e.OrderDetail)})),t.orderDetailService.assignFloristForOrderDetails(i,e,(new Date).getTime()).then((function(e){t.isAssigningFlorist=!1,t.loadMakingDetails(),t.loadShippingDetails()}))}}))}},{key:"selectShipperDialogOpen",value:function(){var e=this,t=!1;this.shippingODs.forEach((function(e){e.IsSelect&&(t=!0)})),t&&chooseShipper((function(t){e.assignUsers(+t)}))}},{key:"selectFloristDialogOpen",value:function(){var e=this,t=!1;this.makingODs.forEach((function(e){e.IsSelect&&(t=!0)})),t&&chooseFlorist((function(t){e.assignUsers(+t)}))}}]),c}(C)).\u0275fac=function(e){return new(e||cc)(f.bc(X.a),f.bc(ct.a),f.bc(l.b))},cc.\u0275cmp=f.Vb({type:cc,selectors:[["app-sort-order-changing"]],features:[f.Lb],decls:30,vars:8,consts:[["id","orderList",1,"page-content"],[1,"container"],["id","listNav","role","tablist",1,"nav","nav-tabs","row"],[1,"nav-item","col-6"],["id","nav1","data-toggle","tab","href","#camhoa","role","tab","aria-controls","camhoa","aria-selected","true",1,"active","main-bg"],["id","nav2","data-toggle","tab","href","#giaohoa","role","tab","aria-controls","giaohoa","aria-selected","false",1,"main-bg"],["id","listContent",1,"tab-content","order-list-bot"],["id","camhoa","role","tabpanel","aria-labelledby","nav1",1,"tab-pane","fade","show","active"],[1,"order-content","cusScroll"],["class","order-content-item product-item",3,"ngClass",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],["id","giaohoa","role","tabpanel","aria-labelledby","nav2",1,"tab-pane","fade"],["id","viewed",1,"popup-content","florist"],[1,"main-bg"],[1,"viewedList"],["class","viewItem",3,"id",4,"ngFor","ngForOf"],["id","viewed",1,"popup-content","shipper"],["class","viewItem-three-column",3,"id",4,"ngFor","ngForOf"],[1,"order-content-item","product-item",3,"ngClass"],[1,"item-top"],[1,"item-code"],[1,"item-info"],[1,"item-name"],[1,"item-quantity"],[3,"state","id","index"],[1,"item-bot"],[1,"order-product-list","cusScroll"],[1,""],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"prodPrice"],[1,"prodCharge"],[1,"item-address"],[1,"item-time"],[1,"item-date"],[1,"row"],[1,"col-6","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-3","exchange-confirm",3,"click"],[1,"col-6","mx-auto","text-center",3,"click"],["type","submit",1,"btn","main-btn","w-100","mt-3","exchange-confirm"],["type","button",1,"btn","main-btn","w-100","mt-3","exchange-confirm",3,"click"],[1,"viewItem",3,"id"],["alt","",1,"itemAva",3,"src"],[1,"itemName"],[1,"viewItem-three-column",3,"id"],[1,"itemRole"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"ul",2),f.hc(3,"li",3),f.hc(4,"a",4),f.Rc(5,"C\u1eafm hoa"),f.gc(),f.gc(),f.hc(6,"li",3),f.hc(7,"a",5),f.Rc(8,"Giao hoa"),f.gc(),f.gc(),f.gc(),f.hc(9,"div",6),f.hc(10,"div",7),f.hc(11,"ul",8),f.Pc(12,$t,36,29,"div",9),f.gc(),f.Pc(13,zt,7,0,"div",10),f.Pc(14,_t,4,0,"div",10),f.gc(),f.hc(15,"div",11),f.hc(16,"ul",8),f.Pc(17,Kt,34,29,"div",9),f.gc(),f.Pc(18,Zt,7,0,"div",10),f.Pc(19,Yt,4,0,"div",10),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(20,"div",12),f.hc(21,"h3",13),f.Rc(22,"Ch\u1ecdn Florist"),f.gc(),f.hc(23,"ul",14),f.Pc(24,ec,5,6,"li",15),f.gc(),f.gc(),f.hc(25,"div",16),f.hc(26,"h3",13),f.Rc(27,"Ch\u1ecdn Shipper"),f.gc(),f.hc(28,"ul",14),f.Pc(29,tc,7,7,"li",17),f.gc(),f.gc()),2&e&&(f.Ob(12),f.Ac("ngForOf",t.makingODs),f.Ob(1),f.Ac("ngIf",t.isAssigningFlorist&&t.makingODs.length>0),f.Ob(1),f.Ac("ngIf",!t.isAssigningFlorist&&t.makingODs.length>0),f.Ob(3),f.Ac("ngForOf",t.shippingODs),f.Ob(1),f.Ac("ngIf",t.isAssigningShipper&&t.shippingODs.length>0),f.Ob(1),f.Ac("ngIf",!t.isAssigningShipper&&t.shippingODs.length>0),f.Ob(5),f.Ac("ngForOf",t.florists),f.Ob(5),f.Ac("ngForOf",t.shippers))},directives:[D.k,D.l,D.j,Te],pipes:[q.a,E.a,E.c,E.b],styles:[""]}),cc),oc=r("TG2U"),ac=r("3oHN"),sc=((nc=function(e){n(c,e);var t=o(c);function c(e,i){var n;return h(this,c),(n=t.call(this)).router=e,n.realtimeService=i,n.Title="",n.NavigateClass="",n.model=new oc.a,S.a.clear(),n}return d(c,[{key:"Init",value:function(){this.setStatusBarColor(!0),this.globalService.isOnMobile()&&savedLoginInforGettingRequest()}},{key:"savedLoginInforReturn",value:function(e,t){this.model.passcode=t,this.model.userName=e}},{key:"afterLogin",value:function(){switch(this.globalService.isOnMobile()&&(this.globalService.isRememberPassWillCheck=!0,mobileLogin(this.model.userName,this.model.passcode)),S.a.getRole()){case A.i.Admin:case A.i.Account:this.router.navigate(["/staff/orders-manage"]);break;case A.i.Florist:this.router.navigate(["staff/florist-main"]);break;case A.i.Shipper:this.router.navigate(["staff/shipper-main"])}}},{key:"login",value:function(e){var t=this;e.valid&&this.authService.login(this.model,(function(e){e&&t.ngZone.run((function(){t.afterLogin()}))}))}}]),c}(C)).\u0275fac=function(e){return new(e||nc)(f.bc(l.b),f.bc(ac.a))},nc.\u0275cmp=f.Vb({type:nc,selectors:[["app-login"]],features:[f.Lb],decls:11,vars:2,consts:[["id","login",1,"page-content"],[1,"logo"],["href","#"],["autocomplete","on","id","loginform",3,"submit"],["form","ngForm"],[1,"form-group"],["name","userName","placeholder","T\xean \u0111\u0103ng nh\u1eadp...",1,"form-control",3,"ngModel","ngModelChange"],["type","password","name","passcode","placeholder","M\u1eadt kh\u1ea9u...",1,"form-control",3,"ngModel","ngModelChange"],["type","submit","value","\u0110\u0103ng nh\u1eadp",1,"btn","btn-default"]],template:function(e,t){if(1&e){var c=f.ic();f.hc(0,"div",0),f.hc(1,"h1",1),f.hc(2,"a",2),f.Rc(3,"Login to Florid"),f.gc(),f.gc(),f.hc(4,"form",3,4),f.pc("submit",(function(){f.Jc(c);var e=f.Hc(5);return t.login(e)})),f.hc(6,"div",5),f.hc(7,"input",6),f.pc("ngModelChange",(function(e){return t.model.userName=e})),f.gc(),f.gc(),f.hc(8,"div",5),f.hc(9,"input",7),f.pc("ngModelChange",(function(e){return t.model.passcode=e})),f.gc(),f.gc(),f.cc(10,"input",8),f.gc(),f.gc()}2&e&&(f.Ob(7),f.Ac("ngModel",t.model.userName),f.Ob(2),f.Ac("ngModel",t.model.passcode))},directives:[B.v,B.l,B.m,B.b,B.k,B.n],styles:[""]}),nc),uc=((ic=function(){function e(t,c,i,n){var r=this;h(this,e),this.router=t,this.globalService=c,this.authService=i,this.realtimeService=n,this.navigateClass="",this.title="",this.headerUpdate=this.globalService.mobileUpdateHeader.subscribe((function(e){null!==e&&e&&r.updateHeaderBar(e.Title,e.NavigateClass)}))}return d(e,[{key:"ngOnInit",value:function(){var e=this;this.logoutInvoker=this.realtimeService.LogouOutBehavier.subscribe((function(t){!1!==t&&e.authService.logOut((function(t){t&&e.router.navigate(["/staff/login"])}))}));var t=S.a.getUserId();t&&this.realtimeService.connect(+t,S.a.getRole(),(function(){})),this.globalService.setStatusBarColor(!1)}},{key:"updateHeaderBar",value:function(e,t){var c=this;setTimeout((function(){c.navigateClass=t,c.title=e}),100)}},{key:"ngOnDestroy",value:function(){this.headerUpdate.unsubscribe(),this.logoutInvoker.unsubscribe()}},{key:"navigateOnClick",value:function(){this.globalService.clickOnNavigateButton()}}]),e}()).\u0275fac=function(e){return new(e||ic)(f.bc(l.b),f.bc(b.a),f.bc(O.a),f.bc(ac.a))},ic.\u0275cmp=f.Vb({type:ic,selectors:[["app-staff-main-layout"]],decls:6,vars:2,consts:[[1,"breadcrumb"],[3,"className","click"],[1,"breadcrumb-title"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"a",1),f.pc("click",(function(){return t.navigateOnClick()})),f.gc(),f.hc(2,"div",2),f.hc(3,"span"),f.Rc(4),f.gc(),f.gc(),f.gc(),f.cc(5,"router-outlet")),2&e&&(f.Ob(1),f.Ac("className",t.navigateClass),f.Ob(3),f.Sc(t.title))},directives:[l.e],styles:[""]}),ic);function lc(e,t){if(1&e&&(f.hc(0,"div",28),f.hc(1,"span",12),f.Rc(2,"T\xean KH"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(4),f.Sc(c.order.CustomerInfo.Name)}}function dc(e,t){if(1&e&&(f.hc(0,"div",28),f.hc(1,"span",12),f.Rc(2,"SDT KH"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(4),f.Sc(c.order.CustomerInfo.PhoneNumber)}}function hc(e,t){if(1&e&&(f.hc(0,"div",28),f.hc(1,"span",12),f.Rc(2,"T\xean ng\u01b0\u1eddi nh\u1eadn:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(4),f.Sc(c.orderDetail.DeliveryInfo.FullName)}}function gc(e,t){if(1&e&&(f.hc(0,"div",29),f.hc(1,"span",12),f.Rc(2,"SDT ng\u01b0\u1eddi nh\u1eadn:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(4),f.Sc(c.orderDetail.DeliveryInfo.PhoneNumber)}}function mc(e,t){if(1&e&&(f.hc(0,"div",29),f.hc(1,"span",12),f.Rc(2,"\u0110\u1ecba ch\u1ec9 giao:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(4),f.Sc(c.orderDetail.DeliveryInfo.Address)}}function pc(e,t){if(1&e&&(f.hc(0,"div",30),f.hc(1,"span",12),f.Rc(2,"Y\xeau c\u1ea7u xong tr\u01b0\u1edbc:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.uc(5,"myDatePipe"),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(4),f.Sc(f.wc(5,1,c.orderDetail.MakingRequestTime,"HH:mm dd/MM/yyyy"))}}function fc(e,t){if(1&e&&(f.hc(0,"div",31),f.hc(1,"span",12),f.Rc(2,"M\xf4 t\u1ea3 KH:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(4),f.Sc(c.orderDetail.Description)}}function vc(e,t){if(1&e&&(f.hc(0,"div",31),f.hc(1,"span",12),f.Rc(2,"Ghi ch\xfa th\u1ef1c hi\u1ec7n:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(4),f.Sc(c.orderDetail.MakingNote)}}function bc(e,t){if(1&e&&(f.hc(0,"div",31),f.hc(1,"span",12),f.Rc(2,"Ghi ch\xfa giao h\xe0ng:"),f.gc(),f.hc(3,"span",13),f.Rc(4),f.gc(),f.gc()),2&e){var c=f.tc();f.Ob(4),f.Sc(c.orderDetail.ShippingNote)}}function Oc(e,t){if(1&e){var c=f.ic();f.hc(0,"div",32),f.pc("click",(function(){return f.Jc(c),f.tc().openViewed()})),f.cc(1,"img",21),f.Rc(2,"\u0110\xe3 xem "),f.gc()}}function yc(e,t){if(1&e&&(f.hc(0,"li",33),f.cc(1,"img",34),f.uc(2,"ImgPipe"),f.hc(3,"span",35),f.Rc(4),f.gc(),f.hc(5,"span",36),f.Rc(6),f.gc(),f.gc()),2&e){var c=t.$implicit;f.Ob(1),f.Bc("src",f.wc(2,3,c.Avt,"UserAvt"),f.Lc),f.Ob(3),f.Sc(c.FullName),f.Ob(2),f.Sc(c.Role)}}var Dc,Ic,Sc=((Ic=function(e){n(c,e);var t=o(c);function c(e,i){var n;return h(this,c),(n=t.call(this)).orderDetailService=e,n.orderService=i,n.Title="Chi ti\u1ebft \u0111\u01a1n",n.IsDataLosingWarning=!1,n.states=A.f,n.canSeen=!0,n.orderDetail=new P.c,n.orderDetail.SeenUsers=[],n.order=new P.d,n.noteImgs=[],n}return d(c,[{key:"Init",value:function(){var e=this;this.orderDetail=this.globalOrderDetail,this.orderService.getById(this.orderDetail.OrderId).then((function(t){null!=t&&(e.order=t)})),this.state=ie.f.filter((function(t){return t.State===e.orderDetail.State}))[0].DisplayName,this.orderDetail.NoteImages.forEach((function(t){e.noteImgs.push(q.a.getImgUrl(t,ie.c.NoteImg))})),setTimeout((function(){e.canSeen&&(e.CurrentUser.Role!==A.i.Florist&&e.CurrentUser.Role!==A.i.Shipper||e.orderDetailService.updateDetailSeen(e.orderDetail.OrderDetailId,e.CurrentUser.Id,(new Date).getTime(),!1).then((function(e){})))}),2e3)}},{key:"destroy",value:function(){this.canSeen=!1}},{key:"openViewed",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e=this;this.orderDetailService.getODSeeners(this.orderDetail.OrderDetailId).then((function(t){e.orderDetail.SeenUsers=t,openViewed()}))}))},{key:"openNoteImages",value:function(){this.orderDetail.NoteImages.length>0&&viewImages((function(){}))}}]),c}(C)).\u0275fac=function(e){return new(e||Ic)(f.bc(X.a),f.bc(M.a))},Ic.\u0275cmp=f.Vb({type:Ic,selectors:[["app-view-order-detail"]],features:[f.Lb],decls:53,vars:34,consts:[["id","prodDetail",1,"page-content"],[1,"container"],[1,"prodDetail"],[1,"prodGen"],[3,"state"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPrice"],[1,"prodCharge"],[1,"prodInfo","cusScroll"],[1,"prodQuan","infoGroup"],[1,"itemlabel"],[1,"itemVal"],["class","prodName infoGroup",4,"ngIf"],["class","prodAddr infoGroup",4,"ngIf"],[1,"prodTime","infoGroup"],["class","prodMakingTime infoGroup",4,"ngIf"],["class","prodDesc infoGroup",4,"ngIf"],["style","right:150px;","class","viewed",3,"click",4,"ngIf"],[1,"viewed",3,"click"],["src","../../../assets/images/eye.svg","alt","",1,"main-filter"],["id","viewed",1,"popup-content"],[1,"main-bg"],[1,"viewedList"],["class","viewItem-three-column",4,"ngFor","ngForOf"],["id","view-product",1,"popup-content","view-img-popup-content",2,"z-index","1000"],[3,"src","config"],[1,"prodName","infoGroup"],[1,"prodAddr","infoGroup"],[1,"prodMakingTime","infoGroup"],[1,"prodDesc","infoGroup"],[1,"viewed",2,"right","150px",3,"click"],[1,"viewItem-three-column"],["alt","",1,"itemAva",3,"src"],[1,"itemName"],[1,"itemRole"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.cc(4,"app-status-point",4),f.cc(5,"img",5),f.uc(6,"ImgPipe"),f.hc(7,"div",6),f.hc(8,"h5",7),f.Rc(9),f.gc(),f.hc(10,"span",8),f.Rc(11),f.uc(12,"myCurrPipe"),f.gc(),f.hc(13,"span",9),f.Rc(14),f.uc(15,"myCurrPipe"),f.gc(),f.hc(16,"span",9),f.Rc(17),f.uc(18,"myCurrPipe"),f.gc(),f.hc(19,"span",9),f.Rc(20),f.gc(),f.gc(),f.gc(),f.hc(21,"div",10),f.hc(22,"div",11),f.hc(23,"span",12),f.Rc(24,"Tr\u1ea1ng th\xe1i:"),f.gc(),f.hc(25,"span",13),f.Rc(26),f.gc(),f.gc(),f.Pc(27,lc,5,1,"div",14),f.Pc(28,dc,5,1,"div",14),f.Pc(29,hc,5,1,"div",14),f.Pc(30,gc,5,1,"div",15),f.Pc(31,mc,5,1,"div",15),f.hc(32,"div",16),f.hc(33,"span",12),f.Rc(34,"Th\u1eddi gian giao:"),f.gc(),f.hc(35,"span",13),f.Rc(36),f.uc(37,"myDatePipe"),f.gc(),f.gc(),f.Pc(38,pc,6,4,"div",17),f.Pc(39,fc,5,1,"div",18),f.Pc(40,vc,5,1,"div",18),f.Pc(41,bc,5,1,"div",18),f.gc(),f.Pc(42,Oc,3,0,"div",19),f.hc(43,"div",20),f.pc("click",(function(){return t.openNoteImages()})),f.cc(44,"img",21),f.Rc(45,"\u1ea2nh ghi ch\xfa "),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(46,"div",22),f.hc(47,"h3",23),f.Rc(48,"Nh\u1eefng ng\u01b0\u1eddi \u0111\xe3 xem"),f.gc(),f.hc(49,"ul",24),f.Pc(50,yc,7,6,"li",25),f.gc(),f.gc(),f.hc(51,"div",26),f.cc(52,"angular-image-viewer",27),f.gc()),2&e&&(f.Ob(4),f.Ac("state",t.orderDetail.State),f.Ob(1),f.Bc("src",f.wc(6,22,t.orderDetail.ProductImageUrl,"ProductImg"),f.Lc),f.Ob(4),f.Sc(t.orderDetail.ProductName),f.Ob(2),f.Sc(f.vc(12,25,t.orderDetail.ModifiedPrice)),f.Ob(3),f.Tc("Gi\u1ea3m gi\xe1: ",f.vc(15,27,t.getDetailDiscount(t.orderDetail)),""),f.Ob(3),f.Tc("Ph\u1ee5 ph\xed: ",f.vc(18,29,t.orderDetail.AdditionalFee),""),f.Ob(3),f.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",t.orderDetail.Quantity,""),f.Ob(6),f.Sc(t.state),f.Ob(1),f.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Florist"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Florist"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf","Florist"!=t.CurrentUser.Role),f.Ob(5),f.Sc(f.wc(37,31,t.orderDetail.DeliveryInfo.DateTime,"HH:mm dd/MM/yyyy")),f.Ob(2),f.Ac("ngIf","Shipper"!=t.CurrentUser.Role),f.Ob(1),f.Ac("ngIf",""!=t.orderDetail.Description),f.Ob(1),f.Ac("ngIf",""!=t.orderDetail.MakingNote),f.Ob(1),f.Ac("ngIf",""!=t.orderDetail.ShippingNote),f.Ob(1),f.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),f.Ob(8),f.Ac("ngForOf",t.orderDetail.SeenUsers),f.Ob(2),f.Ac("src",t.noteImgs)("config",t.viewProdOptions))},directives:[Te,D.l,D.k,We.a],pipes:[q.a,E.a,E.b],styles:[""]}),Ic),kc=((Dc=function(e){n(c,e);var t=o(c);function c(){var e;return h(this,c),(e=t.call(this)).Title="Trang ch\u1ee7",e}return d(c,[{key:"Init",value:function(){}}]),c}(C)).\u0275fac=function(e){return new(e||Dc)},Dc.\u0275cmp=f.Vb({type:Dc,selectors:[["app-home"]],features:[f.Lb],decls:2,vars:0,template:function(e,t){1&e&&(f.hc(0,"p"),f.Rc(1,"home works!"),f.gc())},styles:[""]}),Dc),Cc=function(e){return[e,"VND","symbol-narrow","","vi-VN"]};function Pc(e,t){if(1&e){var c=f.ic();f.hc(0,"div",34),f.pc("click",(function(){f.Jc(c);var e=t.$implicit;return f.tc().selectItem(e)})),f.hc(1,"div",7),f.Rc(2),f.uc(3,"currency"),f.gc(),f.hc(4,"div",8),f.Rc(5),f.gc(),f.hc(6,"div",9),f.Rc(7),f.uc(8,"myDatePipe"),f.gc(),f.gc()}if(2&e){var i=t.$implicit;f.Ob(2),f.Sc(f.xc(3,3,f.Cc(11,Cc,i.Amount))),f.Ob(3),f.Sc(i.Method),f.Ob(2),f.Sc(f.vc(8,9,i.AddingTime))}}var Ac,Tc=((Ac=function(e){n(c,e);var t=o(c);function c(e){var i;return h(this,c),(i=t.call(this)).purchaseService=e,i.Title="C\u1eadp nh\u1eadt thanh to\xe1n",i.purchaseType=A.h,i.IsDataLosingWarning=!1,i.qrContentTemplate="",i.currTotalPaidAmount=0,i.purchaseItems=[],i.order=i.globalOrder,i.qrContent="",i.currentPurchase=new R.a,i}return d(c,[{key:"totalBalance",get:function(){return this.order?this.order.TotalAmount-this.order.TotalPaidAmount:0}},{key:"Init",value:function(){console.log(this.globalPurchases),this.purchaseItems=this.globalPurchases}},{key:"selectItem",value:function(e){var t=this;this.currTotalPaidAmount=this.order.TotalPaidAmount,this.order.TotalPaidAmount-=e.Amount,this.currentPurchase=new R.a,this.currentPurchase.Id=e.Id,this.currentPurchase.Amount=e.Amount,this.currentPurchase.Method=e.Method,this.currentPurchase.Note=e.Note,purchaseDoing((function(){t.order.TotalPaidAmount=t.currTotalPaidAmount}))}},{key:"addPurchase",value:function(){this.currTotalPaidAmount=this.order.TotalPaidAmount,this.currentPurchase=new R.a,this.currentPurchase.Id=-1,this.currentPurchase.Amount=this.totalBalance,this.currentPurchase.Method=A.h.Cash,this.currentPurchase.Note="",purchaseDoing((function(){}))}},{key:"onPayChanged",value:function(e){this.currentPurchase.Amount<10&&(this.currentPurchase.Amount*=1e3,this.moveCursor(this.currentPurchase.Amount.toString().length,"Amount")),this.currentPurchase.Amount=+this.currentPurchase.Amount}},{key:"onPayFocus",value:function(){this.currentPurchase.Amount||(this.currentPurchase.Amount=0),this.moveCursor(this.currentPurchase.Amount.toString().length,"Amount")}},{key:"purchaseConfirm",value:function(){var e=this;if(this.currentPurchase.Amount>this.totalBalance||this.currentPurchase.Amount<=0)this.showError("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!");else{var t=new R.a;t.OrderId=this.order.OrderId,t.Id=this.currentPurchase.Id,t.Amount=+this.currentPurchase.Amount,t.Method=this.currentPurchase.Method,t.AddingTime=(new Date).getTime(),t.Note=this.currentPurchase.Note,this.order.TotalPaidAmount+=t.Amount,this.purchaseService.createOrUpdate(t,this.order.TotalPaidAmount).then((function(c){if(t.Id>0){var i=e.purchaseItems.filter((function(e){return e.Id===t.Id}))[0];i.OrderId=t.OrderId,i.Id=t.Id,i.Amount=+t.Amount,i.Method=t.Method,e.showSuccess("\u0110\xe3 c\u1eadp nh\u1eadt 1 thanh to\xe1n!"),dismissPurchaseDialog()}else e.globalPurchases.push(t),e.showSuccess("\u0110\xe3 th\xeam 1 thanh to\xe1n!"),e.currentPurchase.Amount=0,e.totalBalance<=0&&dismissPurchaseDialog()}))}}},{key:"selectPurType",value:function(e){this.currentPurchase.Method=e,e===A.h.Momo&&this.currentPurchase.Amount>0&&(this.qrContent=this.qrContentTemplate+this.currentPurchase.Amount.toString(),openQR())}}]),c}(C)).\u0275fac=function(e){return new(e||Ac)(f.bc(L.a))},Ac.\u0275cmp=f.Vb({type:Ac,selectors:[["app-view-purchase"]],features:[f.Lb],decls:74,vars:21,consts:[["id","customerInfo",1,"page-content"],[1,"container"],[1,"row","checkTop","search"],[1,"col-12","mx-auto","text-center"],["type","button",1,"btn","main-btn","w-100",3,"click"],[1,"nameTable"],[1,"tableHead"],[1,"tableCenter"],[1,"tableLeft"],[1,"tableRight"],["id","customer-list",1,"tableBody","cusScroll"],["class","tableRow main-bg customer-item",3,"click",4,"ngFor","ngForOf"],[1,"orderTotal"],[1,"totalOld"],[1,"orderPrice"],[1,"totalNew"],["id","purchase-dialog",1,"popup-content"],[1,"checkOut",2,"margin-top","0px","padding","0px"],[1,"checkOutTotal"],[1,"checkOutLeft","mb-2"],[1,"form-group"],["for","currentPayAmount",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Amount","id","Amount",1,"mainForm",3,"ngModel","input","focus","ngModelChange"],["for","Note",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Note","id","Note",1,"mainForm",3,"ngModel","ngModelChange"],[1,"form-group","methodGrid","mb-0"],["href","javascript:void(0)",1,"methodItem",3,"ngClass","click"],["src","../../../../assets/images/momo.jpg","alt",""],["src","../../../../assets/images/banking.jpg","alt",""],["src","../../../../assets/images/cash.png","alt",""],[1,"row"],["id","codeQR",1,"popup-content"],[3,"value","size"],["type","button","id","submit-btn","onClick","qrDone()",1,"btn","main-btn","w-100","mt-3"],[1,"tableRow","main-bg","customer-item",3,"click"]],template:function(e,t){1&e&&(f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.hc(4,"button",4),f.pc("click",(function(){return t.addPurchase()})),f.Rc(5,"Th\xeam thanh to\xe1n"),f.gc(),f.gc(),f.gc(),f.hc(6,"div",5),f.hc(7,"div",6),f.hc(8,"div",7),f.Rc(9,"S\u1ed1 ti\u1ec1n"),f.gc(),f.hc(10,"div",8),f.Rc(11,"H\xecnh th\u1ee9c"),f.gc(),f.hc(12,"div",9),f.Rc(13,"Th\u1eddi gian"),f.gc(),f.gc(),f.hc(14,"div",10),f.Pc(15,Pc,9,13,"div",11),f.gc(),f.gc(),f.hc(16,"div",12),f.hc(17,"p",13),f.Rc(18,"M\xe3 \u0111\u01a1n: "),f.hc(19,"span",14),f.Rc(20),f.gc(),f.gc(),f.hc(21,"p",13),f.Rc(22,"C\xf2n l\u1ea1i: "),f.hc(23,"span",14),f.Rc(24),f.uc(25,"myCurrPipe"),f.gc(),f.gc(),f.hc(26,"p",15),f.Rc(27,"Th\xe0nh ti\u1ec1n: "),f.hc(28,"span",14),f.Rc(29),f.uc(30,"myCurrPipe"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(31,"div",16),f.hc(32,"div",1),f.hc(33,"div",17),f.hc(34,"div",18),f.hc(35,"h3"),f.Rc(36,"T\u1ed5ng"),f.gc(),f.hc(37,"p"),f.Rc(38),f.uc(39,"myCurrPipe"),f.gc(),f.gc(),f.hc(40,"div",19),f.hc(41,"h4"),f.Rc(42,"S\u1ed1 ti\u1ec1n c\xf2n l\u1ea1i"),f.gc(),f.hc(43,"p"),f.Rc(44),f.uc(45,"myCurrPipe"),f.gc(),f.gc(),f.hc(46,"div",20),f.hc(47,"label",21),f.Rc(48,"S\u1ed1 ti\u1ec1n thanh to\xe1n"),f.gc(),f.hc(49,"input",22),f.pc("input",(function(e){return t.onPayChanged(e.target.value)}))("focus",(function(){return t.onPayFocus()}))("ngModelChange",(function(e){return t.currentPurchase.Amount=e})),f.gc(),f.gc(),f.hc(50,"div",20),f.hc(51,"label",23),f.Rc(52,"Ghi Ch\xfa"),f.gc(),f.hc(53,"input",24),f.pc("ngModelChange",(function(e){return t.currentPurchase.Note=e})),f.gc(),f.gc(),f.hc(54,"div",25),f.hc(55,"a",26),f.pc("click",(function(){return t.selectPurType(t.purchaseType.Momo)})),f.cc(56,"img",27),f.gc(),f.hc(57,"a",26),f.pc("click",(function(){return t.selectPurType(t.purchaseType.Banking)})),f.cc(58,"img",28),f.gc(),f.hc(59,"a",26),f.pc("click",(function(){return t.selectPurType(t.purchaseType.Cash)})),f.cc(60,"img",29),f.gc(),f.gc(),f.hc(61,"div",30),f.hc(62,"div",3),f.hc(63,"button",4),f.pc("click",(function(){return t.purchaseConfirm()})),f.Rc(64,"X\xe1c nh\u1eadn"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(65,"div",31),f.hc(66,"span"),f.Rc(67,"Qu\xe9t m\xe3 QR \u0111\u1ec3 thanh to\xe1n"),f.gc(),f.hc(68,"div"),f.cc(69,"qr-code",32),f.gc(),f.hc(70,"div",30),f.hc(71,"div",3),f.hc(72,"button",33),f.Rc(73,"Xong"),f.gc(),f.gc(),f.gc(),f.gc()),2&e&&(f.Ob(15),f.Ac("ngForOf",t.purchaseItems),f.Ob(5),f.Tc("",t.order.OrderId," "),f.Ob(4),f.Tc("",f.vc(25,13,t.totalBalance)," "),f.Ob(5),f.Tc("",f.vc(30,15,t.order.TotalAmount)," "),f.Ob(9),f.Sc(f.vc(39,17,t.order.TotalAmount)),f.Ob(6),f.Sc(f.vc(45,19,t.totalBalance)),f.Ob(5),f.Ac("ngModel",t.currentPurchase.Amount),f.Ob(4),f.Ac("ngModel",t.currentPurchase.Note),f.Ob(2),f.Ac("ngClass","Momo"===t.currentPurchase.Method?" img-purchase-selected":""),f.Ob(2),f.Ac("ngClass","Banking"===t.currentPurchase.Method?" img-purchase-selected":""),f.Ob(2),f.Ac("ngClass","Cash"===t.currentPurchase.Method?" img-purchase-selected":""),f.Ob(10),f.Ac("value",t.qrContent)("size",290))},directives:[D.k,B.b,B.k,B.n,D.j,H.a],pipes:[E.a,D.c,E.b],styles:[""]}),Ac);function wc(e,t){if(1&e){var c=f.ic();f.hc(0,"div",34),f.pc("click",(function(){f.Jc(c);var e=t.$implicit,i=t.index;return f.tc().selectItem(e,i)})),f.hc(1,"div",7),f.Rc(2),f.gc(),f.hc(3,"div",8),f.Rc(4),f.uc(5,"myCurrPipe"),f.gc(),f.hc(6,"div",9),f.Rc(7),f.uc(8,"myDatePipe"),f.gc(),f.gc()}if(2&e){var i=t.$implicit;f.Ob(2),f.Sc(i.Method),f.Ob(2),f.Sc(f.vc(5,3,i.Amount)),f.Ob(3),f.Tc("",f.wc(8,5,i.AddingTime,"HH:mm dd/MM/yyyy")," ")}}function Rc(e,t){1&e&&(f.hc(0,"div"),f.Rc(1," S\u1ed1 ti\u1ec1n l\xe0 b\u1eaft bu\u1ed9c "),f.gc())}function Mc(e,t){1&e&&(f.hc(0,"div"),f.Rc(1," S\u1ed1 ti\u1ec1n t\u1ed1i thi\u1ec3u 3 k\xfd t\u1ef1 "),f.gc())}function Fc(e,t){if(1&e&&(f.hc(0,"div",35),f.Pc(1,Rc,2,0,"div",36),f.Pc(2,Mc,2,0,"div",36),f.gc()),2&e){f.tc();var c=f.Hc(27);f.Ob(1),f.Ac("ngIf",c.errors.required),f.Ob(1),f.Ac("ngIf",c.errors.minlength)}}var Nc,xc,Lc=[{path:"login",component:sc},{path:"",component:uc,children:[{path:"",component:kc,canActivate:[g.f]},{path:"add-purchse",component:(Nc=function(e){n(c,e);var t=o(c);function c(e){var i;return h(this,c),(i=t.call(this)).purchaseService=e,i.Title="Thanh to\xe1n n\u1eb7c danh",i.currentIndex=-1,i.purchaseMethod=A.h,i.currPurchase=new R.a,i.purchases=[],i.currentAddingTime=new Date,i}return d(c,[{key:"Init",value:function(){}},{key:"selectItem",value:function(e,t){this.currentIndex=t,this.currPurchase=new R.a,this.currPurchase.Amount=e.Amount,this.currentAddingTime=new Date(e.AddingTime),this.currPurchase.Id=e.Id,this.currPurchase.Method=e.Method,this.currPurchase.OrderId=e.OrderId,this.currPurchase.Note=e.Note,openAddPurchaseDialog()}},{key:"addPurchase",value:function(){this.currPurchase=new R.a,this.currPurchase.Amount=0,this.currentAddingTime=new Date,this.currPurchase.Id=0,this.currPurchase.Method=A.h.Banking,this.currPurchase.OrderId="",this.currPurchase.Note="",openAddPurchaseDialog()}},{key:"onAmountChanged",value:function(e){this.currPurchase.Amount<10&&(this.currPurchase.Amount*=1e3,this.moveCursor(this.currPurchase.Amount.toString().length,"Amount")),this.currPurchase.Amount=+this.currPurchase.Amount}},{key:"onAmountFocus",value:function(){this.currPurchase.Amount||(this.currPurchase.Amount=0),this.moveCursor(this.currPurchase.Amount.toString().length,"Amount")}},{key:"purchaseSaving",value:function(e){e.valid&&(this.currentIndex>-1?(Object.assign(this.purchases[this.currentIndex],this.currPurchase),this.purchases[this.currentIndex].AddingTime=this.currentAddingTime.getTime(),this.currentIndex=-1):(this.currPurchase.AddingTime=this.currentAddingTime.getTime(),this.purchases.push(this.currPurchase)),dissmissAddPurchaseDialog())}},{key:"saveChanges",value:function(){var e=this;this.purchases.length<=0||this.purchaseService.bulkCreate(this.purchases,"",(function(){e.purchases=[]}))}}]),c}(C),Nc.\u0275fac=function(e){return new(e||Nc)(f.bc(L.a))},Nc.\u0275cmp=f.Vb({type:Nc,selectors:[["app-add-purchase"]],features:[f.Lb],decls:57,vars:12,consts:[["id","customerInfo",1,"page-content"],[1,"container"],[1,"row","checkTop","search"],[1,"col-12","mx-auto","text-center"],["type","button",1,"btn","main-btn","w-100",3,"click"],[1,"nameTable"],[1,"tableHead"],[1,"tableLeft","small-width"],[1,"tableCenter"],[1,"tableRight","large-width"],["id","customer-list",1,"tableBody","cusScroll"],["class","tableRow main-bg customer-item",3,"click",4,"ngFor","ngForOf"],["id","addPurchase",1,"popup-content"],["autocomplete","on",1,"addInfoForm",3,"submit"],["form","ngForm"],[1,"form-group"],["for","Amount",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Amount","id","Amount","required","","minlength","3","placeholder","S\xf4 ti\u1ec1n...",1,"mainForm",3,"ngModel","input","focus","ngModelChange"],["Amount","ngModel"],["class","alert alert-danger",4,"ngIf"],["for","Note",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Note","id","Note",1,"mainForm",3,"ngModel","ngModelChange"],["for","Method",2,"width","100%","text-align","left","margin-bottom","0px"],["id","Method","name","Method",1,"mainForm",3,"ngModel","ngModelChange"],["selected",""],[3,"ngValue"],["for","currentAddingTime",2,"width","100%","text-align","left","margin-bottom","0px"],["name","currentAddingTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],[1,"row"],[1,"col-6","mx-auto","text-center"],["type","button","id","cancel-button","onClick","dissmissAddPurchaseDialog()",1,"btn","grey-btn","w-100","mt-3"],["type","submit",1,"btn","main-btn","w-100","mt-3","btn-success"],[1,"tableRow","main-bg","customer-item",3,"click"],[1,"alert","alert-danger"],[4,"ngIf"]],template:function(e,t){if(1&e){var c=f.ic();f.hc(0,"div",0),f.hc(1,"div",1),f.hc(2,"div",2),f.hc(3,"div",3),f.hc(4,"button",4),f.pc("click",(function(){return t.addPurchase()})),f.Rc(5,"Th\xeam thanh to\xe1n"),f.gc(),f.gc(),f.gc(),f.hc(6,"div",5),f.hc(7,"div",6),f.hc(8,"div",7),f.Rc(9,"H\xecnh th\u1ee9c"),f.gc(),f.hc(10,"div",8),f.Rc(11,"S\u1ed1 ti\u1ec1n"),f.gc(),f.hc(12,"div",9),f.Rc(13,"Th\u1eddi gian"),f.gc(),f.gc(),f.hc(14,"div",10),f.Pc(15,wc,9,8,"div",11),f.gc(),f.gc(),f.hc(16,"div",2),f.hc(17,"div",3),f.hc(18,"button",4),f.pc("click",(function(){return t.saveChanges()})),f.Rc(19,"L\u01b0u"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc(),f.hc(20,"div",12),f.hc(21,"form",13,14),f.pc("submit",(function(){f.Jc(c);var e=f.Hc(22);return t.purchaseSaving(e)})),f.hc(23,"div",15),f.hc(24,"label",16),f.Rc(25,"S\u1ed1 ti\u1ec1n"),f.gc(),f.hc(26,"input",17,18),f.pc("input",(function(e){return t.onAmountChanged(e.target.value)}))("focus",(function(){return t.onAmountFocus()}))("ngModelChange",(function(e){return t.currPurchase.Amount=e})),f.gc(),f.Pc(28,Fc,3,2,"div",19),f.gc(),f.hc(29,"div",15),f.hc(30,"label",20),f.Rc(31,"Ghi Ch\xfa"),f.gc(),f.hc(32,"input",21),f.pc("ngModelChange",(function(e){return t.currPurchase.Note=e})),f.gc(),f.gc(),f.hc(33,"div",15),f.hc(34,"label",22),f.Rc(35,"H\xecnh th\u1ee9c thanh to\xe1n"),f.gc(),f.hc(36,"select",23),f.pc("ngModelChange",(function(e){return t.currPurchase.Method=e})),f.hc(37,"option",24),f.Rc(38,"Ch\u1ecdn..."),f.gc(),f.hc(39,"option",25),f.Rc(40,"Ti\u1ec1n m\u1eb7t"),f.gc(),f.hc(41,"option",25),f.Rc(42,"Chuy\u1ec3n kho\u1ea3n"),f.gc(),f.hc(43,"option",25),f.Rc(44,"V\xed Momo"),f.gc(),f.gc(),f.gc(),f.hc(45,"label",26),f.Rc(46,"Th\u1eddi gian"),f.gc(),f.hc(47,"input",27),f.pc("ngModelChange",(function(e){return t.currentAddingTime=e})),f.gc(),f.cc(48,"owl-date-time",28,29),f.hc(50,"div",30),f.hc(51,"div",31),f.hc(52,"button",32),f.Rc(53,"H\u1ee7y"),f.gc(),f.gc(),f.hc(54,"div",31),f.hc(55,"button",33),f.Rc(56,"L\u01b0u"),f.gc(),f.gc(),f.gc(),f.gc(),f.gc()}if(2&e){var i=f.Hc(27),n=f.Hc(49);f.Ob(15),f.Ac("ngForOf",t.purchases),f.Ob(11),f.Ac("ngModel",t.currPurchase.Amount),f.Ob(2),f.Ac("ngIf",i.invalid&&(i.dirty||i.touched)),f.Ob(4),f.Ac("ngModel",t.currPurchase.Note),f.Ob(4),f.Ac("ngModel",t.currPurchase.Method),f.Ob(3),f.Ac("ngValue",t.purchaseMethod.Cash),f.Ob(2),f.Ac("ngValue",t.purchaseMethod.Banking),f.Ob(2),f.Ac("ngValue",t.purchaseMethod.Momo),f.Ob(4),f.Ac("owlDateTime",n)("owlDateTimeTrigger",n)("ngModel",t.currentAddingTime),f.Ob(1),f.Ac("stepMinute",5)}},directives:[D.k,B.v,B.l,B.m,B.b,B.r,B.h,B.k,B.n,D.l,B.s,B.o,B.u,U.c,U.f,U.b],pipes:[E.a,E.b],styles:[""]}),Nc),canActivate:[g.b]},{path:"final-confirm",component:se,canActivate:[g.b]},{path:"view-purchase",component:Tc,canActivate:[g.b]},{path:"customer-confirming",component:te,canActivate:[g.a]},{path:"shipper-main",component:Qt,canActivate:[g.a]},{path:"sort-order-changing",component:rc,canActivate:[g.b]},{path:"florist-main",component:Fe,canActivate:[g.d]},{path:"order-detail-confirming",component:Je,canActivate:[g.a]},{path:"orders-manage",canActivate:[g.b],component:mt},{path:"select-customer",component:Mt,canActivate:[g.b]},{path:"order-detail/:id",component:Ye,canActivate:[g.b]},{path:"search-product",component:qt,canActivate:[g.b]},{path:"add-order",component:G,canActivate:[g.b]},{path:"select-receiver",component:Jt,canActivate:[g.b]},{path:"order-detail-view",component:Sc,canActivate:[g.e]}]}],Bc=((xc=d((function e(){h(this,e)}))).\u0275mod=f.Zb({type:xc}),xc.\u0275inj=f.Yb({factory:function(e){return new(e||xc)},imports:[[l.d.forChild(Lc),m.a],l.d]}),xc)}}])}();