(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"711k":function(e,t,i){"use strict";i.r(t),i.d(t,"ROUTES",(function(){return Oi})),i.d(t,"StaffModule",(function(){return Di}));var c=i("tyNb"),r=i("+XmF"),n=i("d2mR"),s=i("mrSG"),o=i("fXoL"),a=i("IAJr"),h=i("F2nW"),d=i("QGCU");class l{constructor(e,t){this.Title=e,this.NavigateClass=t}}var g=i("ofXK"),u=i("CVMR"),m=i("oz8C"),p=i("LQcV");let f=(()=>{class e{constructor(){this.IsDataLosingWarning=!0,this.NavigateClass="prev-icon",this.viewProdOptions={btnClass:"default",zoomFactor:.1,containerBackgroundColor:"#ccc",wheelZoom:!0,allowDrag:!0,btnIcons:{zoomIn:"fa fa-plus",zoomOut:"fa fa-minus",rotateClockwise:"fa fa-repeat",rotateCounterClockwise:"fa fa-undo",next:"fa fa-arrow-right",prev:"fa fa-arrow-left",fullscreen:"fa fa-arrows-alt"},btnShow:{zoomIn:!0,zoomOut:!0,rotateClockwise:!0,rotateCounterClockwise:!0,next:!0,prev:!0}};const e=a.a.getInjector();this.globalService=e.get(h.a),this.authService=e.get(d.a),this.location=e.get(g.h),this.ngZone=e.get(o.H),this.addressService=e.get(u.a)}get isEdittingOrder(){return this.globalService.isEdittingOrder}set isEdittingOrder(e){this.globalService.isEdittingOrder=e}get globalPurchases(){return this.globalService.currentPurchases}set globalPurchases(e){this.globalService.currentPurchases=e}get globalOrder(){return this.globalService.currentOrderViewModel}set globalOrder(e){this.globalService.currentOrderViewModel=e}get globalOrderDetail(){return this.globalService.currentOrderDetailViewModel}set globalOrderDetail(e){this.globalService.currentOrderDetailViewModel=e}get globalDistricts(){return this.globalService.currentDistricts}set globalDistricts(e){this.globalService.currentDistricts=e}get globalwards(){return this.globalService.currentWards}set globalwards(e){this.globalService.currentWards=e}get CurrentUser(){return{FullName:m.a.getUserName(),Role:m.a.getRole(),Avt:m.a.getUserAvtUrl(),Id:m.a.getUserId(),PhoneNumber:m.a.getPhoneNumber()}}getDetailDiscount(e){return p.a.getDetailDiscount(e)}ngOnInit(){window.BaseReference={component:this,zone:this.ngZone,dateTimeSelected:(e,t,i,c,r)=>this.dateTimeSelected(e,t,i,c,r),forceBackNavigate:()=>this.backNavigateOnClick(),fileChosen:e=>this.fileChosen(e),printConfirm:e=>this.printConfirm(e),rememberPassConfirm:()=>this.rememberPassConfirm(),savedLoginInforReturn:(e,t)=>this.savedLoginInforReturn(e,t)},this.IsOnTerminal=this.globalService.isRunOnTerimal(),this.Init()}menuOpening(e,t){menuOpen(e,t)}savedLoginInforReturn(e,t){}moveCursor(e,t){setTimeout(()=>{e>3&&moveCursor(t,e-3)},10)}askForRememberPassword(){this.globalService.isRememberPassWillCheck&&(this.globalService.isRememberPassWillCheck=!1,this.globalService.isOnMobile()&&isRememberPassChecking())}rememberPassConfirm(){this.openConfirm("B\u1ea1n mu\u1ed1n l\u01b0u th\xf4ng tin \u0111\u0103ng nh\u1eadp?",()=>{passwordSaving()},()=>{passwordClearing()})}ngOnDestroy(){this.navigateOnClick.unsubscribe(),this.destroy()}ngAfterViewInit(){this.globalService.updaterMobileHeaderInfo(new l(this.Title,this.NavigateClass)),this.navigateOnClick=this.globalService.navigateOnClick.subscribe(e=>{e&&this.backNavigateOnClick()})}printConfirm(e){this.openConfirm("In th\xeam b\u1ea3n?",()=>{e()},()=>{})}selectAddress(e){this.globalwards.length<=0?this.addressService.getAllDistrict().then(t=>{this.globalDistricts=t,this.addressService.getAllWards().then(t=>{this.globalwards=t,this.addressRequest(e)})}):this.addressRequest(e)}addressRequest(e){addressRequest(this.globalDistricts,e,(e,t)=>{t(this.globalwards.filter(t=>t.DistrictId===e))})}dateTimeSelected(e,t,i,c,r){}showError(e){this.globalService.showError(e)}showInfo(e){this.globalService.showInfo(e)}showSuccess(e){this.globalService.showSuccess(e)}showWarning(e){this.globalService.showWarning(e)}openFile(){pickFile(!1)}openFileForShare(){pickFile(!0)}startLoading(){this.globalService.startLoading()}stopLoading(){this.globalService.stopLoading()}setStatusBarColor(e){this.globalService.setStatusBarColor(e)}OnBackNaviage(){this.location.back()}backNavigateOnClick(){this.IsDataLosingWarning?this.openConfirm("D\u1eef li\u1ec7u hi\u1ec7n t\u1ea1i s\u1ebd b\u1ecb m\u1ea5t! B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn?",()=>{this.OnBackNaviage()}):this.OnBackNaviage()}destroy(){}fileChosen(e){}openConfirm(e,t,i,c,r,n){this.globalService.openMobileConfirm(e,t,i,c,r,n)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=o.Wb({type:e}),e})();var b=i("r5y0"),v=i("2pNN"),O=i("jXcA"),D=i("TjQO"),S=i("Abtb"),I=i("kVqo"),C=i("0zL+"),P=i("kGcc"),A=i("EeL4"),T=i("NWHx"),k=i("3Pt+"),y=i("z17N"),R=i("O0x4"),w=i("wRGf"),M=i("jjJn");function F(e,t){if(1&e){const e=o.ic();o.hc(0,"li",72),o.hc(1,"div",73),o.hc(2,"span"),o.Rc(3),o.gc(),o.gc(),o.hc(4,"div",74),o.cc(5,"img",75),o.uc(6,"ImgPipe"),o.hc(7,"div",76),o.hc(8,"h5",77),o.Rc(9),o.gc(),o.hc(10,"span",78),o.Rc(11),o.uc(12,"myCurrPipe"),o.gc(),o.hc(13,"span",79),o.Rc(14),o.gc(),o.hc(15,"span",79),o.Rc(16),o.uc(17,"myCurrPipe"),o.gc(),o.hc(18,"span",79),o.Rc(19),o.uc(20,"myCurrPipe"),o.gc(),o.gc(),o.gc(),o.hc(21,"div",80),o.hc(22,"a",81),o.pc("click",(function(i){o.Jc(e);const c=t.$implicit;return o.tc().deleteOrderDetail(c.Index)})),o.cc(23,"img",82),o.gc(),o.hc(24,"a",81),o.pc("click",(function(i){o.Jc(e);const c=t.$implicit;return o.tc().editOrderDetail(c.Index)})),o.cc(25,"img",83),o.gc(),o.gc(),o.gc()}if(2&e){const e=t.$implicit,i=o.tc();o.Ob(3),o.Sc(e.Index+1),o.Ob(2),o.Bc("src",o.wc(6,7,e.ProductImageUrl,"ProductImg"),o.Lc),o.Ob(4),o.Sc(e.ProductName),o.Ob(2),o.Tc("",o.vc(12,10,e.ModifiedPrice)," "),o.Ob(3),o.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.Quantity," "),o.Ob(2),o.Tc("Ph\u1ee5 ph\xed: ",o.vc(17,12,e.AdditionalFee)," "),o.Ob(3),o.Tc("Gi\u1ea3m gi\xe1: ",o.vc(20,14,i.getDetailDiscount(e)),"")}}function N(e,t){if(1&e){const e=o.ic();o.hc(0,"li",84),o.pc("click",(function(i){o.Jc(e);const c=t.index;return o.tc().selectPromotion(c)})),o.hc(1,"p",85),o.Rc(2),o.gc(),o.hc(3,"span",86),o.Rc(4),o.gc(),o.hc(5,"span",87),o.Rc(6),o.uc(7,"myDatePipe"),o.uc(8,"myDatePipe"),o.gc(),o.gc()}if(2&e){const e=t.$implicit,i=t.index,c=o.tc();o.Pb("data-index",i),o.Ob(2),o.Sc(e.Name),o.Ob(2),o.Sc(c.getPromotionAmount(e)),o.Ob(2),o.Uc("",o.vc(7,5,e.StartTime),"-",o.vc(8,7,e.EndTime),"")}}let x=(()=>{class e extends f{constructor(e,t,i,c,r,n){super(),this.router=e,this.orderService=t,this.customerService=i,this.printJobService=c,this.promotionService=r,this.purchaseService=n,this.Title="Th\xeam \u0110\u01a1n",this.memberShipTitle="",this.totalBalance=0,this.orderDiscount=0,this.isPurchased=!1,this.purchaseType=v.h,this.qrContentTemplate="",this.purchaseNote="",this.isCompleting=!1,this.promotions=[],this.currentPayAmount=0,this.qrContent="",this.wishingDoneTime=new Date}get AcctualBalance(){return this.order?this.order.TotalAmount-this.order.TotalPaidAmount:0}Init(){if(this.promotionService.getAvailablePromotions((new Date).getTime(),!1).then(e=>{this.promotions=e}),this.order=this.globalOrder,this.isEdittingOrder)this.wishingDoneTime=new Date(this.order.DoneTime);else if(this.memberShipTitle="New Customer",!this.order.OrderId){const e=(new Date).getFullYear();this.orderService.getMaxNumberId(e).then(t=>{null==t&&(t=0),this.order.OrderId=`${e%100}.${(t+1).toString()}`})}switch(this.onVATIncludedChange(),this.order.CustomerInfo.MembershipType){case v.d.NewCustomer:this.memberShipTitle="New Customer";break;case v.d.Member:this.memberShipTitle="Member";break;case v.d.Vip:this.memberShipTitle="VIP";break;case v.d.VVip:this.memberShipTitle="VVIP";break;default:this.memberShipTitle="New Customer"}this.totalBalance=this.order.TotalAmount-this.order.TotalPaidAmount}onMemberDiscountChange(){this.totalAmountCalculate()}getPromotionAmount(e){return e.PromotionType===D.b.Amount?e.Amount+" \u20ab":e.Amount+" %"}selectPromotion(e){this.order.AmountDiscount=this.order.PercentDiscount=0;const t=this.promotions[e];t.PromotionType===D.b.Amount?this.order.AmountDiscount=t.Amount:this.order.PercentDiscount=t.Amount,hideReceiverPopup(),this.onVATIncludedChange()}completingOrder(){this.placeOrder(!0)}editOrder(){return Object(s.a)(this,void 0,void 0,(function*(){const e=[];this.order.OrderDetails.forEach(t=>{t.NoteImages&&t.NoteImages.length>0&&t.NoteImages.forEach(t=>{p.a.isBase64(t)||e.push(t)})});try{yield this.orderService.deleteOrderDetailByOrderId(this.order.OrderId,e),this.orderConfirm()}catch(t){console.error(t)}}))}refundChecking(){this.totalBalance<0?this.openConfirm("S\u1ed1 ti\u1ec1n c\u1ea7n tr\u1ea3 l\u1ea1i cho KH l\xe0 "+p.a.toFormatCurrency(-1*this.totalBalance),()=>{this.purchaseService.refund(this.totalBalance,this.order.OrderId).then(()=>{this.order.TotalPaidAmount=this.order.TotalAmount,this.totalBalance=0,this.editOrder()})},()=>{this.editOrder()},()=>{},"X\xe1c nh\u1eadn \u0111\xe3 tr\u1ea3","\u0110\u1ec3 sau"):0==this.totalBalance?this.editOrder():this.openConfirm("Th\xeam thanh to\xe1n cho \u0111\u01a1n n\xe0y?",()=>{this.addPurchase()},()=>{this.editOrder()},null,"Th\xeam","\u0110\u1ec3 sau")}placeOrder(e){this.isCompleting=e,this.currentPayAmount=this.order.TotalAmount-this.order.TotalPaidAmount,this.order.DoneTime=this.wishingDoneTime.getTime(),this.order.CustomerInfo&&this.order.CustomerInfo.Id||(this.order.CustomerInfo=new b.a,this.order.CustomerInfo.Id="KHACH_LE",this.order.CustomerInfo.Name="Kh\xe1ch l\u1ebb"),!this.order.OrderDetails||this.order.OrderDetails.length<=0?this.showError("Ch\u01b0a ch\u1ecdn s\u1ea3n ph\u1ea9m n\xe0o!"):!this.order.TotalAmount||this.order.TotalAmount<=0?this.showError("Th\xe0nh ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!"):(this.order.CustomerInfo.GainedScore=p.a.getScoreFromOrder(this.order),this.isEdittingOrder?this.refundChecking():this.AcctualBalance>0?this.openConfirm("Th\xeam thanh to\xe1n cho \u0111\u01a1n n\xe0y?",()=>{this.addPurchase()},()=>{this.printConfirmation()},null,"Th\xeam","\u0110\u1ec3 sau"):this.printConfirmation())}addPurchase(){this.currentPayAmount=this.totalBalance,this.currentPurType=v.h.Cash,this.purchaseNote="",purchaseDoing()}printConfirmation(){this.order.CreatedDate||(this.order.CreatedDate=new Date),this.openConfirm("In ho\xe1 \u0111\u01a1n?",()=>{this.doPrintJob()},()=>{this.orderConfirm()},()=>{this.orderConfirm()})}getDetailDiscount(e){return p.a.getDetailDiscount(e)}doPrintJob(){let e=0;const t=[];this.order.OrderDetails.forEach(i=>{t.push({productName:i.ProductName,index:i.Index+1,price:i.ModifiedPrice,additionalFee:i.AdditionalFee,discount:p.a.getDetailDiscount(i),quantity:i.Quantity}),e+=i.ModifiedPrice*i.Quantity});const i=[];this.globalPurchases.forEach(e=>{i.push({method:e.Method,amount:e.Amount})});const c={Created:(new Date).getTime(),doneTime:new Date(this.order.DoneTime).toLocaleString("en-US",{hour12:!1}),Id:this.order.OrderId,Active:!0,IsDeleted:!1,saleItems:t,createdDate:this.order.CreatedDate.toLocaleString("en-US",{hour12:!1}),orderId:this.order.OrderId,summary:e,totalAmount:this.order.TotalAmount,totalPaidAmount:this.order.TotalAmount-this.AcctualBalance,totalBalance:this.totalBalance,vatIncluded:this.order.VATIncluded,memberDiscount:this.order.CustomerInfo.DiscountPercent,scoreUsed:this.order.CustomerInfo.ScoreUsed,gainedScore:this.order.CustomerInfo.GainedScore,totalScore:this.order.CustomerInfo.AvailableScore-this.order.CustomerInfo.ScoreUsed+this.order.CustomerInfo.GainedScore,customerName:this.order.CustomerInfo.Name,customerId:this.order.CustomerInfo.Id,discount:this.orderDiscount,isMemberDiscountApply:this.order.IsMemberDiscountApply,purchaseItems:i};this.printJobService.addPrintJob(c),this.orderConfirm()}orderConfirm(){this.startLoading();const e=new O.d;e.CustomerId=this.order.CustomerInfo.Id,e.Id=this.order.OrderId,e.Created=this.order.CreatedDate.getTime(),e.VATIncluded=this.order.VATIncluded,e.TotalAmount=this.order.TotalAmount,e.TotalPaidAmount=this.order.TotalPaidAmount,e.GainedScore=this.order.CustomerInfo.GainedScore,e.ScoreUsed=this.order.CustomerInfo.ScoreUsed,e.Index=this.order.Index,e.OrderType=this.order.OrderType,e.PercentDiscount=this.order.PercentDiscount,e.AmountDiscount=this.order.AmountDiscount,e.IsMemberDiscountApply=this.order.IsMemberDiscountApply,e.DoneTime=this.order.DoneTime,e.IsFinished=this.isCompleting,this.orderService.addOrEditOrder(e,this.isEdittingOrder).then(t=>Object(s.a)(this,void 0,void 0,(function*(){this.globalPurchases.length>0&&this.purchaseService.bulkCreate(this.globalPurchases,e.Id,()=>{this.globalPurchases=[]});const t=[],i=[];this.order.OrderDetails.forEach(c=>{const r=new O.e;r.OrderId=e.Id,r.IsHardcodeProduct=c.IsFromHardCodeProduct,r.HardcodeProductImageName=c.HardcodeImageName,r.ProductId=c.ProductId,r.ProductImageUrl=c.ProductImageUrl,r.ProductPrice=c.ModifiedPrice,r.AdditionalFee=c.AdditionalFee,r.ProductName=c.ProductName,r.Description=c.Description,r.State=this.isCompleting?v.f.Completed:v.f.Added,r.IsVATIncluded=e.VATIncluded,r.PurposeOf=c.PurposeOf,r.Index=c.Index,r.PercentDiscount=c.PercentDiscount,r.AmountDiscount=c.AmountDiscount,r.Quantity=c.Quantity,r.NoteImages=c.NoteImages,r.CustomerName=this.order.CustomerInfo.Name,r.CustomerPhoneNumber=this.order.CustomerInfo.PhoneNumber;const n=new O.a;n.Address=c.DeliveryInfo.Address?c.DeliveryInfo.Address:this.order.CustomerInfo.Address?this.order.CustomerInfo.Address:"",n.FullName=c.DeliveryInfo.FullName?c.DeliveryInfo.FullName:this.order.CustomerInfo.Name?this.order.CustomerInfo.Name:"",n.PhoneNumber=c.DeliveryInfo.PhoneNumber?c.DeliveryInfo.PhoneNumber:this.order.CustomerInfo.PhoneNumber?this.order.CustomerInfo.PhoneNumber:"",r.DeliveryInfo.ReceivingTime=c.DeliveryInfo.DateTime?c.DeliveryInfo.DateTime.getTime():this.order.DoneTime,r.DeliveryInfo.ReceiverDetail=n,t.push(r);let s=!0;i.forEach(e=>{p.a.receiverInfoCompare(e,n)&&(s=!1)}),s&&i.push(n)}),this.globalOrder.CustomerInfo.ReceiverInfos.forEach(e=>{let t=!0;i.forEach(i=>{p.a.receiverInfoCompare(e,i)&&(t=!1)}),t&&i.push(e)}),this.uploadImage(t).then(c=>{this.orderService.addOrderDetails(t).then(()=>{"KHACH_LE"!==e.CustomerId?this.customerService.updateReceiverList(e.CustomerId,i).then(e=>{this.stopLoading(),e&&this.completeOrder()}):(this.stopLoading(),this.completeOrder())}).catch(e=>{console.log(e),this.globalService.stopLoading(),this.showError(e.toString())})}).catch(e=>{this.showError(e.toString())})})))}selectPurType(e){this.currentPurType=e,e===v.h.Momo&&this.currentPayAmount>0&&(this.qrContent=this.qrContentTemplate+this.currentPayAmount.toString(),openQR())}purchaseConfirm(){if(this.currentPayAmount>this.totalBalance||this.currentPayAmount<=0)return void this.showError("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!");const e=new S.a;e.OrderId=this.order.OrderId,e.Amount=+this.currentPayAmount,e.Method=this.currentPurType,e.Note=this.purchaseNote,e.AddingTime=(new Date).getTime(),this.globalPurchases.push(e),this.order.TotalPaidAmount+=e.Amount,this.currentPayAmount=0,this.showSuccess("\u0110\xe3 th\xeam 1 thanh to\xe1n!"),this.totalAmountCalculate(),this.totalBalance<=0?dismissPurchaseDialog(()=>{this.isEdittingOrder?this.editOrder():this.printConfirmation()}):(this.currentPayAmount=this.totalBalance,this.currentPurType=v.h.Cash)}uploadImages(e){return Object(s.a)(this,void 0,void 0,(function*(){return yield new Promise((t,i)=>Object(s.a)(this,void 0,void 0,(function*(){let c="";for(let t=0;t<e.NoteImages.length;t++){const r=e.NoteImages[t];if(!p.a.isBase64(r)){c=t===e.NoteImages.length-1?c+r:c+r+",";continue}const n=yield fetch(r),s=yield n.blob();if(null!=s){const r=new File([s],"result.png",{type:"image/png"}),n=yield this.orderService.uploadNoteImg(r).catch(e=>{this.showError(e),i(e)});c=t===e.NoteImages.length-1?c+n:c+n+","}}t(c)}))).then(e=>e)}))}uploadImage(e){return Object(s.a)(this,void 0,void 0,(function*(){return yield new Promise((t,i)=>Object(s.a)(this,void 0,void 0,(function*(){try{for(let t=0;t<e.length;t++){const c=e[t];if(c.NoteImages&&c.NoteImages.length>0){const e=yield this.uploadImages(c).catch(e=>{i(e)});e&&(console.log(e),c.NoteImages=[],c.NoteImagesBlobbed=e)}}t("added")}catch(c){i(c)}}))).then(e=>e)}))}totalAmountCalculate(){this.order.TotalAmount=0,this.order.OrderDetails.forEach(e=>{e.AdditionalFee||(e.AdditionalFee=0);const t=e.ModifiedPrice*e.Quantity;let i=t;e.PercentDiscount&&e.PercentDiscount>0&&(i-=i/100*e.PercentDiscount),e.AmountDiscount&&e.AmountDiscount>0&&(i-=e.AmountDiscount),this.order.TotalAmount+=this.order.CustomerInfo&&this.order.CustomerInfo.DiscountPercent&&this.order.CustomerInfo.DiscountPercent>0&&this.order.IsMemberDiscountApply?i-t/100*this.order.CustomerInfo.DiscountPercent+e.AdditionalFee:i+e.AdditionalFee}),this.orderDiscount=0,this.order.PercentDiscount&&this.order.PercentDiscount>0&&(this.orderDiscount=this.order.TotalAmount/100*this.order.PercentDiscount,this.order.TotalAmount-=this.orderDiscount),this.order.AmountDiscount&&this.order.AmountDiscount>0&&(this.order.TotalAmount=this.order.TotalAmount-this.order.AmountDiscount,this.orderDiscount+=this.order.AmountDiscount),this.order.VATIncluded&&(this.order.TotalAmount=this.order.TotalAmount+.1*this.order.TotalAmount),this.order.TotalAmount-=p.a.geExchangableAmount(this.order.CustomerInfo.ScoreUsed),this.totalBalance=this.order.TotalAmount-this.order.TotalPaidAmount}onDiscountChanged(e){this.onVATIncludedChange()}onPayChanged(e){this.currentPayAmount<10&&this.currentPayAmount>0&&(this.currentPayAmount*=1e3,this.moveCursor(this.currentPayAmount.toString().length,"currentPayAmount")),this.currentPayAmount=+this.currentPayAmount}onPayFocus(){this.currentPayAmount||(this.currentPayAmount=0),this.moveCursor(this.currentPayAmount.toString().length,"currentPayAmount")}onAmountDiscountChanged(e){this.order.AmountDiscount<10&&this.order.AmountDiscount>0&&(this.order.AmountDiscount*=1e3,this.moveCursor(this.order.AmountDiscount.toString().length,"AmountDiscount")),this.order.AmountDiscount=+this.order.AmountDiscount,this.onVATIncludedChange()}onAmountDiscountFocus(){this.order.AmountDiscount||(this.order.AmountDiscount=0),this.moveCursor(this.order.AmountDiscount.toString().length,"AmountDiscount")}onVATIncludedChange(){this.totalAmountCalculate()}scoreExchange(){openExcForm((e,t)=>this.order.CustomerInfo.AvailableScore<e?(this.showError("V\u01b0\u1ee3t qu\xe1 \u0111i\u1ec3m t\xedch l\u0169y!!"),void t.call(this,!1)):p.a.geExchangableAmount(e)>=this.totalBalance?(this.showError("V\u01b0\u1ee3t qu\xe1 t\u1ed5ng ti\u1ec1n thanh to\xe1n!"),void t.call(this,!1)):(t.call(this,!0),this.order.CustomerInfo.ScoreUsed=e,void this.onVATIncludedChange()))}addNewOrderDetail(){this.globalOrderDetail=new b.c,this.router.navigate(["/staff/order-detail/-1"])}editOrderDetail(e){menuOpen(t=>{const i=b.c.DeepCopy(this.order.OrderDetails[e]);switch(+t){case 0:this.globalOrderDetail=i,this.router.navigate(["/staff/order-detail/"+e]);break;case 1:i.Index=this.order.OrderDetails.length,this.order.OrderDetails.push(i),this.onVATIncludedChange()}},["Ch\u1ec9nh s\u1eeda","Sao ch\xe9p"])}deleteOrderDetail(e){this.openConfirm("Ch\u1eafc ch\u1eafn xo\xe1?",()=>{this.order.OrderDetails.splice(e,1);let t=0;this.order.OrderDetails.forEach(e=>{e.Index=t,t++}),this.onVATIncludedChange()})}completeOrder(){"KHACH_LE"!==this.order.CustomerInfo.Id&&this.isCompleting?this.orderService.addScoreToCustomer(this.order).then(e=>{this.OnBackNaviage()}):this.OnBackNaviage()}}return e.\u0275fac=function(t){return new(t||e)(o.bc(c.b),o.bc(I.a),o.bc(C.a),o.bc(P.a),o.bc(A.a),o.bc(T.a))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-add-order"]],features:[o.Lb],decls:136,vars:36,consts:[["id","confirm",1,"page-content"],[1,"container"],[1,"row","custBrow",2,"margin-bottom","1vh"],[1,"col-10","custList"],["routerLink","/staff/select-customer",1,"main-bg","custListButton"],["src","../../../../assets/images/cust.png","alt",""],["behavior","scroll","direction","left"],[1,"col-2","prodAdd","text-right","pl-0"],[1,"main-bg",3,"click"],["src","../../../../assets/images/add.svg","alt","",1,"main-filter"],[1,"vatStatus"],[1,"vatScope"],["type","checkbox","id","IsMemberDiscountApply","name","IsMemberDiscountApply","value","1",1,"custom-checkbox",3,"ngModel","change","ngModelChange"],[1,"main-bg","vatCustom"],[1,"title-field"],[1,"form-group","orderInfo","borderless-field"],["type","text","name","OrderId","id","OrderId","placeholder","M\xe3 \u0111\u01a1n...",1,"orderField","small-height",3,"ngModel","readonly","ngModelChange"],["href","javascript:void(0)","onclick","openCustMenu()","type","button",1,"btn","main-btn","w-100",2,"margin-bottom","1vh"],[1,"row","col-xs-12",2,"height","62px","padding-left","15px","padding-right","15px"],[1,"addInfo",2,"width","50%","padding-right","5px"],[1,"form-group","orderInfo","borderless-field",2,"margin-bottom","1vh"],["type","number","name","PercentDiscount","id","PercentDiscount","placeholder","%",1,"orderField","small-height",3,"ngModel","input","ngModelChange"],[1,"addInfo",2,"width","50%","padding-left","5px"],["type","tel","name","AmountDiscount","id","AmountDiscount","placeholder","0",1,"orderField","small-height",3,"ngModel","ngModelChange","input","focus"],["type","text","name","wishingDoneTime","id","wishingDoneTime","placeholder","",1,"orderField","small-height",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],[1,"orderDetail","cusScroll"],["class","orderDetailItem",4,"ngFor","ngForOf"],["type","checkbox","id","VATIncluded","name","VATIncluded","value","1",1,"custom-checkbox",3,"ngModel","change","ngModelChange"],[1,"orderTotal"],[1,"totalOld"],[1,"orderPrice"],[1,"totalNew"],[1,"totalExc"],["href","javascript:void(0)","type","button",1,"btn","main-btn","w-100",2,"margin-top","2vh",3,"click"],[1,"row","orderConfirm","text-center"],[1,"col-4","exchange"],[1,"btn","main-bg","w-100",3,"click"],["src","../../../../assets/images/money.svg","alt","\u0110\u1ed5i \u0111i\u1ec3m",1,"main-filter"],[1,"col-8","pl-0"],["href","javascript:void(0)","type","submit",1,"btn","main-btn","w-100",3,"click"],["id","exchangeAdd",1,"popup-content"],["action","",1,""],[1,"form-group"],["for","",1,"excLabel"],[1,"memberLevel","v"],[1,""],["type","number","name","","id","exchange-val","placeholder","S\u1ed1 \u0111i\u1ec3m mu\u1ed1n \u0111\u1ed5i...",1,"mainForm"],[1,"row"],[1,"col-8","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-3","exchange-confirm"],["id","recentInfo",1,"actionMenu2"],["style","height: 69px;text-align: left;",3,"click",4,"ngFor","ngForOf"],["id","purchase-dialog",1,"popup-content"],[1,"checkOut",2,"margin-top","0px","padding","0px"],[1,"checkOutTotal"],[1,"checkOutLeft","mb-2"],["for","currentPayAmount",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","currentPayAmount","id","currentPayAmount",1,"mainForm",3,"ngModel","input","focus","ngModelChange"],["for","Note",2,"width","100%","text-align","left","margin-bottom","0px"],["type","text","name","purchaseNote","id","purchaseNote",1,"mainForm",3,"ngModel","ngModelChange"],[1,"form-group","methodGrid","mb-0"],["href","javascript:void(0)",1,"methodItem",3,"ngClass","click"],["src","../../../../assets/images/momo.jpg","alt",""],["src","../../../../assets/images/banking.jpg","alt",""],["src","../../../../assets/images/cash.png","alt",""],[1,"col-12","mx-auto","text-center"],["type","button",1,"btn","main-btn","w-100",3,"click"],["id","codeQR",1,"popup-content"],[3,"value","size"],["type","button","id","submit-btn","onClick","qrDone()",1,"btn","main-btn","w-100","mt-3"],[1,"orderDetailItem"],[1,"itemNumb"],[1,"itemDetail"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPrice"],[1,"prodCharge"],[1,"itemAction"],[3,"click"],["src","../../../../assets/images/delete.svg","alt","",1,"white-filter"],["src","../../../../assets/images/edit.svg","alt","",1,"white-filter"],[2,"height","69px","text-align","left",3,"click"],[1,"recentInfo-name"],[1,"recentInfo-phone",2,"width","25%"],[1,"recentInfo-date",2,"width","75%"]],template:function(e,t){if(1&e&&(o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"div",2),o.hc(3,"div",3),o.hc(4,"a",4),o.cc(5,"img",5),o.hc(6,"marquee",6),o.Rc(7),o.gc(),o.gc(),o.gc(),o.hc(8,"div",7),o.hc(9,"a",8),o.pc("click",(function(e){return t.addNewOrderDetail()})),o.cc(10,"img",9),o.gc(),o.gc(),o.gc(),o.hc(11,"div",10),o.hc(12,"p"),o.Rc(13,"\xc1p d\u1ee5ng khuy\u1ebfn m\xe3i th\xe0nh vi\xean"),o.gc(),o.hc(14,"div",11),o.hc(15,"input",12),o.pc("change",(function(e){return t.onMemberDiscountChange()}))("ngModelChange",(function(e){return t.order.IsMemberDiscountApply=e})),o.gc(),o.cc(16,"span",13),o.gc(),o.gc(),o.hc(17,"label",14),o.Rc(18,"M\xe3 \u0111\u01a1n "),o.gc(),o.hc(19,"div",15),o.hc(20,"input",16),o.pc("ngModelChange",(function(e){return t.order.OrderId=e})),o.gc(),o.gc(),o.hc(21,"a",17),o.Rc(22,"\xc1p d\u1ee5ng khuy\u1ebfn m\xe3i"),o.gc(),o.hc(23,"div",18),o.hc(24,"div",19),o.hc(25,"label",14),o.Rc(26,"Gi\u1ea3m gi\xe1 ph\u1ea7n tr\u0103m"),o.gc(),o.hc(27,"div",20),o.hc(28,"input",21),o.pc("input",(function(e){return t.onDiscountChanged(e.target.value)}))("ngModelChange",(function(e){return t.order.PercentDiscount=e})),o.gc(),o.gc(),o.gc(),o.hc(29,"div",22),o.hc(30,"label",14),o.Rc(31,"Gi\u1ea3 gi\xe1 ti\u1ec1n"),o.gc(),o.hc(32,"div",15),o.hc(33,"input",23),o.pc("ngModelChange",(function(e){return t.order.AmountDiscount=e}))("input",(function(e){return t.onAmountDiscountChanged(e.target.value)}))("focus",(function(e){return t.onAmountDiscountFocus()})),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(34,"label",14),o.Rc(35,"Th\u1eddi gian nh\u1eadn d\u1ef1 ki\u1ebfn"),o.gc(),o.hc(36,"div",15),o.hc(37,"input",24),o.pc("ngModelChange",(function(e){return t.wishingDoneTime=e})),o.gc(),o.cc(38,"owl-date-time",25,26),o.gc(),o.hc(40,"ul",27),o.Pc(41,F,26,16,"li",28),o.gc(),o.hc(42,"div",10),o.hc(43,"p"),o.Rc(44,"Bao g\u1ed3m VAT"),o.gc(),o.hc(45,"div",11),o.hc(46,"input",29),o.pc("change",(function(e){return t.onVATIncludedChange()}))("ngModelChange",(function(e){return t.order.VATIncluded=e})),o.gc(),o.cc(47,"span",13),o.gc(),o.gc(),o.hc(48,"div",30),o.hc(49,"p",31),o.Rc(50,"C\xf2n l\u1ea1i: "),o.hc(51,"span",32),o.Rc(52),o.uc(53,"myCurrPipe"),o.gc(),o.gc(),o.hc(54,"p",33),o.Rc(55,"Th\xe0nh ti\u1ec1n: "),o.hc(56,"span",32),o.Rc(57),o.uc(58,"myCurrPipe"),o.gc(),o.gc(),o.hc(59,"p",34),o.Rc(60,"\u0110\u1ed5i \u0111i\u1ec3m: "),o.hc(61,"span",32),o.Rc(62),o.gc(),o.gc(),o.gc(),o.hc(63,"a",35),o.pc("click",(function(e){return t.completingOrder()})),o.Rc(64," K\u1ebft th\xfac \u0111\u01a1n"),o.gc(),o.hc(65,"div",36),o.hc(66,"div",37),o.hc(67,"button",38),o.pc("click",(function(e){return t.scoreExchange()})),o.cc(68,"img",39),o.gc(),o.gc(),o.hc(69,"div",40),o.hc(70,"a",41),o.pc("click",(function(e){return t.placeOrder(!1)})),o.Rc(71,"L\u01b0u"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(72,"div",42),o.hc(73,"form",43),o.hc(74,"div",44),o.hc(75,"label",45),o.Rc(76,"Th\xe0nh vi\xean: "),o.gc(),o.hc(77,"span",46),o.Rc(78),o.gc(),o.gc(),o.hc(79,"div",44),o.hc(80,"label",45),o.Rc(81,"\u0110i\u1ec3m t\xedch l\u0169y: "),o.gc(),o.hc(82,"span",47),o.Rc(83),o.gc(),o.gc(),o.hc(84,"div",44),o.cc(85,"input",48),o.gc(),o.hc(86,"div",49),o.hc(87,"div",50),o.hc(88,"button",51),o.Rc(89,"\u0110\u1ed5i \u0111i\u1ec3m"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(90,"div",52),o.hc(91,"ul"),o.Pc(92,N,9,9,"li",53),o.gc(),o.gc(),o.hc(93,"div",54),o.hc(94,"div",1),o.hc(95,"div",55),o.hc(96,"div",56),o.hc(97,"h3"),o.Rc(98,"T\u1ed5ng"),o.gc(),o.hc(99,"p"),o.Rc(100),o.uc(101,"myCurrPipe"),o.gc(),o.gc(),o.hc(102,"div",57),o.hc(103,"h4"),o.Rc(104,"S\u1ed1 ti\u1ec1n c\xf2n l\u1ea1i"),o.gc(),o.hc(105,"p"),o.Rc(106),o.uc(107,"myCurrPipe"),o.gc(),o.gc(),o.hc(108,"div",44),o.hc(109,"label",58),o.Rc(110,"S\u1ed1 ti\u1ec1n thanh to\xe1n"),o.gc(),o.hc(111,"input",59),o.pc("input",(function(e){return t.onPayChanged(e.target.value)}))("focus",(function(e){return t.onPayFocus()}))("ngModelChange",(function(e){return t.currentPayAmount=e})),o.gc(),o.gc(),o.hc(112,"div",44),o.hc(113,"label",60),o.Rc(114,"Ghi Ch\xfa"),o.gc(),o.hc(115,"input",61),o.pc("ngModelChange",(function(e){return t.purchaseNote=e})),o.gc(),o.gc(),o.hc(116,"div",62),o.hc(117,"a",63),o.pc("click",(function(e){return t.selectPurType(t.purchaseType.Momo)})),o.cc(118,"img",64),o.gc(),o.hc(119,"a",63),o.pc("click",(function(e){return t.selectPurType(t.purchaseType.Banking)})),o.cc(120,"img",65),o.gc(),o.hc(121,"a",63),o.pc("click",(function(e){return t.selectPurType(t.purchaseType.Cash)})),o.cc(122,"img",66),o.gc(),o.gc(),o.hc(123,"div",49),o.hc(124,"div",67),o.hc(125,"button",68),o.pc("click",(function(e){return t.purchaseConfirm()})),o.Rc(126,"X\xe1c nh\u1eadn"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(127,"div",69),o.hc(128,"span"),o.Rc(129,"Qu\xe9t m\xe3 QR \u0111\u1ec3 thanh to\xe1n "),o.gc(),o.hc(130,"div"),o.cc(131,"qr-code",70),o.gc(),o.hc(132,"div",49),o.hc(133,"div",67),o.hc(134,"button",71),o.Rc(135,"Xong"),o.gc(),o.gc(),o.gc(),o.gc()),2&e){const e=o.Hc(39);o.Ob(7),o.Uc("",t.order.CustomerInfo.Name," (-",t.order.CustomerInfo.DiscountPercent,"%)"),o.Ob(8),o.Ac("ngModel",t.order.IsMemberDiscountApply),o.Ob(5),o.Ac("ngModel",t.order.OrderId)("readonly",t.isEdittingOrder),o.Ob(8),o.Ac("ngModel",t.order.PercentDiscount),o.Ob(5),o.Ac("ngModel",t.order.AmountDiscount),o.Ob(4),o.Ac("owlDateTime",e)("owlDateTimeTrigger",e)("ngModel",t.wishingDoneTime),o.Ob(1),o.Ac("stepMinute",5),o.Ob(3),o.Ac("ngForOf",t.order.OrderDetails),o.Ob(5),o.Ac("ngModel",t.order.VATIncluded),o.Ob(6),o.Tc("",o.vc(53,28,t.AcctualBalance)," "),o.Ob(5),o.Tc("",o.vc(58,30,t.order.TotalAmount)," "),o.Ob(5),o.Sc(t.order.CustomerInfo.ScoreUsed),o.Ob(16),o.Sc(t.memberShipTitle),o.Ob(5),o.Sc(t.order.CustomerInfo.AvailableScore),o.Ob(9),o.Ac("ngForOf",t.promotions),o.Ob(8),o.Sc(o.vc(101,32,t.order.TotalAmount)),o.Ob(6),o.Sc(o.vc(107,34,t.totalBalance)),o.Ob(5),o.Ac("ngModel",t.currentPayAmount),o.Ob(4),o.Ac("ngModel",t.purchaseNote),o.Ob(2),o.Ac("ngClass","Momo"===t.currentPurType?" img-purchase-selected":""),o.Ob(2),o.Ac("ngClass","Banking"===t.currentPurType?" img-purchase-selected":""),o.Ob(2),o.Ac("ngClass","Cash"===t.currentPurType?" img-purchase-selected":""),o.Ob(10),o.Ac("value",t.qrContent)("size",290)}},directives:[c.c,k.a,k.k,k.n,k.b,k.p,y.c,y.f,y.b,g.k,k.v,k.l,k.m,g.j,R.a],pipes:[w.a,M.a,w.b],styles:[""]}),e})();var L=i("uP5C"),B=i("e6qa");function U(e,t){if(1&e){const e=o.ic();o.hc(0,"a",7),o.pc("click",(function(t){return o.Jc(e),o.tc().openFileForShare()})),o.Rc(1,"Ch\u1ecdn h\xecnh"),o.gc()}}function q(e,t){if(1&e){const e=o.ic();o.hc(0,"a",7),o.pc("click",(function(t){return o.Jc(e),o.tc().openFile()})),o.Rc(1,"Ch\u1ecdn h\xecnh"),o.gc()}}function H(e,t){if(1&e){const e=o.ic();o.hc(0,"div"),o.hc(1,"input",8,9),o.pc("change",(function(t){return o.Jc(e),o.tc().onChange(t)})),o.gc(),o.hc(3,"a",7),o.pc("click",(function(t){return o.Jc(e),o.Hc(2).click()})),o.Rc(4,"Ch\u1ecdn h\xecnh"),o.gc(),o.gc()}}function E(e,t){if(1&e){const e=o.ic();o.hc(0,"a",7),o.pc("click",(function(t){return o.Jc(e),o.tc().shareForCus()})),o.Rc(1,"Share cho KH"),o.gc()}}function V(e,t){if(1&e){const e=o.ic();o.hc(0,"a",7),o.pc("click",(function(t){return o.Jc(e),o.tc().confirm("")})),o.Rc(1,"X\xe1c nh\u1eadn"),o.gc()}}function J(e,t){if(1&e){const e=o.ic();o.hc(0,"a",7),o.pc("click",(function(t){return o.Jc(e),o.tc().shipperCofirm()})),o.Rc(1,"X\xe1c nh\u1eadn"),o.gc()}}let W=(()=>{class e extends f{constructor(e,t,i,c){super(),this.orderDetailService=e,this.customerService=t,this.router=i,this.orderService=c,this.Title="X\xe1c nh\u1eadn v\u1edbi kh\xe1ch h\xe0ng",this.edittingImageUrl="",this.totalBalance=0,this.orderDetail=new b.c,this.order=new b.d,this.customer=new L.a}Init(){this.orderDetail=this.globalOrderDetail,this.orderService.getById(this.orderDetail.OrderId).then(e=>{this.order=e,this.totalBalance=this.order.TotalAmount-this.order.TotalPaidAmount,this.customerService.getById(this.order.CustomerInfo.Id).then(e=>{this.customer=e})})}fileChosen(e){this.edittingImageUrl="data:image/png;base64,"+e}onChange(e){const t=e.target.files[0];if(!t)return;if(null==t.type.match(/image\/*/))return void this.showError("Ph\u1ea3i ch\u1ecdn h\xecnh !!");const i=new FileReader;i.readAsDataURL(t),i.onload=e=>{this.edittingImageUrl=i.result.toString()}}destroy(){super.destroy(),deleteTempImage()}shipperCofirm(){getShippingNoteDialog("X\xe1c nh\u1eadn",e=>{this.confirm(e)})}confirm(e){switch(this.CurrentUser.Role){case v.i.Account:case v.i.Admin:""!==this.edittingImageUrl?fetch(this.edittingImageUrl).then(e=>e.blob()).then(e=>{const t=new File([e],"result.png",{type:"image/png"});this.orderDetailService.resultConfirm(this.orderDetail.OrderDetailId,this.orderDetailService.getLastestMaking(this.orderDetail).Id,t).then(e=>{this.router.navigate(["staff/account-main"])})}):this.orderDetailService.resultConfirm(this.orderDetail.OrderDetailId,this.orderDetailService.getLastestMaking(this.orderDetail).Id,null).then(e=>{this.router.navigate(["staff/account-main"])});break;case v.i.Shipper:""!==this.edittingImageUrl?fetch(this.edittingImageUrl).then(e=>e.blob()).then(t=>{const i=new File([t],"shipping.png",{type:"image/png"});this.orderDetailService.shippingConfirm(this.orderDetail,i,e).then(e=>{this.router.navigate(["staff/shipper-main"])})}):this.orderDetailService.shippingConfirm(this.orderDetail,null,e).then(e=>{this.router.navigate(["staff/shipper-main"])})}}shareForCus(){""!==this.edittingImageUrl&&(this.IsOnTerminal?shareImageCus(p.a.getMainContact(this.customer)):shareImageCusWithData(this.edittingImageUrl,p.a.getMainContact(this.customer)))}}return e.\u0275fac=function(t){return new(t||e)(o.bc(B.a),o.bc(C.a),o.bc(c.b),o.bc(I.a))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-customer-confirm"]],features:[o.Lb],decls:11,vars:7,consts:[["id","staff",1,"page-content"],[1,"container"],[1,"image-top"],["id","selected-image","onclick","rotateImage()","alt","",3,"src"],[1,"image-action"],["href","javascript:void(0)","class","main-bg",3,"click",4,"ngIf"],[4,"ngIf"],["href","javascript:void(0)",1,"main-bg",3,"click"],["type","file","id","resultFile","name","uploadedFile","hidden","",1,"img-cover","file-upload-default",3,"change"],["imageUpload",""]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"div",2),o.cc(3,"img",3),o.gc(),o.hc(4,"div",4),o.Pc(5,U,2,0,"a",5),o.Pc(6,q,2,0,"a",5),o.Pc(7,H,5,0,"div",6),o.Pc(8,E,2,0,"a",5),o.Pc(9,V,2,0,"a",5),o.Pc(10,J,2,0,"a",5),o.gc(),o.gc(),o.gc()),2&e&&(o.Ob(3),o.Ac("src",t.edittingImageUrl,o.Lc),o.Ob(2),o.Ac("ngIf",t.IsOnTerminal&&"Shipper"!=t.CurrentUser.Role),o.Ob(1),o.Ac("ngIf",t.IsOnTerminal&&"Shipper"==t.CurrentUser.Role),o.Ob(1),o.Ac("ngIf",!t.IsOnTerminal),o.Ob(1),o.Ac("ngIf","Shipper"!=t.CurrentUser.Role),o.Ob(1),o.Ac("ngIf","Shipper"!=t.CurrentUser.Role),o.Ob(1),o.Ac("ngIf","Shipper"==t.CurrentUser.Role))},directives:[g.l],styles:[""]}),e})();var G=i("AytR"),j=i("dkQB");let X=(()=>{class e{constructor(e){this.globalService=e}pushFileToStorage(e,t,i){}push(e,t,i){return Object(s.a)(this,void 0,void 0,(function*(){return""}))}deleteFile(e,t){}downloadFIle(e,t){const i=new XMLHttpRequest;i.responseType="blob",i.onload=e=>{t(i.response)},i.open("GET",e),i.send()}pushStringToStorage(e,t,i){}}return e.\u0275fac=function(t){return new(t||e)(o.lc(h.a))},e.\u0275prov=o.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function $(e,t){if(1&e&&(o.hc(0,"div",21),o.hc(1,"span",11),o.Rc(2,"SDT ng\u01b0\u1eddi nh\u1eadn:"),o.gc(),o.hc(3,"span",12),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(4),o.Sc(e.orderDetail.DeliveryInfo.PhoneNumber)}}function Q(e,t){if(1&e&&(o.hc(0,"div",21),o.hc(1,"span",11),o.Rc(2,"\u0110\u1ecba ch\u1ec9 giao:"),o.gc(),o.hc(3,"span",12),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(4),o.Sc(e.orderDetail.DeliveryInfo.Address)}}let z=(()=>{class e extends f{constructor(e,t,i,c,r){super(),this.router=e,this.orderService=t,this.orderDetailService=i,this.storageService=c,this.customerService=r,this.Title="X\xe1c nh\u1eadn giao h\xe0ng",this.sharingImage=""}Init(){this.orderDetail=this.globalOrderDetail,this.customerService.getById(this.globalOrder.CustomerInfo.Id).then(e=>{this.customer=e})}destroy(){super.destroy(),deleteTempImage()}confirmOrderDetail(){this.orderDetailService.completeOD(this.orderDetail,this.globalOrder).then(e=>Object(s.a)(this,void 0,void 0,(function*(){this.router.navigate(["staff/orders-manage"])})))}getShippingImg(){const e=this.orderDetailService.getLastestShipping(this.orderDetail);return null!=e?e.DeliveryImageUrl:""}getResultImg(){const e=this.orderDetailService.getLastestMaking(this.orderDetail);return null!=e?e.ResultImageUrl:""}shareToCus(){this.startLoading(),this.storageService.downloadFIle(`${G.a.base_domain}${j.b.shipping_img}${this.getShippingImg()}`,e=>{this.stopLoading();const t=new FileReader;t.readAsDataURL(e),t.onloadend=()=>{const e=t.result.toString();this.sharingImage=e,shareImageCusWithData(this.sharingImage,p.a.getMainContact(this.customer))}})}}return e.\u0275fac=function(t){return new(t||e)(o.bc(c.b),o.bc(I.a),o.bc(B.a),o.bc(X),o.bc(C.a))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-final-confirm"]],features:[o.Lb],decls:63,vars:31,consts:[["id","deliConfirm",1,"page-content"],[1,"container"],[1,"prodDetail"],[1,"prodGen"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPrice"],[1,"prodCharge"],[1,"prodInfo","cusScroll"],[1,"prodQuan","infoGroup"],[1,"itemlabel"],[1,"itemVal"],[1,"prodName","infoGroup"],[1,"prodTime","infoGroup"],["class","prodAddr infoGroup",4,"ngIf"],[1,"prodDesc","infoGroup"],[1,"row"],[1,"col-10","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-2",3,"click"],["type","submit",1,"btn","grey-btn","w-100","mt-2",3,"click"],[1,"prodAddr","infoGroup"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"div",2),o.hc(3,"div",3),o.cc(4,"img",4),o.uc(5,"ImgPipe"),o.cc(6,"img",4),o.uc(7,"ImgPipe"),o.hc(8,"div",5),o.hc(9,"h5",6),o.Rc(10),o.gc(),o.hc(11,"span",7),o.Rc(12),o.uc(13,"myCurrPipe"),o.gc(),o.hc(14,"span",8),o.Rc(15),o.gc(),o.hc(16,"span",8),o.Rc(17),o.uc(18,"myCurrPipe"),o.gc(),o.hc(19,"span",8),o.Rc(20),o.uc(21,"myCurrPipe"),o.gc(),o.gc(),o.gc(),o.hc(22,"div",9),o.hc(23,"div",10),o.hc(24,"span",11),o.Rc(25,"M\xe3 \u0111\u01a1n: "),o.gc(),o.hc(26,"span",12),o.Rc(27),o.gc(),o.gc(),o.hc(28,"div",13),o.hc(29,"span",11),o.Rc(30,"T\xean KH"),o.gc(),o.hc(31,"span",12),o.Rc(32),o.gc(),o.gc(),o.hc(33,"div",13),o.hc(34,"span",11),o.Rc(35,"SDT KH"),o.gc(),o.hc(36,"span",12),o.Rc(37),o.gc(),o.gc(),o.hc(38,"div",14),o.hc(39,"span",11),o.Rc(40,"Th\u1eddi gian giao:"),o.gc(),o.hc(41,"span",12),o.Rc(42),o.uc(43,"date"),o.gc(),o.gc(),o.hc(44,"div",13),o.hc(45,"span",11),o.Rc(46,"T\xean ng\u01b0\u1eddi nh\u1eadn:"),o.gc(),o.hc(47,"span",12),o.Rc(48),o.gc(),o.gc(),o.Pc(49,$,5,1,"div",15),o.Pc(50,Q,5,1,"div",15),o.hc(51,"div",16),o.hc(52,"span",11),o.Rc(53,"M\xf4 t\u1ea3:"),o.gc(),o.hc(54,"span",12),o.Rc(55),o.gc(),o.gc(),o.gc(),o.hc(56,"div",17),o.hc(57,"div",18),o.hc(58,"button",19),o.pc("click",(function(e){return t.shareToCus()})),o.Rc(59,"X\xe1c nh\u1eadn Kh\xe1ch h\xe0ng"),o.gc(),o.gc(),o.hc(60,"div",18),o.hc(61,"button",20),o.pc("click",(function(e){return t.confirmOrderDetail()})),o.Rc(62,"X\xe1c nh\u1eadn"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc()),2&e&&(o.Ob(4),o.Bc("src",o.wc(5,16,t.getResultImg(),"ResultImg"),o.Lc),o.Ob(2),o.Bc("src",o.wc(7,19,t.getShippingImg(),"ShippingImg"),o.Lc),o.Ob(4),o.Sc(t.orderDetail.ProductName),o.Ob(2),o.Sc(o.vc(13,22,t.orderDetail.ModifiedPrice)),o.Ob(3),o.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",t.orderDetail.Quantity,""),o.Ob(2),o.Tc("Gi\u1ea3m gi\xe1: ",o.vc(18,24,t.getDetailDiscount(t.orderDetail)),""),o.Ob(3),o.Tc("Ph\u1ee5 ph\xed: ",o.vc(21,26,t.orderDetail.AdditionalFee),""),o.Ob(7),o.Uc("",t.orderDetail.OrderId,"_",t.orderDetail.Index+1,""),o.Ob(5),o.Sc(t.orderDetail.CustomerName),o.Ob(5),o.Sc(t.orderDetail.CustomerPhoneNumber),o.Ob(5),o.Sc(o.wc(43,28,t.orderDetail.DeliveryInfo.DateTime,"HH:mm dd/MM/yyyy")),o.Ob(6),o.Sc(t.orderDetail.DeliveryInfo.FullName),o.Ob(1),o.Ac("ngIf","Florist"!=t.CurrentUser.Role),o.Ob(1),o.Ac("ngIf","Florist"!=t.CurrentUser.Role),o.Ob(5),o.Sc(t.orderDetail.Description))},directives:[g.l],pipes:[M.a,w.a,g.e],styles:[""]}),e})();function K(e,t){if(1&e){const e=o.ic();o.hc(0,"div",17),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.hc(1,"span"),o.Rc(2),o.gc(),o.gc()}if(2&e){const e=o.tc(2);o.Ob(2),o.Sc(e.index)}}function _(e,t){if(1&e){const e=o.ic();o.hc(0,"div",18),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.hc(1,"span"),o.Rc(2),o.gc(),o.gc()}if(2&e){const e=o.tc(2);o.Ob(2),o.Sc(e.index)}}function Z(e,t){if(1&e){const e=o.ic();o.hc(0,"div",19),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.hc(1,"span"),o.Rc(2),o.gc(),o.gc()}if(2&e){const e=o.tc(2);o.Ob(2),o.Sc(e.index)}}function Y(e,t){if(1&e){const e=o.ic();o.hc(0,"div",20),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.hc(1,"span"),o.Rc(2),o.gc(),o.gc()}if(2&e){const e=o.tc(2);o.Ob(2),o.Sc(e.index)}}function ee(e,t){if(1&e){const e=o.ic();o.hc(0,"div",21),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.hc(1,"span"),o.Rc(2),o.gc(),o.gc()}if(2&e){const e=o.tc(2);o.Ob(2),o.Sc(e.index)}}function te(e,t){if(1&e){const e=o.ic();o.hc(0,"div",22),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.hc(1,"span"),o.Rc(2),o.gc(),o.gc()}if(2&e){const e=o.tc(2);o.Ob(2),o.Sc(e.index)}}function ie(e,t){if(1&e){const e=o.ic();o.hc(0,"div",23),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.hc(1,"span"),o.Rc(2),o.gc(),o.gc()}if(2&e){const e=o.tc(2);o.Ob(2),o.Sc(e.index)}}function ce(e,t){if(1&e){const e=o.ic();o.hc(0,"div",24),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.hc(1,"span"),o.Rc(2),o.gc(),o.gc()}if(2&e){const e=o.tc(2);o.Ob(2),o.Sc(e.index)}}function re(e,t){if(1&e){const e=o.ic();o.hc(0,"div",25),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.hc(1,"span"),o.Rc(2),o.gc(),o.gc()}if(2&e){const e=o.tc(2);o.Ob(2),o.Sc(e.index)}}function ne(e,t){if(1&e){const e=o.ic();o.hc(0,"div",26),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.hc(1,"span"),o.Rc(2),o.gc(),o.gc()}if(2&e){const e=o.tc(2);o.Ob(2),o.Sc(e.index)}}function se(e,t){if(1&e){const e=o.ic();o.hc(0,"div",27),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.hc(1,"span"),o.Rc(2),o.gc(),o.gc()}if(2&e){const e=o.tc(2);o.Ob(2),o.Sc(e.index)}}function oe(e,t){if(1&e){const e=o.ic();o.hc(0,"div",28),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.hc(1,"span"),o.Rc(2),o.gc(),o.gc()}if(2&e){const e=o.tc(2);o.Ob(2),o.Sc(e.index)}}function ae(e,t){if(1&e){const e=o.ic();o.hc(0,"div",29),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.hc(1,"span"),o.Rc(2),o.gc(),o.gc()}if(2&e){const e=o.tc(2);o.Ob(2),o.Sc(e.index)}}function he(e,t){if(1&e){const e=o.ic();o.hc(0,"div",30),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.hc(1,"span"),o.Rc(2),o.gc(),o.gc()}if(2&e){const e=o.tc(2);o.Ob(2),o.Sc(e.index)}}function de(e,t){if(1&e){const e=o.ic();o.hc(0,"div",31),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.hc(1,"span"),o.Rc(2),o.gc(),o.gc()}if(2&e){const e=o.tc(2);o.Ob(2),o.Sc(e.index)}}function le(e,t){if(1&e&&(o.hc(0,"div",1),o.Pc(1,K,3,1,"div",2),o.Pc(2,_,3,1,"div",3),o.Pc(3,Z,3,1,"div",4),o.Pc(4,Y,3,1,"div",5),o.Pc(5,ee,3,1,"div",6),o.Pc(6,te,3,1,"div",7),o.Pc(7,ie,3,1,"div",8),o.Pc(8,ce,3,1,"div",9),o.Pc(9,re,3,1,"div",10),o.Pc(10,ne,3,1,"div",11),o.Pc(11,se,3,1,"div",12),o.Pc(12,oe,3,1,"div",13),o.Pc(13,ae,3,1,"div",14),o.Pc(14,he,3,1,"div",15),o.Pc(15,de,3,1,"div",16),o.gc()),2&e){const e=o.tc();o.Ac("ngSwitch",e.state),o.Ob(1),o.Ac("ngSwitchCase",e.states.Added),o.Ob(1),o.Ac("ngSwitchCase",e.states.Waiting),o.Ob(1),o.Ac("ngSwitchCase",e.states.Making),o.Ob(1),o.Ac("ngSwitchCase",e.states.Comfirming),o.Ob(1),o.Ac("ngSwitchCase",e.states.DeliveryWaiting),o.Ob(1),o.Ac("ngSwitchCase",e.states.DeliverAssinged),o.Ob(1),o.Ac("ngSwitchCase",e.states.Deliveried),o.Ob(1),o.Ac("ngSwitchCase",e.states.Completed),o.Ob(1),o.Ac("ngSwitchCase",e.states.Canceled),o.Ob(1),o.Ac("ngSwitchCase",e.states.OnTheWay),o.Ob(1),o.Ac("ngSwitchCase",e.states.SentBack),o.Ob(1),o.Ac("ngSwitchCase",e.states.FixingRequest),o.Ob(1),o.Ac("ngSwitchCase",e.states.Fixing),o.Ob(1),o.Ac("ngSwitchCase",e.states.FloristAssigned),o.Ob(1),o.Ac("ngSwitchCase",e.states.FixerAssigned)}}function ge(e,t){if(1&e){const e=o.ic();o.hc(0,"div",17),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.cc(1,"span"),o.gc()}}function ue(e,t){if(1&e){const e=o.ic();o.hc(0,"div",18),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.cc(1,"span"),o.gc()}}function me(e,t){if(1&e){const e=o.ic();o.hc(0,"div",19),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.cc(1,"span"),o.gc()}}function pe(e,t){if(1&e){const e=o.ic();o.hc(0,"div",20),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.cc(1,"span"),o.gc()}}function fe(e,t){if(1&e){const e=o.ic();o.hc(0,"div",21),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.cc(1,"span"),o.gc()}}function be(e,t){if(1&e){const e=o.ic();o.hc(0,"div",22),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.cc(1,"span"),o.gc()}}function ve(e,t){if(1&e){const e=o.ic();o.hc(0,"div",23),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.cc(1,"span"),o.gc()}}function Oe(e,t){if(1&e){const e=o.ic();o.hc(0,"div",24),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.cc(1,"span"),o.gc()}}function De(e,t){if(1&e){const e=o.ic();o.hc(0,"div",25),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.cc(1,"span"),o.gc()}}function Se(e,t){if(1&e){const e=o.ic();o.hc(0,"div",26),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.cc(1,"span"),o.gc()}}function Ie(e,t){if(1&e){const e=o.ic();o.hc(0,"div",27),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.cc(1,"span"),o.gc()}}function Ce(e,t){if(1&e){const e=o.ic();o.hc(0,"div",28),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.cc(1,"span"),o.gc()}}function Pe(e,t){if(1&e){const e=o.ic();o.hc(0,"div",29),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.cc(1,"span"),o.gc()}}function Ae(e,t){if(1&e){const e=o.ic();o.hc(0,"div",30),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.cc(1,"span"),o.gc()}}function Te(e,t){if(1&e){const e=o.ic();o.hc(0,"div",31),o.pc("click",(function(t){return o.Jc(e),o.tc(2).pointClicked()})),o.cc(1,"span"),o.gc()}}function ke(e,t){if(1&e&&(o.hc(0,"div",1),o.Pc(1,ge,2,0,"div",2),o.Pc(2,ue,2,0,"div",3),o.Pc(3,me,2,0,"div",4),o.Pc(4,pe,2,0,"div",5),o.Pc(5,fe,2,0,"div",6),o.Pc(6,be,2,0,"div",7),o.Pc(7,ve,2,0,"div",8),o.Pc(8,Oe,2,0,"div",9),o.Pc(9,De,2,0,"div",10),o.Pc(10,Se,2,0,"div",11),o.Pc(11,Ie,2,0,"div",12),o.Pc(12,Ce,2,0,"div",13),o.Pc(13,Pe,2,0,"div",14),o.Pc(14,Ae,2,0,"div",15),o.Pc(15,Te,2,0,"div",16),o.gc()),2&e){const e=o.tc();o.Ac("ngSwitch",e.state),o.Ob(1),o.Ac("ngSwitchCase",e.states.Added),o.Ob(1),o.Ac("ngSwitchCase",e.states.Waiting),o.Ob(1),o.Ac("ngSwitchCase",e.states.Making),o.Ob(1),o.Ac("ngSwitchCase",e.states.Comfirming),o.Ob(1),o.Ac("ngSwitchCase",e.states.DeliveryWaiting),o.Ob(1),o.Ac("ngSwitchCase",e.states.DeliverAssinged),o.Ob(1),o.Ac("ngSwitchCase",e.states.Deliveried),o.Ob(1),o.Ac("ngSwitchCase",e.states.Completed),o.Ob(1),o.Ac("ngSwitchCase",e.states.Canceled),o.Ob(1),o.Ac("ngSwitchCase",e.states.OnTheWay),o.Ob(1),o.Ac("ngSwitchCase",e.states.SentBack),o.Ob(1),o.Ac("ngSwitchCase",e.states.FixingRequest),o.Ob(1),o.Ac("ngSwitchCase",e.states.Fixing),o.Ob(1),o.Ac("ngSwitchCase",e.states.FloristAssigned),o.Ob(1),o.Ac("ngSwitchCase",e.states.FixerAssigned)}}let ye=(()=>{class e{constructor(){this.states=v.f,this.index=-1,this.id="",this.onClicked=new o.q,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){}pointClicked(){this.onClicked.emit(this.id)}preventEvent(e){e.stopPropagation()}writeValue(e){}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}updateChanges(){this.onChange()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Vb({type:e,selectors:[["app-status-point"]],inputs:{state:"state",index:"index",id:"id"},outputs:{onClicked:"onClicked"},features:[o.Nb([{provide:k.j,useExisting:Object(o.fb)(()=>e),multi:!0}])],decls:2,vars:2,consts:[[3,"ngSwitch",4,"ngIf"],[3,"ngSwitch"],["class","item-status pi",3,"click",4,"ngSwitchCase"],["class","item-status r",3,"click",4,"ngSwitchCase"],["class","item-status o",3,"click",4,"ngSwitchCase"],["class","item-status y",3,"click",4,"ngSwitchCase"],["class","item-status p",3,"click",4,"ngSwitchCase"],["class","item-status b",3,"click",4,"ngSwitchCase"],["class","item-status bl",3,"click",4,"ngSwitchCase"],["class","item-status g",3,"click",4,"ngSwitchCase"],["class","item-status x",3,"click",4,"ngSwitchCase"],["class","item-status on-the-way",3,"click",4,"ngSwitchCase"],["class","item-status send-back",3,"click",4,"ngSwitchCase"],["class","item-status fixing-request",3,"click",4,"ngSwitchCase"],["class","item-status fixing",3,"click",4,"ngSwitchCase"],["class","item-status floristAssined",3,"click",4,"ngSwitchCase"],["class","item-status fixerAssigned",3,"click",4,"ngSwitchCase"],[1,"item-status","pi",3,"click"],[1,"item-status","r",3,"click"],[1,"item-status","o",3,"click"],[1,"item-status","y",3,"click"],[1,"item-status","p",3,"click"],[1,"item-status","b",3,"click"],[1,"item-status","bl",3,"click"],[1,"item-status","g",3,"click"],[1,"item-status","x",3,"click"],[1,"item-status","on-the-way",3,"click"],[1,"item-status","send-back",3,"click"],[1,"item-status","fixing-request",3,"click"],[1,"item-status","fixing",3,"click"],[1,"item-status","floristAssined",3,"click"],[1,"item-status","fixerAssigned",3,"click"]],template:function(e,t){1&e&&(o.Pc(0,le,16,16,"div",0),o.Pc(1,ke,16,16,"div",0)),2&e&&(o.Ac("ngIf",t.index>-1),o.Ob(1),o.Ac("ngIf",-1==t.index))},directives:[g.l,g.n,g.o],styles:[""]}),e})();function Re(e,t){if(1&e){const e=o.ic();o.hc(0,"div",18),o.hc(1,"div",19),o.hc(2,"span",20),o.Rc(3),o.gc(),o.hc(4,"div",21),o.hc(5,"h4",22),o.Rc(6),o.gc(),o.hc(7,"span",23),o.Rc(8),o.gc(),o.gc(),o.cc(9,"app-status-point",24),o.gc(),o.hc(10,"div",25),o.hc(11,"ul",26),o.hc(12,"li",27),o.hc(13,"div",28),o.pc("click",(function(i){o.Jc(e);const c=t.$implicit;return o.tc().getMenu(c)})),o.cc(14,"img",29),o.uc(15,"ImgPipe"),o.hc(16,"div",30),o.hc(17,"span",31),o.Rc(18),o.uc(19,"myCurrPipe"),o.gc(),o.hc(20,"span",32),o.Rc(21),o.uc(22,"myCurrPipe"),o.gc(),o.hc(23,"span",32),o.Rc(24),o.uc(25,"myCurrPipe"),o.gc(),o.hc(26,"span",33),o.Rc(27),o.gc(),o.hc(28,"span",34),o.Rc(29),o.uc(30,"myTimePipe"),o.gc(),o.hc(31,"span",35),o.Rc(32),o.uc(33,"myDatePipe"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc()}if(2&e){const e=t.$implicit,i=t.index,c=o.tc();o.Ob(3),o.Uc("",e.OrderId,"_",e.Index+1,""),o.Ob(3),o.Sc(e.ProductName),o.Ob(2),o.Uc("",e.CustomerName,"-",e.CustomerPhoneNumber,""),o.Ob(1),o.Ac("state",e.State)("id",e.OrderDetailId)("index",i+1),o.Ob(5),o.Bc("src",o.wc(15,15,e.ProductImageUrl,"ProductImg"),o.Lc),o.Ob(4),o.Sc(o.vc(19,18,e.ModifiedPrice)),o.Ob(3),o.Tc("Ph\u1ee5 ph\xed: ",o.vc(22,20,e.AdditionalFee),""),o.Ob(3),o.Tc("Gi\u1ea3m gi\xe1: ",o.vc(25,22,c.getDetailDiscount(e)),""),o.Ob(3),o.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.Quantity,""),o.Ob(2),o.Tc("",o.vc(30,24,e.MakingRequestTime)," "),o.Ob(3),o.Tc(" ",o.vc(33,26,e.MakingRequestTime),"")}}function we(e,t){if(1&e){const e=o.ic();o.hc(0,"div",36),o.hc(1,"div",19),o.hc(2,"span",20),o.Rc(3),o.gc(),o.hc(4,"div",21),o.hc(5,"h4",22),o.Rc(6),o.gc(),o.hc(7,"span",23),o.Rc(8),o.gc(),o.gc(),o.cc(9,"app-status-point",24),o.gc(),o.hc(10,"div",25),o.hc(11,"ul",26),o.hc(12,"li",27),o.hc(13,"div",28),o.pc("click",(function(i){o.Jc(e);const c=t.$implicit;return o.tc().getMenu(c)})),o.cc(14,"img",29),o.uc(15,"ImgPipe"),o.hc(16,"div",30),o.hc(17,"span",31),o.Rc(18),o.uc(19,"myCurrPipe"),o.gc(),o.hc(20,"span",32),o.Rc(21),o.uc(22,"myCurrPipe"),o.gc(),o.hc(23,"span",32),o.Rc(24),o.uc(25,"myCurrPipe"),o.gc(),o.hc(26,"span",33),o.Rc(27),o.gc(),o.hc(28,"span",34),o.Rc(29),o.uc(30,"myTimePipe"),o.gc(),o.hc(31,"span",35),o.Rc(32),o.uc(33,"myDatePipe"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc()}if(2&e){const e=t.$implicit,i=t.index,c=o.tc();o.Ac("ngClass","Making"===e.State||"Fixing"===e.State?"selected-order-detail":""),o.Ob(3),o.Uc("",e.OrderId,"_",e.Index+1,""),o.Ob(3),o.Sc(e.ProductName),o.Ob(2),o.Uc("",e.CustomerName,"-",e.CustomerPhoneNumber,""),o.Ob(1),o.Ac("state",e.State)("id",e.OrderDetailId)("index",i+1),o.Ob(5),o.Bc("src",o.wc(15,16,e.ProductImageUrl,"ProductImg"),o.Lc),o.Ob(4),o.Sc(o.vc(19,19,e.ModifiedPrice)),o.Ob(3),o.Tc("Ph\u1ee5 ph\xed: ",o.vc(22,21,e.AdditionalFee),""),o.Ob(3),o.Tc("Gi\u1ea3m gi\xe1: ",o.vc(25,23,c.getDetailDiscount(e)),""),o.Ob(3),o.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.Quantity,""),o.Ob(2),o.Tc("",o.vc(30,25,e.MakingRequestTime)," "),o.Ob(3),o.Tc(" ",o.vc(33,27,e.MakingRequestTime),"")}}let Me=(()=>{class e extends f{constructor(e,t){super(),this.router=e,this.orderDetailService=t,this.Title="Th\u1ee3 c\u1eafm hoa",this.NavigateClass="nav-icon ",this.IsDataLosingWarning=!1,this.waitingMenuItems=["Nh\u1eadn \u0111\u01a1n","Ho\xe0n th\xe0nh \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],this.fixingRequestMenuItems=["Nh\u1eadn s\u1eeda \u0111\u01a1n","Ho\xe0n th\xe0nh \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],this.asignedMenuItems=["B\u1eaft \u0111\u1ea7u l\xe0m/s\u1eeda","Ho\xe0n th\xe0nh \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],this.makingMenuItems=["Ho\xe0n th\xe0nh \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"]}OnBackNaviage(){customerSupport()}logout(){this.authService.logOut(e=>{e&&this.router.navigate(["staff/login"])})}Init(){this.loadWaitingDetails(),this.loadMakingDetails(),this.askForRememberPassword()}viewDetail(e){this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}loadWaitingDetails(){this.waitingOrderDetails=[],this.orderDetailService.getDetailWithTimeSort([v.f.Waiting,v.f.FixingRequest],"MakingRequestTime").then(e=>{this.waitingOrderDetails=e})}loadMakingDetails(){this.makingOrderDetails=[],this.orderDetailService.getMakingOrderDetails(this.CurrentUser.Id).then(e=>{this.makingOrderDetails=e})}getMenu(e){let t;switch(e.State){case v.f.Waiting:t=this.waitingMenuItems;break;case v.f.Making:case v.f.Fixing:t=this.makingMenuItems;break;case v.f.FixingRequest:t=this.fixingRequestMenuItems;break;case v.f.FixerAssigned:case v.f.FloristAssigned:t=this.asignedMenuItems}menuOpen(t=>{switch(+t){case 0:switch(e.State){case v.f.FixerAssigned:case v.f.FloristAssigned:this.openConfirm("B\u1eaft \u0111\u1ea7u th\u1ef1c hi\u1ec7n \u0111\u01a1n n\xe0y?",()=>{this.orderDetailService.updateMakingFields(this.orderDetailService.getLastestMaking(e).Id,{StartTime:(new Date).getTime()}).then(()=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:e.State==v.f.FixerAssigned?v.f.Fixing:v.f.Making}).then(()=>{this.loadMakingDetails()})})});break;case v.f.FixingRequest:case v.f.Waiting:this.orderDetailService.updateDetailSeen(e.OrderDetailId,this.CurrentUser.Id,(new Date).getTime()).then(t=>{let i=v.c.Making;i=e.State==v.f.Waiting?v.c.Making:v.c.Fixing,this.orderDetailService.assignSingleMaking(e.OrderDetailId,this.CurrentUser.Id,(new Date).getTime(),i).then(()=>{this.loadMakingDetails(),this.loadWaitingDetails()})});break;case v.f.Making:case v.f.Fixing:this.openConfirm("ch\u1eafc ch\u1eafn ho\xe0n th\xe0nh \u0111\u01a1n?",()=>{this.orderDetailService.updateMakingFields(this.orderDetailService.getLastestMaking(e).Id,{CompleteTime:(new Date).getTime()}).then(()=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Comfirming}).then(()=>{this.loadMakingDetails(),this.loadWaitingDetails()})})})}break;case 1:switch(e.State){case v.f.FixerAssigned:case v.f.FloristAssigned:this.orderDetailService.updateMakingFields(this.orderDetailService.getLastestMaking(e).Id,{CompleteTime:(new Date).getTime()}).then(()=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Comfirming}).then(()=>{this.loadMakingDetails(),this.loadWaitingDetails()})});break;case v.f.Waiting:case v.f.FixingRequest:this.orderDetailService.updateDetailSeen(e.OrderDetailId,this.CurrentUser.Id,(new Date).getTime()).then(t=>{let i=v.c.Making;i=e.State==v.f.Waiting?v.c.Making:v.c.Fixing,this.orderDetailService.assignSingleMaking(e.OrderDetailId,this.CurrentUser.Id,(new Date).getTime(),i).then(t=>{this.orderDetailService.updateMakingFields(t.Id,{CompleteTime:(new Date).getTime()}).then(()=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Comfirming}).then(()=>{this.loadMakingDetails(),this.loadWaitingDetails()})})})});break;default:this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}break;case 2:this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}},t)}}return e.\u0275fac=function(t){return new(t||e)(o.bc(c.b),o.bc(B.a))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-florist-main"]],features:[o.Lb],decls:27,vars:9,consts:[["id","arrange",1,"page-content"],[1,"container"],["id","listNav","role","tablist",1,"nav","nav-tabs","row"],[1,"nav-item","col-6"],["id","nav1","data-toggle","tab","href","#camhoa","role","tab","aria-controls","camhoa","aria-selected","true",1,"active","main-bg"],["id","nav2","data-toggle","tab","href","#giaohoa","role","tab","aria-controls","giaohoa","aria-selected","false",1,"main-bg"],["id","listContent",1,"tab-content","order-list-bot"],["id","camhoa","role","tabpanel","aria-labelledby","nav1",1,"tab-pane","fade","show","active"],[1,"order-content","cusScroll"],["class","order-content-item product-item",4,"ngFor","ngForOf"],["id","giaohoa","role","tabpanel","aria-labelledby","nav2",1,"tab-pane","fade"],["class","order-content-item product-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"customer-support"],["alt","",1,"customer-avatar",3,"src"],[1,"customer-name"],["href","tel:0000",1,"customer-phone"],[1,"customer-position"],["id","logoutBtn",1,"customer-position",3,"click"],[1,"order-content-item","product-item"],[1,"item-top"],[1,"item-code"],[1,"item-info"],[1,"item-name"],[1,"item-quantity"],[3,"state","id","index"],[1,"item-bot"],[1,"order-product-list","cusScroll"],[1,""],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"prodPrice"],[1,"prodCharge"],[1,"item-address"],[1,"item-time"],[1,"item-date"],[1,"order-content-item","product-item",3,"ngClass"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"ul",2),o.hc(3,"li",3),o.hc(4,"a",4),o.Rc(5,"Ch\u1edd c\u1eafm"),o.gc(),o.gc(),o.hc(6,"li",3),o.hc(7,"a",5),o.Rc(8,"\u0110ang c\u1eafm"),o.gc(),o.gc(),o.gc(),o.hc(9,"div",6),o.hc(10,"div",7),o.hc(11,"ul",8),o.Pc(12,Re,34,28,"div",9),o.gc(),o.gc(),o.hc(13,"div",10),o.hc(14,"ul",8),o.Pc(15,we,34,29,"div",11),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(16,"div",12),o.cc(17,"img",13),o.uc(18,"ImgPipe"),o.hc(19,"p",14),o.Rc(20),o.gc(),o.hc(21,"a",15),o.Rc(22),o.gc(),o.hc(23,"p",16),o.Rc(24),o.gc(),o.hc(25,"p",17),o.pc("click",(function(e){return t.logout()})),o.Rc(26,"\u0110\u0103ng xu\u1ea5t"),o.gc(),o.gc()),2&e&&(o.Ob(12),o.Ac("ngForOf",t.waitingOrderDetails),o.Ob(3),o.Ac("ngForOf",t.makingOrderDetails),o.Ob(2),o.Bc("src",o.wc(18,6,t.CurrentUser.Avt,"UserAvt"),o.Lc),o.Ob(3),o.Sc(t.CurrentUser.FullName),o.Ob(2),o.Sc(t.CurrentUser.PhoneNumber),o.Ob(2),o.Sc(t.CurrentUser.Role))},directives:[g.k,ye,g.j],pipes:[M.a,w.a,w.c,w.b],styles:[""]}),e})();function Fe(e,t){1&e&&(o.hc(0,"span",15),o.Rc(1,"\u0110\xe3 bao g\u1ed3m"),o.gc())}function Ne(e,t){1&e&&(o.hc(0,"span",15),o.Rc(1,"Ch\u01b0a bao g\u1ed3m"),o.gc())}function xe(e,t){if(1&e&&(o.hc(0,"div",22),o.hc(1,"span",14),o.Rc(2,"VAT: "),o.gc(),o.Pc(3,Fe,2,0,"span",23),o.Pc(4,Ne,2,0,"span",23),o.gc()),2&e){const e=o.tc();o.Ob(3),o.Ac("ngIf",e.orderDetail.IsVATIncluded),o.Ob(1),o.Ac("ngIf",!e.orderDetail.IsVATIncluded)}}function Le(e,t){if(1&e&&(o.hc(0,"div",24),o.hc(1,"span",14),o.Rc(2,"T\xean KH"),o.gc(),o.hc(3,"span",15),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(4),o.Sc(e.orderDetail.CustomerName)}}function Be(e,t){if(1&e&&(o.hc(0,"div",24),o.hc(1,"span",14),o.Rc(2,"T\xean ng\u01b0\u1eddi nh\u1eadn"),o.gc(),o.hc(3,"span",15),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(4),o.Sc(e.orderDetail.DeliveryInfo.FullName)}}function Ue(e,t){if(1&e&&(o.hc(0,"div",24),o.hc(1,"span",14),o.Rc(2,"SDT KH"),o.gc(),o.hc(3,"span",15),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(4),o.Sc(e.orderDetail.CustomerPhoneNumber)}}function qe(e,t){if(1&e&&(o.hc(0,"div",24),o.hc(1,"span",14),o.Rc(2,"SDT ng\u01b0\u1eddi nh\u1eadn"),o.gc(),o.hc(3,"span",15),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(4),o.Sc(e.orderDetail.DeliveryInfo.PhoneNumber)}}function He(e,t){if(1&e){const e=o.ic();o.hc(0,"button",25),o.pc("click",(function(t){return o.Jc(e),o.tc().gotToCusConfirm()})),o.Rc(1,"X\xe1c nh\u1eadn v\u1edbi Kh\xe1ch h\xe0ng"),o.gc()}}function Ee(e,t){if(1&e){const e=o.ic();o.hc(0,"button",25),o.pc("click",(function(t){return o.Jc(e),o.tc().gotToCusConfirm()})),o.Rc(1,"Ch\u1ee5p \u1ea3nh"),o.gc()}}let Ve=(()=>{class e extends f{constructor(e,t){super(),this.router=e,this.orderDetailService=t,this.Title="X\xe1c nh\u1eadn th\xe0nh ph\u1ea9m",this.IsDataLosingWarning=!1}Init(){this.orderDetail=this.globalOrderDetail}gotToCusConfirm(){this.router.navigate(["staff/customer-confirming"])}confirm(){switch(this.CurrentUser.Role){case v.i.Account:case v.i.Admin:this.orderDetailService.resultConfirm(this.globalOrderDetail.OrderDetailId,this.orderDetailService.getLastestMaking(this.globalOrderDetail).Id,null).then(()=>{this.router.navigate(["staff/account-main"])});break;case v.i.Shipper:this.orderDetailService.updateFields(this.globalOrderDetail.OrderDetailId,{State:v.f.Deliveried,DeliveryCompletedTime:(new Date).getTime()}).then(()=>{this.router.navigate(["staff/shipper-main"])})}}}return e.\u0275fac=function(t){return new(t||e)(o.bc(c.b),o.bc(B.a))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-order-detail-confirming"]],features:[o.Lb],decls:49,vars:29,consts:[["id","orderConfirm",1,"page-content"],[1,"container"],[1,"prodDetail"],[1,"prodGen"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPriceOld"],[1,"prodCharge"],[1,"prodPrice"],[1,"prodInfo","cusScroll"],["class","prodQuan infoGroup",4,"ngIf"],["class","prodName infoGroup",4,"ngIf"],[1,"prodAddr","infoGroup"],[1,"itemlabel"],[1,"itemVal"],[1,"prodTime","infoGroup"],[1,"prodDesc","infoGroup"],[1,"row"],[1,"col-10","mx-auto","text-center"],["type","button","class","btn main-btn w-100 mt-2",3,"click",4,"ngIf"],["type","button",1,"btn","grey-btn","w-100","mt-2",3,"click"],[1,"prodQuan","infoGroup"],["class","itemVal",4,"ngIf"],[1,"prodName","infoGroup"],["type","button",1,"btn","main-btn","w-100","mt-2",3,"click"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"div",2),o.hc(3,"div",3),o.cc(4,"img",4),o.uc(5,"ImgPipe"),o.hc(6,"div",5),o.hc(7,"h5",6),o.Rc(8),o.gc(),o.hc(9,"h5",6),o.Rc(10),o.gc(),o.hc(11,"span",7),o.Rc(12),o.uc(13,"myCurrPipe"),o.gc(),o.hc(14,"span",8),o.Rc(15),o.uc(16,"myCurrPipe"),o.gc(),o.hc(17,"span",9),o.Rc(18),o.uc(19,"myCurrPipe"),o.gc(),o.gc(),o.gc(),o.hc(20,"div",10),o.Pc(21,xe,5,2,"div",11),o.Pc(22,Le,5,1,"div",12),o.Pc(23,Be,5,1,"div",12),o.Pc(24,Ue,5,1,"div",12),o.Pc(25,qe,5,1,"div",12),o.hc(26,"div",13),o.hc(27,"span",14),o.Rc(28,"\u0110\u1ecba ch\u1ec9 giao:"),o.gc(),o.hc(29,"span",15),o.Rc(30),o.gc(),o.gc(),o.hc(31,"div",16),o.hc(32,"span",14),o.Rc(33,"Th\u1eddi gian giao:"),o.gc(),o.hc(34,"span",15),o.Rc(35),o.uc(36,"date"),o.gc(),o.gc(),o.hc(37,"div",17),o.hc(38,"span",14),o.Rc(39,"M\xf4 t\u1ea3:"),o.gc(),o.hc(40,"span",15),o.Rc(41),o.gc(),o.gc(),o.gc(),o.hc(42,"div",18),o.hc(43,"div",19),o.Pc(44,He,2,0,"button",20),o.Pc(45,Ee,2,0,"button",20),o.gc(),o.hc(46,"div",19),o.hc(47,"button",21),o.pc("click",(function(e){return t.confirm()})),o.Rc(48,"Xong"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc()),2&e&&(o.Ob(4),o.Bc("src",o.wc(5,17,t.orderDetail.ProductImageUrl,"ProductImg"),o.Lc),o.Ob(4),o.Uc("",t.orderDetail.OrderId,"_",t.orderDetail.Index+1,""),o.Ob(2),o.Sc(t.orderDetail.ProductName),o.Ob(2),o.Sc(o.vc(13,20,t.orderDetail.OriginalPrice)),o.Ob(3),o.Tc("Ph\u1ee5 ph\xed: ",o.vc(16,22,t.orderDetail.AdditionalFee),""),o.Ob(3),o.Sc(o.vc(19,24,t.orderDetail.ModifiedPrice)),o.Ob(3),o.Ac("ngIf","Shipper"!=t.CurrentUser.Role),o.Ob(1),o.Ac("ngIf","Shipper"!=t.CurrentUser.Role),o.Ob(1),o.Ac("ngIf","Shipper"==t.CurrentUser.Role),o.Ob(1),o.Ac("ngIf","Shipper"!=t.CurrentUser.Role),o.Ob(1),o.Ac("ngIf","Shipper"==t.CurrentUser.Role),o.Ob(5),o.Sc(t.orderDetail.DeliveryInfo.Address),o.Ob(5),o.Sc(o.wc(36,26,t.orderDetail.DeliveryInfo.DateTime,"hh:mm a dd/MM/yyyy")),o.Ob(6),o.Sc(t.orderDetail.Description),o.Ob(3),o.Ac("ngIf","Shipper"!=t.CurrentUser.Role),o.Ob(1),o.Ac("ngIf","Shipper"==t.CurrentUser.Role))},directives:[g.l],pipes:[M.a,w.a,g.e],styles:[""]}),e})();var Je=i("cPV5"),We=i("ftz2");function Ge(e,t){if(1&e){const e=o.ic();o.hc(0,"li",51),o.pc("click",(function(i){o.Jc(e);const c=t.index;return o.tc().selectPromotion(c)})),o.hc(1,"p",52),o.Rc(2),o.gc(),o.hc(3,"span",53),o.Rc(4),o.gc(),o.hc(5,"span",54),o.Rc(6),o.uc(7,"myDatePipe"),o.uc(8,"myDatePipe"),o.gc(),o.gc()}if(2&e){const e=t.$implicit,i=t.index,c=o.tc();o.Pb("data-index",i),o.Ob(2),o.Sc(e.Name),o.Ob(2),o.Sc(c.getPromotionAmount(e)),o.Ob(2),o.Uc("",o.vc(7,5,e.StartTime),"-",o.vc(8,7,e.EndTime),"")}}function je(e,t){if(1&e){const e=o.ic();o.hc(0,"div",55),o.pc("click",(function(t){return o.Jc(e),o.tc().addNoteImage()})),o.cc(1,"img",56),o.gc()}}function Xe(e,t){if(1&e){const e=o.ic();o.hc(0,"div",55),o.pc("click",(function(t){return o.Jc(e),o.Hc(3).click()})),o.cc(1,"img",56),o.hc(2,"input",57,58),o.pc("change",(function(t){return o.Jc(e),o.tc(2).onChange(t)})),o.gc(),o.gc()}}function $e(e,t){if(1&e&&(o.hc(0,"div"),o.Pc(1,Xe,4,0,"div",45),o.gc()),2&e){const e=o.tc();o.Ob(1),o.Ac("ngIf",!e.IsOnTerminal)}}function Qe(e,t){if(1&e){const e=o.ic();o.hc(0,"div",44),o.hc(1,"div",59),o.pc("click",(function(i){o.Jc(e);const c=t.index;return o.tc().selectNoteImage(c)})),o.cc(2,"img",60),o.uc(3,"ImgPipe"),o.gc(),o.gc()}if(2&e){const e=t.$implicit;o.Ob(2),o.Bc("src",o.wc(3,1,e,"NoteImg"),o.Lc)}}let ze=(()=>{class e extends f{constructor(e,t,i,c){super(),this.route=e,this.router=t,this.categoryService=i,this.promotionService=c,this.Title="Chi ti\u1ebft \u0111\u01a1n",this.isAddingNoteImage=!1,this.promotions=[],this.images=[],this.globalOrderDetail.NoteImages||(this.globalOrderDetail.NoteImages=[])}Init(){this.promotionService.getAvailablePromotions((new Date).getTime(),!1).then(e=>{this.promotions=e}),this.route.params.subscribe(e=>{this.detailIndex=+e.id,this.globalOrderDetail.PurposeOf||(this.globalOrderDetail.PurposeOf="Mua t\u1eb7ng"),this.globalOrderDetail.ProductName||(this.globalOrderDetail.ProductName="...."),createNumbericElement(!1,e=>{this.globalOrderDetail.Quantity=e})})}getPromotionAmount(e){return e.PromotionType===D.b.Amount?e.Amount+" \u20ab":e.Amount+" %"}onAmountDiscountChanged(e){this.globalOrderDetail.AmountDiscount<10&&(this.globalOrderDetail.AmountDiscount*=1e3,this.moveCursor(this.globalOrderDetail.AmountDiscount.toString().length,"AmountDiscount")),this.globalOrderDetail.AmountDiscount=+this.globalOrderDetail.AmountDiscount}onAcmountDiscountFocus(){this.globalOrderDetail.AmountDiscount||(this.globalOrderDetail.AmountDiscount=0),this.moveCursor(this.globalOrderDetail.AmountDiscount.toString().length,"AmountDiscount")}addNoteImage(){this.isAddingNoteImage=!0,super.openFileForShare()}fileChosen(e){this.globalOrderDetail.NoteImages.push("data:image/png;base64,"+e)}onChange(e){const t=e.target.files[0];if(!t)return;if(null==t.type.match(/image\/*/))return void this.showError("Ph\u1ea3i ch\u1ecdn h\xecnh !!");const i=new FileReader;i.readAsDataURL(t),i.onload=e=>{this.globalOrderDetail.NoteImages.push(i.result.toString())}}selectNoteImage(e){this.menuOpening(t=>{switch(+t){case 0:this.globalOrderDetail.NoteImages.splice(e,1);break;case 1:const t=M.a.getImgUrl(this.globalOrderDetail.NoteImages[e],j.c.NoteImg);this.images=[t],setTimeout(()=>{viewImages(()=>{this.images=[]})},100)}},["Xo\xe1 \u1ea3nh","Xem chi ti\u1ebft \u1ea3nh"])}onAddFeeChanged(e){this.globalOrderDetail.AdditionalFee<10&&(this.globalOrderDetail.AdditionalFee*=1e3,this.moveCursor(this.globalOrderDetail.AdditionalFee.toString().length,"AdditionalFee")),this.globalOrderDetail.AdditionalFee=+this.globalOrderDetail.AdditionalFee}onAddFeeFocus(){this.globalOrderDetail.AdditionalFee||(this.globalOrderDetail.AdditionalFee=0),this.moveCursor(this.globalOrderDetail.AdditionalFee.toString().length,"AdditionalFee")}onNewPriceChanged(e){this.newPrice<10&&(this.newPrice*=1e3,this.moveCursor(this.newPrice.toString().length,"NewPrice")),this.newPrice=+this.newPrice}onNewPriceFocus(){this.newPrice||(this.newPrice=0),this.moveCursor(this.newPrice.toString().length,"NewPrice")}clearProductImg(){this.globalOrderDetail.ProductImageUrl&&(this.globalOrderDetail.IsFromHardCodeProduct?this.globalOrderDetail.ProductImageUrl="":this.openConfirm("Ch\u1eafc ch\u0103c xo\xe1 \u1ea3nh n\xe0y? ",()=>{this.globalOrderDetail.ProductImageUrl=""}))}productNameChangeRequest(){getInputWithType(e=>{""!==e&&(this.globalOrderDetail.ProductName=e,this.globalOrderDetail.IsFromHardCodeProduct=!0)},"C\u1eadp nh\u1eadt t\xean s\u1ea3n ph\u1ea9m...","...."===this.globalOrderDetail.ProductName?"":this.globalOrderDetail.ProductName,"text")}insertModifiedValue(){this.newPrice=this.globalOrderDetail.ModifiedPrice,openFixPriceDialog()}quantityChangeRequest(){getInputWithType(e=>{e&&(this.globalOrderDetail.Quantity=+e)},"C\u1eadp nh\u1eadt s\u1ed1 l\u01b0\u1ee3ng...",this.globalOrderDetail.Quantity.toString(),"number")}submitPrice(){this.newPrice<0?this.showError("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!!"):(this.globalOrderDetail.ModifiedPrice=this.newPrice,dismissFixPriceDialog())}searchProduct(){this.router.navigate(["/staff/search-product"],{queryParams:{category:-1},queryParamsHandling:"merge"})}submitOrderDetail(e){if(!e.valid)return;if(this.globalOrderDetail.ModifiedPrice<=0)return void this.showError("Ch\u01b0a nh\u1eadp gi\xe1 ti\u1ec1n!");this.globalOrderDetail.Index=this.detailIndex>-1?this.detailIndex:this.globalOrder.OrderDetails.length;const t=b.c.DeepCopy(this.globalOrderDetail);this.insertOrderDetail(t)}insertOrderDetail(e){this.detailIndex>-1?this.globalOrder.OrderDetails[this.detailIndex]=e:this.globalOrder.OrderDetails.push(e),super.OnBackNaviage()}selectPromotion(e){this.globalOrderDetail.PercentDiscount=this.globalOrderDetail.AmountDiscount=0;const t=this.promotions[e];t.PromotionType===D.b.Amount?this.globalOrderDetail.AmountDiscount=t.Amount:this.globalOrderDetail.PercentDiscount=t.Amount,hideReceiverPopup()}}return e.\u0275fac=function(t){return new(t||e)(o.bc(c.a),o.bc(c.b),o.bc(Je.a),o.bc(A.a))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-order-detail"]],features:[o.Lb],decls:88,vars:21,consts:[["id","orderAdd",1,"page-content"],[1,"container"],["autocomplete","on",1,"addOrderForm",3,"submit"],["form","ngForm"],[1,"form-group","prodInfo"],[1,"prodImg"],["alt","",3,"src"],["src","../../../../assets/images/delete_white.svg","alt","",1,"close-img",3,"click"],[1,"prodContent"],[1,"prodCode"],[1,"prodPrice"],[1,"prodQuantity"],["type","number","readonly","","name","Quantity","id","Quantity","step","1","min","1",3,"ngModel","ngModelChange"],[1,"prodBrowser",3,"click"],[1,"fa","fa-search","main-bg"],[1,"row","col-xs-12",2,"margin-bottom","10px","padding-left","15px","padding-right","15px"],[1,"addInfo",2,"width","100%","padding-right","5px"],["href","javascript:void(0);",1,"btn","main-btn",3,"click"],[1,"addInfo",2,"width","50%","padding-right","5px"],[1,"addInfo",2,"width","50%","padding-left","5px"],[1,"form-group","addInfo"],["routerLink","/staff/select-receiver",1,"btn","main-btn"],[1,"title-field"],[1,"form-group","orderInfo"],["type","text","name","AdditionalFee","id","AdditionalFee","placeholder","Ph\u1ee5 ph\xed (k)...",1,"orderField",3,"ngModel","ngModelChange","input","focus"],["href","javascript:void(0)","onclick","openCustMenu()","type","button",1,"btn","main-btn","w-100",2,"margin-bottom","1vh","font-size","16px"],[1,"row","col-xs-12",2,"padding-left","15px","padding-right","15px"],["type","number","name","PercentDiscount","id","PercentDiscount","placeholder","%",1,"orderField",3,"ngModel","ngModelChange"],["type","tel","name","AmountDiscount","id","AmountDiscount","placeholder","0",1,"orderField",3,"ngModel","ngModelChange","input","focus"],["type","text","name","PurposeOf","id","PurposeOf","placeholder","M\u1ee5c \u0111\xedch mua h\xe0ng...",1,"orderField",3,"ngModel","ngModelChange"],["type","text","name","Description","id","Description","placeholder","M\xf4 t\u1ea3 giao h\xe0ng...",1,"orderField","col-xs-6",3,"ngModel","ngModelChange"],["href","javascript:void(0)","onClick","openImgsDialog()",1,"btn","main-btn"],["type","submit",1,"btn","main-btn","w-100"],["id","recentInfo",1,"actionMenu2"],["style","height: 69px;text-align: left;",3,"click",4,"ngFor","ngForOf"],["id","inputDialog",1,"popup-content","dialog-popup"],[1,"form-group"],["type","tel","name","newPrice","id","NewPrice","placeholder","c\u1eadp nh\u1eadt gi\xe1 ti\u1ec1n...",1,"mainForm",3,"ngModel","ngModelChange","input","focus"],[1,"row"],[1,"col-6"],["id","confirm-button",1,"main-btn","btn",3,"click"],["id","cancel-button","onClick","dismissFixPriceDialog()",1,"main-bg","border","btn"],["id","imgsDialog",1,"popup-content","dialog-popup"],[1,"row","imageList","cusScroll",2,"max-height","450px"],[1,"col-6","product-item-big"],["class","prodItem-tall","style","height: 220px;position: relative;",3,"click",4,"ngIf"],[4,"ngIf"],["class","col-6 product-item-big",4,"ngFor","ngForOf"],["id","confirm-button","onClick","closeImgsDialog()",1,"main-btn","btn"],["id","view-product",1,"popup-content","view-img-popup-content",2,"z-index","1000"],[3,"src","config"],[2,"height","69px","text-align","left",3,"click"],[1,"recentInfo-name"],[1,"recentInfo-phone",2,"width","25%"],[1,"recentInfo-date",2,"width","75%"],[1,"prodItem-tall",2,"height","220px","position","relative",3,"click"],["src","../../../../assets/images/add.svg","alt","",2,"margin-bottom","0px","width","64px","height","64px","position","absolute","top","50%","left","50%","transform","translate(-50%, -50%)"],["type","file","name","uploadedFile","hidden","",1,"img-cover","file-upload-default",3,"change"],["imageUpload",""],[1,"prodItem-tall",3,"click"],["alt","",2,"margin-bottom","0px",3,"src"]],template:function(e,t){if(1&e){const e=o.ic();o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"form",2,3),o.pc("submit",(function(i){o.Jc(e);const c=o.Hc(3);return t.submitOrderDetail(c)})),o.hc(4,"div",4),o.hc(5,"div",5),o.cc(6,"img",6),o.uc(7,"ImgPipe"),o.hc(8,"img",7),o.pc("click",(function(e){return t.clearProductImg()})),o.gc(),o.gc(),o.hc(9,"div",8),o.hc(10,"h5",9),o.Rc(11),o.gc(),o.hc(12,"span",10),o.Rc(13),o.uc(14,"myCurrPipe"),o.gc(),o.hc(15,"div",11),o.hc(16,"input",12),o.pc("ngModelChange",(function(e){return t.globalOrderDetail.Quantity=e})),o.gc(),o.gc(),o.gc(),o.hc(17,"div",13),o.pc("click",(function(e){return t.searchProduct()})),o.cc(18,"i",14),o.gc(),o.gc(),o.hc(19,"div",15),o.hc(20,"div",16),o.hc(21,"a",17),o.pc("click",(function(e){return t.quantityChangeRequest()})),o.Rc(22,"C\u1eadp nh\u1eadt S\u1ed1 l\u01b0\u1ee3ng"),o.gc(),o.gc(),o.gc(),o.hc(23,"div",15),o.hc(24,"div",18),o.hc(25,"a",17),o.pc("click",(function(e){return t.productNameChangeRequest()})),o.Rc(26,"C\u1eadp nh\u1eadt T\xean"),o.gc(),o.gc(),o.hc(27,"div",19),o.hc(28,"a",17),o.pc("click",(function(e){return t.insertModifiedValue()})),o.Rc(29,"C\u1eadp nh\u1eadt gi\xe1"),o.gc(),o.gc(),o.gc(),o.hc(30,"div",20),o.hc(31,"a",21),o.Rc(32,"Th\xf4ng tin ng\u01b0\u1eddi nh\u1eadn"),o.gc(),o.gc(),o.hc(33,"label",22),o.Rc(34,"Ph\u1ee5 ph\xed"),o.gc(),o.hc(35,"div",23),o.hc(36,"input",24),o.pc("ngModelChange",(function(e){return t.globalOrderDetail.AdditionalFee=e}))("input",(function(e){return t.onAddFeeChanged(e.target.value)}))("focus",(function(e){return t.onAddFeeFocus()})),o.gc(),o.gc(),o.hc(37,"a",25),o.Rc(38,"\xc1p d\u1ee5ng khuy\u1ebfn m\xe3i"),o.gc(),o.hc(39,"div",26),o.hc(40,"div",18),o.hc(41,"label",22),o.Rc(42,"Gi\u1ea3m gi\xe1 ph\u1ea7n tr\u0103m "),o.gc(),o.hc(43,"div",23),o.hc(44,"input",27),o.pc("ngModelChange",(function(e){return t.globalOrderDetail.PercentDiscount=e})),o.gc(),o.gc(),o.gc(),o.hc(45,"div",19),o.hc(46,"label",22),o.Rc(47,"Gi\u1ea3m gi\xe1 ti\u1ec1n"),o.gc(),o.hc(48,"div",23),o.hc(49,"input",28),o.pc("ngModelChange",(function(e){return t.globalOrderDetail.AmountDiscount=e}))("input",(function(e){return t.onAmountDiscountChanged(e.target.value)}))("focus",(function(e){return t.onAcmountDiscountFocus()})),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(50,"label",22),o.Rc(51,"M\u1ee5c \u0111\xedch mua h\xe0ng"),o.gc(),o.hc(52,"div",23),o.hc(53,"input",29),o.pc("ngModelChange",(function(e){return t.globalOrderDetail.PurposeOf=e})),o.gc(),o.gc(),o.hc(54,"label",22),o.Rc(55,"M\xf4 t\u1ea3"),o.gc(),o.hc(56,"div",23),o.hc(57,"input",30),o.pc("ngModelChange",(function(e){return t.globalOrderDetail.Description=e})),o.gc(),o.gc(),o.hc(58,"div",20),o.hc(59,"a",31),o.Rc(60,"\u1ea2nh m\xf4 t\u1ea3"),o.gc(),o.gc(),o.hc(61,"div",20),o.hc(62,"button",32),o.Rc(63,"Xong"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(64,"div",33),o.hc(65,"ul"),o.Pc(66,Ge,9,9,"li",34),o.gc(),o.gc(),o.hc(67,"div",35),o.hc(68,"div",36),o.hc(69,"input",37),o.pc("ngModelChange",(function(e){return t.newPrice=e}))("input",(function(e){return t.onNewPriceChanged(e.target.value)}))("focus",(function(e){return t.onNewPriceFocus()})),o.gc(),o.gc(),o.hc(70,"div",38),o.hc(71,"div",39),o.hc(72,"button",40),o.pc("click",(function(e){return t.submitPrice()})),o.Rc(73,"X\xe1c nh\u1eadn"),o.gc(),o.gc(),o.hc(74,"div",39),o.hc(75,"button",41),o.Rc(76,"H\u1ee7y"),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(77,"div",42),o.hc(78,"div",43),o.hc(79,"div",44),o.Pc(80,je,2,0,"div",45),o.Pc(81,$e,2,1,"div",46),o.gc(),o.Pc(82,Qe,4,4,"div",47),o.gc(),o.hc(83,"div",38),o.hc(84,"button",48),o.Rc(85,"\u0110\xf3ng"),o.gc(),o.gc(),o.gc(),o.hc(86,"div",49),o.cc(87,"angular-image-viewer",50),o.gc()}2&e&&(o.Ob(6),o.Bc("src",o.wc(7,16,t.globalOrderDetail.ProductImageUrl,"ProductImg"),o.Lc),o.Ob(5),o.Tc("",t.globalOrderDetail.ProductName," "),o.Ob(2),o.Sc(o.vc(14,19,t.globalOrderDetail.ModifiedPrice)),o.Ob(3),o.Ac("ngModel",t.globalOrderDetail.Quantity),o.Ob(20),o.Ac("ngModel",t.globalOrderDetail.AdditionalFee),o.Ob(8),o.Ac("ngModel",t.globalOrderDetail.PercentDiscount),o.Ob(5),o.Ac("ngModel",t.globalOrderDetail.AmountDiscount),o.Ob(4),o.Ac("ngModel",t.globalOrderDetail.PurposeOf),o.Ob(4),o.Ac("ngModel",t.globalOrderDetail.Description),o.Ob(9),o.Ac("ngForOf",t.promotions),o.Ob(3),o.Ac("ngModel",t.newPrice),o.Ob(11),o.Ac("ngIf",t.IsOnTerminal),o.Ob(1),o.Ac("ngIf",!t.IsOnTerminal),o.Ob(1),o.Ac("ngForOf",t.globalOrderDetail.NoteImages),o.Ob(5),o.Ac("src",t.images)("config",t.viewProdOptions))},directives:[k.v,k.l,k.m,k.p,k.b,k.k,k.n,c.c,g.k,g.l,We.a],pipes:[M.a,w.a,w.b],styles:[""]}),e})();var Ke=i("Gdn9"),_e=i("tk/3"),Ze=i("qfBg"),Ye=i("Kj3r"),et=i("vkgz");let tt=(()=>{class e{constructor(e,t){this.formBuilder=e,this.ngForm=t,this.placeholder="",this.delayTimeSpan=1e3,this.searchTextInvoke=new o.q,this.onChange=e=>{},this.onTouched=()=>{},this.searchContent=new k.d,this.searchForm=this.formBuilder.group({searchContent:this.searchContent})}ngOnInit(){this.searchContent.valueChanges.pipe(Object(Ye.a)(this.delayTimeSpan),Object(et.a)()).subscribe(e=>{this.searchTextInvoke.emit(e)})}preventEvent(e){e.stopPropagation()}writeValue(e){e!==this.value&&(this.value=e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}updateChanges(){this.onChange(this.value)}}return e.\u0275fac=function(t){return new(t||e)(o.bc(k.c),o.bc(k.m,8))},e.\u0275cmp=o.Vb({type:e,selectors:[["mobile-search-box"]],inputs:{placeholder:"placeholder",delayTimeSpan:"delayTimeSpan"},outputs:{searchTextInvoke:"searchTextInvoke"},features:[o.Nb([{provide:k.j,useExisting:Object(o.fb)(()=>e),multi:!0}])],decls:2,vars:1,consts:[[3,"formGroup"],["type","text","placeholder","placeholder","formControlName","searchContent",1,"form-control"]],template:function(e,t){1&e&&(o.hc(0,"form",0),o.cc(1,"input",1),o.gc()),2&e&&o.Ac("formGroup",t.searchForm)},directives:[k.v,k.l,k.f,k.b,k.k,k.e],styles:[""]}),e})();function it(e,t){if(1&e){const e=o.ic();o.hc(0,"li",75),o.hc(1,"app-status-point",76),o.pc("onClicked",(function(t){return o.Jc(e),o.tc(2).openDetailInfo(t)})),o.gc(),o.hc(2,"div",77),o.pc("click",(function(i){o.Jc(e);const c=t.$implicit;return o.tc(2).updateOrderDetailState(c.OrderDetailId)})),o.cc(3,"img",78),o.uc(4,"ImgPipe"),o.hc(5,"div",79),o.hc(6,"h5",80),o.Rc(7),o.gc(),o.hc(8,"span",81),o.Rc(9),o.uc(10,"myCurrPipe"),o.gc(),o.hc(11,"span",82),o.Rc(12),o.gc(),o.hc(13,"span",83),o.Rc(14),o.uc(15,"myTimePipe"),o.gc(),o.hc(16,"span",69),o.Rc(17),o.uc(18,"myDatePipe"),o.gc(),o.gc(),o.gc(),o.gc()}if(2&e){const e=t.$implicit;o.Ob(1),o.Ac("state",e.State)("id",e.OrderDetailId)("index",e.Index+1),o.Ob(2),o.Bc("src",o.wc(4,9,e.ProductImageUrl,"ProductImg"),o.Lc),o.Ob(4),o.Sc(e.ProductName),o.Ob(2),o.Sc(o.vc(10,12,e.ModifiedPrice)),o.Ob(3),o.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.Quantity,""),o.Ob(2),o.Sc(o.vc(15,14,e.DeliveryInfo.DateTime)),o.Ob(3),o.Sc(o.vc(18,16,e.DeliveryInfo.DateTime))}}function ct(e,t){if(1&e){const e=o.ic();o.hc(0,"a",84),o.pc("click",(function(t){o.Jc(e);const i=o.tc().$implicit;return o.tc().editOrder(i.OrderId)})),o.cc(1,"i",85),o.Rc(2," Ch\u1ec9nh s\u1eeda"),o.gc()}}function rt(e,t){if(1&e){const e=o.ic();o.hc(0,"li",62),o.hc(1,"div",63),o.hc(2,"span",64),o.pc("click",(function(i){o.Jc(e);const c=t.$implicit;return o.tc().viewPurchase(c.OrderId)})),o.Rc(3),o.gc(),o.hc(4,"div",65),o.pc("click",(function(i){o.Jc(e);const c=t.$implicit;return o.tc().selectOrder(c)})),o.hc(5,"h4",66),o.Rc(6),o.gc(),o.hc(7,"h4",67),o.Rc(8),o.gc(),o.hc(9,"span",68),o.Rc(10),o.uc(11,"myCurrPipe"),o.gc(),o.hc(12,"span",69),o.Rc(13),o.uc(14,"myDatePipe"),o.gc(),o.gc(),o.hc(15,"button",70),o.Rc(16,"m\u1edf"),o.gc(),o.gc(),o.hc(17,"div",71),o.hc(18,"ul",72),o.Pc(19,it,19,18,"li",73),o.gc(),o.Pc(20,ct,3,0,"a",74),o.gc(),o.gc()}if(2&e){const e=t.$implicit,i=t.index;o.Ac("id","order"+i),o.Ob(1),o.Ac("id","heading"+i),o.Ob(2),o.Sc(e.OrderId),o.Ob(3),o.Sc(e.CustomerInfo.Name),o.Ob(2),o.Tc("tel: ",e.CustomerInfo.PhoneNumber,""),o.Ob(2),o.Tc("",o.vc(11,14,e.TotalAmount)," "),o.Ob(3),o.Sc(o.vc(14,16,e.DoneTime)),o.Ob(2),o.Pb("data-target","#collapse"+i)("aria-controls","collapse"+i),o.Ob(2),o.Ac("id","collapse"+i),o.Pb("aria-labelledby","heading"+i)("data-parent","#order"+i),o.Ob(2),o.Ac("ngForOf",e.OrderDetails),o.Ob(1),o.Ac("ngIf",!e.IsFinished)}}function nt(e,t){if(1&e&&(o.hc(0,"span"),o.Rc(1),o.gc()),2&e){const e=t.$implicit;o.Ob(1),o.Sc(e.FullName)}}function st(e,t){if(1&e&&(o.hc(0,"span",86),o.Rc(1),o.gc()),2&e){const e=t.$implicit;o.Ob(1),o.Sc(e.FullName)}}function ot(e,t){if(1&e&&(o.hc(0,"li",87),o.cc(1,"img",88),o.uc(2,"ImgPipe"),o.hc(3,"span",89),o.Rc(4),o.gc(),o.gc()),2&e){const e=t.$implicit;o.Bc("id",e.Id),o.Ob(1),o.Bc("src",o.wc(2,3,e.AvtUrl,"UserAvt"),o.Lc),o.Ob(3),o.Sc(e.FullName)}}function at(e,t){if(1&e&&(o.hc(0,"li",90),o.cc(1,"img",88),o.uc(2,"ImgPipe"),o.hc(3,"span",89),o.Rc(4),o.gc(),o.hc(5,"span",91),o.Rc(6),o.gc(),o.gc()),2&e){const e=t.$implicit;o.Bc("id",e.Id),o.Ob(1),o.Bc("src",o.wc(2,4,e.AvtUrl,"UserAvt"),o.Lc),o.Ob(3),o.Sc(e.FullName),o.Ob(2),o.Sc(e.IsExternalShipper?"Shipper ngo\xe0i":"Nh\xe2n vi\xean")}}let ht=(()=>{class e extends f{constructor(e,t,i,c,r,n,s,o,a,h,d){super(),this.customerService=e,this.activatedRoute=t,this.router=i,this.orderService=c,this.storageService=r,this.productService=n,this.orderDetailService=s,this.http=o,this.datePipe=a,this.userService=h,this.printJobService=d,this.Title="Danh s\xe1ch \u0111\u01a1n",this.NavigateClass="nav-icon ",this.IsDataLosingWarning=!1,this.states=v.f,this.pageSize=20,this.totalPage=0,this.statuses=[],this.searchTerm="",this.allStatuses=[v.f.Added,v.f.Comfirming,v.f.Deliveried,v.f.DeliverAssinged,v.f.DeliveryWaiting,v.f.Making,v.f.Waiting,v.f.SentBack,v.f.Fixing,v.f.FixingRequest,v.f.Completed,v.f.Canceled],this.selectedDetail={},this.globalService.currentOrderViewModel=new b.d,this.selectMakingRequestTime=new Date,this.orders=[],this.florists=[],this.shippers=[]}get currentPage(){return this.globalService.currentOrderPage}set currentPage(e){this.globalService.currentOrderPage=e}OnBackNaviage(){customerSupport()}updateOrderDetailState(e){let t=new b.c,i=new b.d;switch(this.orders.forEach(c=>{c.OrderDetails.forEach(r=>{if(r.OrderDetailId===e)return t=r,void(i=c)})}),t.State){case v.f.Added:this.updateAddedDetailState(t,i);break;case v.f.Waiting:this.updateWaitingDetailState(t,i);break;case v.f.Making:case v.f.Fixing:this.updateMakingDetailState(t,i);break;case v.f.Comfirming:this.updatConfirmingDetailState(t,i);break;case v.f.Deliveried:this.updateDeliveriedDetailState(t,i);break;case v.f.DeliveryWaiting:this.updateDeliveryWaitingDetailState(t,i);break;case v.f.OnTheWay:case v.f.DeliverAssinged:this.updateAssignedShipperDetailState(t,i);break;case v.f.DeliverAssinged:this.updateDeliveringetailState(t,i);break;case v.f.SentBack:this.updateSentBackDetailState(t,i);break;case v.f.Completed:this.globalOrderDetail=t,this.globalOrder=i,this.router.navigate(["staff/order-detail-view"]);break;case v.f.FixingRequest:this.updateFixingRequestDetailState(t,i)}}filterByState(){const e=[];e.push({Name:"T\u1ea5t c\u1ea3",Value:"ALL"}),j.e.forEach(t=>{e.push({Name:t.DisplayName,Value:t.State})}),filterOrderByState(e,e=>{this.currentPage=0,this.statuses="ALL"===e?this.allStatuses:[e],this.getOrders()})}getOrders(){this.orders=[],this.orderService.searchOrders(this.currentPage,this.pageSize,this.statuses,this.searchTerm).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders})}searchOrder(e){this.currentPage=0,this.searchTerm=e,this.getOrders()}goToPage(e){e>=this.totalPage||e<0||(this.currentPage=e,this.orderService.searchOrders(this.currentPage,this.pageSize,this.statuses,this.searchTerm).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders}))}logout(){this.authService.logOut(e=>{e&&this.router.navigate(["staff/login"])})}Init(){return Object(s.a)(this,void 0,void 0,(function*(){this.setStatusBarColor(!1),this.statuses=this.allStatuses,this.orderService.searchOrders(this.currentPage,this.pageSize,this.statuses).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders}),this.askForRememberPassword(),this.userService.getByRole(v.i.Florist).then(e=>{this.florists=e}),this.userService.getByRole(v.i.Shipper).then(e=>{this.shippers=e})}))}doPrintJob(e){let t=0;const i=[];e.OrderDetails.forEach(e=>{i.push({productName:e.ProductName,index:e.Index+1,price:e.ModifiedPrice,additionalFee:e.AdditionalFee,discount:this.getDiscount(e.ModifiedPrice,e.PercentDiscount,e.AmountDiscount),quantity:e.Quantity}),t+=e.ModifiedPrice});const c=[];e.PurchaseItems&&e.PurchaseItems.forEach(e=>{c.push({method:e.Method,amount:e.Amount})});const r={Created:(new Date).getTime(),doneTime:new Date(e.DoneTime).toLocaleString("en-US",{hour12:!1}),Id:e.OrderId,Active:!0,IsDeleted:!1,saleItems:i,createdDate:e.CreatedDate.toLocaleString("en-US",{hour12:!1}),orderId:e.OrderId,summary:t,totalAmount:e.TotalAmount,totalPaidAmount:e.TotalPaidAmount,totalBalance:e.TotalAmount-e.TotalPaidAmount,vatIncluded:e.VATIncluded,memberDiscount:e.CustomerInfo.DiscountPercent,scoreUsed:e.CustomerInfo.ScoreUsed,gainedScore:e.CustomerInfo.GainedScore,totalScore:e.IsFinished?e.CustomerInfo.AvailableScore:e.CustomerInfo.AvailableScore-e.CustomerInfo.ScoreUsed+e.CustomerInfo.GainedScore,customerName:e.CustomerInfo.Name,customerId:e.CustomerInfo.Id,discount:this.getDiscount(e.TotalAmount,e.PercentDiscount,e.AmountDiscount),purchaseItems:c,isMemberDiscountApply:e.IsMemberDiscountApply};this.printJobService.addPrintJob(r)}getDiscount(e,t,i){let c=0;return t&&t>0&&(c=e/100*t),i&&i>0&&(c+=i),c}selectOrder(e){this.menuOpening(t=>{switch(+t){case 0:this.viewPurchase(e.OrderId);break;case 1:this.doPrintJob(e);break;case 2:if(e.IsFinished)return;this.orderDetailService.completeOrder(e).then(t=>{this.orderService.addScoreToCustomer(e).then(()=>{this.orderService.searchOrders(this.currentPage,this.pageSize,this.statuses).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders})})});break;case 3:this.openConfirm("Thao t\xe1c n\xe0y kh\xf4ng h\u1ec3 ho\xe0n l\u1ea1i, ch\u1eafc ch\u1eafn xo\xe1?",()=>{e.IsFinished?this.orderService.revertUsedScore(e.OrderId).then(t=>{this.orderService.deleteOrder(e.OrderId).then(e=>{this.orderService.searchOrders(this.currentPage,this.pageSize,this.statuses).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders})})}):this.orderService.deleteOrder(e.OrderId).then(e=>{this.orderService.searchOrders(this.currentPage,this.pageSize,this.statuses).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders})})})}},["Th\xeam thanh to\xe1n","In ho\xe1 \u0111\u01a1n","Ho\xe0n t\u1ea5t \u0111\u01a1n","Xo\xe1 \u0111\u01a1n"])}editOrder(e){this.globalOrder=this.orders.filter(t=>t.OrderId===e)[0],this.globalPurchases=this.globalOrder.PurchaseItems,this.isEdittingOrder=!0,this.customerService.getById(this.globalOrder.CustomerInfo.Id).then(e=>{e&&(this.globalOrder.CustomerInfo=this.orderService.getCustomerInfo(e,this.globalOrder)),this.router.navigate(["/staff/add-order"])})}viewPurchase(e){this.globalOrder=this.orders.filter(t=>t.OrderId===e)[0],this.globalPurchases=this.globalOrder.PurchaseItems,this.router.navigate(["staff/view-purchase"])}addOrder(){this.globalOrder=new b.d,this.globalOrderDetail=new b.c,this.isEdittingOrder=!1,this.globalPurchases=[],this.router.navigate(["/staff/add-order"])}getDetailById(e){return this.orders.filter(t=>t.OrderDetails.filter(t=>t.OrderDetailId===e).length>0)[0].OrderDetails.filter(t=>t.OrderDetailId===e)[0]}openDetailInfo(e){const t=this.getDetailById(e);t&&(this.selectedDetail.Shippers=t.Shippers?t.Shippers:[],this.selectedDetail.Florists=t.Florists?t.Florists:[],this.selectedDetail.State=t.State,this.selectedDetail.StateDisplay=j.f.filter(e=>e.State===t.State)[0].DisplayName,openColorBoard())}updateAssignedShipperDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd-MM-yyyy"),this.selectReceiveRequestTime=e.DeliveryInfo.DateTime,this.shippingNote=e.ShippingNote;const i={State:v.f.DeliveryWaiting,ReceivingTime:this.selectReceiveRequestTime.getTime(),ShippingNote:this.shippingNote};shippingRequest(()=>{i.ShippingNote=this.shippingNote,i.ReceivingTime=this.selectReceiveRequestTime.getTime(),this.orderDetailService.updateFields(e.OrderDetailId,i).then(t=>{this.orderDetailService.replaceShipper(e.OrderDetailId,this.orderDetailService.getLastestShipping(e).Id,-1).then(()=>{this.getOrders()})})},()=>{chooseShipper(t=>{i.State=v.f.DeliverAssinged,i.ShippingNote=this.shippingNote,i.ReceivingTime=this.selectReceiveRequestTime.getTime(),this.orderDetailService.updateFields(e.OrderDetailId,i).then(i=>{this.orderDetailService.replaceShipper(e.OrderDetailId,this.orderDetailService.getLastestShipping(e).Id,+t).then(()=>{this.getOrders()})})})});break;case 1:this.openConfirm("Ho\xe0n t\u1ea5t giao \u0111\u01a1n n\xe0y?",()=>{getShippingNoteDialog("Ho\xe0n t\u1ea5t",t=>{this.orderDetailService.shippingConfirm(e,null,t).then(e=>{this.getOrders()})})});break;case 2:if(e.State===v.f.DeliverAssinged)return void this.showInfo("\u0110\u01a1n ch\u01b0a b\u1eaft \u0111\u1ea7u giao!");this.openConfirm("Tr\u1ea3 l\u1ea1i c\u1eeba h\xe0ng \u0111\u01a1n n\xe0y?",()=>{getShippingNoteDialog("Tr\u1ea3 \u0111\u01a1n",t=>{this.orderDetailService.updateShippingFields(this.orderDetailService.getLastestShipping(e).Id,{Note:t,CompleteTime:(new Date).getTime(),DeliveryImageUrl:""}).then(t=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.SentBack}).then(e=>{this.getOrders()})}).catch(e=>{this.showError(e)})})});break;case 4:this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Canceled}).then(()=>{this.getOrders()});break;case 3:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"])}},["Ch\u1ecdn l\u1ea1i Shipper","Ho\xe0n th\xe0nh giao","Tr\u1ea3 \u0111\u01a1n v\u1ec1","Xem chi ti\u1ebft","Hu\u1ef7  \u0111\u01a1n"])}updateFixingRequestDetailState(e,t){this.menuOpening(i=>{switch(+i){case 1:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 0:this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm  dd-MM-yyyy"),this.selectMakingRequestTime=new Date,this.makingNote=e.MakingNote,makingTimeRequest(()=>{this.transferToFlorist(e,v.c.Fixing)},()=>{chooseFlorist(t=>{this.transferToFlorist(e,v.c.Fixing,+t)})});break;case 2:this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Canceled}).then(()=>{this.getOrders()})}},["Ch\u1ecdn Florist","Xem chi ti\u1ebft","Hu\u1ef7  \u0111\u01a1n"])}updateSentBackDetailState(e,t){this.menuOpening(i=>{switch(+i){case 2:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 0:this.assignShipper(e);break;case 1:this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd-MM-yyyy"),this.selectMakingRequestTime=new Date,this.makingNote=e.MakingNote,makingTimeRequest(()=>{this.transferToFlorist(e,v.c.Fixing)},()=>{chooseFlorist(t=>{this.transferToFlorist(e,v.c.Fixing,+t)})});break;case 3:this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Canceled}).then(()=>{this.getOrders()})}},["Giao sau","L\xe0m l\u1ea1i \u0111\u01a1n","Xem chi ti\u1ebft","Hu\u1ef7  \u0111\u01a1n"])}updateDeliveringetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 1:this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Deliveried}).then(()=>{this.orderDetailService.shippingConfirm(e,null,"").then(()=>{this.getOrders()})});break;case 2:this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Canceled}).then(()=>{this.getOrders()})}},["Xem chi ti\u1ebft","Ho\xe0n th\xe0nh \u0111\u01a1n","Hu\u1ef7 chi ti\u1ebft \u0111\u01a1n"])}assignShipper(e){this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd-MM-yyyy"),this.selectReceiveRequestTime=e.DeliveryInfo.DateTime,this.shippingNote="";const t={State:v.f.DeliveryWaiting,ReceivingTime:this.selectReceiveRequestTime.getTime(),ShippingNote:this.shippingNote};shippingRequest(()=>{t.ReceivingTime=this.selectReceiveRequestTime.getTime(),t.ShippingNote=this.shippingNote,this.orderDetailService.updateFields(e.OrderDetailId,t).then(e=>{this.getOrders()})},()=>{chooseShipper(i=>{t.State=v.f.DeliverAssinged,t.ReceivingTime=this.selectReceiveRequestTime.getTime(),t.ShippingNote=this.shippingNote,this.orderDetailService.updateFields(e.OrderDetailId,t).then(t=>{this.orderDetailService.assignSingleOD(e.OrderDetailId,+i,(new Date).getTime()).then(()=>{this.getOrders()})})})})}updateDeliveryWaitingDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.assignShipper(e);break;case 1:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 2:this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Canceled}).then(()=>{this.getOrders()})}},["Ch\u1ecdn Shipper","Xem chi ti\u1ebft","Hu\u1ef7 chi ti\u1ebft \u0111\u01a1n"])}updateMakingDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.orderDetailService.updateFields(e.OrderDetailId,{State:e.State===v.f.Making?v.f.Added:v.f.FixingRequest,MakingRequestTime:0,FloristId:null}).then(()=>{this.getOrders()});break;case 1:this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd-MM-yyyy"),this.selectMakingRequestTime=new Date(e.MakingRequestTime),this.makingNote=e.MakingNote;const i={State:v.f.Waiting,MakingRequestTime:this.selectMakingRequestTime.getTime(),MakingNote:this.makingNote};makingTimeRequest(()=>{i.MakingNote=this.makingNote,i.MakingRequestTime=this.selectMakingRequestTime.getTime(),this.orderDetailService.updateFields(e.OrderDetailId,i).then(t=>{this.orderDetailService.replaceFlorist(e.OrderDetailId,this.orderDetailService.getLastestMaking(e).Id,-1).then(()=>{this.getOrders()})})},()=>{chooseFlorist(t=>{i.State=v.f.FixerAssigned,i.MakingNote=this.makingNote,i.MakingRequestTime=this.selectMakingRequestTime.getTime(),this.orderDetailService.updateFields(e.OrderDetailId,i).then(i=>{this.orderDetailService.replaceFlorist(e.OrderDetailId,this.orderDetailService.getLastestMaking(e).Id,+t).then(()=>{this.getOrders()})})})});break;case 2:this.openConfirm("Ho\xe0n th\xe0nh \u0111\u01a1n n\xe0y?",()=>{this.orderDetailService.updateMakingFields(this.orderDetailService.getLastestMaking(e).Id,{CompleteTime:(new Date).getTime()}).then(()=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Comfirming}).then(()=>{this.assignShipper(e)})})});break;case 3:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 4:this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Canceled}).then(()=>{this.getOrders()})}},["X\u1eed l\xfd sau","\u0110\u1ed5i florist","Giao h\xe0ng","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}updatConfirmingDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-confirming"]);break;case 1:this.assignShipper(e);break;case 2:this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd-MM-yyyy"),this.selectMakingRequestTime=e.DeliveryInfo.DateTime,this.makingNote="",makingTimeRequest(()=>{this.transferToFlorist(e,v.c.Fixing)},()=>{chooseFlorist(t=>{this.transferToFlorist(e,v.c.Fixing,+t)})});break;case 3:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 4:this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Canceled,MakingRequestTime:0}).then(()=>{this.getOrders()})}},["X\xe1c nh\u1eadn th\xe0nh ph\u1ea9m","Giao h\xe0ng","L\xe0m l\u1ea1i \u0111\u01a1n","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}updateDeliveriedDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/final-confirm"]);break;case 1:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 2:this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Canceled,MakingRequestTime:0}).then(()=>{this.getOrders()})}},["X\xe1c nh\u1eadn giao","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}updateWaitingDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Added}).then(()=>{e.State=v.f.Added,e.MakingRequestTime=0});break;case 1:this.assignShipper(e);break;case 2:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 2:this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Canceled,MakingRequestTime:0}).then(()=>{this.getOrders()})}},["X\u1eed l\xfd sau","Giao h\xe0ng","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}transferToFlorist(e,t,i){i?this.orderDetailService.assignSingleMaking(e.OrderDetailId,i,(new Date).getTime(),t).then(()=>{this.orderDetailService.updateFields(e.OrderDetailId,{MakingNote:this.makingNote,State:t===v.c.Making?v.f.FloristAssigned:v.f.FixerAssigned,MakingRequestTime:this.selectMakingRequestTime.getTime()}).then(()=>{this.getOrders()})}):this.orderDetailService.updateFields(e.OrderDetailId,{State:t===v.c.Making?v.f.Waiting:v.f.FixingRequest,MakingNote:this.makingNote,MakingRequestTime:this.selectMakingRequestTime.getTime()}).then(()=>{this.getOrders()})}updateAddedDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd/MM/yyyy"),this.selectMakingRequestTime=e.MakingRequestTime?new Date(e.MakingRequestTime):e.DeliveryInfo.DateTime,this.makingNote=e.MakingNote?e.MakingNote:"",makingTimeRequest(()=>{this.transferToFlorist(e,v.c.Making)},()=>{chooseFlorist(t=>{this.transferToFlorist(e,v.c.Making,+t)})});break;case 1:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 2:this.assignShipper(e);break;case 3:this.orderDetailService.completeOD(e,t).then(e=>Object(s.a)(this,void 0,void 0,(function*(){this.getOrders()})))}},["Chuy\u1ec3n cho Florist","Xem chi ti\u1ebft","Giao h\xe0ng","K\u1ebft th\xfac chi ti\u1ebft \u0111\u01a1n"])}deleteOrderDetail(e,t){const i=t.OrderDetails.indexOf(e);if(t.OrderDetails.splice(i,1),t.OrderDetails.length<=0){const e=this.orders.filter(e=>e.OrderId===t.OrderId)[0];this.orders.splice(this.orders.indexOf(e),1)}}}return e.\u0275fac=function(t){return new(t||e)(o.bc(C.a),o.bc(c.a),o.bc(c.b),o.bc(I.a),o.bc(X),o.bc(Ke.a),o.bc(B.a),o.bc(_e.a),o.bc(w.b),o.bc(Ze.a),o.bc(P.a))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-orders-manage"]],features:[o.Lb],decls:115,vars:27,consts:[["id","order",1,"page-content"],[1,"container","order-add"],[1,"row"],[1,"col-2"],[1,"col-8","text-center"],["href","javascript:void(0);",1,"btn","main-btn",3,"click"],[1,"col-2","order-noti","text-right"],["routerLink","/staff/add-purchse"],["src","../../../assets/images/money.svg","alt","",1,"main-filter"],[1,"container","order-list"],[1,"row","order-list-top"],[1,"col-2","order-filter","text-left",3,"click"],[1,"main-bg"],["src","../../../assets/images/filter.svg","alt","",1,"main-filter"],[1,"col-8","order-search"],["placeholder","T\xean ho\u1eb7c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i KH...",3,"delayTimeSpan","searchTextInvoke"],[1,"col-2","order-check","text-right"],["routerLink","/staff/sort-order-changing",1,"main-bg"],["src","../../../assets/images/check.svg","alt","",1,"main-filter"],[1,"paging"],[1,"paging-arrow","paging-prev","main-bg",3,"click"],[1,"fa","fa-angle-left"],[1,"paging-arrow","paging-next","main-bg",3,"click"],[1,"fa","fa-angle-right"],[1,"row","order-list-bot"],["id","accordionOrder",1,"col-12","order-content","accordion","cusScroll"],["class","order-content-item",3,"id",4,"ngFor","ngForOf"],["id","makingTimeRequest",1,"popup-content"],[2,"font-weight","bold","font-size","15px","margin-left","3px"],[1,"form-group"],[1,"custom-label"],["id","selectMakingRequestTime","name","selectMakingRequestTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],["id","makingNote","name","makingNote",1,"mainForm",2,"width","100%","height","130px",3,"ngModel","ngModelChange"],[1,"col-12","mx-auto","text-center"],["type","button","id","choose-florist-btn",1,"btn","main-btn","w-100","mt-3"],[1,"col-6","mx-auto","text-center"],["type","button","id","submit-btn",1,"btn","main-btn","w-100","mt-3"],["type","button","id","cancel-btn",1,"btn","grey-btn","w-100","mt-3"],["id","shippingRequest",1,"popup-content"],["id","selectReceiveRequestTime","name","selectReceiveRequestTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],["dt2",""],["id","shippingNote","name","shippingNote",1,"mainForm",2,"width","100%","height","130px",3,"ngModel","ngModelChange"],["id","colorBoard",1,"popup-content"],[1,"colorList"],[1,"colorInfo","colorItem"],[3,"state"],[1,"colorInfo"],[4,"ngFor","ngForOf"],["style","margin-left: 5px;",4,"ngFor","ngForOf"],["id","viewed",1,"popup-content","florist"],[1,"viewedList"],["class","viewItem",3,"id",4,"ngFor","ngForOf"],["id","viewed",1,"popup-content","shipper"],["class","viewItem-three-column",3,"id",4,"ngFor","ngForOf"],[1,"customer-support"],["alt","",1,"customer-avatar",3,"src"],[1,"customer-name"],["href","tel:0000",1,"customer-phone"],[1,"customer-position"],["id","logoutBtn",1,"customer-position",3,"click"],[1,"order-content-item",3,"id"],[1,"item-top",3,"id"],[1,"item-code",3,"click"],[1,"item-info",3,"click"],[1,"item-name"],[1,"item-name",2,"font-size","12px","margin-top","1px"],[1,"item-price"],[1,"item-date"],["data-toggle","collapse","aria-expanded","false",1,"collapsed"],[1,"item-bot","collapse",3,"id"],[1,"order-product-list","cusScroll"],["class","order-product-item",4,"ngFor","ngForOf"],["href","javascript:void(0);","class","order-edit",3,"click",4,"ngIf"],[1,"order-product-item"],[3,"state","id","index","onClicked"],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPrice"],[1,"item-quantity"],[1,"item-time"],["href","javascript:void(0);",1,"order-edit",3,"click"],[1,"fa","fa-pencil"],[2,"margin-left","5px"],[1,"viewItem",3,"id"],["alt","",1,"itemAva",3,"src"],[1,"itemName"],[1,"viewItem-three-column",3,"id"],[1,"itemRole"]],template:function(e,t){if(1&e&&(o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"div",2),o.cc(3,"div",3),o.hc(4,"div",4),o.hc(5,"a",5),o.pc("click",(function(e){return t.addOrder()})),o.Rc(6,"Th\xeam \u0111\u01a1n"),o.gc(),o.gc(),o.hc(7,"div",6),o.hc(8,"a",7),o.cc(9,"img",8),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(10,"div",9),o.hc(11,"div",10),o.hc(12,"div",11),o.pc("click",(function(e){return t.filterByState()})),o.hc(13,"a",12),o.cc(14,"img",13),o.gc(),o.gc(),o.hc(15,"div",14),o.hc(16,"mobile-search-box",15),o.pc("searchTextInvoke",(function(e){return t.searchOrder(e)})),o.gc(),o.gc(),o.hc(17,"div",16),o.hc(18,"a",17),o.cc(19,"img",18),o.gc(),o.gc(),o.gc(),o.hc(20,"ul",19),o.hc(21,"li",20),o.pc("click",(function(e){return t.goToPage(t.currentPage-1)})),o.cc(22,"i",21),o.gc(),o.hc(23,"li",22),o.pc("click",(function(e){return t.goToPage(t.currentPage+1)})),o.cc(24,"i",23),o.gc(),o.gc(),o.hc(25,"div",24),o.hc(26,"ul",25),o.Pc(27,rt,21,18,"li",26),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(28,"div",27),o.hc(29,"label"),o.Rc(30,"Th\u1eddi gian giao: "),o.gc(),o.hc(31,"span",28),o.Rc(32),o.gc(),o.hc(33,"div",29),o.hc(34,"label",30),o.Rc(35,"Th\u1eddi gian ho\xe0n th\xe0nh: "),o.gc(),o.hc(36,"input",31),o.pc("ngModelChange",(function(e){return t.selectMakingRequestTime=e})),o.gc(),o.cc(37,"owl-date-time",32,33),o.gc(),o.hc(39,"div",29),o.hc(40,"label",30),o.Rc(41,"Ghi ch\xfa: "),o.gc(),o.hc(42,"textarea",34),o.pc("ngModelChange",(function(e){return t.makingNote=e})),o.gc(),o.gc(),o.hc(43,"div",2),o.hc(44,"div",35),o.hc(45,"button",36),o.Rc(46,"Ch\u1ec9 \u0111\u1ecbnh Florist"),o.gc(),o.gc(),o.gc(),o.hc(47,"div",2),o.hc(48,"div",37),o.hc(49,"button",38),o.Rc(50,"L\u01b0u"),o.gc(),o.gc(),o.hc(51,"div",37),o.hc(52,"button",39),o.Rc(53,"H\u1ee7y"),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(54,"div",40),o.hc(55,"label"),o.Rc(56,"Th\u1eddi nh\u1eadn d\u1ef1 ki\u1ebfn: "),o.gc(),o.hc(57,"span",28),o.Rc(58),o.gc(),o.hc(59,"div",29),o.hc(60,"label",30),o.Rc(61,"Th\u1eddi gian nh\u1eadn: "),o.gc(),o.hc(62,"input",41),o.pc("ngModelChange",(function(e){return t.selectReceiveRequestTime=e})),o.gc(),o.cc(63,"owl-date-time",32,42),o.gc(),o.hc(65,"div",29),o.hc(66,"label",30),o.Rc(67,"Ghi ch\xfa giao h\xe0ng: "),o.gc(),o.hc(68,"textarea",43),o.pc("ngModelChange",(function(e){return t.shippingNote=e})),o.gc(),o.gc(),o.hc(69,"div",2),o.hc(70,"div",35),o.hc(71,"button",36),o.Rc(72,"Ch\u1ec9 \u0111\u1ecbnh Shipper"),o.gc(),o.gc(),o.gc(),o.hc(73,"div",2),o.hc(74,"div",37),o.hc(75,"button",38),o.Rc(76,"L\u01b0u"),o.gc(),o.gc(),o.hc(77,"div",37),o.hc(78,"button",39),o.Rc(79,"H\u1ee7y"),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(80,"div",44),o.hc(81,"ul",45),o.hc(82,"li",46),o.cc(83,"app-status-point",47),o.hc(84,"label"),o.Rc(85),o.gc(),o.gc(),o.hc(86,"li",48),o.hc(87,"label"),o.Rc(88,"Th\u1ee3 c\u1eafm hoa: "),o.gc(),o.Pc(89,nt,2,1,"span",49),o.gc(),o.hc(90,"li",48),o.hc(91,"label"),o.Rc(92,"Ng\u01b0\u1eddi giao hoa: "),o.gc(),o.Pc(93,st,2,1,"span",50),o.gc(),o.gc(),o.gc(),o.hc(94,"div",51),o.hc(95,"h3",12),o.Rc(96,"Ch\u1ecdn Florist"),o.gc(),o.hc(97,"ul",52),o.Pc(98,ot,5,6,"li",53),o.gc(),o.gc(),o.hc(99,"div",54),o.hc(100,"h3",12),o.Rc(101,"Ch\u1ecdn Shipper"),o.gc(),o.hc(102,"ul",52),o.Pc(103,at,7,7,"li",55),o.gc(),o.gc(),o.hc(104,"div",56),o.cc(105,"img",57),o.uc(106,"ImgPipe"),o.hc(107,"p",58),o.Rc(108),o.gc(),o.hc(109,"a",59),o.Rc(110),o.gc(),o.hc(111,"p",60),o.Rc(112),o.gc(),o.hc(113,"p",61),o.pc("click",(function(e){return t.logout()})),o.Rc(114,"\u0110\u0103ng xu\u1ea5t"),o.gc(),o.gc()),2&e){const e=o.Hc(38),i=o.Hc(64);o.Ob(16),o.Ac("delayTimeSpan",1e3),o.Ob(11),o.Ac("ngForOf",t.orders),o.Ob(5),o.Sc(t.selectDeliveryTime),o.Ob(4),o.Ac("owlDateTime",e)("owlDateTimeTrigger",e)("ngModel",t.selectMakingRequestTime),o.Ob(1),o.Ac("stepMinute",5),o.Ob(5),o.Ac("ngModel",t.makingNote),o.Ob(16),o.Sc(t.selectDeliveryTime),o.Ob(4),o.Ac("owlDateTime",i)("owlDateTimeTrigger",i)("ngModel",t.selectReceiveRequestTime),o.Ob(1),o.Ac("stepMinute",5),o.Ob(5),o.Ac("ngModel",t.shippingNote),o.Ob(15),o.Ac("state",t.selectedDetail.State),o.Ob(2),o.Sc(t.selectedDetail.StateDisplay),o.Ob(4),o.Ac("ngForOf",t.selectedDetail.Florists),o.Ob(4),o.Ac("ngForOf",t.selectedDetail.Shippers),o.Ob(5),o.Ac("ngForOf",t.florists),o.Ob(5),o.Ac("ngForOf",t.shippers),o.Ob(2),o.Bc("src",o.wc(106,24,t.CurrentUser.Avt,"UserAvt"),o.Lc),o.Ob(3),o.Sc(t.CurrentUser.FullName),o.Ob(2),o.Sc(t.CurrentUser.PhoneNumber),o.Ob(2),o.Sc(t.CurrentUser.Role)}},directives:[c.c,tt,g.k,y.c,k.b,y.f,k.k,k.n,y.b,ye,g.l],pipes:[M.a,w.a,w.b,w.c],styles:[".item-detail-info[_ngcontent-%COMP%]   .item-date[_ngcontent-%COMP%]{margin-left:7px}"]}),e})();function dt(e,t){if(1&e&&(o.hc(0,"div",37),o.hc(1,"div",10),o.Rc(2),o.gc(),o.hc(3,"div",11),o.Rc(4),o.gc(),o.hc(5,"div",12),o.Rc(6),o.gc(),o.gc()),2&e){const e=t.$implicit;o.Pb("data-id",e.Id),o.Ob(2),o.Sc(e.FullName),o.Ob(2),o.Sc(e.PhoneNumber),o.Ob(2),o.Sc(e.MembershipInfo.MembershipType)}}function lt(e,t){1&e&&(o.hc(0,"div"),o.Rc(1," M\xe3 l\xe0 b\u1eaft bu\u1ed9c "),o.gc())}function gt(e,t){1&e&&(o.hc(0,"div"),o.Rc(1," T\xean t\u1ed1i thi\u1ec3u 3 k\xfd t\u1ef1 "),o.gc())}function ut(e,t){if(1&e&&(o.hc(0,"div",38),o.Pc(1,lt,2,0,"div",39),o.Pc(2,gt,2,0,"div",39),o.gc()),2&e){o.tc();const e=o.Hc(27);o.Ob(1),o.Ac("ngIf",e.errors.required),o.Ob(1),o.Ac("ngIf",e.errors.minlength)}}function mt(e,t){1&e&&(o.hc(0,"div"),o.Rc(1," T\xean t\u1ed1i thi\u1ec3u 1 k\xfd t\u1ef1 "),o.gc())}function pt(e,t){if(1&e&&(o.hc(0,"div",38),o.Pc(1,mt,2,0,"div",39),o.gc()),2&e){o.tc();const e=o.Hc(31);o.Ob(1),o.Ac("ngIf",e.errors.minlength)}}function ft(e,t){1&e&&(o.hc(0,"div"),o.Rc(1," SDT t\u1ed1i thi\u1ec3u 3 k\xfd t\u1ef1 "),o.gc())}function bt(e,t){if(1&e&&(o.hc(0,"div",38),o.Pc(1,ft,2,0,"div",39),o.gc()),2&e){o.tc();const e=o.Hc(43);o.Ob(1),o.Ac("ngIf",e.errors.minlength)}}function vt(e,t){if(1&e&&(o.hc(0,"li",42),o.hc(1,"label"),o.Rc(2,"Ng\xe0y sinh: "),o.gc(),o.hc(3,"span"),o.Rc(4),o.uc(5,"myDatePipe"),o.gc(),o.gc()),2&e){const e=o.tc(2);o.Ob(4),o.Sc(o.vc(5,1,e.selectedCustomer.Birthday))}}function Ot(e,t){if(1&e&&(o.hc(0,"li",42),o.hc(1,"label"),o.Rc(2,"Facebook: "),o.gc(),o.hc(3,"span"),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc(2);o.Ob(4),o.Sc(e.selectedCustomer.ContactInfo.Facebook)}}function Dt(e,t){if(1&e&&(o.hc(0,"li",42),o.hc(1,"label"),o.Rc(2,"Zalo: "),o.gc(),o.hc(3,"span"),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc(2);o.Ob(4),o.Sc(e.selectedCustomer.ContactInfo.Zalo)}}function St(e,t){if(1&e&&(o.hc(0,"li",42),o.hc(1,"label"),o.Rc(2,"Instagram: "),o.gc(),o.hc(3,"span"),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc(2);o.Ob(4),o.Sc(e.selectedCustomer.ContactInfo.Instagram)}}function It(e,t){if(1&e&&(o.hc(0,"li",42),o.hc(1,"label"),o.Rc(2,"Skype: "),o.gc(),o.hc(3,"span"),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc(2);o.Ob(4),o.Sc(e.selectedCustomer.ContactInfo.Skype)}}function Ct(e,t){if(1&e&&(o.hc(0,"div",40),o.hc(1,"ul",41),o.hc(2,"li",42),o.hc(3,"label"),o.Rc(4,"H\u1ecd t\xean:"),o.gc(),o.hc(5,"span"),o.Rc(6),o.gc(),o.gc(),o.hc(7,"li",42),o.hc(8,"label"),o.Rc(9,"SDT: "),o.gc(),o.hc(10,"span"),o.Rc(11),o.gc(),o.gc(),o.hc(12,"li",42),o.hc(13,"label"),o.Rc(14,"Danh x\u01b0ng: "),o.gc(),o.hc(15,"span"),o.Rc(16),o.gc(),o.gc(),o.Pc(17,vt,6,3,"li",43),o.Pc(18,Ot,5,1,"li",43),o.Pc(19,Dt,5,1,"li",43),o.Pc(20,St,5,1,"li",43),o.Pc(21,It,5,1,"li",43),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(6),o.Sc(e.selectedCustomer.FullName),o.Ob(5),o.Sc(e.selectedCustomer.PhoneNumber),o.Ob(5),o.Sc(e.selectedCustomer.Sex),o.Ob(1),o.Ac("ngIf",e.selectedCustomer.Birthday&&e.selectedCustomer.Birthday>0),o.Ob(1),o.Ac("ngIf",e.selectedCustomer.ContactInfo&&e.selectedCustomer.ContactInfo.Facebook),o.Ob(1),o.Ac("ngIf",e.selectedCustomer.ContactInfo&&e.selectedCustomer.ContactInfo.Zalo),o.Ob(1),o.Ac("ngIf",e.selectedCustomer.ContactInfo&&e.selectedCustomer.ContactInfo.Instagram),o.Ob(1),o.Ac("ngIf",e.selectedCustomer.ContactInfo&&e.selectedCustomer.ContactInfo.Skype)}}let Pt=(()=>{class e extends f{constructor(e,t){super(),this.customerService=e,this._ngZone=t,this.Title="Ch\u1ecdn kh\xe1ch h\xe0ng",this.IsDataLosingWarning=!1,this.totalCount=0,this.newCustomer=new L.a,this.customers=[],this.selectedCustomer=new L.a,window.searchProdReference={component:this,zone:this._ngZone,itemSelected:e=>this.setSelectedCustomer(e)}}setSelectedCustomer(e){const t=this.customers.filter(t=>t.Id===e)[0],i=[];let c=!0;this.selectedCustomer&&this.selectedCustomer.Id===t.Id?(i.push("B\u1ecf ch\u1ecdn"),c=!1):(this.selectedCustomer=t,i.push("Ch\u1ecdn")),i.push("Xem th\xf4ng tin chi ti\u1ebft"),this.menuOpening(e=>{switch(+e){case 0:c?this.selectConfirm():this.unSelectCustomer();break;case 1:viewCustomerInfo()}},i)}Init(){this.customerService.getCount().then(e=>{this.totalCount=e+1,this.newCustomer.Id=p.a.detectCustomerId(this.totalCount)}),this.selectedCustomer=new L.a,this.globalOrder.CustomerInfo&&this.searchCustomer(this.globalOrder.CustomerInfo.PhoneNumber?this.globalOrder.CustomerInfo.PhoneNumber:this.globalOrder.CustomerInfo.Name)}addCustomer(e){if(!e.valid)return;this.selectedCustomer=new L.a;const t=new L.a;t.FullName=this.newCustomer.FullName,t.PhoneNumber=this.newCustomer.PhoneNumber,t.Sex=this.newCustomer.Sex,t.MembershipInfo.MembershipType=v.d.NewCustomer,t.MembershipInfo.AccumulatedAmount=0,t.MembershipInfo.AvailableScore=0,t.MembershipInfo.UsedScoreTotal=0,t.Id=this.newCustomer.Id,this.customerService.createCustomer(t).then(e=>{this.newCustomer=new L.a,this.selectedCustomer=t,this.customers.push(t),this.globalOrder.CustomerInfo=b.a.toViewModel(this.selectedCustomer),closeAddCustomerDialog(),this.totalCount+=1,this.newCustomer=new L.a,this.newCustomer.Id=p.a.detectCustomerId(this.totalCount),setTimeout(()=>{setSelectedCustomerItem(this.selectedCustomer.Id)},500)})}unSelectCustomer(){this.globalOrder.CustomerInfo=new b.a,this.selectedCustomer=null,this.newCustomer=new L.a,setSelectedCustomerItem("")}selectConfirm(){null!=this.selectedCustomer?this.globalOrder.CustomerInfo.Id!==this.selectedCustomer.Id?(this.globalOrder.CustomerInfo=b.a.toViewModel(this.selectedCustomer),this.OnBackNaviage()):this.OnBackNaviage():this.showError("Ch\u01b0a ch\u1ecdn kh\xe1ch h\xe0ng n\xe0o c\u1ea3!!!")}searchCustomer(e){e&&""!==e?this.customerService.getList(-1,-1,v.d.All,e).then(e=>{this.customers=e.Customers,setTimeout(()=>{null!=this.globalOrder.CustomerInfo.Id&&(setSelectedCustomerItem(this.globalOrder.CustomerInfo.Id),this.selectedCustomer=e.Customers.find(e=>e.Id===this.globalOrder.CustomerInfo.Id))},50)}):this.customers=[]}}return e.\u0275fac=function(t){return new(t||e)(o.bc(C.a),o.bc(o.H))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-select-customer"]],features:[o.Lb],decls:53,vars:12,consts:[["id","customerInfo",1,"page-content"],[1,"container"],[1,"row","checkTop","search"],[1,"col-10","filterSearch"],["placeholder","T\xean ho\u1eb7c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i KH...",3,"delayTimeSpan","searchTextInvoke"],[1,"col-2","filterAdd","text-right"],["onclick","openAddInfo()",1,"main-bg"],["src","../../../../assets/images/addnew.svg","alt","",1,"main-filter"],[1,"nameTable"],[1,"tableHead"],[1,"tableLeft"],[1,"tableCenter"],[1,"tableRight"],["id","customer-list",1,"tableBody","cusScroll"],["class","tableRow main-bg customer-item","onclick","selectItem(this,'.customer-item')",4,"ngFor","ngForOf"],[1,"row","prodDone"],[1,"col-8","mx-auto","text-center"],["href","javascript:void(0);",1,"btn","main-btn","w-100",3,"click"],["id","infoAdd",1,"popup-content"],["autocomplete","on",1,"addInfoForm",3,"submit"],["form","ngForm"],[1,"form-group"],["type","text","name","Id","id","Id","required","","minlength","3","placeholder","M\xe3 KH...",1,"mainForm",3,"ngModel","ngModelChange"],["Id","ngModel"],["class","alert alert-danger",4,"ngIf"],["type","text","name","FullName","id","FullName","minlength","1","placeholder","T\xean \u0111\u1ea7y \u0111\u1ee7 ...",1,"mainForm",3,"ngModel","ngModelChange"],["FullName","ngModel"],["id","newCustomer.Sex","name","newCustomer.Sex",1,"mainForm",3,"ngModel","ngModelChange"],["selected",""],[3,"ngValue"],["type","tel","name","PhoneNumber","id","PhoneNumber","minlength","3","placeholder","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i...",1,"mainForm",3,"ngModel","ngModelChange"],["PhoneNumber","ngModel"],[1,"row"],[1,"col-6","mx-auto","text-center"],["type","button","id","cancel-button",1,"btn","grey-btn","w-100","mt-3"],["type","submit",1,"btn","main-btn","w-100","mt-3","btn-success"],["id","colorBoard","class","popup-content",4,"ngIf"],["onclick","selectItem(this,'.customer-item')",1,"tableRow","main-bg","customer-item"],[1,"alert","alert-danger"],[4,"ngIf"],["id","colorBoard",1,"popup-content"],[1,"colorList"],[1,"colorInfo"],["class","colorInfo",4,"ngIf"]],template:function(e,t){if(1&e){const e=o.ic();o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"div",2),o.hc(3,"div",3),o.hc(4,"mobile-search-box",4),o.pc("searchTextInvoke",(function(e){return t.searchCustomer(e)})),o.gc(),o.gc(),o.hc(5,"div",5),o.hc(6,"button",6),o.cc(7,"img",7),o.gc(),o.gc(),o.gc(),o.hc(8,"div",8),o.hc(9,"div",9),o.hc(10,"div",10),o.Rc(11,"H\u1ecd t\xean"),o.gc(),o.hc(12,"div",11),o.Rc(13,"SDT"),o.gc(),o.hc(14,"div",12),o.Rc(15,"Th\xe0nh vi\xean"),o.gc(),o.gc(),o.hc(16,"div",13),o.Pc(17,dt,7,4,"div",14),o.gc(),o.gc(),o.hc(18,"div",15),o.hc(19,"div",16),o.hc(20,"a",17),o.pc("click",(function(e){return t.selectConfirm()})),o.Rc(21,"Xong"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(22,"div",18),o.hc(23,"form",19,20),o.pc("submit",(function(i){o.Jc(e);const c=o.Hc(24);return t.addCustomer(c)})),o.hc(25,"div",21),o.hc(26,"input",22,23),o.pc("ngModelChange",(function(e){return t.newCustomer.Id=e})),o.gc(),o.Pc(28,ut,3,2,"div",24),o.gc(),o.hc(29,"div",21),o.hc(30,"input",25,26),o.pc("ngModelChange",(function(e){return t.newCustomer.FullName=e})),o.gc(),o.Pc(32,pt,2,1,"div",24),o.gc(),o.hc(33,"div",21),o.hc(34,"select",27),o.pc("ngModelChange",(function(e){return t.newCustomer.Sex=e})),o.hc(35,"option",28),o.Rc(36,"Danh x\u01b0ng"),o.gc(),o.hc(37,"option",29),o.Rc(38,"Anh"),o.gc(),o.hc(39,"option",29),o.Rc(40,"Ch\u1ecb"),o.gc(),o.gc(),o.gc(),o.hc(41,"div",21),o.hc(42,"input",30,31),o.pc("ngModelChange",(function(e){return t.newCustomer.PhoneNumber=e})),o.gc(),o.Pc(44,bt,2,1,"div",24),o.gc(),o.hc(45,"div",32),o.hc(46,"div",33),o.hc(47,"button",34),o.Rc(48,"H\u1ee7y"),o.gc(),o.gc(),o.hc(49,"div",33),o.hc(50,"button",35),o.Rc(51,"L\u01b0u"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.Pc(52,Ct,22,8,"div",36)}if(2&e){const e=o.Hc(27),i=o.Hc(31),c=o.Hc(43);o.Ob(4),o.Ac("delayTimeSpan",1e3),o.Ob(13),o.Ac("ngForOf",t.customers),o.Ob(9),o.Ac("ngModel",t.newCustomer.Id),o.Ob(2),o.Ac("ngIf",e.invalid&&(e.dirty||e.touched)),o.Ob(2),o.Ac("ngModel",t.newCustomer.FullName),o.Ob(2),o.Ac("ngIf",i.invalid&&(i.dirty||i.touched)),o.Ob(2),o.Ac("ngModel",t.newCustomer.Sex),o.Ob(3),o.Ac("ngValue","Male"),o.Ob(2),o.Ac("ngValue","Female"),o.Ob(3),o.Ac("ngModel",t.newCustomer.PhoneNumber),o.Ob(2),o.Ac("ngIf",c.invalid&&(c.dirty||c.touched)),o.Ob(8),o.Ac("ngIf",t.selectedCustomer)}},directives:[tt,g.k,k.v,k.l,k.m,k.b,k.r,k.h,k.k,k.n,g.l,k.s,k.o,k.u],pipes:[w.b],styles:[""]}),e})();var At=i("nAti"),Tt=i("kLqA"),kt=i("sWfF");class yt extends kt.a{}class Rt extends yt{constructor(){super(),this.FolderName="/tempProduct"}}let wt=(()=>{class e extends class{constructor(){const e=a.a.getInjector();this.globalService=e.get(h.a),this.storageService=e.get(X)}get tableRef(){return this.db.ref(this.tableName)}startLoading(){this.globalService.startLoading()}stopLoading(){this.globalService.stopLoading()}errorToast(e){this.globalService.showError(e)}infoToast(e){this.globalService.showInfo(e)}warningToast(e){this.globalService.showWarning(e)}successToast(e){this.globalService.showSuccess(e)}get db(){return null}deleteFileByUrl(e,t){e&&""!==e?(this.startLoading(),this.tableRef.orderByChild("Url").equalTo(e).once("value").then(e=>{var i;if(e.forEach(e=>{i=e.val()}),!i)return this.stopLoading(),void t(!0);this.storageService.deleteFile(i.Name,i.FolderName).then(()=>{this.stopLoading(),t(!0),this.delete(i.Id)}).catch(e=>{t(!1),this.stopLoading(),this.errorToast(e)})})):t(!0)}updateList(e,t){return this.tableRef.update(e,e=>{e?this.errorToast(e.message):t()})}getByFieldName(e,t){return this.globalService.startLoading(),this.tableRef.orderByChild(e).equalTo(t).once("value").then(e=>{this.globalService.stopLoading();const t=[];return e.forEach(e=>{const i=e.val();t.push(i)}),t}).catch(e=>(this.globalService.stopLoading(),this.globalService.showError(e),[]))}setAnotherEntity(e,t){return this.db.ref(`${t}/${e.Id}`).set(e).then(t=>{if(t)return e})}set(e){return e.Id&&""!=e.Id||(e.Id=Tt.Guid.create().toString()),this.startLoading(),this.db.ref(`${this.tableName}/${e.Id}`).set(e).then(t=>(this.stopLoading(),e)).catch(e=>{throw this.errorToast(e.message),this.stopLoading(),new e})}insert(e){this.startLoading();const t=this.tableRef.push(e);return e.Id=t.key,this.update(e)}setListSeperate(e){return Object(s.a)(this,void 0,void 0,(function*(){for(const t of e)this.set(t).catch(e=>{throw e});return[]}))}setList(e){return Object(s.a)(this,void 0,void 0,(function*(){const t=[];for(const i of e){const e=yield this.set(i).catch(e=>{throw e});e&&t.push(e)}return t}))}insertList(e){return Object(s.a)(this,void 0,void 0,(function*(){const t=[];this.startLoading();for(let i=0;i<e.length;i++){const c=yield this.insert(e[i]);c?t.push(c):console.log("error insert")}return t}))}getById(e){return this.startLoading(),this.db.ref(`${this.tableName}/${e}`).once("value").then(e=>(this.stopLoading(),e?e.val():null)).catch(e=>(this.stopLoading(),console.log(e),null))}updateSingleField(e,t,i){this.startLoading();var c={};return c[`/${e}/${t}`]=i,this.tableRef.update(c,e=>{this.stopLoading(),null!=e&&this.errorToast(e.message)})}updateFields(e){return this.startLoading(),this.tableRef.update(e,e=>{this.stopLoading(),null!=e&&this.errorToast(e.message)})}update(e){return this.tableRef.child(e.Id).set(e).then(()=>(this.stopLoading(),e))}delete(e){return this.startLoading(),this.db.ref(`${this.tableName}/${e}`).remove().then(()=>{this.stopLoading()})}deleteMany(e){return Object(s.a)(this,void 0,void 0,(function*(){this.startLoading(),e.forEach(e=>Object(s.a)(this,void 0,void 0,(function*(){yield this.db.ref(`${this.tableName}/${e}`).remove()}))),this.stopLoading()}))}getAllWithOrder(e){return this.startLoading(),this.tableRef.orderByChild(e).once("value").then(e=>{const t=[];return e.forEach(e=>{t.push(e.val())}),this.stopLoading(),t}).catch(e=>(this.errorToast(e),this.stopLoading(),[]))}getAll(){return this.startLoading(),this.tableRef.once("value").then(e=>{const t=[];return e.forEach(e=>{t.push(e.val())}),this.stopLoading(),t}).catch(e=>(this.errorToast(e),this.stopLoading(),[]))}deleteAll(){return this.startLoading(),this.tableRef.remove().then(()=>{this.stopLoading()})}}{constructor(){super()}get tableName(){return"/tempProducts"}deleteFile(e){const t=new Rt;return this.storageService.deleteFile(e,t.FolderName)}addFile(e,t,i){this.storageService.pushFileToStorage(e,t,e=>{null===e&&i("ERROR"),i(e.Url)})}addFileFromBase64String(e,t,i){this.storageService.pushStringToStorage(e,t,e=>{null===e&&i("ERROR"),i(e.Url)})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=o.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Mt=i("lBcp");function Ft(e,t){if(1&e&&(o.hc(0,"div",26),o.hc(1,"div",27),o.cc(2,"img",28),o.uc(3,"ImgPipe"),o.hc(4,"h4"),o.Rc(5),o.gc(),o.hc(6,"span"),o.Rc(7),o.uc(8,"myCurrPipe"),o.gc(),o.gc(),o.gc()),2&e){const e=t.$implicit;o.Pb("data-id",e.Id),o.Ob(2),o.Bc("src",o.wc(3,4,e.ImageUrl,"ProductImg"),o.Lc),o.Ob(3),o.Sc(e.Name),o.Ob(2),o.Sc(o.vc(8,7,e.Price))}}function Nt(e,t){if(1&e){const e=o.ic();o.hc(0,"div",29),o.hc(1,"label",30),o.hc(2,"input",31),o.pc("ngModelChange",(function(i){return o.Jc(e),t.$implicit.IsSelected=i})),o.gc(),o.cc(3,"span",32),o.Rc(4),o.gc(),o.gc()}if(2&e){const e=t.$implicit;o.Ob(2),o.Ac("ngModel",e.IsSelected),o.Ob(2),o.Tc("",e.Tag.Name," ")}}let xt=(()=>{class e extends f{constructor(e,t,i,c,r,n,s,o){super(),this.route=e,this.router=t,this.orderDetailService=i,this.productService=c,this._ngZone=r,this.tempProductService=n,this.tagService=s,this.categoryService=o,this.Title="Ch\u1ecdn s\u1ea3n ph\u1ea9m",this.currentPage=1,this.itemsPerPage=18,this.currentMaxPage=1,this.categoryName="",this.currentHardcodeUsedCount=-1,this.searchTerm="",this.priceSearchTerm=0,this.IsDataLosingWarning=!1,this.pagingProducts=[],this.categories=[],this.globalTags=[],this.productSearchingMode=v.g.None,this.images=[]}Init(){return Object(s.a)(this,void 0,void 0,(function*(){this.selectedProduct=new At.a,this.route.queryParams.subscribe(e=>{this.categoryService.getAll().then(t=>{this.categories.push({Value:-1,Name:"T\u1ea5t c\u1ea3"}),t.forEach(e=>{this.categories.push({Value:e.Id,Name:e.Name})}),this.tagService.getAll().then(t=>{t.forEach(e=>{this.globalTags.push({Tag:e,IsSelected:!1})}),this.getProductByCategory(+e.category)})})}),window.searchProdReference={component:this,zone:this._ngZone,itemSelected:e=>this.setSelectedProduct(e),tagsSelected:()=>this.tagsSelected()}}))}tagsSelected(){const e=[];this.globalTags.forEach(t=>{t.IsSelected&&e.push(t.Tag.Id)}),e.length<=0||(this.currentPage=1,this.filterByTags(e))}filterByTags(e){this.searchTerm="",this.priceSearchTerm=0,this.productSearchingMode=v.g.Name,this.getProductsByPage(1,e)}setSelectedProduct(e){this.selectedProduct=this.pagingProducts.filter(t=>t.Id==e)[0];const t=["Xem h\xecnh S\u1ea3n ph\u1ea3m"];(!this.selectedProduct.PriceList||this.selectedProduct.PriceList.length<=0)&&(this.selectedProduct.PriceList=[this.selectedProduct.Price]),this.selectedProduct.PriceList.forEach(e=>{t.push(w.a.currencyFormat(e))}),this.menuOpening(e=>{switch(+e){case 0:const t=M.a.getImgUrl(this.selectedProduct.ImageUrl,j.c.ProductImg);this.images=[t],setTimeout(()=>{viewProductImg(t,()=>{this.images=[]})},200);break;default:this.selectedProduct.Price=this.selectedProduct.PriceList[e-1],this.selectProduct()}},t)}getProductByCategory(e){this.productCategory=e,this.searchTerm="",this.priceSearchTerm=0,this.productSearchingMode=v.g.Name,this.categoryName=this.categories.filter(e=>e.Value===this.productCategory)[0].Name,this.getProductsByPage(this.currentPage)}filter(){selectProductCategory(this.categories,e=>{filterFocus(),this.getProductByCategory(+e)})}getProductsByPage(e,t=[]){return Object(s.a)(this,void 0,void 0,(function*(){if(this.globalTags.forEach(e=>{e.IsSelected=!1}),e<=0)return;if(this.currentMaxPage<e&&this.currentMaxPage>0)return;let i;this.pagingProducts=[],this.currentPage=e,this.selectedProduct=new At.a,i=this.productSearchingMode!==v.g.Price?yield this.productService.getRecords(e,this.itemsPerPage,this.productCategory,t,this.searchTerm):yield this.productService.getRecordsByPrice(e,this.itemsPerPage,this.productCategory,this.priceSearchTerm),i&&i.products?(i.products.forEach(e=>{this.pagingProducts.push(e.Product)}),this.currentMaxPage=i.totalPages):this.currentMaxPage=1}))}searchProduct(e){if(e.indexOf("k")===e.length-1||e.indexOf("K")===e.length-1){const t=e.toLowerCase().split("k")[0],i=parseInt(t);NaN!==i&&i>0?(this.productSearchingMode=v.g.Price,this.priceSearchTerm=1e3*i,this.searchTerm="",console.log(this.priceSearchTerm)):(this.productSearchingMode=v.g.Name,this.searchTerm="",this.priceSearchTerm=0)}else this.productSearchingMode=v.g.Name,this.priceSearchTerm=0,this.searchTerm=e;this.getProductsByPage(1)}selectProduct(){this.selectedProduct.Id?(this.globalOrderDetail.ProductName=this.selectedProduct.Name,this.globalOrderDetail.ProductImageUrl=this.selectedProduct.ImageUrl,this.globalOrderDetail.ProductId=this.selectedProduct.Id,this.globalOrderDetail.IsFromHardCodeProduct=!1,this.globalOrderDetail.OriginalPrice=this.selectedProduct.Price,this.globalOrderDetail.ModifiedPrice=this.selectedProduct.Price,this.OnBackNaviage()):this.showError("Ch\u01b0a c\xf3 s\u1ea3n ph\u1ea9m n\xe0o \u0111\u01b0\u1ee3c ch\u1ecdn!!")}}return e.\u0275fac=function(t){return new(t||e)(o.bc(c.a),o.bc(c.b),o.bc(B.a),o.bc(Ke.a),o.bc(o.H),o.bc(wt),o.bc(Mt.a),o.bc(Je.a))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-search-product"]],features:[o.Lb],decls:31,vars:6,consts:[["id","prodCate",1,"page-content"],[1,"container"],[1,"prodFilter"],[1,"filterCate"],["href","javascript:void(0)",1,"main-bg",3,"click"],["src","../../../../assets/images/filter2.png","alt",""],["onclick","searchFocus(this)",1,"filterSearch"],["placeholder","M\xe3 s\u1ea3n ph\u1ea9m...",3,"delayTimeSpan","searchTextInvoke"],[1,"filterAdd"],[1,"main-bg"],["src","../../../../assets/images/attach.svg","alt","",1,"main-filter"],["src","../../../../assets/images/price.svg","alt","","onClick","openTagMenu()",1,"main-filter"],[1,"row","prodList","cusScroll"],["onclick","selectItem(this,'.product-item')","class","col-4 product-item","style","padding-left: 0px;padding-right: 0px;",4,"ngFor","ngForOf"],[1,"paging"],[1,"paging-arrow","paging-prev","main-bg",3,"click"],[1,"fa","fa-angle-left"],[1,"paging-arrow","paging-next","main-bg",3,"click"],[1,"fa","fa-angle-right"],[1,"row","prodDone"],[1,"col-8","mx-auto","text-center"],["href","javascript:void(0);",1,"btn","main-btn",3,"click"],["id","tagsMenu",1,"tagMenu","checkMenu","tagMenu"],["class","form-check",4,"ngFor","ngForOf"],["id","view-product",1,"popup-content","view-img-popup-content"],[3,"src","config"],["onclick","selectItem(this,'.product-item')",1,"col-4","product-item",2,"padding-left","0px","padding-right","0px"],[1,"prodItem"],["alt","",3,"src"],[1,"form-check"],[1,"form-check-label"],["type","checkbox","name","IsSelected","id","IsSelected","value","checkedValue",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"main-bg","vatCustom"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"div",2),o.hc(3,"div",3),o.hc(4,"a",4),o.pc("click",(function(e){return t.filter()})),o.cc(5,"img",5),o.hc(6,"span"),o.Rc(7),o.gc(),o.gc(),o.gc(),o.hc(8,"div",6),o.hc(9,"mobile-search-box",7),o.pc("searchTextInvoke",(function(e){return t.searchProduct(e)})),o.gc(),o.gc(),o.hc(10,"div",8),o.hc(11,"button",9),o.cc(12,"img",10),o.gc(),o.gc(),o.hc(13,"div",8),o.hc(14,"button",9),o.cc(15,"img",11),o.gc(),o.gc(),o.gc(),o.hc(16,"div",12),o.Pc(17,Ft,9,9,"div",13),o.gc(),o.hc(18,"ul",14),o.hc(19,"li",15),o.pc("click",(function(e){return t.getProductsByPage(t.currentPage-1)})),o.cc(20,"i",16),o.gc(),o.hc(21,"li",17),o.pc("click",(function(e){return t.getProductsByPage(t.currentPage+1)})),o.cc(22,"i",18),o.gc(),o.gc(),o.hc(23,"div",19),o.hc(24,"div",20),o.hc(25,"a",21),o.pc("click",(function(e){return t.selectProduct()})),o.Rc(26,"Xong"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(27,"div",22),o.Pc(28,Nt,5,2,"div",23),o.gc(),o.hc(29,"div",24),o.cc(30,"angular-image-viewer",25),o.gc()),2&e&&(o.Ob(7),o.Sc(t.categoryName),o.Ob(2),o.Ac("delayTimeSpan",1600),o.Ob(8),o.Ac("ngForOf",t.pagingProducts),o.Ob(11),o.Ac("ngForOf",t.globalTags),o.Ob(2),o.Ac("src",t.images)("config",t.viewProdOptions))},directives:[tt,g.k,We.a,k.a,k.k,k.n],pipes:[M.a,w.a],styles:[""]}),e})();function Lt(e,t){if(1&e&&(o.hc(0,"li",24),o.hc(1,"p",25),o.Rc(2),o.gc(),o.hc(3,"span",26),o.Rc(4),o.gc(),o.hc(5,"span",27),o.Rc(6),o.uc(7,"myDatePipe"),o.gc(),o.hc(8,"span",28),o.Rc(9),o.gc(),o.gc()),2&e){const e=t.$implicit;o.Pb("data-index",t.index),o.Ob(2),o.Sc(e.FullName),o.Ob(2),o.Sc(e.PhoneNumber),o.Ob(2),o.Sc(o.wc(7,5,e.DateTime,"HH:mm d/M/yyyy")),o.Ob(3),o.Sc(e.Address)}}let Bt=(()=>{class e extends f{constructor(e,t){super(),this.route=e,this._ngZone=t,this.Title="Th\xf4ng tin ng\u01b0\u1eddi nh\u1eadn",this.IsDataLosingWarning=!1,this.currentList=[],this.deliveryInfo=new b.b}addressChoosing(){this.selectAddress(e=>{console.log("selected"),this.deliveryInfo.Address=e})}Init(){this.route.params.subscribe(e=>{this.deliveryInfo=b.b.DeepCopy(this.globalOrderDetail.DeliveryInfo),this.deliveryInfo.DateTime.setSeconds(0)}),window.DeliveryInfoReference={component:this,zone:this._ngZone,selectDeliveryInfo:e=>this.selectDeliveryInfo(e)},setTimeout(()=>{this.globalOrder.OrderDetails.forEach(e=>{const t=b.b.DeepCopy(e.DeliveryInfo);let i=!0;this.currentList.forEach(e=>{p.a.deliveryInfoCompare(t,e)&&(i=!1)}),i&&this.currentList.push(t)}),this.globalOrder.CustomerInfo&&this.globalOrder.CustomerInfo.ReceiverInfos.forEach(e=>{let t=!0;this.currentList.forEach(i=>{p.a.receiverInfoCompare(e,{FullName:i.FullName,PhoneNumber:i.PhoneNumber,Address:i.Address})&&(t=!1)}),t&&this.currentList.push({FullName:e.FullName,PhoneNumber:e.PhoneNumber,Address:e.Address,DateTime:new Date})})},200)}selectDeliveryInfo(e){console.log("selected"),this.deliveryInfo=b.b.DeepCopy(this.currentList[e])}addReceiver(e){e.valid&&(this.globalOrderDetail.DeliveryInfo=b.b.DeepCopy(this.deliveryInfo),super.OnBackNaviage())}}return e.\u0275fac=function(t){return new(t||e)(o.bc(c.a),o.bc(o.H))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-select-receiver"]],features:[o.Lb],decls:30,vars:8,consts:[["id","custInfo",1,"page-content"],[1,"container"],[1,"custInfo"],[1,"currentInfo"],["href","javascript:void(0)","onclick","openCustMenu()",1,"main-bg"],["src","../../../../assets/images/view.svg",1,"white-filter"],[1,"newInfo"],["autocomplete","on",1,"addInfoForm",3,"submit"],["form","ngForm"],[1,"form-group"],["type","text","name","FullName","id","FullName","value","","placeholder","T\xean...",1,"mainForm",3,"ngModel","ngModelChange"],["FullName","ngModel"],["type","tel","name","PhoneNumber","id","PhoneNumber","value","","placeholder","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i...",1,"mainForm",3,"ngModel","ngModelChange"],["type","text","name","Address","id","Address","placeholder","\u0110\u1ecba ch\u1ec9...",1,"mainForm",3,"ngModel","ngModelChange"],["href","javascript:void(0)",1,"viewMore","btn","main-btn",3,"click"],[1,"fa","fa-location-arrow"],["name","DateTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],[1,"row"],[1,"col-8","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-3"],["id","recentInfo",1,"actionMenu"],["onclick","selectSavedDeliveryInfo(this)",4,"ngFor","ngForOf"],["onclick","selectSavedDeliveryInfo(this)"],[1,"recentInfo-name"],[1,"recentInfo-phone"],[1,"recentInfo-date"],[1,"recentInfo-add"]],template:function(e,t){if(1&e){const e=o.ic();o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"div",2),o.hc(3,"div",3),o.hc(4,"span"),o.Rc(5,"Th\xf4ng tin ng\u01b0\u1eddi nh\u1eadn \u0111\xe3 l\u01b0u"),o.gc(),o.hc(6,"a",4),o.cc(7,"img",5),o.gc(),o.gc(),o.hc(8,"div",6),o.hc(9,"form",7,8),o.pc("submit",(function(i){o.Jc(e);const c=o.Hc(10);return t.addReceiver(c)})),o.hc(11,"div",9),o.hc(12,"input",10,11),o.pc("ngModelChange",(function(e){return t.deliveryInfo.FullName=e})),o.gc(),o.gc(),o.hc(14,"div",9),o.hc(15,"input",12),o.pc("ngModelChange",(function(e){return t.deliveryInfo.PhoneNumber=e})),o.gc(),o.gc(),o.hc(16,"div",9),o.hc(17,"input",13),o.pc("ngModelChange",(function(e){return t.deliveryInfo.Address=e})),o.gc(),o.hc(18,"a",14),o.pc("click",(function(e){return t.addressChoosing()})),o.cc(19,"i",15),o.gc(),o.gc(),o.hc(20,"input",16),o.pc("ngModelChange",(function(e){return t.deliveryInfo.DateTime=e})),o.gc(),o.cc(21,"owl-date-time",17,18),o.hc(23,"div",19),o.hc(24,"div",20),o.hc(25,"button",21),o.Rc(26,"Xong"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(27,"div",22),o.hc(28,"ul"),o.Pc(29,Lt,10,8,"li",23),o.gc(),o.gc()}if(2&e){const e=o.Hc(22);o.Ob(12),o.Ac("ngModel",t.deliveryInfo.FullName),o.Ob(3),o.Ac("ngModel",t.deliveryInfo.PhoneNumber),o.Ob(2),o.Ac("ngModel",t.deliveryInfo.Address),o.Ob(3),o.Ac("owlDateTime",e)("owlDateTimeTrigger",e)("ngModel",t.deliveryInfo.DateTime),o.Ob(1),o.Ac("stepMinute",5),o.Ob(8),o.Ac("ngForOf",t.currentList)}},directives:[k.v,k.l,k.m,k.b,k.k,k.n,y.c,y.f,y.b,g.k],pipes:[w.b],styles:[""]}),e})();function Ut(e,t){if(1&e){const e=o.ic();o.hc(0,"div",18),o.hc(1,"div",19),o.hc(2,"span",20),o.Rc(3),o.gc(),o.hc(4,"div",21),o.hc(5,"h4",22),o.Rc(6),o.gc(),o.hc(7,"span",23),o.Rc(8),o.gc(),o.gc(),o.cc(9,"app-status-point",24),o.gc(),o.hc(10,"div",25),o.hc(11,"ul",26),o.hc(12,"li",27),o.hc(13,"div",28),o.pc("click",(function(i){o.Jc(e);const c=t.$implicit;return o.tc().getMenu(c)})),o.cc(14,"img",29),o.uc(15,"ImgPipe"),o.hc(16,"div",30),o.hc(17,"span",31),o.Rc(18),o.uc(19,"myCurrPipe"),o.gc(),o.hc(20,"span",32),o.Rc(21),o.gc(),o.hc(22,"span",32),o.Rc(23),o.gc(),o.hc(24,"span",32),o.Rc(25),o.gc(),o.hc(26,"span",33),o.Rc(27),o.uc(28,"myTimePipe"),o.gc(),o.hc(29,"span",34),o.Rc(30),o.uc(31,"myDatePipe"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc()}if(2&e){const e=t.$implicit,i=t.index;o.Ob(3),o.Uc("",e.OrderId,"_",e.Index+1,""),o.Ob(3),o.Sc(e.ProductName),o.Ob(2),o.Uc("",e.DeliveryInfo.FullName,"-",e.DeliveryInfo.PhoneNumber,""),o.Ob(1),o.Ac("state",e.State)("id",e.OrderDetailId)("index",i+1),o.Ob(5),o.Bc("src",o.wc(15,15,e.ProductImageUrl,"ProductImg"),o.Lc),o.Ob(4),o.Sc(o.vc(19,18,e.ModifiedPrice)),o.Ob(3),o.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.Quantity,""),o.Ob(2),o.Tc("t\xean: ",e.DeliveryInfo.FullName,""),o.Ob(2),o.Tc("dc: ",e.DeliveryInfo.Address,""),o.Ob(2),o.Tc("th\u1eddi gian ",o.vc(28,20,e.DeliveryInfo.DateTime)," "),o.Ob(3),o.Tc(" ",o.vc(31,22,e.DeliveryInfo.DateTime),"")}}function qt(e,t){if(1&e){const e=o.ic();o.hc(0,"div",35),o.hc(1,"div",19),o.hc(2,"span",20),o.Rc(3),o.gc(),o.hc(4,"div",21),o.hc(5,"h4",22),o.Rc(6),o.gc(),o.hc(7,"span",23),o.Rc(8),o.gc(),o.gc(),o.cc(9,"app-status-point",24),o.gc(),o.hc(10,"div",25),o.hc(11,"ul",26),o.hc(12,"li",27),o.hc(13,"div",28),o.pc("click",(function(i){o.Jc(e);const c=t.$implicit;return o.tc().getMenu(c)})),o.cc(14,"img",29),o.uc(15,"ImgPipe"),o.hc(16,"div",30),o.hc(17,"span",31),o.Rc(18),o.uc(19,"myCurrPipe"),o.gc(),o.hc(20,"span",32),o.Rc(21),o.gc(),o.hc(22,"span",32),o.Rc(23),o.gc(),o.hc(24,"span",32),o.Rc(25),o.gc(),o.hc(26,"span",33),o.Rc(27),o.uc(28,"myTimePipe"),o.gc(),o.hc(29,"span",34),o.Rc(30),o.uc(31,"myDatePipe"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc()}if(2&e){const e=t.$implicit,i=t.index;o.Ac("ngClass","OnTheWay"===e.State?"selected-order-detail":""),o.Ob(3),o.Uc("",e.OrderId,"_",e.Index+1,""),o.Ob(3),o.Sc(e.ProductName),o.Ob(2),o.Uc("",e.DeliveryInfo.FullName,"-",e.DeliveryInfo.PhoneNumber,""),o.Ob(1),o.Ac("state",e.State)("id",e.OrderDetailId)("index",i+1),o.Ob(5),o.Bc("src",o.wc(15,16,e.ProductImageUrl,"ProductImg"),o.Lc),o.Ob(4),o.Sc(o.vc(19,19,e.ModifiedPrice)),o.Ob(3),o.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.Quantity,""),o.Ob(2),o.Tc("ng\u01b0\u1eddi nh\u1eadn: ",e.DeliveryInfo.FullName,""),o.Ob(2),o.Tc("dc nh\u1eadn: ",e.DeliveryInfo.Address,""),o.Ob(2),o.Tc("giao l\xfac ",o.vc(28,21,e.DeliveryInfo.DateTime)," "),o.Ob(3),o.Tc(" ",o.vc(31,23,e.DeliveryInfo.DateTime),"")}}let Ht=(()=>{class e extends f{constructor(e,t,i){super(),this.router=e,this.orderService=t,this.orderDetailService=i,this.Title="Ng\u01b0\u1eddi giao h\xe0ng",this.NavigateClass="nav-icon ",this.IsDataLosingWarning=!1,this.selectDeliveryTime="",this.shippingNote="",this.waitingMenuItems=["Nh\u1eadn \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],this.shippingMenuItems=["Giao \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],this.onTheWayMenuItems=["Ho\xe0n th\xe0nh \u0111\u01a1n","Ch\u1ee5p \u1ea3nh giao h\xe0ng","Tr\u1ea3 h\xe0ng","Xem chi ti\u1ebft \u0111\u01a1n"],this.waitingOrderDetails=[],this.shippingOrderDetails=[]}Init(){this.loadWaitingDetails(),this.loadShippingDetails(),this.askForRememberPassword()}OnBackNaviage(){customerSupport()}logout(){this.authService.logOut(e=>{e&&this.router.navigate(["staff/login"])})}viewDetail(e){this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}loadWaitingDetails(){this.waitingOrderDetails=[],this.orderDetailService.getDetailWithTimeSort([v.f.DeliveryWaiting],"ReceivingTime").then(e=>{this.waitingOrderDetails=e})}loadShippingDetails(){this.shippingOrderDetails=[],this.orderDetailService.getShippingOrderDetails(this.CurrentUser.Id).then(e=>{this.shippingOrderDetails=e})}updateFinalState(e,t,i){getShippingNoteDialog(t,t=>{i===v.f.SentBack?this.orderDetailService.updateShippingFields(this.orderDetailService.getLastestShipping(e).Id,{Note:t,CompleteTime:(new Date).getTime(),DeliveryImageUrl:""}).then(t=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:i}).then(e=>{this.loadShippingDetails()})}).catch(e=>{this.showError(e)}):this.orderDetailService.shippingConfirm(e,null,t).then(e=>{this.loadShippingDetails()}).catch(e=>{this.showError(e)})})}getMenu(e){menuOpen(t=>{switch(+t){case 0:switch(e.State){case v.f.DeliveryWaiting:this.orderDetailService.updateDetailSeen(e.OrderDetailId,this.CurrentUser.Id,(new Date).getTime()).then(t=>{this.orderDetailService.assignSingleOD(e.OrderDetailId,this.CurrentUser.Id,(new Date).getTime()).then(()=>{this.loadShippingDetails(),this.loadWaitingDetails()})});break;case v.f.OnTheWay:this.openConfirm("Ho\xe0n th\xe0nh giao \u0111\u01a1n?",()=>{this.updateFinalState(e,"Ho\xe0n th\xe0nh",v.f.Deliveried)});break;case v.f.DeliverAssinged:this.openConfirm("B\u1eaft \u0111\u1ea7u giao \u0111\u01a1n n\xe0y?",()=>{this.orderDetailService.updateShippingFields(this.orderDetailService.getLastestShipping(e).Id,{StartTime:(new Date).getTime()}).then(()=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.OnTheWay}).then(()=>{this.loadShippingDetails()})})})}break;case 1:switch(e.State){case v.f.OnTheWay:this.globalOrderDetail=e,this.router.navigate(["staff/customer-confirming"]);break;default:this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}break;case 2:this.openConfirm("Tr\u1ea3 \u0111\u01a1n n\xe0y?",()=>{this.updateFinalState(e,"Tr\u1ea3 \u0111\u01a1n",v.f.SentBack)});break;case 3:this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}},e.State===v.f.DeliveryWaiting?this.waitingMenuItems:e.State===v.f.DeliverAssinged?this.shippingMenuItems:this.onTheWayMenuItems)}}return e.\u0275fac=function(t){return new(t||e)(o.bc(c.b),o.bc(I.a),o.bc(B.a))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-shipper-main"]],features:[o.Lb],decls:27,vars:9,consts:[["id","arrange",1,"page-content"],[1,"container"],["id","listNav","role","tablist",1,"nav","nav-tabs","row"],[1,"nav-item","col-6"],["id","nav1","data-toggle","tab","href","#camhoa","role","tab","aria-controls","camhoa","aria-selected","true",1,"active","main-bg"],["id","nav2","data-toggle","tab","href","#giaohoa","role","tab","aria-controls","giaohoa","aria-selected","false",1,"main-bg"],["id","listContent",1,"tab-content","order-list-bot"],["id","camhoa","role","tabpanel","aria-labelledby","nav1",1,"tab-pane","fade","show","active"],[1,"order-content","cusScroll"],["class","order-content-item product-item",4,"ngFor","ngForOf"],["id","giaohoa","role","tabpanel","aria-labelledby","nav2",1,"tab-pane","fade"],["class","order-content-item product-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"customer-support"],["alt","",1,"customer-avatar",3,"src"],[1,"customer-name"],["href","tel:0000",1,"customer-phone"],[1,"customer-position"],["id","logoutBtn",1,"customer-position",3,"click"],[1,"order-content-item","product-item"],[1,"item-top"],[1,"item-code"],[1,"item-info"],[1,"item-name"],[1,"item-quantity"],[3,"state","id","index"],[1,"item-bot"],[1,"order-product-list","cusScroll"],[1,""],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"prodPrice"],[1,"item-address"],[1,"item-time"],[1,"item-date"],[1,"order-content-item","product-item",3,"ngClass"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"ul",2),o.hc(3,"li",3),o.hc(4,"a",4),o.Rc(5,"Ch\u1edd giao"),o.gc(),o.gc(),o.hc(6,"li",3),o.hc(7,"a",5),o.Rc(8,"\u0110ang giao"),o.gc(),o.gc(),o.gc(),o.hc(9,"div",6),o.hc(10,"div",7),o.hc(11,"ul",8),o.Pc(12,Ut,32,24,"div",9),o.gc(),o.gc(),o.hc(13,"div",10),o.hc(14,"ul",8),o.Pc(15,qt,32,25,"div",11),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(16,"div",12),o.cc(17,"img",13),o.uc(18,"ImgPipe"),o.hc(19,"p",14),o.Rc(20),o.gc(),o.hc(21,"a",15),o.Rc(22),o.gc(),o.hc(23,"p",16),o.Rc(24),o.gc(),o.hc(25,"p",17),o.pc("click",(function(e){return t.logout()})),o.Rc(26,"\u0110\u0103ng xu\u1ea5t"),o.gc(),o.gc()),2&e&&(o.Ob(12),o.Ac("ngForOf",t.waitingOrderDetails),o.Ob(3),o.Ac("ngForOf",t.shippingOrderDetails),o.Ob(2),o.Bc("src",o.wc(18,6,t.CurrentUser.Avt,"UserAvt"),o.Lc),o.Ob(3),o.Sc(t.CurrentUser.FullName),o.Ob(2),o.Sc(t.CurrentUser.PhoneNumber),o.Ob(2),o.Sc(t.CurrentUser.Role))},directives:[g.k,ye,g.j],pipes:[M.a,w.a,w.c,w.b],styles:[""]}),e})();function Et(e,t){if(1&e){const e=o.ic();o.hc(0,"div",18),o.hc(1,"div",19),o.hc(2,"span",20),o.Rc(3),o.gc(),o.hc(4,"div",21),o.hc(5,"h4",22),o.Rc(6),o.gc(),o.hc(7,"span",23),o.Rc(8),o.gc(),o.hc(9,"span",23),o.Rc(10),o.gc(),o.gc(),o.cc(11,"app-status-point",24),o.gc(),o.hc(12,"div",25),o.hc(13,"ul",26),o.hc(14,"li",27),o.hc(15,"div",28),o.pc("click",(function(i){o.Jc(e);const c=t.index;return o.tc().viewMakingDetail(c)})),o.cc(16,"img",29),o.uc(17,"ImgPipe"),o.hc(18,"div",30),o.hc(19,"span",31),o.Rc(20),o.uc(21,"myCurrPipe"),o.gc(),o.hc(22,"span",32),o.Rc(23),o.uc(24,"myCurrPipe"),o.gc(),o.hc(25,"span",32),o.Rc(26),o.uc(27,"myCurrPipe"),o.gc(),o.hc(28,"span",33),o.Rc(29),o.gc(),o.hc(30,"span",34),o.Rc(31),o.uc(32,"myTimePipe"),o.gc(),o.hc(33,"span",35),o.Rc(34),o.uc(35,"myDatePipe"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc()}if(2&e){const e=t.$implicit,i=t.index,c=o.tc();o.Ac("ngClass",e.IsSelect?"selected-order-detail":""),o.Ob(3),o.Uc("",e.OrderDetail.OrderId,"_",e.OrderDetail.Index+1,""),o.Ob(3),o.Sc(e.OrderDetail.ProductName),o.Ob(2),o.Sc(e.OrderDetail.CustomerName),o.Ob(2),o.Sc(e.OrderDetail.CustomerPhoneNumber),o.Ob(1),o.Ac("state",e.OrderDetail.State)("id",e.OrderDetail.OrderDetailId)("index",i+1),o.Ob(5),o.Bc("src",o.wc(17,16,e.OrderDetail.ProductImageUrl,"ProductImg"),o.Lc),o.Ob(4),o.Sc(o.vc(21,19,e.OrderDetail.ModifiedPrice)),o.Ob(3),o.Tc("Ph\u1ee5 ph\xed: ",o.vc(24,21,e.OrderDetail.AdditionalFee),""),o.Ob(3),o.Tc("Gi\u1ea3m gi\xe1: ",o.vc(27,23,c.getDetailDiscount(e.OrderDetail)),""),o.Ob(3),o.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.OrderDetail.Quantity,""),o.Ob(2),o.Tc("",o.vc(32,25,e.OrderDetail.MakingRequestTime)," "),o.Ob(3),o.Tc(" ",o.vc(35,27,e.OrderDetail.MakingRequestTime),"")}}function Vt(e,t){if(1&e){const e=o.ic();o.hc(0,"div",36),o.hc(1,"div",37),o.hc(2,"button",38),o.pc("click",(function(t){return o.Jc(e),o.tc().selectFloristDialogOpen()})),o.Rc(3,"Ch\u1ecdn Florist"),o.gc(),o.gc(),o.hc(4,"div",39),o.pc("click",(function(t){return o.Jc(e),o.tc().cancelFloristSelectMode()})),o.hc(5,"button",40),o.Rc(6,"Hu\u1ef7"),o.gc(),o.gc(),o.gc()}}function Jt(e,t){if(1&e){const e=o.ic();o.hc(0,"div",36),o.hc(1,"div",37),o.hc(2,"button",41),o.pc("click",(function(t){return o.Jc(e),o.tc().gotoSelectFloristMode()})),o.Rc(3,"Ch\u1ecdn nhi\u1ec1u"),o.gc(),o.gc(),o.gc()}}function Wt(e,t){if(1&e){const e=o.ic();o.hc(0,"div",18),o.hc(1,"div",19),o.hc(2,"span",20),o.Rc(3),o.gc(),o.hc(4,"div",21),o.hc(5,"h4",22),o.Rc(6),o.gc(),o.hc(7,"span",23),o.Rc(8),o.gc(),o.gc(),o.cc(9,"app-status-point",24),o.gc(),o.hc(10,"div",25),o.hc(11,"ul",26),o.hc(12,"li",27),o.hc(13,"div",28),o.pc("click",(function(i){o.Jc(e);const c=t.index;return o.tc().viewShippingDetail(c)})),o.cc(14,"img",29),o.uc(15,"ImgPipe"),o.hc(16,"div",30),o.hc(17,"span",31),o.Rc(18),o.uc(19,"myCurrPipe"),o.gc(),o.hc(20,"span",32),o.Rc(21),o.uc(22,"myCurrPipe"),o.gc(),o.hc(23,"span",32),o.Rc(24),o.uc(25,"myCurrPipe"),o.gc(),o.hc(26,"span",33),o.Rc(27),o.gc(),o.hc(28,"span",34),o.Rc(29),o.uc(30,"myTimePipe"),o.gc(),o.hc(31,"span",35),o.Rc(32),o.uc(33,"myDatePipe"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc()}if(2&e){const e=t.$implicit,i=t.index,c=o.tc();o.Ac("ngClass",e.IsSelect?"selected-order-detail":""),o.Ob(3),o.Uc("",e.OrderDetail.OrderId,"_",e.OrderDetail.Index+1,""),o.Ob(3),o.Sc(e.OrderDetail.ProductName),o.Ob(2),o.Uc("",e.OrderDetail.CustomerName,"-",e.OrderDetail.CustomerPhoneNumber,""),o.Ob(1),o.Ac("state",e.OrderDetail.State)("id",e.OrderDetail.OrderDetailId)("index",i+1),o.Ob(5),o.Bc("src",o.wc(15,16,e.OrderDetail.ProductImageUrl,"ProductImg"),o.Lc),o.Ob(4),o.Sc(o.vc(19,19,e.OrderDetail.ModifiedPrice)),o.Ob(3),o.Tc("Ph\u1ee5 ph\xed: ",o.vc(22,21,e.OrderDetail.AdditionalFee),""),o.Ob(3),o.Tc("Gi\u1ea3m gi\xe1: ",o.vc(25,23,c.getDetailDiscount(e.OrderDetail)),""),o.Ob(3),o.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.OrderDetail.Quantity,""),o.Ob(2),o.Tc("",o.vc(30,25,e.OrderDetail.DeliveryInfo.DateTime)," "),o.Ob(3),o.Tc(" ",o.vc(33,27,e.OrderDetail.DeliveryInfo.DateTime),"")}}function Gt(e,t){if(1&e){const e=o.ic();o.hc(0,"div",36),o.hc(1,"div",37),o.hc(2,"button",38),o.pc("click",(function(t){return o.Jc(e),o.tc().selectShipperDialogOpen()})),o.Rc(3,"Ch\u1ecdn Shipper"),o.gc(),o.gc(),o.hc(4,"div",39),o.pc("click",(function(t){return o.Jc(e),o.tc().cancelShipperSelectMode()})),o.hc(5,"button",40),o.Rc(6,"Hu\u1ef7"),o.gc(),o.gc(),o.gc()}}function jt(e,t){if(1&e){const e=o.ic();o.hc(0,"div",36),o.hc(1,"div",37),o.hc(2,"button",38),o.pc("click",(function(t){return o.Jc(e),o.tc().gotoSelectShipperMode()})),o.Rc(3,"Ch\u1ecdn nhi\u1ec1u"),o.gc(),o.gc(),o.gc()}}function Xt(e,t){if(1&e&&(o.hc(0,"li",42),o.cc(1,"img",43),o.uc(2,"ImgPipe"),o.hc(3,"span",44),o.Rc(4),o.gc(),o.gc()),2&e){const e=t.$implicit;o.Bc("id",e.Id),o.Ob(1),o.Bc("src",o.wc(2,3,e.AvtUrl,"UserAvt"),o.Lc),o.Ob(3),o.Sc(e.FullName)}}function $t(e,t){if(1&e&&(o.hc(0,"li",45),o.cc(1,"img",43),o.uc(2,"ImgPipe"),o.hc(3,"span",44),o.Rc(4),o.gc(),o.hc(5,"span",46),o.Rc(6),o.gc(),o.gc()),2&e){const e=t.$implicit;o.Bc("id",e.Id),o.Ob(1),o.Bc("src",o.wc(2,4,e.AvtUrl,"UserAvt"),o.Lc),o.Ob(3),o.Sc(e.FullName),o.Ob(2),o.Sc(e.IsExternalShipper?"Shipper ngo\xe0i":"Nh\xe2n vi\xean")}}let Qt=(()=>{class e extends f{constructor(e,t,i){super(),this.orderDetailService=e,this.userService=t,this.router=i,this.Title="Th\u1ee9 t\u1ef1 \u01b0u ti\xean",this.IsDataLosingWarning=!1,this.isAssigningShipper=!1,this.isAssigningFlorist=!1,this.shippingODs=[],this.shippers=[],this.makingODs=[],this.florists=[]}Init(){this.loadMakingDetails(),this.loadShippingDetails(),this.userService.getByRole(v.i.Shipper).then(e=>{this.shippers=e}),this.userService.getByRole(v.i.Florist).then(e=>{this.florists=e})}loadMakingDetails(){this.makingODs=[],this.orderDetailService.getDetailWithTimeSort([v.f.Waiting,v.f.FixingRequest],"MakingRequestTime").then(e=>{e.forEach(e=>{this.makingODs.push({OrderDetail:e,IsSelect:!1})})})}loadShippingDetails(){this.shippingODs=[],this.orderDetailService.getDetailWithTimeSort([v.f.DeliveryWaiting],"ReceivingTime").then(e=>{e.forEach(e=>{this.shippingODs.push({OrderDetail:e,IsSelect:!1})})})}viewShippingDetail(e){this.isAssigningShipper?this.shippingODs[e].IsSelect=!this.shippingODs[e].IsSelect:(this.globalOrderDetail=this.shippingODs[e].OrderDetail,this.router.navigate(["staff/order-detail-view"]))}viewMakingDetail(e){this.isAssigningFlorist?this.makingODs[e].IsSelect=!this.makingODs[e].IsSelect:(this.globalOrderDetail=this.makingODs[e].OrderDetail,this.router.navigate(["staff/order-detail-view"]))}gotoSelectShipperMode(){this.isAssigningShipper=!0}gotoSelectFloristMode(){this.isAssigningFlorist=!0}cancelShipperSelectMode(){this.shippingODs.forEach(e=>{e.IsSelect=!1}),this.isAssigningShipper=!1}cancelFloristSelectMode(){this.makingODs.forEach(e=>{e.IsSelect=!1}),this.isAssigningFlorist=!1}assignUsers(e){this.openConfirm(this.isAssigningShipper?"X\xe1c nh\u1eadn giao \u0111\u01a1n cho shipper?":"X\xe1c nh\u1eadn ph\xe2n c\xf4ng florist?",()=>{if(this.isAssigningShipper){const t=[];this.shippingODs.forEach(e=>{e.IsSelect&&t.push(e.OrderDetail.OrderDetailId)}),this.orderDetailService.assignOrderDetails(t,e,(new Date).getTime()).then(e=>{this.isAssigningShipper=!1,this.loadMakingDetails(),this.loadShippingDetails()})}else{const t=[];this.makingODs.forEach(e=>{e.IsSelect&&t.push(e.OrderDetail)}),this.orderDetailService.assignFloristForOrderDetails(t,e,(new Date).getTime()).then(e=>{this.isAssigningFlorist=!1,this.loadMakingDetails(),this.loadShippingDetails()})}})}selectShipperDialogOpen(){let e=!1;this.shippingODs.forEach(t=>{t.IsSelect&&(e=!0)}),e&&chooseShipper(e=>{this.assignUsers(+e)})}selectFloristDialogOpen(){let e=!1;this.makingODs.forEach(t=>{t.IsSelect&&(e=!0)}),e&&chooseFlorist(e=>{this.assignUsers(+e)})}}return e.\u0275fac=function(t){return new(t||e)(o.bc(B.a),o.bc(Ze.a),o.bc(c.b))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-sort-order-changing"]],features:[o.Lb],decls:30,vars:8,consts:[["id","orderList",1,"page-content"],[1,"container"],["id","listNav","role","tablist",1,"nav","nav-tabs","row"],[1,"nav-item","col-6"],["id","nav1","data-toggle","tab","href","#camhoa","role","tab","aria-controls","camhoa","aria-selected","true",1,"active","main-bg"],["id","nav2","data-toggle","tab","href","#giaohoa","role","tab","aria-controls","giaohoa","aria-selected","false",1,"main-bg"],["id","listContent",1,"tab-content","order-list-bot"],["id","camhoa","role","tabpanel","aria-labelledby","nav1",1,"tab-pane","fade","show","active"],[1,"order-content","cusScroll"],["class","order-content-item product-item",3,"ngClass",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],["id","giaohoa","role","tabpanel","aria-labelledby","nav2",1,"tab-pane","fade"],["id","viewed",1,"popup-content","florist"],[1,"main-bg"],[1,"viewedList"],["class","viewItem",3,"id",4,"ngFor","ngForOf"],["id","viewed",1,"popup-content","shipper"],["class","viewItem-three-column",3,"id",4,"ngFor","ngForOf"],[1,"order-content-item","product-item",3,"ngClass"],[1,"item-top"],[1,"item-code"],[1,"item-info"],[1,"item-name"],[1,"item-quantity"],[3,"state","id","index"],[1,"item-bot"],[1,"order-product-list","cusScroll"],[1,""],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"prodPrice"],[1,"prodCharge"],[1,"item-address"],[1,"item-time"],[1,"item-date"],[1,"row"],[1,"col-6","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-3","exchange-confirm",3,"click"],[1,"col-6","mx-auto","text-center",3,"click"],["type","submit",1,"btn","main-btn","w-100","mt-3","exchange-confirm"],["type","button",1,"btn","main-btn","w-100","mt-3","exchange-confirm",3,"click"],[1,"viewItem",3,"id"],["alt","",1,"itemAva",3,"src"],[1,"itemName"],[1,"viewItem-three-column",3,"id"],[1,"itemRole"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"ul",2),o.hc(3,"li",3),o.hc(4,"a",4),o.Rc(5,"C\u1eafm hoa"),o.gc(),o.gc(),o.hc(6,"li",3),o.hc(7,"a",5),o.Rc(8,"Giao hoa"),o.gc(),o.gc(),o.gc(),o.hc(9,"div",6),o.hc(10,"div",7),o.hc(11,"ul",8),o.Pc(12,Et,36,29,"div",9),o.gc(),o.Pc(13,Vt,7,0,"div",10),o.Pc(14,Jt,4,0,"div",10),o.gc(),o.hc(15,"div",11),o.hc(16,"ul",8),o.Pc(17,Wt,34,29,"div",9),o.gc(),o.Pc(18,Gt,7,0,"div",10),o.Pc(19,jt,4,0,"div",10),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(20,"div",12),o.hc(21,"h3",13),o.Rc(22,"Ch\u1ecdn Florist"),o.gc(),o.hc(23,"ul",14),o.Pc(24,Xt,5,6,"li",15),o.gc(),o.gc(),o.hc(25,"div",16),o.hc(26,"h3",13),o.Rc(27,"Ch\u1ecdn Shipper"),o.gc(),o.hc(28,"ul",14),o.Pc(29,$t,7,7,"li",17),o.gc(),o.gc()),2&e&&(o.Ob(12),o.Ac("ngForOf",t.makingODs),o.Ob(1),o.Ac("ngIf",t.isAssigningFlorist&&t.makingODs.length>0),o.Ob(1),o.Ac("ngIf",!t.isAssigningFlorist&&t.makingODs.length>0),o.Ob(3),o.Ac("ngForOf",t.shippingODs),o.Ob(1),o.Ac("ngIf",t.isAssigningShipper&&t.shippingODs.length>0),o.Ob(1),o.Ac("ngIf",!t.isAssigningShipper&&t.shippingODs.length>0),o.Ob(5),o.Ac("ngForOf",t.florists),o.Ob(5),o.Ac("ngForOf",t.shippers))},directives:[g.k,g.l,g.j,ye],pipes:[M.a,w.a,w.c,w.b],styles:[""]}),e})();var zt=i("TG2U"),Kt=i("3oHN");let _t=(()=>{class e extends f{constructor(e,t){super(),this.router=e,this.realtimeService=t,this.Title="",this.NavigateClass="",this.model=new zt.a,m.a.clear()}Init(){this.setStatusBarColor(!0),this.globalService.isOnMobile()&&savedLoginInforGettingRequest()}savedLoginInforReturn(e,t){this.model.passcode=t,this.model.userName=e}afterLogin(){switch(this.globalService.isOnMobile()&&(this.globalService.isRememberPassWillCheck=!0,mobileLogin(this.model.userName,this.model.passcode)),m.a.getRole()){case v.i.Admin:case v.i.Account:this.router.navigate(["/staff/orders-manage"]);break;case v.i.Florist:this.router.navigate(["staff/florist-main"]);break;case v.i.Shipper:this.router.navigate(["staff/shipper-main"])}}login(e){e.valid&&this.authService.login(this.model,e=>{e&&this.ngZone.run(()=>{this.afterLogin()})})}}return e.\u0275fac=function(t){return new(t||e)(o.bc(c.b),o.bc(Kt.a))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-login"]],features:[o.Lb],decls:11,vars:2,consts:[["id","login",1,"page-content"],[1,"logo"],["href","#"],["autocomplete","on","id","loginform",3,"submit"],["form","ngForm"],[1,"form-group"],["name","userName","placeholder","T\xean \u0111\u0103ng nh\u1eadp...",1,"form-control",3,"ngModel","ngModelChange"],["type","password","name","passcode","placeholder","M\u1eadt kh\u1ea9u...",1,"form-control",3,"ngModel","ngModelChange"],["type","submit","value","\u0110\u0103ng nh\u1eadp",1,"btn","btn-default"]],template:function(e,t){if(1&e){const e=o.ic();o.hc(0,"div",0),o.hc(1,"h1",1),o.hc(2,"a",2),o.Rc(3,"Login to Florid"),o.gc(),o.gc(),o.hc(4,"form",3,4),o.pc("submit",(function(i){o.Jc(e);const c=o.Hc(5);return t.login(c)})),o.hc(6,"div",5),o.hc(7,"input",6),o.pc("ngModelChange",(function(e){return t.model.userName=e})),o.gc(),o.gc(),o.hc(8,"div",5),o.hc(9,"input",7),o.pc("ngModelChange",(function(e){return t.model.passcode=e})),o.gc(),o.gc(),o.cc(10,"input",8),o.gc(),o.gc()}2&e&&(o.Ob(7),o.Ac("ngModel",t.model.userName),o.Ob(2),o.Ac("ngModel",t.model.passcode))},directives:[k.v,k.l,k.m,k.b,k.k,k.n],styles:[""]}),e})(),Zt=(()=>{class e{constructor(e,t,i,c){this.router=e,this.globalService=t,this.authService=i,this.realtimeService=c,this.navigateClass="",this.title="",this.headerUpdate=this.globalService.mobileUpdateHeader.subscribe(e=>{null!==e&&e&&this.updateHeaderBar(e.Title,e.NavigateClass)})}ngOnInit(){this.logoutInvoker=this.realtimeService.LogouOutBehavier.subscribe(e=>{!1!==e&&this.authService.logOut(e=>{e&&this.router.navigate(["/staff/login"])})});const e=m.a.getUserId();e&&this.realtimeService.connect(+e,m.a.getRole(),()=>{}),this.globalService.setStatusBarColor(!1)}updateHeaderBar(e,t){setTimeout(()=>{this.navigateClass=t,this.title=e},100)}ngOnDestroy(){this.headerUpdate.unsubscribe(),this.logoutInvoker.unsubscribe()}navigateOnClick(){this.globalService.clickOnNavigateButton()}}return e.\u0275fac=function(t){return new(t||e)(o.bc(c.b),o.bc(h.a),o.bc(d.a),o.bc(Kt.a))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-staff-main-layout"]],decls:6,vars:3,consts:[[1,"breadcrumb"],[3,"click"],[1,"breadcrumb-title"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"a",1),o.pc("click",(function(e){return t.navigateOnClick()})),o.gc(),o.hc(2,"div",2),o.hc(3,"span"),o.Rc(4),o.gc(),o.gc(),o.gc(),o.cc(5,"router-outlet")),2&e&&(o.Ob(1),o.Qb(t.navigateClass),o.Ob(3),o.Sc(t.title))},directives:[c.e],styles:[""]}),e})();function Yt(e,t){if(1&e&&(o.hc(0,"div",28),o.hc(1,"span",12),o.Rc(2,"T\xean KH"),o.gc(),o.hc(3,"span",13),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(4),o.Sc(e.order.CustomerInfo.Name)}}function ei(e,t){if(1&e&&(o.hc(0,"div",28),o.hc(1,"span",12),o.Rc(2,"SDT KH"),o.gc(),o.hc(3,"span",13),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(4),o.Sc(e.order.CustomerInfo.PhoneNumber)}}function ti(e,t){if(1&e&&(o.hc(0,"div",28),o.hc(1,"span",12),o.Rc(2,"T\xean ng\u01b0\u1eddi nh\u1eadn:"),o.gc(),o.hc(3,"span",13),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(4),o.Sc(e.orderDetail.DeliveryInfo.FullName)}}function ii(e,t){if(1&e&&(o.hc(0,"div",29),o.hc(1,"span",12),o.Rc(2,"SDT ng\u01b0\u1eddi nh\u1eadn:"),o.gc(),o.hc(3,"span",13),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(4),o.Sc(e.orderDetail.DeliveryInfo.PhoneNumber)}}function ci(e,t){if(1&e&&(o.hc(0,"div",29),o.hc(1,"span",12),o.Rc(2,"\u0110\u1ecba ch\u1ec9 giao:"),o.gc(),o.hc(3,"span",13),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(4),o.Sc(e.orderDetail.DeliveryInfo.Address)}}function ri(e,t){if(1&e&&(o.hc(0,"div",30),o.hc(1,"span",12),o.Rc(2,"Y\xeau c\u1ea7u xong tr\u01b0\u1edbc:"),o.gc(),o.hc(3,"span",13),o.Rc(4),o.uc(5,"myDatePipe"),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(4),o.Sc(o.wc(5,1,e.orderDetail.MakingRequestTime,"HH:mm dd/MM/yyyy"))}}function ni(e,t){if(1&e&&(o.hc(0,"div",31),o.hc(1,"span",12),o.Rc(2,"M\xf4 t\u1ea3 KH:"),o.gc(),o.hc(3,"span",13),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(4),o.Sc(e.orderDetail.Description)}}function si(e,t){if(1&e&&(o.hc(0,"div",31),o.hc(1,"span",12),o.Rc(2,"Ghi ch\xfa th\u1ef1c hi\u1ec7n:"),o.gc(),o.hc(3,"span",13),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(4),o.Sc(e.orderDetail.MakingNote)}}function oi(e,t){if(1&e&&(o.hc(0,"div",31),o.hc(1,"span",12),o.Rc(2,"Ghi ch\xfa giao h\xe0ng:"),o.gc(),o.hc(3,"span",13),o.Rc(4),o.gc(),o.gc()),2&e){const e=o.tc();o.Ob(4),o.Sc(e.orderDetail.ShippingNote)}}function ai(e,t){if(1&e){const e=o.ic();o.hc(0,"div",32),o.pc("click",(function(t){return o.Jc(e),o.tc().openViewed()})),o.cc(1,"img",21),o.Rc(2,"\u0110\xe3 xem "),o.gc()}}function hi(e,t){if(1&e&&(o.hc(0,"li",33),o.cc(1,"img",34),o.uc(2,"ImgPipe"),o.hc(3,"span",35),o.Rc(4),o.gc(),o.hc(5,"span",36),o.Rc(6),o.gc(),o.gc()),2&e){const e=t.$implicit;o.Ob(1),o.Bc("src",o.wc(2,3,e.Avt,"UserAvt"),o.Lc),o.Ob(3),o.Sc(e.FullName),o.Ob(2),o.Sc(e.Role)}}let di=(()=>{class e extends f{constructor(e,t){super(),this.orderDetailService=e,this.orderService=t,this.Title="Chi ti\u1ebft \u0111\u01a1n",this.IsDataLosingWarning=!1,this.states=v.f,this.canSeen=!0,this.orderDetail=new b.c,this.orderDetail.SeenUsers=[],this.order=new b.d,this.noteImgs=[]}Init(){this.orderDetail=this.globalOrderDetail,this.orderService.getById(this.orderDetail.OrderId).then(e=>{null!=e&&(this.order=e)}),this.state=j.f.filter(e=>e.State===this.orderDetail.State)[0].DisplayName,this.orderDetail.NoteImages.forEach(e=>{this.noteImgs.push(M.a.getImgUrl(e,j.c.NoteImg))}),setTimeout(()=>{this.canSeen&&(this.CurrentUser.Role!==v.i.Florist&&this.CurrentUser.Role!==v.i.Shipper||this.orderDetailService.updateDetailSeen(this.orderDetail.OrderDetailId,this.CurrentUser.Id,(new Date).getTime(),!1).then(e=>{}))},2e3)}destroy(){this.canSeen=!1}openViewed(){this.orderDetailService.getODSeeners(this.orderDetail.OrderDetailId).then(e=>{this.orderDetail.SeenUsers=e,openViewed()})}openNoteImages(){this.orderDetail.NoteImages.length>0&&viewImages(()=>{})}}return e.\u0275fac=function(t){return new(t||e)(o.bc(B.a),o.bc(I.a))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-view-order-detail"]],features:[o.Lb],decls:53,vars:34,consts:[["id","prodDetail",1,"page-content"],[1,"container"],[1,"prodDetail"],[1,"prodGen"],[3,"state"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPrice"],[1,"prodCharge"],[1,"prodInfo","cusScroll"],[1,"prodQuan","infoGroup"],[1,"itemlabel"],[1,"itemVal"],["class","prodName infoGroup",4,"ngIf"],["class","prodAddr infoGroup",4,"ngIf"],[1,"prodTime","infoGroup"],["class","prodMakingTime infoGroup",4,"ngIf"],["class","prodDesc infoGroup",4,"ngIf"],["style","right:150px;","class","viewed",3,"click",4,"ngIf"],[1,"viewed",3,"click"],["src","../../../assets/images/eye.svg","alt","",1,"main-filter"],["id","viewed",1,"popup-content"],[1,"main-bg"],[1,"viewedList"],["class","viewItem-three-column",4,"ngFor","ngForOf"],["id","view-product",1,"popup-content","view-img-popup-content",2,"z-index","1000"],[3,"src","config"],[1,"prodName","infoGroup"],[1,"prodAddr","infoGroup"],[1,"prodMakingTime","infoGroup"],[1,"prodDesc","infoGroup"],[1,"viewed",2,"right","150px",3,"click"],[1,"viewItem-three-column"],["alt","",1,"itemAva",3,"src"],[1,"itemName"],[1,"itemRole"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"div",2),o.hc(3,"div",3),o.cc(4,"app-status-point",4),o.cc(5,"img",5),o.uc(6,"ImgPipe"),o.hc(7,"div",6),o.hc(8,"h5",7),o.Rc(9),o.gc(),o.hc(10,"span",8),o.Rc(11),o.uc(12,"myCurrPipe"),o.gc(),o.hc(13,"span",9),o.Rc(14),o.uc(15,"myCurrPipe"),o.gc(),o.hc(16,"span",9),o.Rc(17),o.uc(18,"myCurrPipe"),o.gc(),o.hc(19,"span",9),o.Rc(20),o.gc(),o.gc(),o.gc(),o.hc(21,"div",10),o.hc(22,"div",11),o.hc(23,"span",12),o.Rc(24,"Tr\u1ea1ng th\xe1i:"),o.gc(),o.hc(25,"span",13),o.Rc(26),o.gc(),o.gc(),o.Pc(27,Yt,5,1,"div",14),o.Pc(28,ei,5,1,"div",14),o.Pc(29,ti,5,1,"div",14),o.Pc(30,ii,5,1,"div",15),o.Pc(31,ci,5,1,"div",15),o.hc(32,"div",16),o.hc(33,"span",12),o.Rc(34,"Th\u1eddi gian giao:"),o.gc(),o.hc(35,"span",13),o.Rc(36),o.uc(37,"myDatePipe"),o.gc(),o.gc(),o.Pc(38,ri,6,4,"div",17),o.Pc(39,ni,5,1,"div",18),o.Pc(40,si,5,1,"div",18),o.Pc(41,oi,5,1,"div",18),o.gc(),o.Pc(42,ai,3,0,"div",19),o.hc(43,"div",20),o.pc("click",(function(e){return t.openNoteImages()})),o.cc(44,"img",21),o.Rc(45,"\u1ea2nh ghi ch\xfa "),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(46,"div",22),o.hc(47,"h3",23),o.Rc(48,"Nh\u1eefng ng\u01b0\u1eddi \u0111\xe3 xem"),o.gc(),o.hc(49,"ul",24),o.Pc(50,hi,7,6,"li",25),o.gc(),o.gc(),o.hc(51,"div",26),o.cc(52,"angular-image-viewer",27),o.gc()),2&e&&(o.Ob(4),o.Ac("state",t.orderDetail.State),o.Ob(1),o.Bc("src",o.wc(6,22,t.orderDetail.ProductImageUrl,"ProductImg"),o.Lc),o.Ob(4),o.Sc(t.orderDetail.ProductName),o.Ob(2),o.Sc(o.vc(12,25,t.orderDetail.ModifiedPrice)),o.Ob(3),o.Tc("Gi\u1ea3m gi\xe1: ",o.vc(15,27,t.getDetailDiscount(t.orderDetail)),""),o.Ob(3),o.Tc("Ph\u1ee5 ph\xed: ",o.vc(18,29,t.orderDetail.AdditionalFee),""),o.Ob(3),o.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",t.orderDetail.Quantity,""),o.Ob(6),o.Sc(t.state),o.Ob(1),o.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),o.Ob(1),o.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),o.Ob(1),o.Ac("ngIf","Florist"!=t.CurrentUser.Role),o.Ob(1),o.Ac("ngIf","Florist"!=t.CurrentUser.Role),o.Ob(1),o.Ac("ngIf","Florist"!=t.CurrentUser.Role),o.Ob(5),o.Sc(o.wc(37,31,t.orderDetail.DeliveryInfo.DateTime,"HH:mm dd/MM/yyyy")),o.Ob(2),o.Ac("ngIf","Shipper"!=t.CurrentUser.Role),o.Ob(1),o.Ac("ngIf",""!=t.orderDetail.Description),o.Ob(1),o.Ac("ngIf",""!=t.orderDetail.MakingNote),o.Ob(1),o.Ac("ngIf",""!=t.orderDetail.ShippingNote),o.Ob(1),o.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),o.Ob(8),o.Ac("ngForOf",t.orderDetail.SeenUsers),o.Ob(2),o.Ac("src",t.noteImgs)("config",t.viewProdOptions))},directives:[ye,g.l,g.k,We.a],pipes:[M.a,w.a,w.b],styles:[""]}),e})(),li=(()=>{class e extends f{constructor(){super(),this.Title="Trang ch\u1ee7"}Init(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Vb({type:e,selectors:[["app-home"]],features:[o.Lb],decls:2,vars:0,template:function(e,t){1&e&&(o.hc(0,"p"),o.Rc(1,"home works!"),o.gc())},styles:[""]}),e})();const gi=function(e){return[e,"VND","symbol-narrow","","vi-VN"]};function ui(e,t){if(1&e){const e=o.ic();o.hc(0,"div",34),o.pc("click",(function(i){o.Jc(e);const c=t.$implicit;return o.tc().selectItem(c)})),o.hc(1,"div",7),o.Rc(2),o.uc(3,"currency"),o.gc(),o.hc(4,"div",8),o.Rc(5),o.gc(),o.hc(6,"div",9),o.Rc(7),o.uc(8,"myDatePipe"),o.gc(),o.gc()}if(2&e){const e=t.$implicit;o.Ob(2),o.Sc(o.xc(3,3,o.Cc(11,gi,e.Amount))),o.Ob(3),o.Sc(e.Method),o.Ob(2),o.Sc(o.vc(8,9,e.AddingTime))}}let mi=(()=>{class e extends f{constructor(e){super(),this.purchaseService=e,this.Title="C\u1eadp nh\u1eadt thanh to\xe1n",this.purchaseType=v.h,this.IsDataLosingWarning=!1,this.qrContentTemplate="",this.currTotalPaidAmount=0,this.purchaseItems=[],this.order=this.globalOrder,this.qrContent="",this.currentPurchase=new S.a}get totalBalance(){return this.order?this.order.TotalAmount-this.order.TotalPaidAmount:0}Init(){console.log(this.globalPurchases),this.purchaseItems=this.globalPurchases}selectItem(e){this.currTotalPaidAmount=this.order.TotalPaidAmount,this.order.TotalPaidAmount-=e.Amount,this.currentPurchase=new S.a,this.currentPurchase.Id=e.Id,this.currentPurchase.Amount=e.Amount,this.currentPurchase.Method=e.Method,this.currentPurchase.Note=e.Note,purchaseDoing(()=>{this.order.TotalPaidAmount=this.currTotalPaidAmount})}addPurchase(){this.currTotalPaidAmount=this.order.TotalPaidAmount,this.currentPurchase=new S.a,this.currentPurchase.Id=-1,this.currentPurchase.Amount=this.totalBalance,this.currentPurchase.Method=v.h.Cash,this.currentPurchase.Note="",purchaseDoing(()=>{})}onPayChanged(e){this.currentPurchase.Amount<10&&(this.currentPurchase.Amount*=1e3,this.moveCursor(this.currentPurchase.Amount.toString().length,"Amount")),this.currentPurchase.Amount=+this.currentPurchase.Amount}onPayFocus(){this.currentPurchase.Amount||(this.currentPurchase.Amount=0),this.moveCursor(this.currentPurchase.Amount.toString().length,"Amount")}purchaseConfirm(){if(this.currentPurchase.Amount>this.totalBalance||this.currentPurchase.Amount<=0)return void this.showError("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!");const e=new S.a;e.OrderId=this.order.OrderId,e.Id=this.currentPurchase.Id,e.Amount=+this.currentPurchase.Amount,e.Method=this.currentPurchase.Method,e.AddingTime=(new Date).getTime(),e.Note=this.currentPurchase.Note,this.order.TotalPaidAmount+=e.Amount,this.purchaseService.createOrUpdate(e,this.order.TotalPaidAmount).then(t=>{if(e.Id>0){const t=this.purchaseItems.filter(t=>t.Id===e.Id)[0];t.OrderId=e.OrderId,t.Id=e.Id,t.Amount=+e.Amount,t.Method=e.Method,this.showSuccess("\u0110\xe3 c\u1eadp nh\u1eadt 1 thanh to\xe1n!"),dismissPurchaseDialog()}else this.globalPurchases.push(e),this.showSuccess("\u0110\xe3 th\xeam 1 thanh to\xe1n!"),this.currentPurchase.Amount=0,this.totalBalance<=0&&dismissPurchaseDialog()})}selectPurType(e){this.currentPurchase.Method=e,e===v.h.Momo&&this.currentPurchase.Amount>0&&(this.qrContent=this.qrContentTemplate+this.currentPurchase.Amount.toString(),openQR())}}return e.\u0275fac=function(t){return new(t||e)(o.bc(T.a))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-view-purchase"]],features:[o.Lb],decls:74,vars:21,consts:[["id","customerInfo",1,"page-content"],[1,"container"],[1,"row","checkTop","search"],[1,"col-12","mx-auto","text-center"],["type","button",1,"btn","main-btn","w-100",3,"click"],[1,"nameTable"],[1,"tableHead"],[1,"tableCenter"],[1,"tableLeft"],[1,"tableRight"],["id","customer-list",1,"tableBody","cusScroll"],["class","tableRow main-bg customer-item",3,"click",4,"ngFor","ngForOf"],[1,"orderTotal"],[1,"totalOld"],[1,"orderPrice"],[1,"totalNew"],["id","purchase-dialog",1,"popup-content"],[1,"checkOut",2,"margin-top","0px","padding","0px"],[1,"checkOutTotal"],[1,"checkOutLeft","mb-2"],[1,"form-group"],["for","currentPayAmount",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Amount","id","Amount",1,"mainForm",3,"ngModel","input","focus","ngModelChange"],["for","Note",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Note","id","Note",1,"mainForm",3,"ngModel","ngModelChange"],[1,"form-group","methodGrid","mb-0"],["href","javascript:void(0)",1,"methodItem",3,"ngClass","click"],["src","../../../../assets/images/momo.jpg","alt",""],["src","../../../../assets/images/banking.jpg","alt",""],["src","../../../../assets/images/cash.png","alt",""],[1,"row"],["id","codeQR",1,"popup-content"],[3,"value","size"],["type","button","id","submit-btn","onClick","qrDone()",1,"btn","main-btn","w-100","mt-3"],[1,"tableRow","main-bg","customer-item",3,"click"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"div",2),o.hc(3,"div",3),o.hc(4,"button",4),o.pc("click",(function(e){return t.addPurchase()})),o.Rc(5,"Th\xeam thanh to\xe1n"),o.gc(),o.gc(),o.gc(),o.hc(6,"div",5),o.hc(7,"div",6),o.hc(8,"div",7),o.Rc(9,"S\u1ed1 ti\u1ec1n"),o.gc(),o.hc(10,"div",8),o.Rc(11,"H\xecnh th\u1ee9c"),o.gc(),o.hc(12,"div",9),o.Rc(13,"Th\u1eddi gian"),o.gc(),o.gc(),o.hc(14,"div",10),o.Pc(15,ui,9,13,"div",11),o.gc(),o.gc(),o.hc(16,"div",12),o.hc(17,"p",13),o.Rc(18,"M\xe3 \u0111\u01a1n: "),o.hc(19,"span",14),o.Rc(20),o.gc(),o.gc(),o.hc(21,"p",13),o.Rc(22,"C\xf2n l\u1ea1i: "),o.hc(23,"span",14),o.Rc(24),o.uc(25,"myCurrPipe"),o.gc(),o.gc(),o.hc(26,"p",15),o.Rc(27,"Th\xe0nh ti\u1ec1n: "),o.hc(28,"span",14),o.Rc(29),o.uc(30,"myCurrPipe"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(31,"div",16),o.hc(32,"div",1),o.hc(33,"div",17),o.hc(34,"div",18),o.hc(35,"h3"),o.Rc(36,"T\u1ed5ng"),o.gc(),o.hc(37,"p"),o.Rc(38),o.uc(39,"myCurrPipe"),o.gc(),o.gc(),o.hc(40,"div",19),o.hc(41,"h4"),o.Rc(42,"S\u1ed1 ti\u1ec1n c\xf2n l\u1ea1i"),o.gc(),o.hc(43,"p"),o.Rc(44),o.uc(45,"myCurrPipe"),o.gc(),o.gc(),o.hc(46,"div",20),o.hc(47,"label",21),o.Rc(48,"S\u1ed1 ti\u1ec1n thanh to\xe1n"),o.gc(),o.hc(49,"input",22),o.pc("input",(function(e){return t.onPayChanged(e.target.value)}))("focus",(function(e){return t.onPayFocus()}))("ngModelChange",(function(e){return t.currentPurchase.Amount=e})),o.gc(),o.gc(),o.hc(50,"div",20),o.hc(51,"label",23),o.Rc(52,"Ghi Ch\xfa"),o.gc(),o.hc(53,"input",24),o.pc("ngModelChange",(function(e){return t.currentPurchase.Note=e})),o.gc(),o.gc(),o.hc(54,"div",25),o.hc(55,"a",26),o.pc("click",(function(e){return t.selectPurType(t.purchaseType.Momo)})),o.cc(56,"img",27),o.gc(),o.hc(57,"a",26),o.pc("click",(function(e){return t.selectPurType(t.purchaseType.Banking)})),o.cc(58,"img",28),o.gc(),o.hc(59,"a",26),o.pc("click",(function(e){return t.selectPurType(t.purchaseType.Cash)})),o.cc(60,"img",29),o.gc(),o.gc(),o.hc(61,"div",30),o.hc(62,"div",3),o.hc(63,"button",4),o.pc("click",(function(e){return t.purchaseConfirm()})),o.Rc(64,"X\xe1c nh\u1eadn"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(65,"div",31),o.hc(66,"span"),o.Rc(67,"Qu\xe9t m\xe3 QR \u0111\u1ec3 thanh to\xe1n"),o.gc(),o.hc(68,"div"),o.cc(69,"qr-code",32),o.gc(),o.hc(70,"div",30),o.hc(71,"div",3),o.hc(72,"button",33),o.Rc(73,"Xong"),o.gc(),o.gc(),o.gc(),o.gc()),2&e&&(o.Ob(15),o.Ac("ngForOf",t.purchaseItems),o.Ob(5),o.Tc("",t.order.OrderId," "),o.Ob(4),o.Tc("",o.vc(25,13,t.totalBalance)," "),o.Ob(5),o.Tc("",o.vc(30,15,t.order.TotalAmount)," "),o.Ob(9),o.Sc(o.vc(39,17,t.order.TotalAmount)),o.Ob(6),o.Sc(o.vc(45,19,t.totalBalance)),o.Ob(5),o.Ac("ngModel",t.currentPurchase.Amount),o.Ob(4),o.Ac("ngModel",t.currentPurchase.Note),o.Ob(2),o.Ac("ngClass","Momo"===t.currentPurchase.Method?" img-purchase-selected":""),o.Ob(2),o.Ac("ngClass","Banking"===t.currentPurchase.Method?" img-purchase-selected":""),o.Ob(2),o.Ac("ngClass","Cash"===t.currentPurchase.Method?" img-purchase-selected":""),o.Ob(10),o.Ac("value",t.qrContent)("size",290))},directives:[g.k,k.b,k.k,k.n,g.j,R.a],pipes:[w.a,g.c,w.b],styles:[""]}),e})();function pi(e,t){if(1&e){const e=o.ic();o.hc(0,"div",34),o.pc("click",(function(i){o.Jc(e);const c=t.$implicit,r=t.index;return o.tc().selectItem(c,r)})),o.hc(1,"div",7),o.Rc(2),o.gc(),o.hc(3,"div",8),o.Rc(4),o.uc(5,"myCurrPipe"),o.gc(),o.hc(6,"div",9),o.Rc(7),o.uc(8,"myDatePipe"),o.gc(),o.gc()}if(2&e){const e=t.$implicit;o.Ob(2),o.Sc(e.Method),o.Ob(2),o.Sc(o.vc(5,3,e.Amount)),o.Ob(3),o.Tc("",o.wc(8,5,e.AddingTime,"HH:mm dd/MM/yyyy")," ")}}function fi(e,t){1&e&&(o.hc(0,"div"),o.Rc(1," S\u1ed1 ti\u1ec1n l\xe0 b\u1eaft bu\u1ed9c "),o.gc())}function bi(e,t){1&e&&(o.hc(0,"div"),o.Rc(1," S\u1ed1 ti\u1ec1n t\u1ed1i thi\u1ec3u 3 k\xfd t\u1ef1 "),o.gc())}function vi(e,t){if(1&e&&(o.hc(0,"div",35),o.Pc(1,fi,2,0,"div",36),o.Pc(2,bi,2,0,"div",36),o.gc()),2&e){o.tc();const e=o.Hc(27);o.Ob(1),o.Ac("ngIf",e.errors.required),o.Ob(1),o.Ac("ngIf",e.errors.minlength)}}const Oi=[{path:"login",component:_t},{path:"",component:Zt,children:[{path:"",component:li,canActivate:[r.f]},{path:"add-purchse",component:(()=>{class e extends f{constructor(e){super(),this.purchaseService=e,this.Title="Thanh to\xe1n n\u1eb7c danh",this.currentIndex=-1,this.purchaseMethod=v.h,this.currPurchase=new S.a,this.purchases=[],this.currentAddingTime=new Date}Init(){}selectItem(e,t){this.currentIndex=t,this.currPurchase=new S.a,this.currPurchase.Amount=e.Amount,this.currentAddingTime=new Date(e.AddingTime),this.currPurchase.Id=e.Id,this.currPurchase.Method=e.Method,this.currPurchase.OrderId=e.OrderId,this.currPurchase.Note=e.Note,openAddPurchaseDialog()}addPurchase(){this.currPurchase=new S.a,this.currPurchase.Amount=0,this.currentAddingTime=new Date,this.currPurchase.Id=0,this.currPurchase.Method=v.h.Banking,this.currPurchase.OrderId="",this.currPurchase.Note="",openAddPurchaseDialog()}onAmountChanged(e){this.currPurchase.Amount<10&&(this.currPurchase.Amount*=1e3,this.moveCursor(this.currPurchase.Amount.toString().length,"Amount")),this.currPurchase.Amount=+this.currPurchase.Amount}onAmountFocus(){this.currPurchase.Amount||(this.currPurchase.Amount=0),this.moveCursor(this.currPurchase.Amount.toString().length,"Amount")}purchaseSaving(e){e.valid&&(this.currentIndex>-1?(Object.assign(this.purchases[this.currentIndex],this.currPurchase),this.purchases[this.currentIndex].AddingTime=this.currentAddingTime.getTime(),this.currentIndex=-1):(this.currPurchase.AddingTime=this.currentAddingTime.getTime(),this.purchases.push(this.currPurchase)),dissmissAddPurchaseDialog())}saveChanges(){this.purchases.length<=0||this.purchaseService.bulkCreate(this.purchases,"",()=>{this.purchases=[]})}}return e.\u0275fac=function(t){return new(t||e)(o.bc(T.a))},e.\u0275cmp=o.Vb({type:e,selectors:[["app-add-purchase"]],features:[o.Lb],decls:57,vars:12,consts:[["id","customerInfo",1,"page-content"],[1,"container"],[1,"row","checkTop","search"],[1,"col-12","mx-auto","text-center"],["type","button",1,"btn","main-btn","w-100",3,"click"],[1,"nameTable"],[1,"tableHead"],[1,"tableLeft","small-width"],[1,"tableCenter"],[1,"tableRight","large-width"],["id","customer-list",1,"tableBody","cusScroll"],["class","tableRow main-bg customer-item",3,"click",4,"ngFor","ngForOf"],["id","addPurchase",1,"popup-content"],["autocomplete","on",1,"addInfoForm",3,"submit"],["form","ngForm"],[1,"form-group"],["for","Amount",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Amount","id","Amount","required","","minlength","3","placeholder","S\xf4 ti\u1ec1n...",1,"mainForm",3,"ngModel","input","focus","ngModelChange"],["Amount","ngModel"],["class","alert alert-danger",4,"ngIf"],["for","Note",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Note","id","Note",1,"mainForm",3,"ngModel","ngModelChange"],["for","Method",2,"width","100%","text-align","left","margin-bottom","0px"],["id","Method","name","Method",1,"mainForm",3,"ngModel","ngModelChange"],["selected",""],[3,"ngValue"],["for","currentAddingTime",2,"width","100%","text-align","left","margin-bottom","0px"],["name","currentAddingTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],[1,"row"],[1,"col-6","mx-auto","text-center"],["type","button","id","cancel-button","onClick","dissmissAddPurchaseDialog()",1,"btn","grey-btn","w-100","mt-3"],["type","submit",1,"btn","main-btn","w-100","mt-3","btn-success"],[1,"tableRow","main-bg","customer-item",3,"click"],[1,"alert","alert-danger"],[4,"ngIf"]],template:function(e,t){if(1&e){const e=o.ic();o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"div",2),o.hc(3,"div",3),o.hc(4,"button",4),o.pc("click",(function(e){return t.addPurchase()})),o.Rc(5,"Th\xeam thanh to\xe1n"),o.gc(),o.gc(),o.gc(),o.hc(6,"div",5),o.hc(7,"div",6),o.hc(8,"div",7),o.Rc(9,"H\xecnh th\u1ee9c"),o.gc(),o.hc(10,"div",8),o.Rc(11,"S\u1ed1 ti\u1ec1n"),o.gc(),o.hc(12,"div",9),o.Rc(13,"Th\u1eddi gian"),o.gc(),o.gc(),o.hc(14,"div",10),o.Pc(15,pi,9,8,"div",11),o.gc(),o.gc(),o.hc(16,"div",2),o.hc(17,"div",3),o.hc(18,"button",4),o.pc("click",(function(e){return t.saveChanges()})),o.Rc(19,"L\u01b0u"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(20,"div",12),o.hc(21,"form",13,14),o.pc("submit",(function(i){o.Jc(e);const c=o.Hc(22);return t.purchaseSaving(c)})),o.hc(23,"div",15),o.hc(24,"label",16),o.Rc(25,"S\u1ed1 ti\u1ec1n"),o.gc(),o.hc(26,"input",17,18),o.pc("input",(function(e){return t.onAmountChanged(e.target.value)}))("focus",(function(e){return t.onAmountFocus()}))("ngModelChange",(function(e){return t.currPurchase.Amount=e})),o.gc(),o.Pc(28,vi,3,2,"div",19),o.gc(),o.hc(29,"div",15),o.hc(30,"label",20),o.Rc(31,"Ghi Ch\xfa"),o.gc(),o.hc(32,"input",21),o.pc("ngModelChange",(function(e){return t.currPurchase.Note=e})),o.gc(),o.gc(),o.hc(33,"div",15),o.hc(34,"label",22),o.Rc(35,"H\xecnh th\u1ee9c thanh to\xe1n"),o.gc(),o.hc(36,"select",23),o.pc("ngModelChange",(function(e){return t.currPurchase.Method=e})),o.hc(37,"option",24),o.Rc(38,"Ch\u1ecdn..."),o.gc(),o.hc(39,"option",25),o.Rc(40,"Ti\u1ec1n m\u1eb7t"),o.gc(),o.hc(41,"option",25),o.Rc(42,"Chuy\u1ec3n kho\u1ea3n"),o.gc(),o.hc(43,"option",25),o.Rc(44,"V\xed Momo"),o.gc(),o.gc(),o.gc(),o.hc(45,"label",26),o.Rc(46,"Th\u1eddi gian"),o.gc(),o.hc(47,"input",27),o.pc("ngModelChange",(function(e){return t.currentAddingTime=e})),o.gc(),o.cc(48,"owl-date-time",28,29),o.hc(50,"div",30),o.hc(51,"div",31),o.hc(52,"button",32),o.Rc(53,"H\u1ee7y"),o.gc(),o.gc(),o.hc(54,"div",31),o.hc(55,"button",33),o.Rc(56,"L\u01b0u"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc()}if(2&e){const e=o.Hc(27),i=o.Hc(49);o.Ob(15),o.Ac("ngForOf",t.purchases),o.Ob(11),o.Ac("ngModel",t.currPurchase.Amount),o.Ob(2),o.Ac("ngIf",e.invalid&&(e.dirty||e.touched)),o.Ob(4),o.Ac("ngModel",t.currPurchase.Note),o.Ob(4),o.Ac("ngModel",t.currPurchase.Method),o.Ob(3),o.Ac("ngValue",t.purchaseMethod.Cash),o.Ob(2),o.Ac("ngValue",t.purchaseMethod.Banking),o.Ob(2),o.Ac("ngValue",t.purchaseMethod.Momo),o.Ob(4),o.Ac("owlDateTime",i)("owlDateTimeTrigger",i)("ngModel",t.currentAddingTime),o.Ob(1),o.Ac("stepMinute",5)}},directives:[g.k,k.v,k.l,k.m,k.b,k.r,k.h,k.k,k.n,g.l,k.s,k.o,k.u,y.c,y.f,y.b],pipes:[w.a,w.b],styles:[""]}),e})(),canActivate:[r.b]},{path:"final-confirm",component:z,canActivate:[r.b]},{path:"view-purchase",component:mi,canActivate:[r.b]},{path:"customer-confirming",component:W,canActivate:[r.a]},{path:"shipper-main",component:Ht,canActivate:[r.a]},{path:"sort-order-changing",component:Qt,canActivate:[r.b]},{path:"florist-main",component:Me,canActivate:[r.d]},{path:"order-detail-confirming",component:Ve,canActivate:[r.a]},{path:"orders-manage",canActivate:[r.b],component:ht},{path:"select-customer",component:Pt,canActivate:[r.b]},{path:"order-detail/:id",component:ze,canActivate:[r.b]},{path:"search-product",component:xt,canActivate:[r.b]},{path:"add-order",component:x,canActivate:[r.b]},{path:"select-receiver",component:Bt,canActivate:[r.b]},{path:"order-detail-view",component:di,canActivate:[r.e]}]}];let Di=(()=>{class e{}return e.\u0275mod=o.Zb({type:e}),e.\u0275inj=o.Yb({factory:function(t){return new(t||e)},imports:[[c.d.forChild(Oi),n.a],c.d]}),e})()}}]);