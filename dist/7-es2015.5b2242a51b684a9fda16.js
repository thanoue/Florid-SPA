(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"711k":function(e,t,i){"use strict";i.r(t),i.d(t,"ROUTES",(function(){return hi})),i.d(t,"StaffModule",(function(){return di}));var c=i("tyNb"),r=i("+XmF"),n=i("d2mR"),o=i("mrSG"),a=i("fXoL"),s=i("IAJr"),h=i("F2nW"),d=i("QGCU");class l{constructor(e,t){this.Title=e,this.NavigateClass=t}}var g=i("ofXK"),u=i("CVMR"),p=i("oz8C");let m=(()=>{class e{constructor(){this.IsDataLosingWarning=!0,this.NavigateClass="prev-icon";const e=s.a.getInjector();this.globalService=e.get(h.a),this.authService=e.get(d.a),this.location=e.get(g.h),this.ngZone=e.get(a.H),this.addressService=e.get(u.a)}get isEdittingOrder(){return this.globalService.isEdittingOrder}set isEdittingOrder(e){this.globalService.isEdittingOrder=e}get globalPurchases(){return this.globalService.currentPurchases}set globalPurchases(e){this.globalService.currentPurchases=e}get globalOrder(){return this.globalService.currentOrderViewModel}set globalOrder(e){this.globalService.currentOrderViewModel=e}get globalOrderDetail(){return this.globalService.currentOrderDetailViewModel}set globalOrderDetail(e){this.globalService.currentOrderDetailViewModel=e}get globalDistricts(){return this.globalService.currentDistricts}set globalDistricts(e){this.globalService.currentDistricts=e}get globalwards(){return this.globalService.currentWards}set globalwards(e){this.globalService.currentWards=e}get CurrentUser(){return{FullName:p.a.getUserName(),Role:p.a.getRole(),Avt:p.a.getUserAvtUrl(),Id:p.a.getUserId(),PhoneNumber:p.a.getPhoneNumber()}}ngOnInit(){window.BaseReference={component:this,zone:this.ngZone,dateTimeSelected:(e,t,i,c,r)=>this.dateTimeSelected(e,t,i,c,r),forceBackNavigate:()=>this.backNavigateOnClick(),fileChosen:e=>this.fileChosen(e),printConfirm:e=>this.printConfirm(e),rememberPassConfirm:()=>this.rememberPassConfirm(),savedLoginInforReturn:(e,t)=>this.savedLoginInforReturn(e,t)},this.IsOnTerminal=this.globalService.isRunOnTerimal(),this.Init()}menuOpening(e,t){menuOpen(e,t)}savedLoginInforReturn(e,t){}moveCursor(e,t){setTimeout(()=>{e>3&&moveCursor(t,e-3)},10)}askForRememberPassword(){this.globalService.isRememberPassWillCheck&&(this.globalService.isRememberPassWillCheck=!1,this.globalService.isOnMobile()&&isRememberPassChecking())}rememberPassConfirm(){this.openConfirm("B\u1ea1n mu\u1ed1n l\u01b0u th\xf4ng tin \u0111\u0103ng nh\u1eadp?",()=>{passwordSaving()},()=>{passwordClearing()})}ngOnDestroy(){this.navigateOnClick.unsubscribe(),this.destroy()}ngAfterViewInit(){this.globalService.updaterMobileHeaderInfo(new l(this.Title,this.NavigateClass)),this.navigateOnClick=this.globalService.navigateOnClick.subscribe(e=>{e&&this.backNavigateOnClick()})}printConfirm(e){this.openConfirm("In th\xeam b\u1ea3n?",()=>{e()},()=>{})}selectAddress(e){this.globalwards.length<=0?this.addressService.getAllDistrict().then(t=>{this.globalDistricts=t,this.addressService.getAllWards().then(t=>{this.globalwards=t,this.addressRequest(e)})}):this.addressRequest(e)}addressRequest(e){addressRequest(this.globalDistricts,e,(e,t)=>{t(this.globalwards.filter(t=>t.DistrictId===e))})}dateTimeSelected(e,t,i,c,r){}showError(e){this.globalService.showError(e)}showInfo(e){this.globalService.showInfo(e)}showSuccess(e){this.globalService.showSuccess(e)}showWarning(e){this.globalService.showWarning(e)}openFile(){pickFile(!1)}openFileForShare(){pickFile(!0)}startLoading(){this.globalService.startLoading()}stopLoading(){this.globalService.stopLoading()}setStatusBarColor(e){this.globalService.setStatusBarColor(e)}OnBackNaviage(){this.location.back()}backNavigateOnClick(){this.IsDataLosingWarning?this.openConfirm("D\u1eef li\u1ec7u hi\u1ec7n t\u1ea1i s\u1ebd b\u1ecb m\u1ea5t! B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn?",()=>{this.OnBackNaviage()}):this.OnBackNaviage()}destroy(){}fileChosen(e){}openConfirm(e,t,i,c,r,n){this.globalService.openMobileConfirm(e,t,i,c,r,n)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=a.Wb({type:e}),e})();var f=i("r5y0"),b=i("2pNN"),v=i("+hdJ"),O=i("jXcA"),S=i("TjQO"),D=i("Abtb"),I=i("uP5C"),C=i("kVqo"),P=i("0zL+"),A=i("kGcc"),k=i("EeL4"),y=i("NWHx"),T=i("3Pt+"),R=i("O0x4"),w=i("wRGf"),M=i("jjJn");function F(e,t){if(1&e){const e=a.ic();a.hc(0,"li",73),a.hc(1,"div",74),a.hc(2,"span"),a.Rc(3),a.gc(),a.gc(),a.hc(4,"div",75),a.cc(5,"img",76),a.uc(6,"ImgPipe"),a.hc(7,"div",77),a.hc(8,"h5",78),a.Rc(9),a.gc(),a.hc(10,"span",79),a.Rc(11),a.uc(12,"myCurrPipe"),a.gc(),a.hc(13,"span",80),a.Rc(14),a.gc(),a.hc(15,"span",80),a.Rc(16),a.uc(17,"myCurrPipe"),a.gc(),a.hc(18,"span",80),a.Rc(19),a.uc(20,"myCurrPipe"),a.gc(),a.gc(),a.gc(),a.hc(21,"div",81),a.hc(22,"a",82),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit;return a.tc().deleteOrderDetail(c.Index)})),a.cc(23,"img",83),a.gc(),a.hc(24,"a",82),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit;return a.tc().editOrderDetail(c.Index)})),a.cc(25,"img",84),a.gc(),a.gc(),a.gc()}if(2&e){const e=t.$implicit,i=a.tc();a.Ob(3),a.Sc(e.Index+1),a.Ob(2),a.Bc("src",a.wc(6,7,e.ProductImageUrl,"ProductImg"),a.Lc),a.Ob(4),a.Sc(e.ProductName),a.Ob(2),a.Tc("",a.vc(12,10,e.ModifiedPrice)," "),a.Ob(3),a.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.Quantity," "),a.Ob(2),a.Tc("Ph\u1ee5 ph\xed: ",a.vc(17,12,e.AdditionalFee)," "),a.Ob(3),a.Tc("Gi\u1ea3m gi\xe1: ",a.vc(20,14,i.getDetailDiscount(e)),"")}}function N(e,t){if(1&e){const e=a.ic();a.hc(0,"li",85),a.pc("click",(function(i){a.Jc(e);const c=t.index;return a.tc().selectPromotion(c)})),a.hc(1,"p",86),a.Rc(2),a.gc(),a.hc(3,"span",87),a.Rc(4),a.gc(),a.hc(5,"span",88),a.Rc(6),a.uc(7,"myDatePipe"),a.uc(8,"myDatePipe"),a.gc(),a.gc()}if(2&e){const e=t.$implicit,i=t.index,c=a.tc();a.Pb("data-index",i),a.Ob(2),a.Sc(e.Name),a.Ob(2),a.Sc(c.getPromotionAmount(e)),a.Ob(2),a.Uc("",a.vc(7,5,e.StartTime),"-",a.vc(8,7,e.EndTime),"")}}let x=(()=>{class e extends m{constructor(e,t,i,c,r,n){super(),this.router=e,this.orderService=t,this.customerService=i,this.printJobService=c,this.promotionService=r,this.purchaseService=n,this.Title="Th\xeam \u0110\u01a1n",this.memberShipTitle="",this.totalBalance=0,this.orderDiscount=0,this.isPurchased=!1,this.purchaseType=b.g,this.qrContentTemplate="",this.purchaseNote="",this.promotions=[],this.currentPayAmount=0,this.qrContent=""}get AcctualBalance(){if(!this.order)return 0;let e=0;return this.globalPurchases.forEach(t=>{t.Status==b.h.Completed&&(e+=t.Amount)}),this.order.TotalAmount-e}Init(){if(this.promotionService.getAvailablePromotions((new Date).getTime(),!1).then(e=>{this.promotions=e}),this.order=this.globalOrder,!this.isEdittingOrder&&(this.memberShipTitle="New Customer",!this.order.OrderId)){let e=(new Date).getFullYear();this.orderService.getMaxNumberId(e).then(t=>{null==t&&(t=0),this.order.OrderId=`${e%100}.${(t+1).toString()}`})}switch(this.onVATIncludedChange(),this.order.CustomerInfo.MembershipType){case b.c.NewCustomer:this.memberShipTitle="New Customer";break;case b.c.Member:this.memberShipTitle="Member";break;case b.c.Vip:this.memberShipTitle="VIP";break;case b.c.VVip:this.memberShipTitle="VVIP";break;default:this.memberShipTitle="New Customer"}this.totalBalance=this.order.TotalAmount-this.order.TotalPaidAmount}onMemberDiscountChange(){this.totalAmountCalculate()}getPromotionAmount(e){return e.PromotionType==S.b.Amount?e.Amount+" \u20ab":e.Amount+" %"}selectPromotion(e){this.order.AmountDiscount=this.order.PercentDiscount=0;let t=this.promotions[e];t.PromotionType==S.b.Amount?this.order.AmountDiscount=t.Amount:this.order.PercentDiscount=t.Amount,hideReceiverPopup(),this.onVATIncludedChange()}completingOrder(){this.placeOrder(!0)}editOrder(){const e=[],t=[];this.order.OrderDetails.forEach(i=>{const c=new O.f;c.OrderId=this.globalOrder.OrderId,c.Id=i.OrderDetailId,c.State=i.State,c.CustomerName=this.globalOrder.CustomerInfo.Name,c.CustomerPhoneNumber=this.globalOrder.CustomerInfo.PhoneNumber;const r=new O.a;r.Address=i.DeliveryInfo.Address?i.DeliveryInfo.Address:this.order.CustomerInfo.Address?this.order.CustomerInfo.Address:"",r.FullName=i.DeliveryInfo.FullName?i.DeliveryInfo.FullName:this.order.CustomerInfo.Name?this.order.CustomerInfo.Name:"",r.PhoneNumber=i.DeliveryInfo.PhoneNumber?i.DeliveryInfo.PhoneNumber:this.order.CustomerInfo.PhoneNumber?this.order.CustomerInfo.PhoneNumber:"",c.DeliveryInfo.ReceivingTime=i.DeliveryInfo.DateTime?i.DeliveryInfo.DateTime.getTime():(new Date).getTime(),c.DeliveryInfo.ReceiverDetail=r,e.push(c);let n=!0;t.forEach(e=>{v.a.receiverInfoCompare(e,r)&&(n=!1)}),n&&t.push(r)}),this.globalOrder.CustomerInfo.ReceiverInfos.forEach(e=>{let i=!0;t.forEach(t=>{v.a.receiverInfoCompare(e,t)&&(i=!1)}),i&&t.push(e)}),this.globalPurchases.length>0&&this.purchaseService.bulkCreate(this.globalPurchases,this.order.OrderId,()=>{this.globalPurchases=[]}),this.orderService.updateOrderInfos(this.order.OrderId,e,this.order.TotalPaidAmount,this.order.CustomerInfo.Id).then(()=>{"KHACH_LE"!=this.order.CustomerInfo.Id?this.customerService.updateReceiverList(this.order.CustomerInfo.Id,t).then(e=>{this.OnBackNaviage()}):this.OnBackNaviage()})}placeOrder(e){this.currentPayAmount=this.order.TotalAmount-this.order.TotalPaidAmount,this.order.CustomerInfo&&this.order.CustomerInfo.Id||(this.order.CustomerInfo=new f.a,this.order.CustomerInfo.Id="KHACH_LE",this.order.CustomerInfo.Name="Kh\xe1ch l\u1ebb"),this.isEdittingOrder?this.editOrder():!this.order.OrderDetails||this.order.OrderDetails.length<=0?this.showError("Ch\u01b0a ch\u1ecdn s\u1ea3n ph\u1ea9m n\xe0o!"):!this.order.TotalAmount||this.order.TotalAmount<=0?this.showError("Th\xe0nh ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!"):this.order.TotalPaidAmount<=0?this.openConfirm("Ho\xe1 \u0111\u01a1n ch\u01b0a \u0111\u01b0\u1ee3c thanh to\xe1n, c\xf3 mu\u1ed1n ti\u1ebfp t\u1ee5c?",()=>{this.addPurchase()},()=>{this.printConfirmation(e)},null,"Thanh To\xe1n","Ti\u1ebfp t\u1ee5c"):this.printConfirmation(e)}addPurchase(){this.currentPayAmount=this.totalBalance,this.currentPurType=b.g.Cash,this.currentPurStatus=b.h.Completed,this.purchaseNote="",purchaseDoing()}printConfirmation(e){this.order.CreatedDate||(this.order.CreatedDate=new Date),this.order.CustomerInfo.GainedScore=v.a.getScoreFromOrder(this.order),this.openConfirm("In ho\xe1 \u0111\u01a1n?",()=>{this.doPrintJob(e)},()=>{this.orderConfirm(e)},()=>{})}getDetailDiscount(e){return v.a.getDetailDiscount(e)}doPrintJob(e){let t=0;const i=[];this.order.OrderDetails.forEach(e=>{i.push({productName:e.ProductName,index:e.Index+1,price:e.ModifiedPrice,additionalFee:e.AdditionalFee,discount:v.a.getDetailDiscount(e),quantity:e.Quantity}),t+=e.ModifiedPrice*e.Quantity});let c=[];this.globalPurchases.forEach(e=>{e.Status==b.h.Completed&&c.push({method:e.Method,amount:e.Amount,status:e.Status})});const r={Created:(new Date).getTime(),Id:this.order.OrderId,Active:!0,IsDeleted:!1,saleItems:i,createdDate:this.order.CreatedDate.toLocaleString("en-US",{hour12:!0}),orderId:this.order.OrderId,summary:t,totalAmount:this.order.TotalAmount,totalPaidAmount:this.order.TotalAmount-this.AcctualBalance,totalBalance:this.totalBalance,vatIncluded:this.order.VATIncluded,memberDiscount:this.order.CustomerInfo.DiscountPercent,scoreUsed:this.order.CustomerInfo.ScoreUsed,gainedScore:this.order.CustomerInfo.GainedScore,totalScore:this.order.CustomerInfo.AvailableScore-this.order.CustomerInfo.ScoreUsed+this.order.CustomerInfo.GainedScore,customerName:this.order.CustomerInfo.Name,customerId:this.order.CustomerInfo.Id,discount:this.orderDiscount,isMemberDiscountApply:this.order.IsMemberDiscountApply,purchaseItems:c};this.printJobService.addPrintJob(r),this.orderConfirm(e)}orderConfirm(e){this.startLoading();const t=new O.e;t.CustomerId=this.order.CustomerInfo.Id,t.Id=this.order.OrderId,t.Created=this.order.CreatedDate.getTime(),t.VATIncluded=this.order.VATIncluded,t.TotalAmount=this.order.TotalAmount,t.TotalPaidAmount=this.order.TotalPaidAmount,t.GainedScore=this.order.CustomerInfo.GainedScore,t.ScoreUsed=this.order.CustomerInfo.ScoreUsed,t.Index=this.order.Index,t.OrderType=this.order.OrderType,t.PercentDiscount=this.order.PercentDiscount,t.AmountDiscount=this.order.AmountDiscount,t.IsMemberDiscountApply=this.order.IsMemberDiscountApply,t.DoneTime=e?(new Date).getTime():0,this.orderService.addOrEditOrder(t,this.isEdittingOrder).then(i=>Object(o.a)(this,void 0,void 0,(function*(){this.globalPurchases.length>0&&this.purchaseService.bulkCreate(this.globalPurchases,t.Id,()=>{this.globalPurchases=[]});const i=[],c=[];this.order.OrderDetails.forEach(r=>{const n=new O.f;n.OrderId=t.Id,n.IsHardcodeProduct=r.IsFromHardCodeProduct,n.HardcodeProductImageName=r.HardcodeImageName,n.ProductId=r.ProductId,n.ProductImageUrl=r.ProductImageUrl,n.ProductPrice=r.ModifiedPrice,n.AdditionalFee=r.AdditionalFee,n.ProductName=r.ProductName,n.Description=r.Description,n.State=e?b.e.Completed:b.e.Added,n.IsVATIncluded=t.VATIncluded,n.PurposeOf=r.PurposeOf,n.Index=r.Index,n.PercentDiscount=r.PercentDiscount,n.AmountDiscount=r.AmountDiscount,n.Quantity=r.Quantity,n.CustomerName=this.order.CustomerInfo.Name,n.CustomerPhoneNumber=this.order.CustomerInfo.PhoneNumber;const o=new O.a;o.Address=r.DeliveryInfo.Address?r.DeliveryInfo.Address:this.order.CustomerInfo.Address?this.order.CustomerInfo.Address:"",o.FullName=r.DeliveryInfo.FullName?r.DeliveryInfo.FullName:this.order.CustomerInfo.Name?this.order.CustomerInfo.Name:"",o.PhoneNumber=r.DeliveryInfo.PhoneNumber?r.DeliveryInfo.PhoneNumber:this.order.CustomerInfo.PhoneNumber?this.order.CustomerInfo.PhoneNumber:"",n.DeliveryInfo.ReceivingTime=r.DeliveryInfo.DateTime?r.DeliveryInfo.DateTime.getTime():(new Date).getTime(),n.DeliveryInfo.ReceiverDetail=o,i.push(n);let a=!0;c.forEach(e=>{v.a.receiverInfoCompare(e,o)&&(a=!1)}),a&&c.push(o)}),this.globalOrder.CustomerInfo.ReceiverInfos.forEach(e=>{let t=!0;c.forEach(i=>{v.a.receiverInfoCompare(e,i)&&(t=!1)}),t&&c.push(e)}),yield this.orderService.deleteOrderDetailByOrderId(t.Id),this.orderService.addOrderDetails(i).then(()=>{"KHACH_LE"!=t.CustomerId?this.customerService.updateReceiverList(t.CustomerId,c).then(e=>{this.stopLoading(),e&&this.completeOrder()}):(this.stopLoading(),this.completeOrder())}).catch(e=>{console.log(e),this.globalService.stopLoading(),this.showError(e.toString())})})))}selectPurType(e){this.currentPurType=e,e==b.g.Momo&&this.currentPayAmount>0&&(this.qrContent=this.qrContentTemplate+this.currentPayAmount.toString(),openQR())}purchaseConfirm(){if(this.currentPayAmount>this.totalBalance||this.currentPayAmount<=0)return void this.showError("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!");let e=new D.a;e.OrderId=this.order.OrderId,e.Amount=+this.currentPayAmount,e.Method=this.currentPurType,e.Status=this.currentPurStatus,e.Note=this.purchaseNote,e.AddingTime=(new Date).getTime(),this.globalPurchases.push(e),this.order.TotalPaidAmount+=e.Amount,this.currentPayAmount=0,this.showSuccess("\u0110\xe3 th\xeam 1 thanh to\xe1n!"),this.totalAmountCalculate(),this.totalBalance<=0?dismissPurchaseDialog():(this.currentPayAmount=this.totalBalance,this.currentPurType=b.g.Cash,this.currentPurStatus=b.h.Completed)}totalAmountCalculate(){this.order.TotalAmount=0,this.order.OrderDetails.forEach(e=>{e.AdditionalFee||(e.AdditionalFee=0);let t=e.ModifiedPrice*e.Quantity,i=t;e.PercentDiscount&&e.PercentDiscount>0&&(i-=i/100*e.PercentDiscount),e.AmountDiscount&&e.AmountDiscount>0&&(i-=e.AmountDiscount),this.order.TotalAmount+=this.order.CustomerInfo&&this.order.CustomerInfo.DiscountPercent&&this.order.CustomerInfo.DiscountPercent>0&&this.order.IsMemberDiscountApply?i-t/100*this.order.CustomerInfo.DiscountPercent+e.AdditionalFee:i+e.AdditionalFee}),this.orderDiscount=0,this.order.PercentDiscount&&this.order.PercentDiscount>0&&(this.orderDiscount=this.order.TotalAmount/100*this.order.PercentDiscount,this.order.TotalAmount-=this.orderDiscount),this.order.AmountDiscount&&this.order.AmountDiscount>0&&(this.order.TotalAmount=this.order.TotalAmount-this.order.AmountDiscount,this.orderDiscount+=this.order.AmountDiscount),this.order.VATIncluded&&(this.order.TotalAmount=this.order.TotalAmount+.1*this.order.TotalAmount),this.order.TotalAmount-=v.a.geExchangableAmount(this.order.CustomerInfo.ScoreUsed),this.totalBalance=this.order.TotalAmount-this.order.TotalPaidAmount}onDiscountChanged(e){this.onVATIncludedChange()}onPayChanged(e){this.currentPayAmount<10&&this.currentPayAmount>0&&(this.currentPayAmount*=1e3,this.moveCursor(this.currentPayAmount.toString().length,"currentPayAmount")),this.currentPayAmount=+this.currentPayAmount}onPayFocus(){this.currentPayAmount||(this.currentPayAmount=0),this.moveCursor(this.currentPayAmount.toString().length,"currentPayAmount")}onAmountDiscountChanged(e){this.order.AmountDiscount<10&&this.order.AmountDiscount>0&&(this.order.AmountDiscount*=1e3,this.moveCursor(this.order.AmountDiscount.toString().length,"AmountDiscount")),this.order.AmountDiscount=+this.order.AmountDiscount,this.onVATIncludedChange()}onAmountDiscountFocus(){this.order.AmountDiscount||(this.order.AmountDiscount=0),this.moveCursor(this.order.AmountDiscount.toString().length,"AmountDiscount")}onVATIncludedChange(){this.totalAmountCalculate()}scoreExchange(){openExcForm((e,t)=>this.order.CustomerInfo.AvailableScore<e?(this.showError("V\u01b0\u1ee3t qu\xe1 \u0111i\u1ec3m t\xedch l\u0169y!!"),void t.call(this,!1)):v.a.geExchangableAmount(e)>=this.totalBalance?(this.showError("V\u01b0\u1ee3t qu\xe1 t\u1ed5ng ti\u1ec1n thanh to\xe1n!"),void t.call(this,!1)):(t.call(this,!0),this.order.CustomerInfo.ScoreUsed=e,void this.onVATIncludedChange()))}addNewOrderDetail(){this.globalOrderDetail=new f.c,this.router.navigate(["/staff/order-detail/-1"])}editOrderDetail(e){menuOpen(t=>{const i=f.c.DeepCopy(this.order.OrderDetails[e]);switch(+t){case 0:this.globalOrderDetail=i,this.router.navigate(["/staff/order-detail/"+e]);break;case 1:i.Index=this.order.OrderDetails.length,this.order.OrderDetails.push(i),this.onVATIncludedChange()}},["Ch\u1ec9nh s\u1eeda","Sao ch\xe9p"])}deleteOrderDetail(e){this.openConfirm("Ch\u1eafc ch\u1eafn xo\xe1?",()=>{this.order.OrderDetails.splice(e,1);let t=0;this.order.OrderDetails.forEach(e=>{e.Index=t,t++}),this.onVATIncludedChange()})}completeOrder(){if("KHACH_LE"==this.order.CustomerInfo.Id)return void this.OnBackNaviage();let e=new I.d,t=v.a.getScoreFromOrder(this.order);e.AvailableScore=this.order.CustomerInfo.AvailableScore-this.order.CustomerInfo.ScoreUsed+t,e.AccumulatedAmount=this.order.CustomerInfo.AccumulatedAmount+v.a.getAmountFromScore(t),e.UsedScoreTotal=this.order.CustomerInfo.CustomerScoreUsedTotal+this.order.CustomerInfo.ScoreUsed,e.MembershipType=v.a.detectMemberShipType(e.AccumulatedAmount),this.customerService.updateFields(this.order.CustomerInfo.Id,{UsedScoreTotal:e.UsedScoreTotal,AvailableScore:e.AvailableScore,AccumulatedAmount:e.AccumulatedAmount,MembershipType:e.MembershipType}).then(e=>{this.OnBackNaviage()})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(c.b),a.bc(C.a),a.bc(P.a),a.bc(A.a),a.bc(k.a),a.bc(y.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-add-order"]],features:[a.Lb],decls:144,vars:36,consts:[["id","confirm",1,"page-content"],[1,"container"],[1,"row","custBrow",2,"margin-bottom","1vh"],[1,"col-10","custList"],["routerLink","/staff/select-customer",1,"main-bg","custListButton"],["src","../../../../assets/images/cust.png","alt",""],["behavior","scroll","direction","left"],[1,"col-2","prodAdd","text-right","pl-0"],[1,"main-bg",3,"click"],["src","../../../../assets/images/add.svg","alt","",1,"main-filter"],[1,"vatStatus"],[1,"vatScope"],["type","checkbox","id","IsMemberDiscountApply","name","IsMemberDiscountApply","value","1",1,"custom-checkbox",3,"ngModel","change","ngModelChange"],[1,"main-bg","vatCustom"],[1,"title-field"],[1,"form-group","orderInfo","borderless-field"],["type","text","name","OrderId","id","OrderId","placeholder","M\xe3 \u0111\u01a1n...",1,"orderField","small-height",3,"ngModel","readonly","ngModelChange"],["href","javascript:void(0)","onclick","openCustMenu()","type","button",1,"btn","main-btn","w-100",2,"margin-bottom","1vh"],[1,"row","col-xs-12",2,"height","62px","padding-left","15px","padding-right","15px"],[1,"addInfo",2,"width","50%","padding-right","5px"],[1,"form-group","orderInfo","borderless-field",2,"margin-bottom","1vh"],["type","number","name","PercentDiscount","id","PercentDiscount","placeholder","%",1,"orderField","small-height",3,"ngModel","input","ngModelChange"],[1,"addInfo",2,"width","50%","padding-left","5px"],["type","tel","name","AmountDiscount","id","AmountDiscount","placeholder","0",1,"orderField","small-height",3,"ngModel","ngModelChange","input","focus"],[1,"orderDetail","cusScroll"],["class","orderDetailItem",4,"ngFor","ngForOf"],["type","checkbox","id","VATIncluded","name","VATIncluded","value","1",1,"custom-checkbox",3,"ngModel","change","ngModelChange"],[1,"orderTotal"],[1,"totalOld"],[1,"orderPrice"],[1,"totalNew"],[1,"totalExc"],["href","javascript:void(0)","type","button",1,"btn","main-btn","w-100",2,"margin-top","2vh",3,"click"],[1,"row","orderConfirm","text-center"],[1,"col-4","exchange"],[1,"btn","main-bg","w-100",3,"click"],["src","../../../../assets/images/money.svg","alt","\u0110\u1ed5i \u0111i\u1ec3m",1,"main-filter"],[1,"col-8","pl-0"],["href","javascript:void(0)","type","submit",1,"btn","main-btn","w-100",3,"click"],["id","exchangeAdd",1,"popup-content"],["action","",1,""],[1,"form-group"],["for","",1,"excLabel"],[1,"memberLevel","v"],[1,""],["type","number","name","","id","exchange-val","placeholder","S\u1ed1 \u0111i\u1ec3m mu\u1ed1n \u0111\u1ed5i...",1,"mainForm"],[1,"row"],[1,"col-8","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-3","exchange-confirm"],["id","recentInfo",1,"actionMenu2"],["style","height: 69px;text-align: left;",3,"click",4,"ngFor","ngForOf"],["id","purchase-dialog",1,"popup-content"],[1,"checkOut",2,"margin-top","0px","padding","0px"],[1,"checkOutTotal"],[1,"checkOutLeft","mb-2"],["for","currentPayAmount",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","currentPayAmount","id","currentPayAmount",1,"mainForm",3,"ngModel","input","focus","ngModelChange"],["for","Note",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","purchaseNote","id","purchaseNote",1,"mainForm",3,"ngModel","ngModelChange"],["for","currentPurStatus",2,"width","100%","text-align","left","margin-bottom","0px"],["id","currentPurStatus","name","currentPurStatus",1,"mainForm",3,"ngModel","ngModelChange"],["selected",""],[3,"ngValue"],[1,"form-group","methodGrid","mb-0"],["href","javascript:void(0)",1,"methodItem",3,"ngClass","click"],["src","../../../../assets/images/momo.jpg","alt",""],["src","../../../../assets/images/banking.jpg","alt",""],["src","../../../../assets/images/cash.png","alt",""],[1,"col-12","mx-auto","text-center"],["type","button",1,"btn","main-btn","w-100",3,"click"],["id","codeQR",1,"popup-content"],[3,"value","size"],["type","button","id","submit-btn","onClick","qrDone()",1,"btn","main-btn","w-100","mt-3"],[1,"orderDetailItem"],[1,"itemNumb"],[1,"itemDetail"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPrice"],[1,"prodCharge"],[1,"itemAction"],[3,"click"],["src","../../../../assets/images/delete.svg","alt","",1,"white-filter"],["src","../../../../assets/images/edit.svg","alt","",1,"white-filter"],[2,"height","69px","text-align","left",3,"click"],[1,"recentInfo-name"],[1,"recentInfo-phone",2,"width","25%"],[1,"recentInfo-date",2,"width","75%"]],template:function(e,t){1&e&&(a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"div",2),a.hc(3,"div",3),a.hc(4,"a",4),a.cc(5,"img",5),a.hc(6,"marquee",6),a.Rc(7),a.gc(),a.gc(),a.gc(),a.hc(8,"div",7),a.hc(9,"a",8),a.pc("click",(function(e){return t.addNewOrderDetail()})),a.cc(10,"img",9),a.gc(),a.gc(),a.gc(),a.hc(11,"div",10),a.hc(12,"p"),a.Rc(13,"\xc1p d\u1ee5ng khuy\u1ebfn m\xe3i th\xe0nh vi\xean"),a.gc(),a.hc(14,"div",11),a.hc(15,"input",12),a.pc("change",(function(e){return t.onMemberDiscountChange()}))("ngModelChange",(function(e){return t.order.IsMemberDiscountApply=e})),a.gc(),a.cc(16,"span",13),a.gc(),a.gc(),a.hc(17,"label",14),a.Rc(18,"M\xe3 \u0111\u01a1n "),a.gc(),a.hc(19,"div",15),a.hc(20,"input",16),a.pc("ngModelChange",(function(e){return t.order.OrderId=e})),a.gc(),a.gc(),a.hc(21,"a",17),a.Rc(22,"\xc1p d\u1ee5ng khuy\u1ebfn m\xe3i"),a.gc(),a.hc(23,"div",18),a.hc(24,"div",19),a.hc(25,"label",14),a.Rc(26,"Gi\u1ea3m gi\xe1 ph\u1ea7n tr\u0103m"),a.gc(),a.hc(27,"div",20),a.hc(28,"input",21),a.pc("input",(function(e){return t.onDiscountChanged(e.target.value)}))("ngModelChange",(function(e){return t.order.PercentDiscount=e})),a.gc(),a.gc(),a.gc(),a.hc(29,"div",22),a.hc(30,"label",14),a.Rc(31,"Gi\u1ea3 gi\xe1 ti\u1ec1n"),a.gc(),a.hc(32,"div",15),a.hc(33,"input",23),a.pc("ngModelChange",(function(e){return t.order.AmountDiscount=e}))("input",(function(e){return t.onAmountDiscountChanged(e.target.value)}))("focus",(function(e){return t.onAmountDiscountFocus()})),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(34,"ul",24),a.Pc(35,F,26,16,"li",25),a.gc(),a.hc(36,"div",10),a.hc(37,"p"),a.Rc(38,"Bao g\u1ed3m VAT"),a.gc(),a.hc(39,"div",11),a.hc(40,"input",26),a.pc("change",(function(e){return t.onVATIncludedChange()}))("ngModelChange",(function(e){return t.order.VATIncluded=e})),a.gc(),a.cc(41,"span",13),a.gc(),a.gc(),a.hc(42,"div",27),a.hc(43,"p",28),a.Rc(44,"C\xf2n l\u1ea1i: "),a.hc(45,"span",29),a.Rc(46),a.uc(47,"myCurrPipe"),a.gc(),a.gc(),a.hc(48,"p",30),a.Rc(49,"Th\xe0nh ti\u1ec1n: "),a.hc(50,"span",29),a.Rc(51),a.uc(52,"myCurrPipe"),a.gc(),a.gc(),a.hc(53,"p",31),a.Rc(54,"\u0110\u1ed5i \u0111i\u1ec3m: "),a.hc(55,"span",29),a.Rc(56),a.gc(),a.gc(),a.gc(),a.hc(57,"a",32),a.pc("click",(function(e){return t.addPurchase()})),a.Rc(58," Thanh to\xe1n"),a.gc(),a.hc(59,"a",32),a.pc("click",(function(e){return t.completingOrder()})),a.Rc(60," K\u1ebft th\xfac \u0111\u01a1n"),a.gc(),a.hc(61,"div",33),a.hc(62,"div",34),a.hc(63,"button",35),a.pc("click",(function(e){return t.scoreExchange()})),a.cc(64,"img",36),a.gc(),a.gc(),a.hc(65,"div",37),a.hc(66,"a",38),a.pc("click",(function(e){return t.placeOrder(!1)})),a.Rc(67,"L\u01b0u"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(68,"div",39),a.hc(69,"form",40),a.hc(70,"div",41),a.hc(71,"label",42),a.Rc(72,"Th\xe0nh vi\xean: "),a.gc(),a.hc(73,"span",43),a.Rc(74),a.gc(),a.gc(),a.hc(75,"div",41),a.hc(76,"label",42),a.Rc(77,"\u0110i\u1ec3m t\xedch l\u0169y: "),a.gc(),a.hc(78,"span",44),a.Rc(79),a.gc(),a.gc(),a.hc(80,"div",41),a.cc(81,"input",45),a.gc(),a.hc(82,"div",46),a.hc(83,"div",47),a.hc(84,"button",48),a.Rc(85,"\u0110\u1ed5i \u0111i\u1ec3m"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(86,"div",49),a.hc(87,"ul"),a.Pc(88,N,9,9,"li",50),a.gc(),a.gc(),a.hc(89,"div",51),a.hc(90,"div",1),a.hc(91,"div",52),a.hc(92,"div",53),a.hc(93,"h3"),a.Rc(94,"T\u1ed5ng"),a.gc(),a.hc(95,"p"),a.Rc(96),a.uc(97,"myCurrPipe"),a.gc(),a.gc(),a.hc(98,"div",54),a.hc(99,"h4"),a.Rc(100,"S\u1ed1 ti\u1ec1n c\xf2n l\u1ea1i"),a.gc(),a.hc(101,"p"),a.Rc(102),a.uc(103,"myCurrPipe"),a.gc(),a.gc(),a.hc(104,"div",41),a.hc(105,"label",55),a.Rc(106,"S\u1ed1 ti\u1ec1n thanh to\xe1n"),a.gc(),a.hc(107,"input",56),a.pc("input",(function(e){return t.onPayChanged(e.target.value)}))("focus",(function(e){return t.onPayFocus()}))("ngModelChange",(function(e){return t.currentPayAmount=e})),a.gc(),a.gc(),a.hc(108,"div",41),a.hc(109,"label",57),a.Rc(110,"Ghi Ch\xfa"),a.gc(),a.hc(111,"input",58),a.pc("ngModelChange",(function(e){return t.purchaseNote=e})),a.gc(),a.gc(),a.hc(112,"div",41),a.hc(113,"label",59),a.Rc(114,"T\xecnh tr\u1ea1ng thanh to\xe1n"),a.gc(),a.hc(115,"select",60),a.pc("ngModelChange",(function(e){return t.currentPurStatus=e})),a.hc(116,"option",61),a.Rc(117,"Ch\u1ecdn..."),a.gc(),a.hc(118,"option",62),a.Rc(119,"\u0110ang \u0111\u1ee3i"),a.gc(),a.hc(120,"option",62),a.Rc(121,"Ho\xe0n t\u1ea5t"),a.gc(),a.hc(122,"option",62),a.Rc(123,"\u0110\xe3 Hu\u1ef7"),a.gc(),a.gc(),a.gc(),a.hc(124,"div",63),a.hc(125,"a",64),a.pc("click",(function(e){return t.selectPurType(t.purchaseType.Momo)})),a.cc(126,"img",65),a.gc(),a.hc(127,"a",64),a.pc("click",(function(e){return t.selectPurType(t.purchaseType.Banking)})),a.cc(128,"img",66),a.gc(),a.hc(129,"a",64),a.pc("click",(function(e){return t.selectPurType(t.purchaseType.Cash)})),a.cc(130,"img",67),a.gc(),a.gc(),a.hc(131,"div",46),a.hc(132,"div",68),a.hc(133,"button",69),a.pc("click",(function(e){return t.purchaseConfirm()})),a.Rc(134,"X\xe1c nh\u1eadn"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(135,"div",70),a.hc(136,"span"),a.Rc(137,"Qu\xe9t m\xe3 QR \u0111\u1ec3 thanh to\xe1n "),a.gc(),a.hc(138,"div"),a.cc(139,"qr-code",71),a.gc(),a.hc(140,"div",46),a.hc(141,"div",68),a.hc(142,"button",72),a.Rc(143,"Xong"),a.gc(),a.gc(),a.gc(),a.gc()),2&e&&(a.Ob(7),a.Uc("",t.order.CustomerInfo.Name," (-",t.order.CustomerInfo.DiscountPercent,"%)"),a.Ob(8),a.Ac("ngModel",t.order.IsMemberDiscountApply),a.Ob(5),a.Ac("ngModel",t.order.OrderId)("readonly",t.isEdittingOrder),a.Ob(8),a.Ac("ngModel",t.order.PercentDiscount),a.Ob(5),a.Ac("ngModel",t.order.AmountDiscount),a.Ob(2),a.Ac("ngForOf",t.order.OrderDetails),a.Ob(5),a.Ac("ngModel",t.order.VATIncluded),a.Ob(6),a.Tc("",a.vc(47,28,t.AcctualBalance)," "),a.Ob(5),a.Tc("",a.vc(52,30,t.order.TotalAmount)," "),a.Ob(5),a.Sc(t.order.CustomerInfo.ScoreUsed),a.Ob(18),a.Sc(t.memberShipTitle),a.Ob(5),a.Sc(t.order.CustomerInfo.AvailableScore),a.Ob(9),a.Ac("ngForOf",t.promotions),a.Ob(8),a.Sc(a.vc(97,32,t.order.TotalAmount)),a.Ob(6),a.Sc(a.vc(103,34,t.totalBalance)),a.Ob(5),a.Ac("ngModel",t.currentPayAmount),a.Ob(4),a.Ac("ngModel",t.purchaseNote),a.Ob(4),a.Ac("ngModel",t.currentPurStatus),a.Ob(3),a.Ac("ngValue","Waiting"),a.Ob(2),a.Ac("ngValue","Completed"),a.Ob(2),a.Ac("ngValue","Canceled"),a.Ob(3),a.Ac("ngClass","Momo"===t.currentPurType?" img-purchase-selected":""),a.Ob(2),a.Ac("ngClass","Banking"===t.currentPurType?" img-purchase-selected":""),a.Ob(2),a.Ac("ngClass","Cash"===t.currentPurType?" img-purchase-selected":""),a.Ob(10),a.Ac("value",t.qrContent)("size",290))},directives:[c.c,T.a,T.k,T.n,T.b,T.p,g.k,T.v,T.l,T.m,T.s,T.o,T.u,g.j,R.a],pipes:[w.a,M.a,w.b],styles:[""]}),e})();var L=i("e6qa");function B(e,t){if(1&e){const e=a.ic();a.hc(0,"a",7),a.pc("click",(function(t){return a.Jc(e),a.tc().openFileForShare()})),a.Rc(1,"Ch\u1ecdn h\xecnh"),a.gc()}}function U(e,t){if(1&e){const e=a.ic();a.hc(0,"a",7),a.pc("click",(function(t){return a.Jc(e),a.tc().openFile()})),a.Rc(1,"Ch\u1ecdn h\xecnh"),a.gc()}}function q(e,t){if(1&e){const e=a.ic();a.hc(0,"div"),a.hc(1,"input",8,9),a.pc("change",(function(t){return a.Jc(e),a.tc().onChange(t)})),a.gc(),a.hc(3,"a",7),a.pc("click",(function(t){return a.Jc(e),a.Hc(2).click()})),a.Rc(4,"Ch\u1ecdn h\xecnh"),a.gc(),a.gc()}}function V(e,t){if(1&e){const e=a.ic();a.hc(0,"a",7),a.pc("click",(function(t){return a.Jc(e),a.tc().shareForCus()})),a.Rc(1,"Share cho KH"),a.gc()}}function H(e,t){if(1&e){const e=a.ic();a.hc(0,"a",7),a.pc("click",(function(t){return a.Jc(e),a.tc().partPay()})),a.Rc(1,"Thanh to\xe1n"),a.gc()}}function E(e,t){if(1&e){const e=a.ic();a.hc(0,"a",7),a.pc("click",(function(t){return a.Jc(e),a.tc().confirm("")})),a.Rc(1,"X\xe1c nh\u1eadn"),a.gc()}}function J(e,t){if(1&e){const e=a.ic();a.hc(0,"a",7),a.pc("click",(function(t){return a.Jc(e),a.tc().shipperCofirm()})),a.Rc(1,"X\xe1c nh\u1eadn"),a.gc()}}let W=(()=>{class e extends m{constructor(e,t,i,c){super(),this.orderDetailService=e,this.customerService=t,this.router=i,this.orderService=c,this.Title="X\xe1c nh\u1eadn v\u1edbi kh\xe1ch h\xe0ng",this.edittingImageUrl="",this.totalBalance=0,this.orderDetail=new f.c,this.order=new f.d,this.customer=new I.a}Init(){this.orderDetail=this.globalOrderDetail,this.orderService.getById(this.orderDetail.OrderId).then(e=>{this.order=e,this.totalBalance=this.order.TotalAmount-this.order.TotalPaidAmount,this.customerService.getById(this.order.CustomerInfo.Id).then(e=>{this.customer=e})})}fileChosen(e){this.edittingImageUrl="data:image/png;base64,"+e}onChange(e){const t=e.target.files[0];if(t)if(null!=t.type.match(/image\/*/)){var i=new FileReader;i.readAsDataURL(t),i.onload=e=>{this.edittingImageUrl=i.result.toString()}}else this.showError("Ph\u1ea3i ch\u1ecdn h\xecnh !!")}partPay(){getNumberValidateInput((e,t)=>{e>this.totalBalance?t(!1,"Thanh to\xe1n v\u01b0\u1ee3t qu\xe1 th\xe0nh ti\u1ec1n!"):e<=0?t(!1,"Thanh to\xe1n ph\u1ea3i l\u1edbn h\u01a1n 0!"):(t(!0,""),getShippingNoteDialog("X\xe1c nh\u1eadn",t=>{this.orderService.updateFields(this.order.OrderId,{TotalPaidAmount:this.order.TotalPaidAmount+e}).then(()=>{this.confirm(t)})}))},"S\u1ed1 ti\u1ec1n thanh to\xe1n...",this.totalBalance)}destroy(){super.destroy(),deleteTempImage()}shipperCofirm(){getShippingNoteDialog("X\xe1c nh\u1eadn",e=>{this.confirm(e)})}confirm(e){switch(this.CurrentUser.Role){case b.i.Account:case b.i.Admin:""!=this.edittingImageUrl&&fetch(this.edittingImageUrl).then(e=>e.blob()).then(e=>{const t=new File([e],"result.png",{type:"image/png"});this.orderDetailService.resultConfirm(this.orderDetail.OrderDetailId,t).then(e=>{this.router.navigate(["staff/account-main"])})});break;case b.i.Shipper:""!=this.edittingImageUrl?fetch(this.edittingImageUrl).then(e=>e.blob()).then(t=>{const i=new File([t],"shipping.png",{type:"image/png"});this.orderDetailService.shippingConfirm(this.orderDetail.OrderDetailId,i,e).then(e=>{this.router.navigate(["staff/shipper-main"])})}):this.orderDetailService.updateFields(this.orderDetail.OrderDetailId,{DeliveryCompletedTime:(new Date).getTime(),State:b.e.Deliveried,MakingSortOrder:0,ShippingSortOrder:0,ShippingNote:e}).then(e=>{this.router.navigate(["staff/shipper-main"])})}}shareForCus(){""!=this.edittingImageUrl&&(this.IsOnTerminal?shareImageCus(v.a.getMainContact(this.customer)):shareImageCusWithData(this.edittingImageUrl,v.a.getMainContact(this.customer)))}}return e.\u0275fac=function(t){return new(t||e)(a.bc(L.a),a.bc(P.a),a.bc(c.b),a.bc(C.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-customer-confirm"]],features:[a.Lb],decls:12,vars:8,consts:[["id","staff",1,"page-content"],[1,"container"],[1,"image-top"],["id","selected-image","onclick","rotateImage()","alt","",3,"src"],[1,"image-action"],["href","javascript:void(0)","class","main-bg",3,"click",4,"ngIf"],[4,"ngIf"],["href","javascript:void(0)",1,"main-bg",3,"click"],["type","file","id","resultFile","name","uploadedFile","hidden","",1,"img-cover","file-upload-default",3,"change"],["imageUpload",""]],template:function(e,t){1&e&&(a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"div",2),a.cc(3,"img",3),a.gc(),a.hc(4,"div",4),a.Pc(5,B,2,0,"a",5),a.Pc(6,U,2,0,"a",5),a.Pc(7,q,5,0,"div",6),a.Pc(8,V,2,0,"a",5),a.Pc(9,H,2,0,"a",5),a.Pc(10,E,2,0,"a",5),a.Pc(11,J,2,0,"a",5),a.gc(),a.gc(),a.gc()),2&e&&(a.Ob(3),a.Ac("src",t.edittingImageUrl,a.Lc),a.Ob(2),a.Ac("ngIf",t.IsOnTerminal&&"Shipper"!=t.CurrentUser.Role),a.Ob(1),a.Ac("ngIf",t.IsOnTerminal&&"Shipper"==t.CurrentUser.Role),a.Ob(1),a.Ac("ngIf",!t.IsOnTerminal),a.Ob(1),a.Ac("ngIf","Shipper"!=t.CurrentUser.Role),a.Ob(1),a.Ac("ngIf","Shipper"==t.CurrentUser.Role&&t.totalBalance>0),a.Ob(1),a.Ac("ngIf","Shipper"!=t.CurrentUser.Role),a.Ob(1),a.Ac("ngIf","Shipper"==t.CurrentUser.Role))},directives:[g.l],styles:[""]}),e})();var G=i("AytR"),$=i("dkQB");let j=(()=>{class e{constructor(e){this.globalService=e}pushFileToStorage(e,t,i){}push(e,t,i){return Object(o.a)(this,void 0,void 0,(function*(){return""}))}deleteFile(e,t){}downloadFIle(e,t){var i=new XMLHttpRequest;i.responseType="blob",i.onload=function(e){t(i.response)},i.open("GET",e),i.send()}pushStringToStorage(e,t,i){}}return e.\u0275fac=function(t){return new(t||e)(a.lc(h.a))},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function X(e,t){if(1&e&&(a.hc(0,"div",22),a.hc(1,"span",12),a.Rc(2,"SDT ng\u01b0\u1eddi nh\u1eadn:"),a.gc(),a.hc(3,"span",13),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.orderDetail.DeliveryInfo.PhoneNumber)}}function Q(e,t){if(1&e&&(a.hc(0,"div",22),a.hc(1,"span",12),a.Rc(2,"\u0110\u1ecba ch\u1ec9 giao:"),a.gc(),a.hc(3,"span",13),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.orderDetail.DeliveryInfo.Address)}}let z=(()=>{class e extends m{constructor(e,t,i,c,r){super(),this.router=e,this.orderService=t,this.orderDetailService=i,this.storageService=c,this.customerService=r,this.Title="X\xe1c nh\u1eadn giao h\xe0ng",this.sharingImage=""}Init(){this.orderDetail=this.globalOrderDetail,this.customerService.getById(this.globalOrder.CustomerInfo.Id).then(e=>{this.customer=e})}destroy(){super.destroy(),deleteTempImage()}confirmOrderDetail(){this.orderDetailService.updateFields(this.orderDetail.OrderDetailId,{State:b.e.Completed,ShippingSortOrder:0}).then(()=>Object(o.a)(this,void 0,void 0,(function*(){0==(yield this.orderDetailService.getByOrderId(this.orderDetail.OrderId)).filter(e=>e.State!=b.e.Completed).length?this.orderDetailService.updateStatusByOrderId(this.orderDetail.OrderId,b.e.Completed,(new Date).getTime()).then(e=>{this.router.navigate(["staff/orders-manage"])}):this.router.navigate(["staff/orders-manage"])})))}shareToCus(){this.startLoading(),this.storageService.downloadFIle(`${G.a.base_domain}${$.b.shipping_img}${this.orderDetail.DeliveryImageUrl}`,e=>{this.stopLoading();var t=new FileReader;t.readAsDataURL(e),t.onloadend=()=>{var e=t.result.toString();this.sharingImage=e,shareImageCusWithData(this.sharingImage,v.a.getMainContact(this.customer))}})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(c.b),a.bc(C.a),a.bc(L.a),a.bc(j),a.bc(P.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-final-confirm"]],features:[a.Lb],decls:61,vars:30,consts:[["id","deliConfirm",1,"page-content"],[1,"container"],[1,"prodDetail"],[1,"prodGen"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPriceOld"],[1,"prodCharge"],[1,"prodPrice"],[1,"prodInfo","cusScroll"],[1,"prodQuan","infoGroup"],[1,"itemlabel"],[1,"itemVal"],[1,"prodName","infoGroup"],[1,"prodTime","infoGroup"],["class","prodAddr infoGroup",4,"ngIf"],[1,"prodDesc","infoGroup"],[1,"row"],[1,"col-10","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-2",3,"click"],["type","submit",1,"btn","grey-btn","w-100","mt-2",3,"click"],[1,"prodAddr","infoGroup"]],template:function(e,t){1&e&&(a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"div",2),a.hc(3,"div",3),a.cc(4,"img",4),a.uc(5,"ImgPipe"),a.cc(6,"img",4),a.uc(7,"ImgPipe"),a.hc(8,"div",5),a.hc(9,"h5",6),a.Rc(10),a.gc(),a.hc(11,"span",7),a.Rc(12),a.uc(13,"myCurrPipe"),a.gc(),a.hc(14,"span",8),a.Rc(15),a.uc(16,"myCurrPipe"),a.gc(),a.hc(17,"span",9),a.Rc(18),a.uc(19,"myCurrPipe"),a.gc(),a.gc(),a.gc(),a.hc(20,"div",10),a.hc(21,"div",11),a.hc(22,"span",12),a.Rc(23,"M\xe3 \u0111\u01a1n: "),a.gc(),a.hc(24,"span",13),a.Rc(25),a.gc(),a.gc(),a.hc(26,"div",14),a.hc(27,"span",12),a.Rc(28,"T\xean KH"),a.gc(),a.hc(29,"span",13),a.Rc(30),a.gc(),a.gc(),a.hc(31,"div",14),a.hc(32,"span",12),a.Rc(33,"SDT KH"),a.gc(),a.hc(34,"span",13),a.Rc(35),a.gc(),a.gc(),a.hc(36,"div",15),a.hc(37,"span",12),a.Rc(38,"Th\u1eddi gian giao:"),a.gc(),a.hc(39,"span",13),a.Rc(40),a.uc(41,"date"),a.gc(),a.gc(),a.hc(42,"div",14),a.hc(43,"span",12),a.Rc(44,"T\xean ng\u01b0\u1eddi nh\u1eadn:"),a.gc(),a.hc(45,"span",13),a.Rc(46),a.gc(),a.gc(),a.Pc(47,X,5,1,"div",16),a.Pc(48,Q,5,1,"div",16),a.hc(49,"div",17),a.hc(50,"span",12),a.Rc(51,"M\xf4 t\u1ea3:"),a.gc(),a.hc(52,"span",13),a.Rc(53),a.gc(),a.gc(),a.gc(),a.hc(54,"div",18),a.hc(55,"div",19),a.hc(56,"button",20),a.pc("click",(function(e){return t.shareToCus()})),a.Rc(57,"X\xe1c nh\u1eadn Kh\xe1ch h\xe0ng"),a.gc(),a.gc(),a.hc(58,"div",19),a.hc(59,"button",21),a.pc("click",(function(e){return t.confirmOrderDetail()})),a.Rc(60,"X\xe1c nh\u1eadn"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc()),2&e&&(a.Ob(4),a.Bc("src",a.wc(5,15,t.orderDetail.ResultImageUrl,"ResultImg"),a.Lc),a.Ob(2),a.Bc("src",a.wc(7,18,t.orderDetail.DeliveryImageUrl,"ShippingImg"),a.Lc),a.Ob(4),a.Sc(t.orderDetail.ProductName),a.Ob(2),a.Sc(a.vc(13,21,t.orderDetail.OriginalPrice)),a.Ob(3),a.Tc("Ph\u1ee5 ph\xed: ",a.vc(16,23,t.orderDetail.AdditionalFee),""),a.Ob(3),a.Sc(a.vc(19,25,t.orderDetail.ModifiedPrice)),a.Ob(7),a.Uc("",t.orderDetail.OrderId,"_",t.orderDetail.Index+1,""),a.Ob(5),a.Sc(t.orderDetail.CustomerName),a.Ob(5),a.Sc(t.orderDetail.CustomerPhoneNumber),a.Ob(5),a.Sc(a.wc(41,27,t.orderDetail.DeliveryInfo.DateTime,"HH:mm dd/MM/yyyy")),a.Ob(6),a.Sc(t.orderDetail.DeliveryInfo.FullName),a.Ob(1),a.Ac("ngIf","Florist"!=t.CurrentUser.Role),a.Ob(1),a.Ac("ngIf","Florist"!=t.CurrentUser.Role),a.Ob(5),a.Sc(t.orderDetail.Description))},directives:[g.l],pipes:[M.a,w.a,g.e],styles:[""]}),e})();function K(e,t){if(1&e){const e=a.ic();a.hc(0,"div",15),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.hc(1,"span"),a.Rc(2),a.gc(),a.gc()}if(2&e){const e=a.tc(2);a.Ob(2),a.Sc(e.index)}}function _(e,t){if(1&e){const e=a.ic();a.hc(0,"div",16),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.hc(1,"span"),a.Rc(2),a.gc(),a.gc()}if(2&e){const e=a.tc(2);a.Ob(2),a.Sc(e.index)}}function Z(e,t){if(1&e){const e=a.ic();a.hc(0,"div",17),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.hc(1,"span"),a.Rc(2),a.gc(),a.gc()}if(2&e){const e=a.tc(2);a.Ob(2),a.Sc(e.index)}}function Y(e,t){if(1&e){const e=a.ic();a.hc(0,"div",18),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.hc(1,"span"),a.Rc(2),a.gc(),a.gc()}if(2&e){const e=a.tc(2);a.Ob(2),a.Sc(e.index)}}function ee(e,t){if(1&e){const e=a.ic();a.hc(0,"div",19),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.hc(1,"span"),a.Rc(2),a.gc(),a.gc()}if(2&e){const e=a.tc(2);a.Ob(2),a.Sc(e.index)}}function te(e,t){if(1&e){const e=a.ic();a.hc(0,"div",20),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.hc(1,"span"),a.Rc(2),a.gc(),a.gc()}if(2&e){const e=a.tc(2);a.Ob(2),a.Sc(e.index)}}function ie(e,t){if(1&e){const e=a.ic();a.hc(0,"div",21),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.hc(1,"span"),a.Rc(2),a.gc(),a.gc()}if(2&e){const e=a.tc(2);a.Ob(2),a.Sc(e.index)}}function ce(e,t){if(1&e){const e=a.ic();a.hc(0,"div",22),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.hc(1,"span"),a.Rc(2),a.gc(),a.gc()}if(2&e){const e=a.tc(2);a.Ob(2),a.Sc(e.index)}}function re(e,t){if(1&e){const e=a.ic();a.hc(0,"div",23),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.hc(1,"span"),a.Rc(2),a.gc(),a.gc()}if(2&e){const e=a.tc(2);a.Ob(2),a.Sc(e.index)}}function ne(e,t){if(1&e){const e=a.ic();a.hc(0,"div",24),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.hc(1,"span"),a.Rc(2),a.gc(),a.gc()}if(2&e){const e=a.tc(2);a.Ob(2),a.Sc(e.index)}}function oe(e,t){if(1&e){const e=a.ic();a.hc(0,"div",25),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.hc(1,"span"),a.Rc(2),a.gc(),a.gc()}if(2&e){const e=a.tc(2);a.Ob(2),a.Sc(e.index)}}function ae(e,t){if(1&e){const e=a.ic();a.hc(0,"div",26),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.hc(1,"span"),a.Rc(2),a.gc(),a.gc()}if(2&e){const e=a.tc(2);a.Ob(2),a.Sc(e.index)}}function se(e,t){if(1&e){const e=a.ic();a.hc(0,"div",27),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.hc(1,"span"),a.Rc(2),a.gc(),a.gc()}if(2&e){const e=a.tc(2);a.Ob(2),a.Sc(e.index)}}function he(e,t){if(1&e&&(a.hc(0,"div",1),a.Pc(1,K,3,1,"div",2),a.Pc(2,_,3,1,"div",3),a.Pc(3,Z,3,1,"div",4),a.Pc(4,Y,3,1,"div",5),a.Pc(5,ee,3,1,"div",6),a.Pc(6,te,3,1,"div",7),a.Pc(7,ie,3,1,"div",8),a.Pc(8,ce,3,1,"div",9),a.Pc(9,re,3,1,"div",10),a.Pc(10,ne,3,1,"div",11),a.Pc(11,oe,3,1,"div",12),a.Pc(12,ae,3,1,"div",13),a.Pc(13,se,3,1,"div",14),a.gc()),2&e){const e=a.tc();a.Ac("ngSwitch",e.state),a.Ob(1),a.Ac("ngSwitchCase",e.states.Added),a.Ob(1),a.Ac("ngSwitchCase",e.states.Waiting),a.Ob(1),a.Ac("ngSwitchCase",e.states.Making),a.Ob(1),a.Ac("ngSwitchCase",e.states.Comfirming),a.Ob(1),a.Ac("ngSwitchCase",e.states.DeliveryWaiting),a.Ob(1),a.Ac("ngSwitchCase",e.states.DeliverAssinged),a.Ob(1),a.Ac("ngSwitchCase",e.states.Deliveried),a.Ob(1),a.Ac("ngSwitchCase",e.states.Completed),a.Ob(1),a.Ac("ngSwitchCase",e.states.Canceled),a.Ob(1),a.Ac("ngSwitchCase",e.states.OnTheWay),a.Ob(1),a.Ac("ngSwitchCase",e.states.SentBack),a.Ob(1),a.Ac("ngSwitchCase",e.states.FixingRequest),a.Ob(1),a.Ac("ngSwitchCase",e.states.Fixing)}}function de(e,t){if(1&e){const e=a.ic();a.hc(0,"div",15),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.cc(1,"span"),a.gc()}}function le(e,t){if(1&e){const e=a.ic();a.hc(0,"div",16),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.cc(1,"span"),a.gc()}}function ge(e,t){if(1&e){const e=a.ic();a.hc(0,"div",17),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.cc(1,"span"),a.gc()}}function ue(e,t){if(1&e){const e=a.ic();a.hc(0,"div",18),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.cc(1,"span"),a.gc()}}function pe(e,t){if(1&e){const e=a.ic();a.hc(0,"div",19),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.cc(1,"span"),a.gc()}}function me(e,t){if(1&e){const e=a.ic();a.hc(0,"div",20),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.cc(1,"span"),a.gc()}}function fe(e,t){if(1&e){const e=a.ic();a.hc(0,"div",21),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.cc(1,"span"),a.gc()}}function be(e,t){if(1&e){const e=a.ic();a.hc(0,"div",22),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.cc(1,"span"),a.gc()}}function ve(e,t){if(1&e){const e=a.ic();a.hc(0,"div",23),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.cc(1,"span"),a.gc()}}function Oe(e,t){if(1&e){const e=a.ic();a.hc(0,"div",24),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.cc(1,"span"),a.gc()}}function Se(e,t){if(1&e){const e=a.ic();a.hc(0,"div",25),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.cc(1,"span"),a.gc()}}function De(e,t){if(1&e){const e=a.ic();a.hc(0,"div",26),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.cc(1,"span"),a.gc()}}function Ie(e,t){if(1&e){const e=a.ic();a.hc(0,"div",27),a.pc("click",(function(t){return a.Jc(e),a.tc(2).pointClicked()})),a.cc(1,"span"),a.gc()}}function Ce(e,t){if(1&e&&(a.hc(0,"div",1),a.Pc(1,de,2,0,"div",2),a.Pc(2,le,2,0,"div",3),a.Pc(3,ge,2,0,"div",4),a.Pc(4,ue,2,0,"div",5),a.Pc(5,pe,2,0,"div",6),a.Pc(6,me,2,0,"div",7),a.Pc(7,fe,2,0,"div",8),a.Pc(8,be,2,0,"div",9),a.Pc(9,ve,2,0,"div",10),a.Pc(10,Oe,2,0,"div",11),a.Pc(11,Se,2,0,"div",12),a.Pc(12,De,2,0,"div",13),a.Pc(13,Ie,2,0,"div",14),a.gc()),2&e){const e=a.tc();a.Ac("ngSwitch",e.state),a.Ob(1),a.Ac("ngSwitchCase",e.states.Added),a.Ob(1),a.Ac("ngSwitchCase",e.states.Waiting),a.Ob(1),a.Ac("ngSwitchCase",e.states.Making),a.Ob(1),a.Ac("ngSwitchCase",e.states.Comfirming),a.Ob(1),a.Ac("ngSwitchCase",e.states.DeliveryWaiting),a.Ob(1),a.Ac("ngSwitchCase",e.states.DeliverAssinged),a.Ob(1),a.Ac("ngSwitchCase",e.states.Deliveried),a.Ob(1),a.Ac("ngSwitchCase",e.states.Completed),a.Ob(1),a.Ac("ngSwitchCase",e.states.Canceled),a.Ob(1),a.Ac("ngSwitchCase",e.states.OnTheWay),a.Ob(1),a.Ac("ngSwitchCase",e.states.SentBack),a.Ob(1),a.Ac("ngSwitchCase",e.states.FixingRequest),a.Ob(1),a.Ac("ngSwitchCase",e.states.Fixing)}}let Pe=(()=>{class e{constructor(){this.states=b.e,this.index=-1,this.id="",this.onClicked=new a.q,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){}pointClicked(){this.onClicked.emit(this.id)}preventEvent(e){e.stopPropagation()}writeValue(e){}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}updateChanges(){this.onChange()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Vb({type:e,selectors:[["app-status-point"]],inputs:{state:"state",index:"index",id:"id"},outputs:{onClicked:"onClicked"},features:[a.Nb([{provide:T.j,useExisting:Object(a.fb)(()=>e),multi:!0}])],decls:2,vars:2,consts:[[3,"ngSwitch",4,"ngIf"],[3,"ngSwitch"],["class","item-status pi",3,"click",4,"ngSwitchCase"],["class","item-status r",3,"click",4,"ngSwitchCase"],["class","item-status o",3,"click",4,"ngSwitchCase"],["class","item-status y",3,"click",4,"ngSwitchCase"],["class","item-status p",3,"click",4,"ngSwitchCase"],["class","item-status b",3,"click",4,"ngSwitchCase"],["class","item-status bl",3,"click",4,"ngSwitchCase"],["class","item-status g",3,"click",4,"ngSwitchCase"],["class","item-status x",3,"click",4,"ngSwitchCase"],["class","item-status on-the-way",3,"click",4,"ngSwitchCase"],["class","item-status send-back",3,"click",4,"ngSwitchCase"],["class","item-status fixing-request",3,"click",4,"ngSwitchCase"],["class","item-status fixing",3,"click",4,"ngSwitchCase"],[1,"item-status","pi",3,"click"],[1,"item-status","r",3,"click"],[1,"item-status","o",3,"click"],[1,"item-status","y",3,"click"],[1,"item-status","p",3,"click"],[1,"item-status","b",3,"click"],[1,"item-status","bl",3,"click"],[1,"item-status","g",3,"click"],[1,"item-status","x",3,"click"],[1,"item-status","on-the-way",3,"click"],[1,"item-status","send-back",3,"click"],[1,"item-status","fixing-request",3,"click"],[1,"item-status","fixing",3,"click"]],template:function(e,t){1&e&&(a.Pc(0,he,14,14,"div",0),a.Pc(1,Ce,14,14,"div",0)),2&e&&(a.Ac("ngIf",t.index>-1),a.Ob(1),a.Ac("ngIf",-1==t.index))},directives:[g.l,g.n,g.o],styles:[""]}),e})();function Ae(e,t){if(1&e){const e=a.ic();a.hc(0,"div",17),a.hc(1,"div",18),a.hc(2,"span",19),a.Rc(3),a.gc(),a.hc(4,"div",20),a.hc(5,"h4",21),a.Rc(6),a.gc(),a.hc(7,"span",22),a.Rc(8),a.gc(),a.gc(),a.cc(9,"app-status-point",23),a.gc(),a.hc(10,"div",24),a.hc(11,"ul",25),a.hc(12,"li",26),a.hc(13,"div",27),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit;return a.tc().getMenu(c)})),a.cc(14,"img",28),a.uc(15,"ImgPipe"),a.hc(16,"div",29),a.hc(17,"span",30),a.Rc(18),a.uc(19,"myCurrPipe"),a.gc(),a.hc(20,"span",31),a.Rc(21),a.uc(22,"myCurrPipe"),a.gc(),a.hc(23,"span",32),a.Rc(24),a.uc(25,"myCurrPipe"),a.gc(),a.hc(26,"span",33),a.Rc(27),a.gc(),a.hc(28,"span",34),a.Rc(29),a.uc(30,"myTimePipe"),a.gc(),a.hc(31,"span",35),a.Rc(32),a.uc(33,"myDatePipe"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc()}if(2&e){const e=t.$implicit,i=t.index;a.Ob(3),a.Uc("",e.OrderId,"_",e.Index+1,""),a.Ob(3),a.Sc(e.ProductName),a.Ob(2),a.Uc("",e.CustomerName,"-",e.CustomerPhoneNumber,""),a.Ob(1),a.Ac("state",e.State)("id",e.OrderDetailId)("index",i+1),a.Ob(5),a.Bc("src",a.wc(15,15,e.ProductImageUrl,"ProductImg"),a.Lc),a.Ob(4),a.Sc(a.vc(19,18,e.OriginalPrice)),a.Ob(3),a.Sc(a.vc(22,20,e.AdditionalFee)),a.Ob(3),a.Sc(a.vc(25,22,e.ModifiedPrice)),a.Ob(3),a.Sc(e.DeliveryInfo.Address),a.Ob(2),a.Sc(a.vc(30,24,e.MakingRequestTime)),a.Ob(3),a.Sc(a.vc(33,26,e.MakingRequestTime))}}function ke(e,t){if(1&e){const e=a.ic();a.hc(0,"div",17),a.hc(1,"div",18),a.hc(2,"span",19),a.Rc(3),a.gc(),a.hc(4,"div",20),a.hc(5,"h4",21),a.Rc(6),a.gc(),a.hc(7,"span",22),a.Rc(8),a.gc(),a.gc(),a.cc(9,"app-status-point",23),a.gc(),a.hc(10,"div",24),a.hc(11,"ul",25),a.hc(12,"li",26),a.hc(13,"div",27),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit;return a.tc().getMenu(c)})),a.cc(14,"img",28),a.uc(15,"ImgPipe"),a.hc(16,"div",29),a.hc(17,"span",30),a.Rc(18),a.uc(19,"myCurrPipe"),a.gc(),a.hc(20,"span",31),a.Rc(21),a.uc(22,"myCurrPipe"),a.gc(),a.hc(23,"span",32),a.Rc(24),a.uc(25,"myCurrPipe"),a.gc(),a.hc(26,"span",33),a.Rc(27),a.gc(),a.hc(28,"span",34),a.Rc(29),a.uc(30,"myTimePipe"),a.gc(),a.hc(31,"span",35),a.Rc(32),a.uc(33,"myDatePipe"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc()}if(2&e){const e=t.$implicit,i=t.index;a.Ob(3),a.Uc("",e.OrderId,"_",e.Index+1,""),a.Ob(3),a.Sc(e.ProductName),a.Ob(2),a.Uc("",e.CustomerName,"-",e.CustomerPhoneNumber,""),a.Ob(1),a.Ac("state",e.State)("id",e.OrderDetailId)("index",i+1),a.Ob(5),a.Bc("src",a.wc(15,15,e.ProductImageUrl,"ProductImg"),a.Lc),a.Ob(4),a.Sc(a.vc(19,18,e.OriginalPrice)),a.Ob(3),a.Sc(a.vc(22,20,e.AdditionalFee)),a.Ob(3),a.Sc(a.vc(25,22,e.ModifiedPrice)),a.Ob(3),a.Sc(e.DeliveryInfo.Address),a.Ob(2),a.Sc(a.vc(30,24,e.MakingRequestTime)),a.Ob(3),a.Sc(a.vc(33,26,e.MakingRequestTime))}}let ye=(()=>{class e extends m{constructor(e,t){super(),this.router=e,this.orderDetailService=t,this.Title="Th\u1ee3 c\u1eafm hoa",this.NavigateClass="nav-icon ",this.IsDataLosingWarning=!1,this.waitingMenuItems=["Nh\u1eadn \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],this.fixingRequestMenuItems=["S\u1eeda \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],this.makingMenuItems=["Ho\xe0n th\xe0nh \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"]}OnBackNaviage(){customerSupport()}logout(){this.authService.logOut(e=>{e&&this.router.navigate(["staff/login"])})}Init(){this.loadWaitingDetails(),this.loadMakingDetails(),this.askForRememberPassword()}viewDetail(e){this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}loadWaitingDetails(){this.waitingOrderDetails=[],this.orderDetailService.getByStates([b.e.Waiting,b.e.FixingRequest]).then(e=>{this.waitingOrderDetails=e,this.waitingOrderDetails.sort((e,t)=>e.MakingSortOrder<t.MakingSortOrder?-1:e.MakingSortOrder>t.MakingSortOrder?1:0)})}loadMakingDetails(){this.makingOrderDetails=[],this.orderDetailService.getByStatesAndFloristId(this.CurrentUser.Id,[b.e.Making,b.e.Fixing]).then(e=>{this.makingOrderDetails=e,this.makingOrderDetails.sort((e,t)=>e.MakingSortOrder<t.MakingSortOrder?-1:e.MakingSortOrder>t.MakingSortOrder?1:0)})}getMenu(e){let t;switch(e.State){case b.e.Waiting:t=this.waitingMenuItems;break;case b.e.Making:case b.e.Fixing:t=this.makingMenuItems;break;case b.e.FixingRequest:t=this.fixingRequestMenuItems}menuOpen(t=>{switch(+t){case 0:switch(e.State){case b.e.Waiting:this.orderDetailService.updateDetailSeen(e.OrderDetailId,this.CurrentUser.Id,(new Date).getTime()).then(t=>{let i={};i=e.State==b.e.Waiting?{State:b.e.Making,MakingSortOrder:0,FloristId:this.CurrentUser.Id,MakingStartTime:(new Date).getTime()}:{State:b.e.Fixing,MakingSortOrder:0,FixingFloristId:this.CurrentUser.Id,MakingStartTime:(new Date).getTime()},this.orderDetailService.updateFields(e.OrderDetailId,i).then(()=>{this.loadMakingDetails(),this.loadWaitingDetails()})});break;case b.e.Making:case b.e.Fixing:this.openConfirm("ch\u1eafc ch\u1eafn ho\xe0n th\xe0nh \u0111\u01a1n?",()=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.Comfirming,MakingCompletedTime:(new Date).getTime()}).then(()=>{this.loadMakingDetails(),this.loadWaitingDetails()})})}break;case 1:this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}},t)}}return e.\u0275fac=function(t){return new(t||e)(a.bc(c.b),a.bc(L.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-florist-main"]],features:[a.Lb],decls:27,vars:9,consts:[["id","arrange",1,"page-content"],[1,"container"],["id","listNav","role","tablist",1,"nav","nav-tabs","row"],[1,"nav-item","col-6"],["id","nav1","data-toggle","tab","href","#camhoa","role","tab","aria-controls","camhoa","aria-selected","true",1,"active","main-bg"],["id","nav2","data-toggle","tab","href","#giaohoa","role","tab","aria-controls","giaohoa","aria-selected","false",1,"main-bg"],["id","listContent",1,"tab-content","order-list-bot"],["id","camhoa","role","tabpanel","aria-labelledby","nav1",1,"tab-pane","fade","show","active"],[1,"order-content","cusScroll"],["class","order-content-item product-item",4,"ngFor","ngForOf"],["id","giaohoa","role","tabpanel","aria-labelledby","nav2",1,"tab-pane","fade"],[1,"customer-support"],["alt","",1,"customer-avatar",3,"src"],[1,"customer-name"],["href","tel:0000",1,"customer-phone"],[1,"customer-position"],["id","logoutBtn",1,"customer-position",3,"click"],[1,"order-content-item","product-item"],[1,"item-top"],[1,"item-code"],[1,"item-info"],[1,"item-name"],[1,"item-quantity"],[3,"state","id","index"],[1,"item-bot"],[1,"order-product-list","cusScroll"],[1,""],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"prodPriceOld"],[1,"prodCharge"],[1,"prodPrice"],[1,"item-address"],[1,"item-time"],[1,"item-date"]],template:function(e,t){1&e&&(a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"ul",2),a.hc(3,"li",3),a.hc(4,"a",4),a.Rc(5,"Ch\u1edd c\u1eafm"),a.gc(),a.gc(),a.hc(6,"li",3),a.hc(7,"a",5),a.Rc(8,"\u0110ang c\u1eafm"),a.gc(),a.gc(),a.gc(),a.hc(9,"div",6),a.hc(10,"div",7),a.hc(11,"ul",8),a.Pc(12,Ae,34,28,"div",9),a.gc(),a.gc(),a.hc(13,"div",10),a.hc(14,"ul",8),a.Pc(15,ke,34,28,"div",9),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(16,"div",11),a.cc(17,"img",12),a.uc(18,"ImgPipe"),a.hc(19,"p",13),a.Rc(20),a.gc(),a.hc(21,"a",14),a.Rc(22),a.gc(),a.hc(23,"p",15),a.Rc(24),a.gc(),a.hc(25,"p",16),a.pc("click",(function(e){return t.logout()})),a.Rc(26,"\u0110\u0103ng xu\u1ea5t"),a.gc(),a.gc()),2&e&&(a.Ob(12),a.Ac("ngForOf",t.waitingOrderDetails),a.Ob(3),a.Ac("ngForOf",t.makingOrderDetails),a.Ob(2),a.Bc("src",a.wc(18,6,t.CurrentUser.Avt,"UserAvt"),a.Lc),a.Ob(3),a.Sc(t.CurrentUser.FullName),a.Ob(2),a.Sc(t.CurrentUser.PhoneNumber),a.Ob(2),a.Sc(t.CurrentUser.Role))},directives:[g.k,Pe],pipes:[M.a,w.a,w.c,w.b],styles:[""]}),e})();function Te(e,t){1&e&&(a.hc(0,"span",15),a.Rc(1,"\u0110\xe3 bao g\u1ed3m"),a.gc())}function Re(e,t){1&e&&(a.hc(0,"span",15),a.Rc(1,"Ch\u01b0a bao g\u1ed3m"),a.gc())}function we(e,t){if(1&e&&(a.hc(0,"div",22),a.hc(1,"span",14),a.Rc(2,"VAT: "),a.gc(),a.Pc(3,Te,2,0,"span",23),a.Pc(4,Re,2,0,"span",23),a.gc()),2&e){const e=a.tc();a.Ob(3),a.Ac("ngIf",e.orderDetail.IsVATIncluded),a.Ob(1),a.Ac("ngIf",!e.orderDetail.IsVATIncluded)}}function Me(e,t){if(1&e&&(a.hc(0,"div",24),a.hc(1,"span",14),a.Rc(2,"T\xean KH"),a.gc(),a.hc(3,"span",15),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.orderDetail.CustomerName)}}function Fe(e,t){if(1&e&&(a.hc(0,"div",24),a.hc(1,"span",14),a.Rc(2,"T\xean ng\u01b0\u1eddi nh\u1eadn"),a.gc(),a.hc(3,"span",15),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.orderDetail.DeliveryInfo.FullName)}}function Ne(e,t){if(1&e&&(a.hc(0,"div",24),a.hc(1,"span",14),a.Rc(2,"SDT KH"),a.gc(),a.hc(3,"span",15),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.orderDetail.CustomerPhoneNumber)}}function xe(e,t){if(1&e&&(a.hc(0,"div",24),a.hc(1,"span",14),a.Rc(2,"SDT ng\u01b0\u1eddi nh\u1eadn"),a.gc(),a.hc(3,"span",15),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.orderDetail.DeliveryInfo.PhoneNumber)}}function Le(e,t){if(1&e){const e=a.ic();a.hc(0,"button",25),a.pc("click",(function(t){return a.Jc(e),a.tc().gotToCusConfirm()})),a.Rc(1,"X\xe1c nh\u1eadn v\u1edbi Kh\xe1ch h\xe0ng"),a.gc()}}function Be(e,t){if(1&e){const e=a.ic();a.hc(0,"button",25),a.pc("click",(function(t){return a.Jc(e),a.tc().gotToCusConfirm()})),a.Rc(1,"Ch\u1ee5p \u1ea3nh"),a.gc()}}let Ue=(()=>{class e extends m{constructor(e,t){super(),this.router=e,this.orderDetailService=t,this.Title="X\xe1c nh\u1eadn th\xe0nh ph\u1ea9m",this.IsDataLosingWarning=!1}Init(){this.orderDetail=this.globalOrderDetail}gotToCusConfirm(){this.router.navigate(["staff/customer-confirming"])}confirm(){switch(this.CurrentUser.Role){case b.i.Account:case b.i.Admin:this.orderDetailService.getNextShippingSortOrder().then(e=>{this.orderDetailService.updateFields(this.globalOrderDetail.OrderDetailId,{State:b.e.DeliveryWaiting,ShippingSortOrder:e}).then(()=>{this.router.navigate(["staff/account-main"])})});break;case b.i.Shipper:this.orderDetailService.updateFields(this.globalOrderDetail.OrderDetailId,{ShippingSortOrder:0,State:b.e.Deliveried,DeliveryCompletedTime:(new Date).getTime()}).then(()=>{this.router.navigate(["staff/shipper-main"])})}}}return e.\u0275fac=function(t){return new(t||e)(a.bc(c.b),a.bc(L.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-order-detail-confirming"]],features:[a.Lb],decls:49,vars:29,consts:[["id","orderConfirm",1,"page-content"],[1,"container"],[1,"prodDetail"],[1,"prodGen"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPriceOld"],[1,"prodCharge"],[1,"prodPrice"],[1,"prodInfo","cusScroll"],["class","prodQuan infoGroup",4,"ngIf"],["class","prodName infoGroup",4,"ngIf"],[1,"prodAddr","infoGroup"],[1,"itemlabel"],[1,"itemVal"],[1,"prodTime","infoGroup"],[1,"prodDesc","infoGroup"],[1,"row"],[1,"col-10","mx-auto","text-center"],["type","button","class","btn main-btn w-100 mt-2",3,"click",4,"ngIf"],["type","button",1,"btn","grey-btn","w-100","mt-2",3,"click"],[1,"prodQuan","infoGroup"],["class","itemVal",4,"ngIf"],[1,"prodName","infoGroup"],["type","button",1,"btn","main-btn","w-100","mt-2",3,"click"]],template:function(e,t){1&e&&(a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"div",2),a.hc(3,"div",3),a.cc(4,"img",4),a.uc(5,"ImgPipe"),a.hc(6,"div",5),a.hc(7,"h5",6),a.Rc(8),a.gc(),a.hc(9,"h5",6),a.Rc(10),a.gc(),a.hc(11,"span",7),a.Rc(12),a.uc(13,"myCurrPipe"),a.gc(),a.hc(14,"span",8),a.Rc(15),a.uc(16,"myCurrPipe"),a.gc(),a.hc(17,"span",9),a.Rc(18),a.uc(19,"myCurrPipe"),a.gc(),a.gc(),a.gc(),a.hc(20,"div",10),a.Pc(21,we,5,2,"div",11),a.Pc(22,Me,5,1,"div",12),a.Pc(23,Fe,5,1,"div",12),a.Pc(24,Ne,5,1,"div",12),a.Pc(25,xe,5,1,"div",12),a.hc(26,"div",13),a.hc(27,"span",14),a.Rc(28,"\u0110\u1ecba ch\u1ec9 giao:"),a.gc(),a.hc(29,"span",15),a.Rc(30),a.gc(),a.gc(),a.hc(31,"div",16),a.hc(32,"span",14),a.Rc(33,"Th\u1eddi gian giao:"),a.gc(),a.hc(34,"span",15),a.Rc(35),a.uc(36,"date"),a.gc(),a.gc(),a.hc(37,"div",17),a.hc(38,"span",14),a.Rc(39,"M\xf4 t\u1ea3:"),a.gc(),a.hc(40,"span",15),a.Rc(41),a.gc(),a.gc(),a.gc(),a.hc(42,"div",18),a.hc(43,"div",19),a.Pc(44,Le,2,0,"button",20),a.Pc(45,Be,2,0,"button",20),a.gc(),a.hc(46,"div",19),a.hc(47,"button",21),a.pc("click",(function(e){return t.confirm()})),a.Rc(48,"Xong"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc()),2&e&&(a.Ob(4),a.Bc("src",a.wc(5,17,t.orderDetail.ProductImageUrl,"ProductImg"),a.Lc),a.Ob(4),a.Uc("",t.orderDetail.OrderId,"_",t.orderDetail.Index+1,""),a.Ob(2),a.Sc(t.orderDetail.ProductName),a.Ob(2),a.Sc(a.vc(13,20,t.orderDetail.OriginalPrice)),a.Ob(3),a.Tc("Ph\u1ee5 ph\xed: ",a.vc(16,22,t.orderDetail.AdditionalFee),""),a.Ob(3),a.Sc(a.vc(19,24,t.orderDetail.ModifiedPrice)),a.Ob(3),a.Ac("ngIf","Shipper"!=t.CurrentUser.Role),a.Ob(1),a.Ac("ngIf","Shipper"!=t.CurrentUser.Role),a.Ob(1),a.Ac("ngIf","Shipper"==t.CurrentUser.Role),a.Ob(1),a.Ac("ngIf","Shipper"!=t.CurrentUser.Role),a.Ob(1),a.Ac("ngIf","Shipper"==t.CurrentUser.Role),a.Ob(5),a.Sc(t.orderDetail.DeliveryInfo.Address),a.Ob(5),a.Sc(a.wc(36,26,t.orderDetail.DeliveryInfo.DateTime,"hh:mm a dd/MM/yyyy")),a.Ob(6),a.Sc(t.orderDetail.Description),a.Ob(3),a.Ac("ngIf","Shipper"!=t.CurrentUser.Role),a.Ob(1),a.Ac("ngIf","Shipper"==t.CurrentUser.Role))},directives:[g.l],pipes:[M.a,w.a,g.e],styles:[""]}),e})();var qe=i("cPV5");function Ve(e,t){if(1&e){const e=a.ic();a.hc(0,"li",42),a.pc("click",(function(i){a.Jc(e);const c=t.index;return a.tc().selectPromotion(c)})),a.hc(1,"p",43),a.Rc(2),a.gc(),a.hc(3,"span",44),a.Rc(4),a.gc(),a.hc(5,"span",45),a.Rc(6),a.uc(7,"myDatePipe"),a.uc(8,"myDatePipe"),a.gc(),a.gc()}if(2&e){const e=t.$implicit,i=t.index,c=a.tc();a.Pb("data-index",i),a.Ob(2),a.Sc(e.Name),a.Ob(2),a.Sc(c.getPromotionAmount(e)),a.Ob(2),a.Uc("",a.vc(7,5,e.StartTime),"-",a.vc(8,7,e.EndTime),"")}}let He=(()=>{class e extends m{constructor(e,t,i,c){super(),this.route=e,this.router=t,this.categoryService=i,this.promotionService=c,this.Title="Chi ti\u1ebft \u0111\u01a1n",this.categories=[],this.promotions=[]}getPromotionAmount(e){return e.PromotionType==S.b.Amount?e.Amount+" \u20ab":e.Amount+" %"}onAmountDiscountChanged(e){this.globalOrderDetail.AmountDiscount<10&&(this.globalOrderDetail.AmountDiscount*=1e3,this.moveCursor(this.globalOrderDetail.AmountDiscount.toString().length,"AmountDiscount")),this.globalOrderDetail.AmountDiscount=+this.globalOrderDetail.AmountDiscount}onAcmountDiscountFocus(){this.globalOrderDetail.AmountDiscount||(this.globalOrderDetail.AmountDiscount=0),this.moveCursor(this.globalOrderDetail.AmountDiscount.toString().length,"AmountDiscount")}onAddFeeChanged(e){this.globalOrderDetail.AdditionalFee<10&&(this.globalOrderDetail.AdditionalFee*=1e3,this.moveCursor(this.globalOrderDetail.AdditionalFee.toString().length,"AdditionalFee")),this.globalOrderDetail.AdditionalFee=+this.globalOrderDetail.AdditionalFee}onAddFeeFocus(){this.globalOrderDetail.AdditionalFee||(this.globalOrderDetail.AdditionalFee=0),this.moveCursor(this.globalOrderDetail.AdditionalFee.toString().length,"AdditionalFee")}onNewPriceChanged(e){this.newPrice<10&&(this.newPrice*=1e3,this.moveCursor(this.newPrice.toString().length,"NewPrice")),this.newPrice=+this.newPrice}onNewPriceFocus(){this.newPrice||(this.newPrice=0),this.moveCursor(this.newPrice.toString().length,"NewPrice")}Init(){this.promotionService.getAvailablePromotions((new Date).getTime(),!1).then(e=>{this.promotions=e}),this.route.params.subscribe(e=>{this.detailIndex=+e.id,this.globalOrderDetail.PurposeOf||(this.globalOrderDetail.PurposeOf="Mua t\u1eb7ng"),this.globalOrderDetail.ProductName||(this.globalOrderDetail.ProductName="...."),createNumbericElement(!1,e=>{this.globalOrderDetail.Quantity=e}),this.categoryService.getAll().then(e=>{this.categories.push({Value:-1,Name:"T\u1ea5t c\u1ea3"}),e.forEach(e=>{this.categories.push({Value:e.Id,Name:e.Name})})})})}clearProductImg(){this.globalOrderDetail.ProductImageUrl&&(this.globalOrderDetail.IsFromHardCodeProduct?this.globalOrderDetail.ProductImageUrl="":this.openConfirm("Ch\u1eafc ch\u0103c xo\xe1 \u1ea3nh n\xe0y? ",()=>{this.globalOrderDetail.ProductImageUrl=""}))}productNameChangeRequest(){getTextInput(e=>{""!=e&&(this.globalOrderDetail.ProductName=e,this.globalOrderDetail.IsFromHardCodeProduct=!0)},"C\u1eadp nh\u1eadt t\xean s\u1ea3n ph\u1ea9m...","...."==this.globalOrderDetail.ProductName?"":this.globalOrderDetail.ProductName)}insertModifiedValue(){this.newPrice=this.globalOrderDetail.ModifiedPrice,openFixPriceDialog()}submitPrice(){this.newPrice<0?this.showError("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!!"):(this.globalOrderDetail.ModifiedPrice=this.newPrice,dismissFixPriceDialog())}searchProduct(){selectProductCategory(this.categories,e=>{this.router.navigate(["/staff/search-product"],{queryParams:{category:+e},queryParamsHandling:"merge"})})}submitOrderDetail(e){if(!e.valid)return;if(this.globalOrderDetail.ModifiedPrice<=0)return void this.showError("Ch\u01b0a nh\u1eadp gi\xe1 ti\u1ec1n!");this.globalOrderDetail.Index=this.detailIndex>-1?this.detailIndex:this.globalOrder.OrderDetails.length;const t=f.c.DeepCopy(this.globalOrderDetail);this.insertOrderDetail(t)}insertOrderDetail(e){this.detailIndex>-1?this.globalOrder.OrderDetails[this.detailIndex]=e:this.globalOrder.OrderDetails.push(e),super.OnBackNaviage()}selectPromotion(e){this.globalOrderDetail.PercentDiscount=this.globalOrderDetail.AmountDiscount=0;let t=this.promotions[e];t.PromotionType==S.b.Amount?this.globalOrderDetail.AmountDiscount=t.Amount:this.globalOrderDetail.PercentDiscount=t.Amount,hideReceiverPopup()}}return e.\u0275fac=function(t){return new(t||e)(a.bc(c.a),a.bc(c.b),a.bc(qe.a),a.bc(k.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-order-detail"]],features:[a.Lb],decls:71,vars:16,consts:[["id","orderAdd",1,"page-content"],[1,"container"],["autocomplete","on",1,"addOrderForm",3,"submit"],["form","ngForm"],[1,"form-group","prodInfo"],[1,"prodImg"],["alt","",3,"src"],["src","../../../../assets/images/delete_white.svg","alt","",1,"close-img",3,"click"],[1,"prodContent"],[1,"prodCode"],[1,"prodPrice"],[1,"prodQuantity"],["type","number","readonly","","name","Quantity","id","Quantity","step","1","min","1",3,"ngModel","ngModelChange"],[1,"prodBrowser",3,"click"],[1,"fa","fa-search","main-bg"],[1,"row","col-xs-12",2,"margin-bottom","10px","padding-left","15px","padding-right","15px"],[1,"addInfo",2,"width","50%","padding-right","5px"],["href","javascript:void(0);",1,"btn","main-btn",3,"click"],[1,"addInfo",2,"width","50%","padding-left","5px"],[1,"form-group","addInfo"],["routerLink","/staff/select-receiver",1,"btn","main-btn"],[1,"title-field"],[1,"form-group","orderInfo"],["type","text","name","AdditionalFee","id","AdditionalFee","placeholder","Ph\u1ee5 ph\xed (k)...",1,"orderField",3,"ngModel","ngModelChange","input","focus"],["href","javascript:void(0)","onclick","openCustMenu()","type","button",1,"btn","main-btn","w-100",2,"margin-bottom","1vh","font-size","16px"],[1,"row","col-xs-12",2,"padding-left","15px","padding-right","15px"],["type","number","name","PercentDiscount","id","PercentDiscount","placeholder","%",1,"orderField",3,"ngModel","ngModelChange"],["type","tel","name","AmountDiscount","id","AmountDiscount","placeholder","0",1,"orderField",3,"ngModel","ngModelChange","input","focus"],["type","text","name","PurposeOf","id","PurposeOf","placeholder","M\u1ee5c \u0111\xedch mua h\xe0ng...",1,"orderField",3,"ngModel","ngModelChange"],[1,"form-group","orderDesc"],["name","Description","id","Description","placeholder","B\xecnh d\u1eb9p...",1,"orderField",3,"ngModel","ngModelChange"],[1,"row"],[1,"col-8","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100"],["id","recentInfo",1,"actionMenu2"],["style","height: 69px;text-align: left;",3,"click",4,"ngFor","ngForOf"],["id","inputDialog",1,"popup-content","dialog-popup"],[1,"form-group"],["type","tel","name","newPrice","id","NewPrice","placeholder","c\u1eadp nh\u1eadt gi\xe1 ti\u1ec1n...",1,"mainForm",3,"ngModel","ngModelChange","input","focus"],[1,"col-6"],["id","confirm-button",1,"main-btn","btn",3,"click"],["id","cancel-button","onClick","dismissFixPriceDialog()",1,"main-bg","border","btn"],[2,"height","69px","text-align","left",3,"click"],[1,"recentInfo-name"],[1,"recentInfo-phone",2,"width","25%"],[1,"recentInfo-date",2,"width","75%"]],template:function(e,t){if(1&e){const e=a.ic();a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"form",2,3),a.pc("submit",(function(i){a.Jc(e);const c=a.Hc(3);return t.submitOrderDetail(c)})),a.hc(4,"div",4),a.hc(5,"div",5),a.cc(6,"img",6),a.uc(7,"ImgPipe"),a.hc(8,"img",7),a.pc("click",(function(e){return t.clearProductImg()})),a.gc(),a.gc(),a.hc(9,"div",8),a.hc(10,"h5",9),a.Rc(11),a.gc(),a.hc(12,"span",10),a.Rc(13),a.uc(14,"myCurrPipe"),a.gc(),a.hc(15,"div",11),a.hc(16,"input",12),a.pc("ngModelChange",(function(e){return t.globalOrderDetail.Quantity=e})),a.gc(),a.gc(),a.gc(),a.hc(17,"div",13),a.pc("click",(function(e){return t.searchProduct()})),a.cc(18,"i",14),a.gc(),a.gc(),a.hc(19,"div",15),a.hc(20,"div",16),a.hc(21,"a",17),a.pc("click",(function(e){return t.productNameChangeRequest()})),a.Rc(22,"C\u1eadp nh\u1eadt T\xean"),a.gc(),a.gc(),a.hc(23,"div",18),a.hc(24,"a",17),a.pc("click",(function(e){return t.insertModifiedValue()})),a.Rc(25,"C\u1eadp nh\u1eadt gi\xe1"),a.gc(),a.gc(),a.gc(),a.hc(26,"div",19),a.hc(27,"a",20),a.Rc(28,"Th\xf4ng tin ng\u01b0\u1eddi nh\u1eadn"),a.gc(),a.gc(),a.hc(29,"label",21),a.Rc(30,"Ph\u1ee5 ph\xed"),a.gc(),a.hc(31,"div",22),a.hc(32,"input",23),a.pc("ngModelChange",(function(e){return t.globalOrderDetail.AdditionalFee=e}))("input",(function(e){return t.onAddFeeChanged(e.target.value)}))("focus",(function(e){return t.onAddFeeFocus()})),a.gc(),a.gc(),a.hc(33,"a",24),a.Rc(34,"\xc1p d\u1ee5ng khuy\u1ebfn m\xe3i"),a.gc(),a.hc(35,"div",25),a.hc(36,"div",16),a.hc(37,"label",21),a.Rc(38,"Gi\u1ea3m gi\xe1 ph\u1ea7n tr\u0103m "),a.gc(),a.hc(39,"div",22),a.hc(40,"input",26),a.pc("ngModelChange",(function(e){return t.globalOrderDetail.PercentDiscount=e})),a.gc(),a.gc(),a.gc(),a.hc(41,"div",18),a.hc(42,"label",21),a.Rc(43,"Gi\u1ea3m gi\xe1 ti\u1ec1n"),a.gc(),a.hc(44,"div",22),a.hc(45,"input",27),a.pc("ngModelChange",(function(e){return t.globalOrderDetail.AmountDiscount=e}))("input",(function(e){return t.onAmountDiscountChanged(e.target.value)}))("focus",(function(e){return t.onAcmountDiscountFocus()})),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(46,"label",21),a.Rc(47,"M\u1ee5c \u0111\xedch mua h\xe0ng"),a.gc(),a.hc(48,"div",22),a.hc(49,"input",28),a.pc("ngModelChange",(function(e){return t.globalOrderDetail.PurposeOf=e})),a.gc(),a.gc(),a.hc(50,"label",21),a.Rc(51,"M\xf4 t\u1ea3"),a.gc(),a.hc(52,"div",29),a.hc(53,"textarea",30),a.pc("ngModelChange",(function(e){return t.globalOrderDetail.Description=e})),a.gc(),a.gc(),a.hc(54,"div",31),a.hc(55,"div",32),a.hc(56,"button",33),a.Rc(57,"Xong"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(58,"div",34),a.hc(59,"ul"),a.Pc(60,Ve,9,9,"li",35),a.gc(),a.gc(),a.hc(61,"div",36),a.hc(62,"div",37),a.hc(63,"input",38),a.pc("ngModelChange",(function(e){return t.newPrice=e}))("input",(function(e){return t.onNewPriceChanged(e.target.value)}))("focus",(function(e){return t.onNewPriceFocus()})),a.gc(),a.gc(),a.hc(64,"div",31),a.hc(65,"div",39),a.hc(66,"button",40),a.pc("click",(function(e){return t.submitPrice()})),a.Rc(67,"X\xe1c nh\u1eadn"),a.gc(),a.gc(),a.hc(68,"div",39),a.hc(69,"button",41),a.Rc(70,"H\u1ee7y"),a.gc(),a.gc(),a.gc(),a.gc()}2&e&&(a.Ob(6),a.Bc("src",a.wc(7,11,t.globalOrderDetail.ProductImageUrl,"ProductImg"),a.Lc),a.Ob(5),a.Tc("",t.globalOrderDetail.ProductName," "),a.Ob(2),a.Sc(a.vc(14,14,t.globalOrderDetail.ModifiedPrice)),a.Ob(3),a.Ac("ngModel",t.globalOrderDetail.Quantity),a.Ob(16),a.Ac("ngModel",t.globalOrderDetail.AdditionalFee),a.Ob(8),a.Ac("ngModel",t.globalOrderDetail.PercentDiscount),a.Ob(5),a.Ac("ngModel",t.globalOrderDetail.AmountDiscount),a.Ob(4),a.Ac("ngModel",t.globalOrderDetail.PurposeOf),a.Ob(4),a.Ac("ngModel",t.globalOrderDetail.Description),a.Ob(7),a.Ac("ngForOf",t.promotions),a.Ob(3),a.Ac("ngModel",t.newPrice))},directives:[T.v,T.l,T.m,T.p,T.b,T.k,T.n,c.c,g.k],pipes:[M.a,w.a,w.b],styles:[""]}),e})();var Ee=i("Gdn9"),Je=i("tk/3"),We=i("qfBg"),Ge=i("Kj3r"),$e=i("vkgz");let je=(()=>{class e{constructor(e,t){this.formBuilder=e,this.ngForm=t,this.placeholder="",this.delayTimeSpan=1e3,this.searchTextInvoke=new a.q,this.onChange=e=>{},this.onTouched=()=>{},this.searchContent=new T.d,this.searchForm=this.formBuilder.group({searchContent:this.searchContent})}ngOnInit(){this.searchContent.valueChanges.pipe(Object(Ge.a)(this.delayTimeSpan),Object($e.a)()).subscribe(e=>{this.searchTextInvoke.emit(e)})}preventEvent(e){e.stopPropagation()}writeValue(e){e!==this.value&&(this.value=e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}updateChanges(){this.onChange(this.value)}}return e.\u0275fac=function(t){return new(t||e)(a.bc(T.c),a.bc(T.m,8))},e.\u0275cmp=a.Vb({type:e,selectors:[["mobile-search-box"]],inputs:{placeholder:"placeholder",delayTimeSpan:"delayTimeSpan"},outputs:{searchTextInvoke:"searchTextInvoke"},features:[a.Nb([{provide:T.j,useExisting:Object(a.fb)(()=>e),multi:!0}])],decls:2,vars:1,consts:[[3,"formGroup"],["type","text","placeholder","placeholder","formControlName","searchContent",1,"form-control"]],template:function(e,t){1&e&&(a.hc(0,"form",0),a.cc(1,"input",1),a.gc()),2&e&&a.Ac("formGroup",t.searchForm)},directives:[T.v,T.l,T.f,T.b,T.k,T.e],styles:[""]}),e})();var Xe=i("z17N");function Qe(e,t){if(1&e){const e=a.ic();a.hc(0,"li",71),a.hc(1,"app-status-point",72),a.pc("onClicked",(function(t){return a.Jc(e),a.tc(2).openDetailInfo(t)})),a.gc(),a.hc(2,"div",73),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit;return a.tc(2).updateOrderDetailState(c.OrderDetailId)})),a.cc(3,"img",74),a.uc(4,"ImgPipe"),a.hc(5,"div",75),a.hc(6,"h5",76),a.Rc(7),a.gc(),a.hc(8,"span",77),a.Rc(9),a.uc(10,"myCurrPipe"),a.gc(),a.hc(11,"span",78),a.Rc(12),a.gc(),a.hc(13,"span",79),a.Rc(14),a.uc(15,"myTimePipe"),a.gc(),a.hc(16,"span",64),a.Rc(17),a.uc(18,"myDatePipe"),a.gc(),a.gc(),a.gc(),a.gc()}if(2&e){const e=t.$implicit;a.Ob(1),a.Ac("state",e.State)("id",e.OrderDetailId)("index",e.Index+1),a.Ob(2),a.Bc("src",a.wc(4,9,e.ProductImageUrl,"ProductImg"),a.Lc),a.Ob(4),a.Sc(e.ProductName),a.Ob(2),a.Tc("Ph\u1ee5 ph\xed: ",a.vc(10,12,e.AdditionalFee),""),a.Ob(3),a.Sc(e.DeliveryInfo.Address),a.Ob(2),a.Sc(a.vc(15,14,e.DeliveryInfo.DateTime)),a.Ob(3),a.Sc(a.vc(18,16,e.DeliveryInfo.DateTime))}}function ze(e,t){if(1&e){const e=a.ic();a.hc(0,"li",57),a.hc(1,"div",58),a.hc(2,"span",59),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit;return a.tc().viewPurchase(c.OrderId)})),a.Rc(3),a.gc(),a.hc(4,"div",60),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit;return a.tc().selectOrder(c)})),a.hc(5,"h4",61),a.Rc(6),a.gc(),a.hc(7,"h4",62),a.Rc(8),a.gc(),a.hc(9,"span",63),a.Rc(10),a.uc(11,"myCurrPipe"),a.gc(),a.hc(12,"span",64),a.Rc(13),a.uc(14,"myDatePipe"),a.gc(),a.gc(),a.hc(15,"button",65),a.Rc(16,"m\u1edf"),a.gc(),a.gc(),a.hc(17,"div",66),a.hc(18,"ul",67),a.Pc(19,Qe,19,18,"li",68),a.gc(),a.hc(20,"a",69),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit;return a.tc().editOrder(c.OrderId)})),a.cc(21,"i",70),a.Rc(22," Ch\u1ec9nh s\u1eeda"),a.gc(),a.gc(),a.gc()}if(2&e){const e=t.$implicit,i=t.index;a.Ac("id","order"+i),a.Ob(1),a.Ac("id","heading"+i),a.Ob(2),a.Sc(e.OrderId),a.Ob(3),a.Sc(e.CustomerInfo.Name),a.Ob(2),a.Tc("tel: ",e.CustomerInfo.PhoneNumber,""),a.Ob(2),a.Tc("",a.vc(11,13,e.TotalAmount)," "),a.Ob(3),a.Sc(a.vc(14,15,e.DoneTime)),a.Ob(2),a.Pb("data-target","#collapse"+i)("aria-controls","collapse"+i),a.Ob(2),a.Ac("id","collapse"+i),a.Pb("aria-labelledby","heading"+i)("data-parent","#order"+i),a.Ob(2),a.Ac("ngForOf",e.OrderDetails)}}function Ke(e,t){if(1&e&&(a.hc(0,"li",44),a.hc(1,"label"),a.Rc(2,"Ng\u01b0\u1eddi s\u1eeda hoa: "),a.gc(),a.hc(3,"span"),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.selectedDetail.FixingFloristName)}}function _e(e,t){if(1&e&&(a.hc(0,"li",80),a.cc(1,"img",81),a.uc(2,"ImgPipe"),a.hc(3,"span",82),a.Rc(4),a.gc(),a.gc()),2&e){const e=t.$implicit;a.Bc("id",e.Id),a.Ob(1),a.Bc("src",a.wc(2,3,e.AvtUrl,"UserAvt"),a.Lc),a.Ob(3),a.Sc(e.FullName)}}function Ze(e,t){if(1&e&&(a.hc(0,"li",83),a.cc(1,"img",81),a.uc(2,"ImgPipe"),a.hc(3,"span",82),a.Rc(4),a.gc(),a.hc(5,"span",84),a.Rc(6),a.gc(),a.gc()),2&e){const e=t.$implicit;a.Bc("id",e.Id),a.Ob(1),a.Bc("src",a.wc(2,4,e.AvtUrl,"UserAvt"),a.Lc),a.Ob(3),a.Sc(e.FullName),a.Ob(2),a.Sc(e.IsExternalShipper?"Shipper ngo\xe0i":"Nh\xe2n vi\xean")}}let Ye=(()=>{class e extends m{constructor(e,t,i,c,r,n,o,a,s,h,d){super(),this.customerService=e,this.activatedRoute=t,this.router=i,this.orderService=c,this.storageService=r,this.productService=n,this.orderDetailService=o,this.http=a,this.datePipe=s,this.userService=h,this.printJobService=d,this.Title="Danh s\xe1ch \u0111\u01a1n",this.NavigateClass="nav-icon ",this.IsDataLosingWarning=!1,this.states=b.e,this.pageSize=20,this.currentPage=0,this.totalPage=0,this.statuses=[],this.searchTerm="",this.allStatuses=[b.e.Added,b.e.Comfirming,b.e.Deliveried,b.e.DeliverAssinged,b.e.DeliveryWaiting,b.e.Making,b.e.Waiting,b.e.SentBack,b.e.Fixing,b.e.FixingRequest,b.e.Completed,b.e.Canceled],this.selectedDetail={},this.globalService.currentOrderViewModel=new f.d,this.selectMakingRequestTime=new Date,this.orders=[],this.florists=[],this.shippers=[]}OnBackNaviage(){customerSupport()}filterByState(){var e=[];e.push({Name:"T\u1ea5t c\u1ea3",Value:"ALL"}),$.e.forEach(t=>{e.push({Name:t.DisplayName,Value:t.State})}),filterOrderByState(e,e=>{this.currentPage=0,this.statuses="ALL"==e?this.allStatuses:[e],this.orderService.searchOrders(this.currentPage,this.pageSize,this.statuses).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders})})}searchOrder(e){this.currentPage=0,this.searchTerm=e,this.orderService.searchOrders(this.currentPage,this.pageSize,this.statuses,this.searchTerm).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders})}goToPage(e){e>=this.totalPage||e<0||(this.currentPage=e,this.orderService.searchOrders(this.currentPage,this.pageSize,this.statuses,this.searchTerm).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders}))}logout(){this.authService.logOut(e=>{e&&this.router.navigate(["staff/login"])})}Init(){return Object(o.a)(this,void 0,void 0,(function*(){this.setStatusBarColor(!1),this.statuses=this.allStatuses,this.orderService.searchOrders(this.currentPage,this.pageSize,this.statuses).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders}),this.userService.getByRole(b.i.Florist).then(e=>{this.florists=e}),this.userService.getByRole(b.i.Shipper).then(e=>{this.shippers=e}),this.askForRememberPassword()}))}doPrintJob(e){let t=0;const i=[];e.OrderDetails.forEach(e=>{i.push({productName:e.ProductName,index:e.Index+1,price:e.ModifiedPrice,additionalFee:e.AdditionalFee,discount:this.getDetailDiscount(e.ModifiedPrice,e.PercentDiscount,e.AmountDiscount),quantity:e.Quantity}),t+=e.ModifiedPrice});let c=[];e.PurchaseItems&&e.PurchaseItems.forEach(e=>{e.Status==b.h.Completed&&c.push({method:e.Method,amount:e.Amount,status:e.Status})});const r={Created:(new Date).getTime(),Id:e.OrderId,Active:!0,IsDeleted:!1,saleItems:i,createdDate:e.CreatedDate.toLocaleString("en-US",{hour12:!0}),orderId:e.OrderId,summary:t,totalAmount:e.TotalAmount,totalPaidAmount:e.TotalPaidAmount,totalBalance:e.TotalAmount-e.TotalPaidAmount,vatIncluded:e.VATIncluded,memberDiscount:e.CustomerInfo.DiscountPercent,scoreUsed:e.CustomerInfo.ScoreUsed,gainedScore:e.CustomerInfo.GainedScore,totalScore:e.CustomerInfo.AvailableScore-e.CustomerInfo.ScoreUsed+e.CustomerInfo.GainedScore,customerName:e.CustomerInfo.Name,customerId:e.CustomerInfo.Id,discount:this.getDetailDiscount(e.TotalAmount,e.PercentDiscount,e.AmountDiscount),purchaseItems:c,isMemberDiscountApply:e.IsMemberDiscountApply};console.log(r),this.printJobService.addPrintJob(r)}getDetailDiscount(e,t,i){let c=0;return t&&t>0&&(c=e/100*t),i&&i>0&&(c+=i),c}selectOrder(e){this.menuOpening(t=>{switch(+t){case 0:this.viewPurchase(e.OrderId);break;case 1:this.doPrintJob(e);break;case 2:this.orderDetailService.updateStatusByOrderId(e.OrderId,b.e.Completed,(new Date).getTime()).then(e=>{this.orderService.searchOrders(this.currentPage,this.pageSize,this.statuses).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders})});break;case 3:this.orderDetailService.updateStatusByOrderId(e.OrderId,b.e.Canceled,0).then(e=>{this.orderService.searchOrders(this.currentPage,this.pageSize,this.statuses).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders})})}},["Th\xeam thanh to\xe1n","In ho\xe1 \u0111\u01a1n","Ho\xe0n t\u1ea5t \u0111\u01a1n","Hu\u1ef7 \u0111\u01a1n"])}editOrder(e){this.globalOrder=this.orders.filter(t=>t.OrderId===e)[0],this.globalPurchases=this.globalOrder.PurchaseItems,this.isEdittingOrder=!0,this.customerService.getById(this.globalOrder.CustomerInfo.Id).then(e=>{e&&(this.globalOrder.CustomerInfo=this.orderService.getCustomerInfo(e,this.globalOrder)),this.router.navigate(["/staff/add-order"])})}viewPurchase(e){this.globalOrder=this.orders.filter(t=>t.OrderId===e)[0],this.globalPurchases=this.globalOrder.PurchaseItems,this.router.navigate(["staff/view-purchase"])}addOrder(){this.globalOrder=new f.d,this.globalOrderDetail=new f.c,this.isEdittingOrder=!1,this.globalPurchases=[],this.router.navigate(["/staff/add-order"])}openDetailInfo(e){this.orders.forEach(t=>{let i=!1;t.OrderDetails.forEach(t=>{t.OrderDetailId!==e||this.orderDetailService.getODFlorisAndShipper(t.OrderDetailId).then(e=>{this.selectedDetail.FloristName=e.Florist?e.Florist.FullName:"...",this.selectedDetail.ShipperName=e.Shipper?e.Shipper.FullName:"...",this.selectedDetail.State=t.State,this.selectedDetail.FixingFloristName=e.FixingFlorist?e.FixingFlorist.FullName:"",this.selectedDetail.StateDisplay=$.e.filter(e=>e.State===t.State)[0].DisplayName,i=!0})})}),openColorBoard()}updateOrderDetailState(e){let t=new f.c,i=new f.d;switch(this.orders.forEach(c=>{c.OrderDetails.forEach(r=>{if(r.OrderDetailId===e)return t=r,void(i=c)})}),t.State){case b.e.Added:this.updateAddedDetailState(t,i);break;case b.e.Waiting:this.updateWaitingDetailState(t,i);break;case b.e.Making:this.updateMakingDetailState(t,i);break;case b.e.Comfirming:this.updatConfirmingDetailState(t,i);break;case b.e.Deliveried:this.updateDeliveriedDetailState(t,i);break;case b.e.DeliveryWaiting:this.updateDeliveryWaitingDetailState(t,i);break;case b.e.DeliverAssinged:this.updateDeliveringetailState(t,i);break;case b.e.SentBack:this.updateSentBackDetailState(t,i);break;case b.e.Completed:case b.e.Fixing:this.globalOrderDetail=t,this.globalOrder=i,this.router.navigate(["staff/order-detail-view"]);break;case b.e.FixingRequest:this.updateFixingRequestDetailState(t,i)}}updateFixingRequestDetailState(e,t){this.menuOpening(i=>{switch(+i){case 1:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 0:chooseFlorist(t=>{this.transferToFloristToFix(e,+t)});break;case 2:this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.Canceled,ShippingSortOrder:0,MakingSortOrder:0}).then(()=>{e.State=b.e.Canceled})}},["Ch\u1ecdn Florist","Xem chi ti\u1ebft","Hu\u1ef7  \u0111\u01a1n"])}updateSentBackDetailState(e,t){this.menuOpening(i=>{switch(+i){case 2:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 0:this.orderDetailService.getNextShippingSortOrder().then(t=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.DeliveryWaiting,ShippingSortOrder:t}).then(()=>{e.State=b.e.DeliveryWaiting})});break;case 1:this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"hh:mm a dd-MM-yyyy"),this.selectMakingRequestTime=new Date,this.makingNote=e.MakingNote,makingTimeRequest(()=>{this.transferToFloristToFix(e)},()=>{chooseFlorist(t=>{this.transferToFloristToFix(e,+t)})});break;case 3:this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.Canceled,ShippingSortOrder:0}).then(()=>{e.State=b.e.Canceled})}},["Giao sau","L\xe0m l\u1ea1i \u0111\u01a1n","Xem chi ti\u1ebft","Hu\u1ef7  \u0111\u01a1n"])}updateDeliveringetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 1:this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.Deliveried,ShippingSortOrder:0}).then(()=>{e.State=b.e.Deliveried});break;case 2:this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.Canceled,ShippingSortOrder:0}).then(()=>{e.State=b.e.Canceled})}},["Xem chi ti\u1ebft","Ho\xe0n th\xe0nh \u0111\u01a1n","Hu\u1ef7 chi ti\u1ebft \u0111\u01a1n"])}updateDeliveryWaitingDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:chooseShipper(t=>{this.orderDetailService.assignSingleOD(e.OrderDetailId,t,(new Date).getTime()).then(t=>{e.State=b.e.DeliverAssinged})});break;case 1:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 2:this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.Canceled,ShippingSortOrder:0}).then(()=>{e.State=b.e.Canceled})}},["Ch\u1ecdn Shipper","Xem chi ti\u1ebft","Hu\u1ef7 chi ti\u1ebft \u0111\u01a1n"])}updateMakingDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.Added,MakingSortOrder:0,MakingRequestTime:0,FloristId:null}).then(()=>{e.State=b.e.Added,e.MakingSortOrder=0,e.MakingRequestTime=0,e.FloristInfo=new O.b});break;case 1:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 2:this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.Canceled,MakingSortOrder:0}).then(()=>{e.State=b.e.Canceled})}},["X\u1eed l\xfd sau","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}updatConfirmingDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-confirming"]);break;case 1:this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"hh:mm a dd-MM-yyyy"),this.selectMakingRequestTime=e.DeliveryInfo.DateTime,this.makingNote="",makingTimeRequest(()=>{this.transferToFlorist(e,t)},()=>{chooseFlorist(i=>{this.transferToFlorist(e,t,+i)})});break;case 2:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 3:this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.Canceled,MakingSortOrder:0,MakingRequestTime:0}).then(()=>{e.State=b.e.Canceled,e.MakingSortOrder=0,e.MakingRequestTime=0,this.deleteOrderDetail(e,t)})}},["X\xe1c nh\u1eadn th\xe0nh ph\u1ea9m","L\xe0m l\u1ea1i \u0111\u01a1n","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}updateDeliveriedDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/final-confirm"]);break;case 1:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 2:this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.Canceled,MakingSortOrder:0,MakingRequestTime:0}).then(()=>{e.State=b.e.Canceled,e.MakingSortOrder=0,e.MakingRequestTime=0,this.deleteOrderDetail(e,t)})}},["X\xe1c nh\u1eadn giao","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}updateWaitingDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.Added,MakingSortOrder:0,MakingRequestTime:0}).then(()=>{e.State=b.e.Added,e.MakingSortOrder=0,e.FloristInfo=new O.b,e.MakingRequestTime=0});break;case 1:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 2:this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.Canceled,MakingSortOrder:0,MakingRequestTime:0}).then(()=>{e.State=b.e.Canceled,e.MakingSortOrder=0,e.MakingRequestTime=0,this.deleteOrderDetail(e,t)})}},["X\u1eed l\xfd sau","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}transferToFlorist(e,t,i){console.log("edit:",e),i?this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.Making,MakingSortOrder:0,MakingRequestTime:this.selectMakingRequestTime.getTime(),MakingNote:this.makingNote,FloristId:i}).then(()=>{e.MakingSortOrder=0,e.State=b.e.Making,e.MakingRequestTime=this.selectMakingRequestTime.getTime(),e.MakingNote=this.makingNote}):this.orderDetailService.getNextMakingSortOrder().then(t=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.Waiting,MakingSortOrder:t,MakingRequestTime:this.selectMakingRequestTime.getTime(),MakingNote:this.makingNote}).then(()=>{e.MakingSortOrder=t,e.State=b.e.Waiting,e.MakingRequestTime=this.selectMakingRequestTime.getTime(),e.MakingNote=this.makingNote})})}transferToFloristToFix(e,t){this.orderDetailService.getNextMakingSortOrder().then(i=>{let c={};c=t?{State:b.e.Fixing,MakingSortOrder:0,MakingRequestTime:this.selectMakingRequestTime.getTime(),MakingNote:this.makingNote,FixingFloristId:t}:{State:b.e.FixingRequest,MakingSortOrder:i,MakingRequestTime:this.selectMakingRequestTime.getTime(),MakingNote:this.makingNote},this.orderDetailService.updateFields(e.OrderDetailId,c).then(()=>{e.State=t?b.e.Fixing:b.e.FixingRequest,e.MakingSortOrder=t?0:i,e.MakingRequestTime=this.selectMakingRequestTime.getTime(),e.MakingNote=this.makingNote})})}updateAddedDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd/MM/yyyy"),this.selectMakingRequestTime=e.MakingRequestTime?new Date(e.MakingRequestTime):e.DeliveryInfo.DateTime,this.makingNote=e.MakingNote?e.MakingNote:"",makingTimeRequest(()=>{this.transferToFlorist(e,t)},()=>{chooseFlorist(i=>{this.transferToFlorist(e,t,+i)})});break;case 1:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 2:this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.Canceled,MakingSortOrder:0}).then(()=>{e.State=b.e.Canceled,e.MakingSortOrder=0,this.deleteOrderDetail(e,t)})}},["Chuy\u1ec3n cho Florist","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}deleteOrderDetail(e,t){let i=t.OrderDetails.indexOf(e);if(t.OrderDetails.splice(i,1),t.OrderDetails.length<=0){let e=this.orders.filter(e=>e.OrderId==t.OrderId)[0];this.orders.splice(this.orders.indexOf(e),1)}}}return e.\u0275fac=function(t){return new(t||e)(a.bc(P.a),a.bc(c.a),a.bc(c.b),a.bc(C.a),a.bc(j),a.bc(Ee.a),a.bc(L.a),a.bc(Je.a),a.bc(w.b),a.bc(We.a),a.bc(A.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-orders-manage"]],features:[a.Lb],decls:92,vars:22,consts:[["id","order",1,"page-content"],[1,"container","order-add"],[1,"row"],[1,"col-2"],[1,"col-8","text-center"],["href","javascript:void(0);",1,"btn","main-btn",3,"click"],[1,"col-2","order-noti","text-right"],["routerLink","/staff/add-purchse"],["src","../../../assets/images/money.svg","alt","",1,"main-filter"],[1,"container","order-list"],[1,"row","order-list-top"],[1,"col-2","order-filter","text-left",3,"click"],[1,"main-bg"],["src","../../../assets/images/filter.svg","alt","",1,"main-filter"],[1,"col-8","order-search"],["placeholder","T\xean ho\u1eb7c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i KH...",3,"delayTimeSpan","searchTextInvoke"],[1,"col-2","order-check","text-right"],["routerLink","/staff/sort-order-changing",1,"main-bg"],["src","../../../assets/images/check.svg","alt","",1,"main-filter"],[1,"paging"],[1,"paging-arrow","paging-prev","main-bg",3,"click"],[1,"fa","fa-angle-left"],[1,"paging-arrow","paging-next","main-bg",3,"click"],[1,"fa","fa-angle-right"],[1,"row","order-list-bot"],["id","accordionOrder",1,"col-12","order-content","accordion","cusScroll"],["class","order-content-item",3,"id",4,"ngFor","ngForOf"],["id","makingTimeRequest",1,"popup-content"],[2,"font-weight","bold","font-size","15px","margin-left","3px"],[1,"form-group"],[1,"custom-label"],["id","request-time","name","DateTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],["id","makingNote","name","makingNote",1,"mainForm",2,"width","100%","height","130px",3,"ngModel","ngModelChange"],[1,"col-12","mx-auto","text-center"],["type","button","id","choose-florist-btn",1,"btn","main-btn","w-100","mt-3"],[1,"col-6","mx-auto","text-center"],["type","button","id","submit-btn",1,"btn","main-btn","w-100","mt-3"],["type","button","id","cancel-btn",1,"btn","grey-btn","w-100","mt-3"],["id","colorBoard",1,"popup-content"],[1,"colorList"],[1,"colorInfo","colorItem"],[3,"state"],[1,"colorInfo"],["class","colorInfo",4,"ngIf"],["id","viewed",1,"popup-content","florist"],[1,"viewedList"],["class","viewItem",3,"id",4,"ngFor","ngForOf"],["id","viewed",1,"popup-content","shipper"],["class","viewItem-three-column",3,"id",4,"ngFor","ngForOf"],[1,"customer-support"],["alt","",1,"customer-avatar",3,"src"],[1,"customer-name"],["href","tel:0000",1,"customer-phone"],[1,"customer-position"],["id","logoutBtn",1,"customer-position",3,"click"],[1,"order-content-item",3,"id"],[1,"item-top",3,"id"],[1,"item-code",3,"click"],[1,"item-info",3,"click"],[1,"item-name"],[1,"item-name",2,"font-size","12px","margin-top","1px"],[1,"item-price"],[1,"item-date"],["data-toggle","collapse","aria-expanded","false",1,"collapsed"],[1,"item-bot","collapse",3,"id"],[1,"order-product-list","cusScroll"],["class","order-product-item",4,"ngFor","ngForOf"],["href","javascript:void(0);",1,"order-edit",3,"click"],[1,"fa","fa-pencil"],[1,"order-product-item"],[3,"state","id","index","onClicked"],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"item-quantity"],[1,"item-address"],[1,"item-time"],[1,"viewItem",3,"id"],["alt","",1,"itemAva",3,"src"],[1,"itemName"],[1,"viewItem-three-column",3,"id"],[1,"itemRole"]],template:function(e,t){if(1&e&&(a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"div",2),a.cc(3,"div",3),a.hc(4,"div",4),a.hc(5,"a",5),a.pc("click",(function(e){return t.addOrder()})),a.Rc(6,"Th\xeam \u0111\u01a1n"),a.gc(),a.gc(),a.hc(7,"div",6),a.hc(8,"a",7),a.cc(9,"img",8),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(10,"div",9),a.hc(11,"div",10),a.hc(12,"div",11),a.pc("click",(function(e){return t.filterByState()})),a.hc(13,"a",12),a.cc(14,"img",13),a.gc(),a.gc(),a.hc(15,"div",14),a.hc(16,"mobile-search-box",15),a.pc("searchTextInvoke",(function(e){return t.searchOrder(e)})),a.gc(),a.gc(),a.hc(17,"div",16),a.hc(18,"a",17),a.cc(19,"img",18),a.gc(),a.gc(),a.gc(),a.hc(20,"ul",19),a.hc(21,"li",20),a.pc("click",(function(e){return t.goToPage(t.currentPage-1)})),a.cc(22,"i",21),a.gc(),a.hc(23,"li",22),a.pc("click",(function(e){return t.goToPage(t.currentPage+1)})),a.cc(24,"i",23),a.gc(),a.gc(),a.hc(25,"div",24),a.hc(26,"ul",25),a.Pc(27,ze,23,17,"li",26),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(28,"div",27),a.hc(29,"label"),a.Rc(30,"Th\u1eddi gian giao: "),a.gc(),a.hc(31,"span",28),a.Rc(32),a.gc(),a.hc(33,"div",29),a.hc(34,"label",30),a.Rc(35,"Th\u1eddi gian ho\xe0n th\xe0nh: "),a.gc(),a.hc(36,"input",31),a.pc("ngModelChange",(function(e){return t.selectMakingRequestTime=e})),a.gc(),a.cc(37,"owl-date-time",32,33),a.gc(),a.hc(39,"div",29),a.hc(40,"label",30),a.Rc(41,"Ghi ch\xfa: "),a.gc(),a.hc(42,"textarea",34),a.pc("ngModelChange",(function(e){return t.makingNote=e})),a.gc(),a.gc(),a.hc(43,"div",2),a.hc(44,"div",35),a.hc(45,"button",36),a.Rc(46,"Ch\u1ec9 \u0111\u1ecbnh Florist"),a.gc(),a.gc(),a.gc(),a.hc(47,"div",2),a.hc(48,"div",37),a.hc(49,"button",38),a.Rc(50,"L\u01b0u"),a.gc(),a.gc(),a.hc(51,"div",37),a.hc(52,"button",39),a.Rc(53,"H\u1ee7y"),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(54,"div",40),a.hc(55,"ul",41),a.hc(56,"li",42),a.cc(57,"app-status-point",43),a.hc(58,"label"),a.Rc(59),a.gc(),a.gc(),a.hc(60,"li",44),a.hc(61,"label"),a.Rc(62,"Ng\u01b0\u1eddi c\u1eafm hoa: "),a.gc(),a.hc(63,"span"),a.Rc(64),a.gc(),a.gc(),a.hc(65,"li",44),a.hc(66,"label"),a.Rc(67,"Ng\u01b0\u1eddi giao hoa: "),a.gc(),a.hc(68,"span"),a.Rc(69),a.gc(),a.gc(),a.Pc(70,Ke,5,1,"li",45),a.gc(),a.gc(),a.hc(71,"div",46),a.hc(72,"h3",12),a.Rc(73,"Ch\u1ecdn Florist"),a.gc(),a.hc(74,"ul",47),a.Pc(75,_e,5,6,"li",48),a.gc(),a.gc(),a.hc(76,"div",49),a.hc(77,"h3",12),a.Rc(78,"Ch\u1ecdn Shipper"),a.gc(),a.hc(79,"ul",47),a.Pc(80,Ze,7,7,"li",50),a.gc(),a.gc(),a.hc(81,"div",51),a.cc(82,"img",52),a.uc(83,"ImgPipe"),a.hc(84,"p",53),a.Rc(85),a.gc(),a.hc(86,"a",54),a.Rc(87),a.gc(),a.hc(88,"p",55),a.Rc(89),a.gc(),a.hc(90,"p",56),a.pc("click",(function(e){return t.logout()})),a.Rc(91,"\u0110\u0103ng xu\u1ea5t"),a.gc(),a.gc()),2&e){const e=a.Hc(38);a.Ob(16),a.Ac("delayTimeSpan",1e3),a.Ob(11),a.Ac("ngForOf",t.orders),a.Ob(5),a.Sc(t.selectDeliveryTime),a.Ob(4),a.Ac("owlDateTime",e)("owlDateTimeTrigger",e)("ngModel",t.selectMakingRequestTime),a.Ob(1),a.Ac("stepMinute",5),a.Ob(5),a.Ac("ngModel",t.makingNote),a.Ob(15),a.Ac("state",t.selectedDetail.State),a.Ob(2),a.Sc(t.selectedDetail.StateDisplay),a.Ob(5),a.Sc(t.selectedDetail.FloristName),a.Ob(5),a.Sc(t.selectedDetail.ShipperName),a.Ob(1),a.Ac("ngIf",t.selectedDetail&&void 0!==t.selectedDetail.FixingFloristName&&""!==t.selectedDetail.FixingFloristName),a.Ob(5),a.Ac("ngForOf",t.florists),a.Ob(5),a.Ac("ngForOf",t.shippers),a.Ob(2),a.Bc("src",a.wc(83,19,t.CurrentUser.Avt,"UserAvt"),a.Lc),a.Ob(3),a.Sc(t.CurrentUser.FullName),a.Ob(2),a.Sc(t.CurrentUser.PhoneNumber),a.Ob(2),a.Sc(t.CurrentUser.Role)}},directives:[c.c,je,g.k,Xe.c,T.b,Xe.f,T.k,T.n,Xe.b,Pe,g.l],pipes:[M.a,w.a,w.b,w.c],styles:[".item-detail-info[_ngcontent-%COMP%]   .item-date[_ngcontent-%COMP%]{margin-left:7px}"]}),e})();function et(e,t){if(1&e&&(a.hc(0,"div",37),a.hc(1,"div",10),a.Rc(2),a.gc(),a.hc(3,"div",11),a.Rc(4),a.gc(),a.hc(5,"div",12),a.Rc(6),a.gc(),a.gc()),2&e){const e=t.$implicit;a.Pb("data-id",e.Id),a.Ob(2),a.Sc(e.FullName),a.Ob(2),a.Sc(e.PhoneNumber),a.Ob(2),a.Sc(e.MembershipInfo.MembershipType)}}function tt(e,t){1&e&&(a.hc(0,"div"),a.Rc(1," M\xe3 l\xe0 b\u1eaft bu\u1ed9c "),a.gc())}function it(e,t){1&e&&(a.hc(0,"div"),a.Rc(1," T\xean t\u1ed1i thi\u1ec3u 3 k\xfd t\u1ef1 "),a.gc())}function ct(e,t){if(1&e&&(a.hc(0,"div",38),a.Pc(1,tt,2,0,"div",39),a.Pc(2,it,2,0,"div",39),a.gc()),2&e){a.tc();const e=a.Hc(27);a.Ob(1),a.Ac("ngIf",e.errors.required),a.Ob(1),a.Ac("ngIf",e.errors.minlength)}}function rt(e,t){1&e&&(a.hc(0,"div"),a.Rc(1," T\xean l\xe0 b\u1eaft bu\u1ed9c "),a.gc())}function nt(e,t){1&e&&(a.hc(0,"div"),a.Rc(1," T\xean t\u1ed1i thi\u1ec3u 1 k\xfd t\u1ef1 "),a.gc())}function ot(e,t){if(1&e&&(a.hc(0,"div",38),a.Pc(1,rt,2,0,"div",39),a.Pc(2,nt,2,0,"div",39),a.gc()),2&e){a.tc();const e=a.Hc(31);a.Ob(1),a.Ac("ngIf",e.errors.required),a.Ob(1),a.Ac("ngIf",e.errors.minlength)}}function at(e,t){1&e&&(a.hc(0,"div"),a.Rc(1," SDT l\xe0 b\u1eaft bu\u1ed9c "),a.gc())}function st(e,t){1&e&&(a.hc(0,"div"),a.Rc(1," SDT t\u1ed1i thi\u1ec3u 9 k\xfd t\u1ef1 "),a.gc())}function ht(e,t){if(1&e&&(a.hc(0,"div",38),a.Pc(1,at,2,0,"div",39),a.Pc(2,st,2,0,"div",39),a.gc()),2&e){a.tc();const e=a.Hc(35);a.Ob(1),a.Ac("ngIf",e.errors.required),a.Ob(1),a.Ac("ngIf",e.errors.minlength)}}function dt(e,t){if(1&e&&(a.hc(0,"li",35),a.hc(1,"label"),a.Rc(2,"Ng\xe0y sinh: "),a.gc(),a.hc(3,"span"),a.Rc(4),a.uc(5,"myDatePipe"),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(a.vc(5,1,e.selectedCustomer.Birthday))}}function lt(e,t){if(1&e&&(a.hc(0,"li",35),a.hc(1,"label"),a.Rc(2,"Facebook: "),a.gc(),a.hc(3,"span"),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.selectedCustomer.ContactInfo.Facebook)}}function gt(e,t){if(1&e&&(a.hc(0,"li",35),a.hc(1,"label"),a.Rc(2,"Zalo: "),a.gc(),a.hc(3,"span"),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.selectedCustomer.ContactInfo.Zalo)}}function ut(e,t){if(1&e&&(a.hc(0,"li",35),a.hc(1,"label"),a.Rc(2,"Instagram: "),a.gc(),a.hc(3,"span"),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.selectedCustomer.ContactInfo.Instagram)}}function pt(e,t){if(1&e&&(a.hc(0,"li",35),a.hc(1,"label"),a.Rc(2,"Skype: "),a.gc(),a.hc(3,"span"),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.selectedCustomer.ContactInfo.Skype)}}let mt=(()=>{class e extends m{constructor(e,t){super(),this.customerService=e,this._ngZone=t,this.Title="Ch\u1ecdn kh\xe1ch h\xe0ng",this.IsDataLosingWarning=!1,this.totalCount=0,this.newCustomer=new I.a,this.customers=[],this.selectedCustomer=new I.a,window.searchProdReference={component:this,zone:this._ngZone,itemSelected:e=>this.setSelectedCustomer(e)}}setSelectedCustomer(e){this.selectedCustomer=this.customers.filter(t=>t.Id===e)[0],this.menuOpening(e=>{switch(+e){case 0:this.selectConfirm();break;case 1:viewCustomerInfo()}},["Ch\u1ecdn Kh\xe1ch h\xe0ng","Xem th\xf4ng tin chi ti\u1ebft"])}Init(){this.customerService.getCount().then(e=>{this.totalCount=e+1,this.newCustomer=new I.a,this.newCustomer.Id=v.a.detectCustomerId(this.totalCount)}),this.selectedCustomer=new I.a,this.globalOrder.CustomerInfo&&this.searchCustomer(this.globalOrder.CustomerInfo.PhoneNumber)}addCustomer(e){if(!e.valid)return;this.selectedCustomer=null;const t=new I.a;t.FullName=this.newCustomer.FullName,t.PhoneNumber=this.newCustomer.PhoneNumber,t.MembershipInfo.MembershipType=b.c.NewCustomer,t.MembershipInfo.AccumulatedAmount=0,t.MembershipInfo.AvailableScore=0,t.MembershipInfo.UsedScoreTotal=0,t.Id=this.newCustomer.Id,this.customerService.createCustomer(t).then(e=>{this.newCustomer=new I.a,this.selectedCustomer=t,this.customers.push(t),this.globalOrder.CustomerInfo=f.a.toViewModel(this.selectedCustomer),setSelectedCustomerItem(this.globalOrder.CustomerInfo.Id),closeAddCustomerDialog(),this.totalCount+=1,this.newCustomer=new I.a,this.newCustomer.Id=v.a.detectCustomerId(this.totalCount)})}selectConfirm(){null!=this.selectedCustomer?this.globalOrder.CustomerInfo.Id!==this.selectedCustomer.Id?(this.globalOrder.CustomerInfo=f.a.toViewModel(this.selectedCustomer),this.OnBackNaviage()):this.OnBackNaviage():this.showError("Ch\u01b0a ch\u1ecdn kh\xe1ch h\xe0ng n\xe0o c\u1ea3!!!")}searchCustomer(e){e&&""!=e?this.customerService.getList(-1,-1,b.c.All,e).then(e=>{this.customers=e.Customers,setTimeout(()=>{this.globalOrder.CustomerInfo.Id&&(setSelectedCustomerItem(this.globalOrder.CustomerInfo.Id),this.selectedCustomer=e.Customers.find(e=>e.Id===this.globalOrder.CustomerInfo.Id))},50)}):this.customers=[]}}return e.\u0275fac=function(t){return new(t||e)(a.bc(P.a),a.bc(a.H))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-select-customer"]],features:[a.Lb],decls:61,vars:15,consts:[["id","customerInfo",1,"page-content"],[1,"container"],[1,"row","checkTop","search"],[1,"col-10","filterSearch"],["placeholder","T\xean ho\u1eb7c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i KH...",3,"delayTimeSpan","searchTextInvoke"],[1,"col-2","filterAdd","text-right"],["onclick","openAddInfo()",1,"main-bg"],["src","../../../../assets/images/addnew.svg","alt","",1,"main-filter"],[1,"nameTable"],[1,"tableHead"],[1,"tableLeft"],[1,"tableCenter"],[1,"tableRight"],["id","customer-list",1,"tableBody","cusScroll"],["class","tableRow main-bg customer-item","onclick","selectItem(this,'.customer-item')",4,"ngFor","ngForOf"],[1,"row","prodDone"],[1,"col-8","mx-auto","text-center"],["href","javascript:void(0);",1,"btn","main-btn","w-100",3,"click"],["id","infoAdd",1,"popup-content"],["autocomplete","on",1,"addInfoForm",3,"submit"],["form","ngForm"],[1,"form-group"],["type","text","name","Id","id","Id","required","","minlength","3","placeholder","M\xe3 KH...",1,"mainForm",3,"ngModel","ngModelChange"],["Id","ngModel"],["class","alert alert-danger",4,"ngIf"],["type","text","name","FullName","id","FullName","required","","minlength","1","placeholder","T\xean \u0111\u1ea7y \u0111\u1ee7 ...",1,"mainForm",3,"ngModel","ngModelChange"],["FullName","ngModel"],["type","tel","name","PhoneNumber","id","PhoneNumber","minlength","9","placeholder","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i...",1,"mainForm",3,"ngModel","ngModelChange"],["PhoneNumber","ngModel"],[1,"row"],[1,"col-6","mx-auto","text-center"],["type","button","id","cancel-button",1,"btn","grey-btn","w-100","mt-3"],["type","submit",1,"btn","main-btn","w-100","mt-3","btn-success"],["id","colorBoard",1,"popup-content"],[1,"colorList"],[1,"colorInfo"],["class","colorInfo",4,"ngIf"],["onclick","selectItem(this,'.customer-item')",1,"tableRow","main-bg","customer-item"],[1,"alert","alert-danger"],[4,"ngIf"]],template:function(e,t){if(1&e){const e=a.ic();a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"div",2),a.hc(3,"div",3),a.hc(4,"mobile-search-box",4),a.pc("searchTextInvoke",(function(e){return t.searchCustomer(e)})),a.gc(),a.gc(),a.hc(5,"div",5),a.hc(6,"button",6),a.cc(7,"img",7),a.gc(),a.gc(),a.gc(),a.hc(8,"div",8),a.hc(9,"div",9),a.hc(10,"div",10),a.Rc(11,"H\u1ecd t\xean"),a.gc(),a.hc(12,"div",11),a.Rc(13,"SDT"),a.gc(),a.hc(14,"div",12),a.Rc(15,"Th\xe0nh vi\xean"),a.gc(),a.gc(),a.hc(16,"div",13),a.Pc(17,et,7,4,"div",14),a.gc(),a.gc(),a.hc(18,"div",15),a.hc(19,"div",16),a.hc(20,"a",17),a.pc("click",(function(e){return t.selectConfirm()})),a.Rc(21,"Xong"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(22,"div",18),a.hc(23,"form",19,20),a.pc("submit",(function(i){a.Jc(e);const c=a.Hc(24);return t.addCustomer(c)})),a.hc(25,"div",21),a.hc(26,"input",22,23),a.pc("ngModelChange",(function(e){return t.newCustomer.Id=e})),a.gc(),a.Pc(28,ct,3,2,"div",24),a.gc(),a.hc(29,"div",21),a.hc(30,"input",25,26),a.pc("ngModelChange",(function(e){return t.newCustomer.FullName=e})),a.gc(),a.Pc(32,ot,3,2,"div",24),a.gc(),a.hc(33,"div",21),a.hc(34,"input",27,28),a.pc("ngModelChange",(function(e){return t.newCustomer.PhoneNumber=e})),a.gc(),a.Pc(36,ht,3,2,"div",24),a.gc(),a.hc(37,"div",29),a.hc(38,"div",30),a.hc(39,"button",31),a.Rc(40,"H\u1ee7y"),a.gc(),a.gc(),a.hc(41,"div",30),a.hc(42,"button",32),a.Rc(43,"L\u01b0u"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(44,"div",33),a.hc(45,"ul",34),a.hc(46,"li",35),a.hc(47,"label"),a.Rc(48,"H\u1ecd t\xean:"),a.gc(),a.hc(49,"span"),a.Rc(50),a.gc(),a.gc(),a.hc(51,"li",35),a.hc(52,"label"),a.Rc(53,"SDT: "),a.gc(),a.hc(54,"span"),a.Rc(55),a.gc(),a.gc(),a.Pc(56,dt,6,3,"li",36),a.Pc(57,lt,5,1,"li",36),a.Pc(58,gt,5,1,"li",36),a.Pc(59,ut,5,1,"li",36),a.Pc(60,pt,5,1,"li",36),a.gc(),a.gc()}if(2&e){const e=a.Hc(27),i=a.Hc(31),c=a.Hc(35);a.Ob(4),a.Ac("delayTimeSpan",1e3),a.Ob(13),a.Ac("ngForOf",t.customers),a.Ob(9),a.Ac("ngModel",t.newCustomer.Id),a.Ob(2),a.Ac("ngIf",e.invalid&&(e.dirty||e.touched)),a.Ob(2),a.Ac("ngModel",t.newCustomer.FullName),a.Ob(2),a.Ac("ngIf",i.invalid&&(i.dirty||i.touched)),a.Ob(2),a.Ac("ngModel",t.newCustomer.PhoneNumber),a.Ob(2),a.Ac("ngIf",c.invalid&&(c.dirty||c.touched)),a.Ob(14),a.Sc(t.selectedCustomer.FullName),a.Ob(5),a.Sc(t.selectedCustomer.PhoneNumber),a.Ob(1),a.Ac("ngIf",t.selectedCustomer.Birthday&&t.selectedCustomer.Birthday>0),a.Ob(1),a.Ac("ngIf",t.selectedCustomer.ContactInfo&&t.selectedCustomer.ContactInfo.Facebook),a.Ob(1),a.Ac("ngIf",t.selectedCustomer.ContactInfo&&t.selectedCustomer.ContactInfo.Zalo),a.Ob(1),a.Ac("ngIf",t.selectedCustomer.ContactInfo&&t.selectedCustomer.ContactInfo.Instagram),a.Ob(1),a.Ac("ngIf",t.selectedCustomer.ContactInfo&&t.selectedCustomer.ContactInfo.Skype)}},directives:[je,g.k,T.v,T.l,T.m,T.b,T.r,T.h,T.k,T.n,g.l],pipes:[w.b],styles:[""]}),e})();var ft=i("nAti"),bt=i("kLqA"),vt=i("sWfF");class Ot extends vt.a{}class St extends Ot{constructor(){super(),this.FolderName="/tempProduct"}}let Dt=(()=>{class e extends class{constructor(){const e=s.a.getInjector();this.globalService=e.get(h.a),this.storageService=e.get(j)}get tableRef(){return this.db.ref(this.tableName)}startLoading(){this.globalService.startLoading()}stopLoading(){this.globalService.stopLoading()}errorToast(e){this.globalService.showError(e)}infoToast(e){this.globalService.showInfo(e)}warningToast(e){this.globalService.showWarning(e)}successToast(e){this.globalService.showSuccess(e)}get db(){return null}deleteFileByUrl(e,t){e&&""!==e?(this.startLoading(),this.tableRef.orderByChild("Url").equalTo(e).once("value").then(e=>{var i;if(e.forEach(e=>{i=e.val()}),!i)return this.stopLoading(),void t(!0);this.storageService.deleteFile(i.Name,i.FolderName).then(()=>{this.stopLoading(),t(!0),this.delete(i.Id)}).catch(e=>{t(!1),this.stopLoading(),this.errorToast(e)})})):t(!0)}updateList(e,t){return this.tableRef.update(e,e=>{e?this.errorToast(e.message):t()})}getByFieldName(e,t){return this.globalService.startLoading(),this.tableRef.orderByChild(e).equalTo(t).once("value").then(e=>{this.globalService.stopLoading();const t=[];return e.forEach(e=>{const i=e.val();t.push(i)}),t}).catch(e=>(this.globalService.stopLoading(),this.globalService.showError(e),[]))}setAnotherEntity(e,t){return this.db.ref(`${t}/${e.Id}`).set(e).then(t=>{if(t)return e})}set(e){return e.Id&&""!=e.Id||(e.Id=bt.Guid.create().toString()),this.startLoading(),this.db.ref(`${this.tableName}/${e.Id}`).set(e).then(t=>(this.stopLoading(),e)).catch(e=>{throw this.errorToast(e.message),this.stopLoading(),new e})}insert(e){this.startLoading();const t=this.tableRef.push(e);return e.Id=t.key,this.update(e)}setListSeperate(e){return Object(o.a)(this,void 0,void 0,(function*(){for(const t of e)this.set(t).catch(e=>{throw e});return[]}))}setList(e){return Object(o.a)(this,void 0,void 0,(function*(){const t=[];for(const i of e){const e=yield this.set(i).catch(e=>{throw e});e&&t.push(e)}return t}))}insertList(e){return Object(o.a)(this,void 0,void 0,(function*(){const t=[];this.startLoading();for(let i=0;i<e.length;i++){const c=yield this.insert(e[i]);c?t.push(c):console.log("error insert")}return t}))}getById(e){return this.startLoading(),this.db.ref(`${this.tableName}/${e}`).once("value").then(e=>(this.stopLoading(),e?e.val():null)).catch(e=>(this.stopLoading(),console.log(e),null))}updateSingleField(e,t,i){this.startLoading();var c={};return c[`/${e}/${t}`]=i,this.tableRef.update(c,e=>{this.stopLoading(),null!=e&&this.errorToast(e.message)})}updateFields(e){return this.startLoading(),this.tableRef.update(e,e=>{this.stopLoading(),null!=e&&this.errorToast(e.message)})}update(e){return this.tableRef.child(e.Id).set(e).then(()=>(this.stopLoading(),e))}delete(e){return this.startLoading(),this.db.ref(`${this.tableName}/${e}`).remove().then(()=>{this.stopLoading()})}deleteMany(e){return Object(o.a)(this,void 0,void 0,(function*(){this.startLoading(),e.forEach(e=>Object(o.a)(this,void 0,void 0,(function*(){yield this.db.ref(`${this.tableName}/${e}`).remove()}))),this.stopLoading()}))}getAllWithOrder(e){return this.startLoading(),this.tableRef.orderByChild(e).once("value").then(e=>{const t=[];return e.forEach(e=>{t.push(e.val())}),this.stopLoading(),t}).catch(e=>(this.errorToast(e),this.stopLoading(),[]))}getAll(){return this.startLoading(),this.tableRef.once("value").then(e=>{const t=[];return e.forEach(e=>{t.push(e.val())}),this.stopLoading(),t}).catch(e=>(this.errorToast(e),this.stopLoading(),[]))}deleteAll(){return this.startLoading(),this.tableRef.remove().then(()=>{this.stopLoading()})}}{constructor(){super()}get tableName(){return"/tempProducts"}deleteFile(e){var t=new St;return this.storageService.deleteFile(e,t.FolderName)}addFile(e,t,i){this.storageService.pushFileToStorage(e,t,e=>{null===e&&i("ERROR"),i(e.Url)})}addFileFromBase64String(e,t,i){this.storageService.pushStringToStorage(e,t,e=>{null===e&&i("ERROR"),i(e.Url)})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=a.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var It=i("lBcp"),Ct=i("ftz2");function Pt(e,t){if(1&e&&(a.hc(0,"div",26),a.hc(1,"div",27),a.cc(2,"img",28),a.uc(3,"ImgPipe"),a.hc(4,"h4"),a.Rc(5),a.gc(),a.hc(6,"span"),a.Rc(7),a.uc(8,"myCurrPipe"),a.gc(),a.gc(),a.gc()),2&e){const e=t.$implicit;a.Pb("data-id",e.Id),a.Ob(2),a.Bc("src",a.wc(3,4,e.ImageUrl,"ProductImg"),a.Lc),a.Ob(3),a.Sc(e.Name),a.Ob(2),a.Sc(a.vc(8,7,e.Price))}}function At(e,t){if(1&e){const e=a.ic();a.hc(0,"div",29),a.hc(1,"label",30),a.hc(2,"input",31),a.pc("ngModelChange",(function(i){return a.Jc(e),t.$implicit.IsSelected=i})),a.gc(),a.cc(3,"span",32),a.Rc(4),a.gc(),a.gc()}if(2&e){const e=t.$implicit;a.Ob(2),a.Ac("ngModel",e.IsSelected),a.Ob(2),a.Tc("",e.Tag.Name," ")}}let kt=(()=>{class e extends m{constructor(e,t,i,c,r,n,o,a){super(),this.route=e,this.router=t,this.orderDetailService=i,this.productService=c,this._ngZone=r,this.tempProductService=n,this.tagService=o,this.categoryService=a,this.Title="Ch\u1ecdn s\u1ea3n ph\u1ea9m",this.currentPage=1,this.itemsPerPage=18,this.currentMaxPage=1,this.categoryName="",this.currentHardcodeUsedCount=-1,this.searchTerm="",this.priceSearchTerm=0,this.viewProdOptions={btnClass:"default",zoomFactor:.1,containerBackgroundColor:"#ccc",wheelZoom:!0,allowDrag:!0,btnIcons:{zoomIn:"fa fa-plus",zoomOut:"fa fa-minus",rotateClockwise:"fa fa-repeat",rotateCounterClockwise:"fa fa-undo",next:"fa fa-arrow-right",prev:"fa fa-arrow-left",fullscreen:"fa fa-arrows-alt"},btnShow:{zoomIn:!0,zoomOut:!0,rotateClockwise:!0,rotateCounterClockwise:!0,next:!0,prev:!0}},this.IsDataLosingWarning=!1,this.pagingProducts=[],this.categories=[],this.globalTags=[],this.productSearchingMode=b.f.None,this.images=[]}Init(){return Object(o.a)(this,void 0,void 0,(function*(){this.selectedProduct=new ft.a,this.route.queryParams.subscribe(e=>{this.categoryService.getAll().then(t=>{this.categories.push({Value:-1,Name:"T\u1ea5t c\u1ea3"}),t.forEach(e=>{this.categories.push({Value:e.Id,Name:e.Name})}),this.tagService.getAll().then(t=>{t.forEach(e=>{this.globalTags.push({Tag:e,IsSelected:!1})}),this.getProductByCategory(+e.category)})})}),window.searchProdReference={component:this,zone:this._ngZone,itemSelected:e=>this.setSelectedProduct(e),tagsSelected:()=>this.tagsSelected()}}))}tagsSelected(){let e=[];this.globalTags.forEach(t=>{t.IsSelected&&e.push(t.Tag.Id)}),e.length<=0||(this.currentPage=1,this.filterByTags(e))}filterByTags(e){this.searchTerm="",this.priceSearchTerm=0,this.productSearchingMode=b.f.Name,this.getProductsByPage(1,e)}setSelectedProduct(e){this.selectedProduct=this.pagingProducts.filter(t=>t.Id==e)[0];let t=["Xem h\xecnh S\u1ea3n ph\u1ea3m"];(!this.selectedProduct.PriceList||this.selectedProduct.PriceList.length<=0)&&(this.selectedProduct.PriceList=[this.selectedProduct.Price]),this.selectedProduct.PriceList.forEach(e=>{t.push(w.a.currencyFormat(e))}),this.menuOpening(e=>{switch(+e){case 0:let t=M.a.getImgUrl(this.selectedProduct.ImageUrl,$.c.ProductImg);this.images=[t],setTimeout(()=>{viewProductImg(t,()=>{this.images=[]})},200);break;default:this.selectedProduct.Price=this.selectedProduct.PriceList[e-1],this.selectProduct()}},t)}getProductByCategory(e){this.productCategory=e,this.searchTerm="",this.priceSearchTerm=0,this.productSearchingMode=b.f.Name,this.categoryName=this.categories.filter(e=>e.Value===this.productCategory)[0].Name,this.getProductsByPage(this.currentPage)}filter(){selectProductCategory(this.categories,e=>{filterFocus(),this.getProductByCategory(+e)})}getProductsByPage(e,t=[]){return Object(o.a)(this,void 0,void 0,(function*(){if(this.globalTags.forEach(e=>{e.IsSelected=!1}),e<=0)return;if(this.currentMaxPage<e&&this.currentMaxPage>0)return;let i;this.pagingProducts=[],this.currentPage=e,this.selectedProduct=new ft.a,i=this.productSearchingMode!=b.f.Price?yield this.productService.getRecords(e,this.itemsPerPage,this.productCategory,t,this.searchTerm):yield this.productService.getRecordsByPrice(e,this.itemsPerPage,this.productCategory,this.priceSearchTerm),i&&i.products?(i.products.forEach(e=>{this.pagingProducts.push(e.Product)}),this.currentMaxPage=i.totalPages):this.currentMaxPage=1}))}searchProduct(e){if(e.indexOf("k")==e.length-1||e.indexOf("K")==e.length-1){let i=e.toLowerCase().split("k")[0];var t=parseInt(i);NaN!=t&&t>0?(this.productSearchingMode=b.f.Price,this.priceSearchTerm=1e3*t,this.searchTerm="",console.log(this.priceSearchTerm)):(this.productSearchingMode=b.f.Name,this.searchTerm="",this.priceSearchTerm=0)}else this.productSearchingMode=b.f.Name,this.priceSearchTerm=0,this.searchTerm=e;this.getProductsByPage(1)}selectProduct(){this.selectedProduct.Id?(this.globalOrderDetail.ProductName=this.selectedProduct.Name,this.globalOrderDetail.ProductImageUrl=this.selectedProduct.ImageUrl,this.globalOrderDetail.ProductId=this.selectedProduct.Id,this.globalOrderDetail.IsFromHardCodeProduct=!1,this.globalOrderDetail.OriginalPrice=this.selectedProduct.Price,this.globalOrderDetail.ModifiedPrice=this.selectedProduct.Price,this.OnBackNaviage()):this.showError("Ch\u01b0a c\xf3 s\u1ea3n ph\u1ea9m n\xe0o \u0111\u01b0\u1ee3c ch\u1ecdn!!")}}return e.\u0275fac=function(t){return new(t||e)(a.bc(c.a),a.bc(c.b),a.bc(L.a),a.bc(Ee.a),a.bc(a.H),a.bc(Dt),a.bc(It.a),a.bc(qe.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-search-product"]],features:[a.Lb],decls:31,vars:6,consts:[["id","prodCate",1,"page-content"],[1,"container"],[1,"prodFilter"],[1,"filterCate"],["href","javascript:void(0)",1,"main-bg",3,"click"],["src","../../../../assets/images/filter2.png","alt",""],["onclick","searchFocus(this)",1,"filterSearch"],["placeholder","M\xe3 s\u1ea3n ph\u1ea9m...",3,"delayTimeSpan","searchTextInvoke"],[1,"filterAdd"],[1,"main-bg"],["src","../../../../assets/images/attach.svg","alt","",1,"main-filter"],["src","../../../../assets/images/price.svg","alt","","onClick","openTagMenu()",1,"main-filter"],[1,"row","prodList","cusScroll"],["onclick","selectItem(this,'.product-item')","class","col-4 product-item",4,"ngFor","ngForOf"],[1,"paging"],[1,"paging-arrow","paging-prev","main-bg",3,"click"],[1,"fa","fa-angle-left"],[1,"paging-arrow","paging-next","main-bg",3,"click"],[1,"fa","fa-angle-right"],[1,"row","prodDone"],[1,"col-8","mx-auto","text-center"],["href","javascript:void(0);",1,"btn","main-btn",3,"click"],["id","tagsMenu",1,"tagMenu","checkMenu","tagMenu"],["class","form-check",4,"ngFor","ngForOf"],["id","view-product",1,"popup-content","view-img-popup-content"],[3,"src","config"],["onclick","selectItem(this,'.product-item')",1,"col-4","product-item"],[1,"prodItem"],["alt","",3,"src"],[1,"form-check"],[1,"form-check-label"],["type","checkbox","name","IsSelected","id","IsSelected","value","checkedValue",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"main-bg","vatCustom"]],template:function(e,t){1&e&&(a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"div",2),a.hc(3,"div",3),a.hc(4,"a",4),a.pc("click",(function(e){return t.filter()})),a.cc(5,"img",5),a.hc(6,"span"),a.Rc(7),a.gc(),a.gc(),a.gc(),a.hc(8,"div",6),a.hc(9,"mobile-search-box",7),a.pc("searchTextInvoke",(function(e){return t.searchProduct(e)})),a.gc(),a.gc(),a.hc(10,"div",8),a.hc(11,"button",9),a.cc(12,"img",10),a.gc(),a.gc(),a.hc(13,"div",8),a.hc(14,"button",9),a.cc(15,"img",11),a.gc(),a.gc(),a.gc(),a.hc(16,"div",12),a.Pc(17,Pt,9,9,"div",13),a.gc(),a.hc(18,"ul",14),a.hc(19,"li",15),a.pc("click",(function(e){return t.getProductsByPage(t.currentPage-1)})),a.cc(20,"i",16),a.gc(),a.hc(21,"li",17),a.pc("click",(function(e){return t.getProductsByPage(t.currentPage+1)})),a.cc(22,"i",18),a.gc(),a.gc(),a.hc(23,"div",19),a.hc(24,"div",20),a.hc(25,"a",21),a.pc("click",(function(e){return t.selectProduct()})),a.Rc(26,"Xong"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(27,"div",22),a.Pc(28,At,5,2,"div",23),a.gc(),a.hc(29,"div",24),a.cc(30,"angular-image-viewer",25),a.gc()),2&e&&(a.Ob(7),a.Sc(t.categoryName),a.Ob(2),a.Ac("delayTimeSpan",1600),a.Ob(8),a.Ac("ngForOf",t.pagingProducts),a.Ob(11),a.Ac("ngForOf",t.globalTags),a.Ob(2),a.Ac("src",t.images)("config",t.viewProdOptions))},directives:[je,g.k,Ct.a,T.a,T.k,T.n],pipes:[M.a,w.a],styles:[""]}),e})();function yt(e,t){if(1&e&&(a.hc(0,"li",24),a.hc(1,"p",25),a.Rc(2),a.gc(),a.hc(3,"span",26),a.Rc(4),a.gc(),a.hc(5,"span",27),a.Rc(6),a.uc(7,"myDatePipe"),a.gc(),a.hc(8,"span",28),a.Rc(9),a.gc(),a.gc()),2&e){const e=t.$implicit,i=t.index,c=a.tc();a.Pb("data-index",i),a.Ob(2),a.Sc(e.FullName),a.Ob(2),a.Sc(e.PhoneNumber),a.Ob(2),a.Sc(a.vc(7,5,c.deliveryInfo.DateTime)),a.Ob(3),a.Sc(e.Address)}}let Tt=(()=>{class e extends m{constructor(e,t){super(),this.route=e,this._ngZone=t,this.Title="Th\xf4ng tin ng\u01b0\u1eddi nh\u1eadn",this.IsDataLosingWarning=!1}addressChoosing(){this.selectAddress(e=>{this.deliveryInfo.Address=e})}Init(){window.DeliveryInfoReference={component:this,zone:this._ngZone,selectDeliveryInfo:e=>this.selectDeliveryInfo(e)},this.currentList=[],this.globalOrder.OrderDetails.forEach(e=>{const t=f.b.DeepCopy(e.DeliveryInfo);let i=!0;this.currentList.forEach(e=>{v.a.deliveryInfoCompare(t,e)&&(i=!1)}),i&&this.currentList.push(t)}),this.globalOrder.CustomerInfo&&this.globalOrder.CustomerInfo.ReceiverInfos.forEach(e=>{let t=!0;this.currentList.forEach(i=>{v.a.receiverInfoCompare(e,{FullName:i.FullName,PhoneNumber:i.PhoneNumber,Address:i.Address})&&(t=!1)}),t&&this.currentList.push({FullName:e.FullName,PhoneNumber:e.PhoneNumber,Address:e.Address,DateTime:new Date})}),this.deliveryInfo=new f.b,this.route.params.subscribe(e=>{this.deliveryInfo=f.b.DeepCopy(this.globalOrderDetail.DeliveryInfo),this.deliveryInfo.DateTime.setSeconds(0)})}selectDeliveryInfo(e){this.deliveryInfo=f.b.DeepCopy(this.currentList[e])}addReceiver(e){e.valid&&(this.globalOrderDetail.DeliveryInfo=f.b.DeepCopy(this.deliveryInfo),super.OnBackNaviage())}}return e.\u0275fac=function(t){return new(t||e)(a.bc(c.a),a.bc(a.H))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-select-receiver"]],features:[a.Lb],decls:30,vars:8,consts:[["id","custInfo",1,"page-content"],[1,"container"],[1,"custInfo"],[1,"currentInfo"],["href","javascript:void(0)","onclick","openCustMenu()",1,"main-bg"],["src","../../../../assets/images/view.svg",1,"white-filter"],[1,"newInfo"],["autocomplete","on",1,"addInfoForm",3,"submit"],["form","ngForm"],[1,"form-group"],["type","text","name","FullName","id","FullName","value","","placeholder","T\xean...",1,"mainForm",3,"ngModel","ngModelChange"],["FullName","ngModel"],["type","tel","name","PhoneNumber","id","PhoneNumber","value","","placeholder","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i...",1,"mainForm",3,"ngModel","ngModelChange"],["type","text","name","Address","id","Address","placeholder","\u0110\u1ecba ch\u1ec9...",1,"mainForm",3,"ngModel","ngModelChange"],["href","javascript:void(0)",1,"viewMore","btn","main-btn",3,"click"],[1,"fa","fa-location-arrow"],["name","DateTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],[1,"row"],[1,"col-8","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-3"],["id","recentInfo",1,"actionMenu"],["onclick","selectSavedDeliveryInfo(this)",4,"ngFor","ngForOf"],["onclick","selectSavedDeliveryInfo(this)"],[1,"recentInfo-name"],[1,"recentInfo-phone"],[1,"recentInfo-date"],[1,"recentInfo-add"]],template:function(e,t){if(1&e){const e=a.ic();a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"div",2),a.hc(3,"div",3),a.hc(4,"span"),a.Rc(5,"Th\xf4ng tin ng\u01b0\u1eddi nh\u1eadn \u0111\xe3 l\u01b0u"),a.gc(),a.hc(6,"a",4),a.cc(7,"img",5),a.gc(),a.gc(),a.hc(8,"div",6),a.hc(9,"form",7,8),a.pc("submit",(function(i){a.Jc(e);const c=a.Hc(10);return t.addReceiver(c)})),a.hc(11,"div",9),a.hc(12,"input",10,11),a.pc("ngModelChange",(function(e){return t.deliveryInfo.FullName=e})),a.gc(),a.gc(),a.hc(14,"div",9),a.hc(15,"input",12),a.pc("ngModelChange",(function(e){return t.deliveryInfo.PhoneNumber=e})),a.gc(),a.gc(),a.hc(16,"div",9),a.hc(17,"input",13),a.pc("ngModelChange",(function(e){return t.deliveryInfo.Address=e})),a.gc(),a.hc(18,"a",14),a.pc("click",(function(e){return t.addressChoosing()})),a.cc(19,"i",15),a.gc(),a.gc(),a.hc(20,"input",16),a.pc("ngModelChange",(function(e){return t.deliveryInfo.DateTime=e})),a.gc(),a.cc(21,"owl-date-time",17,18),a.hc(23,"div",19),a.hc(24,"div",20),a.hc(25,"button",21),a.Rc(26,"Xong"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(27,"div",22),a.hc(28,"ul"),a.Pc(29,yt,10,7,"li",23),a.gc(),a.gc()}if(2&e){const e=a.Hc(22);a.Ob(12),a.Ac("ngModel",t.deliveryInfo.FullName),a.Ob(3),a.Ac("ngModel",t.deliveryInfo.PhoneNumber),a.Ob(2),a.Ac("ngModel",t.deliveryInfo.Address),a.Ob(3),a.Ac("owlDateTime",e)("owlDateTimeTrigger",e)("ngModel",t.deliveryInfo.DateTime),a.Ob(1),a.Ac("stepMinute",5),a.Ob(8),a.Ac("ngForOf",t.currentList)}},directives:[T.v,T.l,T.m,T.b,T.k,T.n,Xe.c,Xe.f,Xe.b,g.k],pipes:[w.b],styles:[""]}),e})();function Rt(e,t){if(1&e){const e=a.ic();a.hc(0,"div",18),a.hc(1,"div",19),a.hc(2,"span",20),a.Rc(3),a.gc(),a.hc(4,"div",21),a.hc(5,"h4",22),a.Rc(6),a.gc(),a.hc(7,"span",23),a.Rc(8),a.gc(),a.gc(),a.cc(9,"app-status-point",24),a.gc(),a.hc(10,"div",25),a.hc(11,"ul",26),a.hc(12,"li",27),a.hc(13,"div",28),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit;return a.tc().getMenu(c)})),a.cc(14,"img",29),a.uc(15,"ImgPipe"),a.hc(16,"div",30),a.hc(17,"span",31),a.Rc(18),a.uc(19,"myCurrPipe"),a.gc(),a.hc(20,"span",32),a.Rc(21),a.uc(22,"myCurrPipe"),a.gc(),a.hc(23,"span",33),a.Rc(24),a.uc(25,"myCurrPipe"),a.gc(),a.hc(26,"span",34),a.Rc(27),a.gc(),a.hc(28,"span",35),a.Rc(29),a.uc(30,"myTimePipe"),a.gc(),a.hc(31,"span",36),a.Rc(32),a.uc(33,"myDatePipe"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc()}if(2&e){const e=t.$implicit,i=t.index;a.Ob(3),a.Uc("",e.OrderId,"_",e.Index+1,""),a.Ob(3),a.Sc(e.ProductName),a.Ob(2),a.Uc("",e.DeliveryInfo.FullName,"-",e.DeliveryInfo.PhoneNumber,""),a.Ob(1),a.Ac("state",e.State)("id",e.OrderDetailId)("index",i+1),a.Ob(5),a.Bc("src",a.wc(15,15,e.ProductImageUrl,"ProductImg"),a.Lc),a.Ob(4),a.Sc(a.vc(19,18,e.OriginalPrice)),a.Ob(3),a.Sc(a.vc(22,20,e.AdditionalFee)),a.Ob(3),a.Sc(a.vc(25,22,e.ModifiedPrice)),a.Ob(3),a.Sc(e.DeliveryInfo.Address),a.Ob(2),a.Sc(a.vc(30,24,e.DeliveryInfo.DateTime)),a.Ob(3),a.Sc(a.vc(33,26,e.DeliveryInfo.DateTime))}}function wt(e,t){if(1&e){const e=a.ic();a.hc(0,"div",37),a.hc(1,"div",19),a.hc(2,"span",20),a.Rc(3),a.gc(),a.hc(4,"div",21),a.hc(5,"h4",22),a.Rc(6),a.gc(),a.hc(7,"span",23),a.Rc(8),a.gc(),a.gc(),a.cc(9,"app-status-point",24),a.gc(),a.hc(10,"div",25),a.hc(11,"ul",26),a.hc(12,"li",27),a.hc(13,"div",28),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit;return a.tc().getMenu(c)})),a.cc(14,"img",29),a.uc(15,"ImgPipe"),a.hc(16,"div",30),a.hc(17,"span",31),a.Rc(18),a.uc(19,"myCurrPipe"),a.gc(),a.hc(20,"span",32),a.Rc(21),a.uc(22,"myCurrPipe"),a.gc(),a.hc(23,"span",33),a.Rc(24),a.uc(25,"myCurrPipe"),a.gc(),a.hc(26,"span",34),a.Rc(27),a.gc(),a.hc(28,"span",35),a.Rc(29),a.uc(30,"myTimePipe"),a.gc(),a.hc(31,"span",36),a.Rc(32),a.uc(33,"myDatePipe"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc()}if(2&e){const e=t.$implicit,i=t.index;a.Ac("ngClass","OnTheWay"===e.State?"selected-order-detail":""),a.Ob(3),a.Uc("",e.OrderId,"_",e.Index+1,""),a.Ob(3),a.Sc(e.ProductName),a.Ob(2),a.Uc("",e.DeliveryInfo.FullName,"-",e.DeliveryInfo.PhoneNumber,""),a.Ob(1),a.Ac("state",e.State)("id",e.OrderDetailId)("index",i+1),a.Ob(5),a.Bc("src",a.wc(15,16,e.ProductImageUrl,"ProductImg"),a.Lc),a.Ob(4),a.Sc(a.vc(19,19,e.OriginalPrice)),a.Ob(3),a.Sc(a.vc(22,21,e.AdditionalFee)),a.Ob(3),a.Sc(a.vc(25,23,e.ModifiedPrice)),a.Ob(3),a.Sc(e.DeliveryInfo.Address),a.Ob(2),a.Sc(a.vc(30,25,e.DeliveryInfo.DateTime)),a.Ob(3),a.Sc(a.vc(33,27,e.DeliveryInfo.DateTime))}}let Mt=(()=>{class e extends m{constructor(e,t,i){super(),this.router=e,this.orderService=t,this.orderDetailService=i,this.Title="Ng\u01b0\u1eddi giao h\xe0ng",this.NavigateClass="nav-icon ",this.IsDataLosingWarning=!1,this.waitingMenuItems=["Nh\u1eadn \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],this.shippingMenuItems=["Giao \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],this.onTheWayMenuItems=["Ho\xe0n th\xe0nh \u0111\u01a1n","Ch\u1ee5p \u1ea3nh giao h\xe0ng","Tr\u1ea3 h\xe0ng","Xem chi ti\u1ebft \u0111\u01a1n"],this.waitingOrderDetails=[],this.shippingOrderDetails=[]}Init(){this.loadWaitingDetails(),this.loadShippingDetails(),this.askForRememberPassword()}OnBackNaviage(){customerSupport()}logout(){this.authService.logOut(e=>{e&&this.router.navigate(["staff/login"])})}viewDetail(e){this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}loadWaitingDetails(){this.waitingOrderDetails=[],this.orderDetailService.getByState(b.e.DeliveryWaiting).then(e=>{this.waitingOrderDetails=e,this.waitingOrderDetails.sort((e,t)=>e.ShippingSortOrder<t.ShippingSortOrder?-1:e.ShippingSortOrder>t.ShippingSortOrder?1:0)})}loadShippingDetails(){this.shippingOrderDetails=[],this.orderDetailService.getShippingOrderDetails(this.CurrentUser.Id).then(e=>{this.shippingOrderDetails=e,this.shippingOrderDetails.sort((e,t)=>e.ShippingSortOrder<t.ShippingSortOrder?-1:e.ShippingSortOrder>t.ShippingSortOrder?1:0)})}updateFinalState(e,t,i){getShippingNoteDialog(t,t=>{this.orderService.getById(e.OrderId).then(c=>{let r=c.TotalAmount-c.TotalPaidAmount;r>0?getNumberValidateInput((n,o)=>{n>r?o(!1,"Thanh to\xe1n v\u01b0\u1ee3t qu\xe1 th\xe0nh ti\u1ec1n!"):n<=0?o(!1,"Thanh to\xe1n ph\u1ea3i l\u1edbn h\u01a1n 0!"):(o(!0,""),this.orderService.updateFields(e.OrderId,{TotalPaidAmount:c.TotalPaidAmount+n}).then(()=>{this.orderDetailService.updateFields(e.OrderDetailId,{DeliveryCompletedTime:(new Date).getTime(),State:i,MakingSortOrder:0,ShippingSortOrder:0,ShippingNote:t}).then(e=>{this.loadShippingDetails()})}))},"S\u1ed1 ti\u1ec1n thanh to\xe1n...",r):this.orderDetailService.updateFields(e.OrderDetailId,{DeliveryCompletedTime:(new Date).getTime(),State:i,MakingSortOrder:0,ShippingSortOrder:0,ShippingNote:t}).then(e=>{this.loadShippingDetails()})})})}getMenu(e){menuOpen(t=>{switch(+t){case 0:switch(e.State){case b.e.DeliveryWaiting:this.orderDetailService.updateDetailSeen(e.OrderDetailId,this.CurrentUser.Id,(new Date).getTime()).then(t=>{this.orderDetailService.assignSingleOD(e.OrderDetailId,this.CurrentUser.Id,(new Date).getTime()).then(()=>{this.loadShippingDetails(),this.loadWaitingDetails()})});break;case b.e.OnTheWay:this.openConfirm("Ho\xe0n th\xe0nh giao \u0111\u01a1n?",()=>{this.updateFinalState(e,"Ho\xe0n th\xe0nh",b.e.Deliveried)});break;case b.e.DeliverAssinged:this.openConfirm("B\u1eaft \u0111\u1ea7u giao \u0111\u01a1n n\xe0y?",()=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:b.e.OnTheWay}).then(()=>{this.loadShippingDetails()})})}break;case 1:switch(e.State){case b.e.OnTheWay:this.globalOrderDetail=e,this.router.navigate(["staff/customer-confirming"]);break;default:this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}break;case 2:this.openConfirm("Tr\u1ea3 \u0111\u01a1n n\xe0y?",()=>{this.updateFinalState(e,"Tr\u1ea3 \u0111\u01a1n",b.e.SentBack)});break;case 3:this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}},e.State===b.e.DeliveryWaiting?this.waitingMenuItems:e.State===b.e.DeliverAssinged?this.shippingMenuItems:this.onTheWayMenuItems)}}return e.\u0275fac=function(t){return new(t||e)(a.bc(c.b),a.bc(C.a),a.bc(L.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-shipper-main"]],features:[a.Lb],decls:27,vars:9,consts:[["id","arrange",1,"page-content"],[1,"container"],["id","listNav","role","tablist",1,"nav","nav-tabs","row"],[1,"nav-item","col-6"],["id","nav1","data-toggle","tab","href","#camhoa","role","tab","aria-controls","camhoa","aria-selected","true",1,"active","main-bg"],["id","nav2","data-toggle","tab","href","#giaohoa","role","tab","aria-controls","giaohoa","aria-selected","false",1,"main-bg"],["id","listContent",1,"tab-content","order-list-bot"],["id","camhoa","role","tabpanel","aria-labelledby","nav1",1,"tab-pane","fade","show","active"],[1,"order-content","cusScroll"],["class","order-content-item product-item",4,"ngFor","ngForOf"],["id","giaohoa","role","tabpanel","aria-labelledby","nav2",1,"tab-pane","fade"],["class","order-content-item product-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"customer-support"],["alt","",1,"customer-avatar",3,"src"],[1,"customer-name"],["href","tel:0000",1,"customer-phone"],[1,"customer-position"],["id","logoutBtn",1,"customer-position",3,"click"],[1,"order-content-item","product-item"],[1,"item-top"],[1,"item-code"],[1,"item-info"],[1,"item-name"],[1,"item-quantity"],[3,"state","id","index"],[1,"item-bot"],[1,"order-product-list","cusScroll"],[1,""],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"prodPriceOld"],[1,"prodCharge"],[1,"prodPrice"],[1,"item-address"],[1,"item-time"],[1,"item-date"],[1,"order-content-item","product-item",3,"ngClass"]],template:function(e,t){1&e&&(a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"ul",2),a.hc(3,"li",3),a.hc(4,"a",4),a.Rc(5,"Ch\u1edd giao"),a.gc(),a.gc(),a.hc(6,"li",3),a.hc(7,"a",5),a.Rc(8,"\u0110ang giao"),a.gc(),a.gc(),a.gc(),a.hc(9,"div",6),a.hc(10,"div",7),a.hc(11,"ul",8),a.Pc(12,Rt,34,28,"div",9),a.gc(),a.gc(),a.hc(13,"div",10),a.hc(14,"ul",8),a.Pc(15,wt,34,29,"div",11),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(16,"div",12),a.cc(17,"img",13),a.uc(18,"ImgPipe"),a.hc(19,"p",14),a.Rc(20),a.gc(),a.hc(21,"a",15),a.Rc(22),a.gc(),a.hc(23,"p",16),a.Rc(24),a.gc(),a.hc(25,"p",17),a.pc("click",(function(e){return t.logout()})),a.Rc(26,"\u0110\u0103ng xu\u1ea5t"),a.gc(),a.gc()),2&e&&(a.Ob(12),a.Ac("ngForOf",t.waitingOrderDetails),a.Ob(3),a.Ac("ngForOf",t.shippingOrderDetails),a.Ob(2),a.Bc("src",a.wc(18,6,t.CurrentUser.Avt,"UserAvt"),a.Lc),a.Ob(3),a.Sc(t.CurrentUser.FullName),a.Ob(2),a.Sc(t.CurrentUser.PhoneNumber),a.Ob(2),a.Sc(t.CurrentUser.Role))},directives:[g.k,Pe,g.j],pipes:[M.a,w.a,w.c,w.b],styles:[""]}),e})();var Ft=i("5+WD");function Nt(e,t){if(1&e){const e=a.ic();a.hc(0,"div",17),a.hc(1,"div",18),a.hc(2,"span",19),a.Rc(3),a.gc(),a.hc(4,"div",20),a.hc(5,"h4",21),a.Rc(6),a.gc(),a.hc(7,"span",22),a.Rc(8),a.gc(),a.gc(),a.cc(9,"app-status-point",23),a.gc(),a.hc(10,"div",24),a.hc(11,"ul",25),a.hc(12,"li",26),a.hc(13,"div",27),a.hc(14,"button",28),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit,r=t.index;return a.tc().move(c.State,r,!0)})),a.Rc(15,"t\u0103ng"),a.gc(),a.hc(16,"button",29),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit,r=t.index;return a.tc().move(c.State,r,!1)})),a.Rc(17,"gi\u1ea3m"),a.gc(),a.gc(),a.hc(18,"div",30),a.pc("click",(function(i){a.Jc(e);const c=t.index;return a.tc().viewMakingDetail(c)})),a.cc(19,"img",31),a.uc(20,"ImgPipe"),a.hc(21,"div",32),a.hc(22,"span",33),a.Rc(23),a.uc(24,"myCurrPipe"),a.gc(),a.hc(25,"span",34),a.Rc(26),a.uc(27,"myCurrPipe"),a.gc(),a.hc(28,"span",35),a.Rc(29),a.uc(30,"myCurrPipe"),a.gc(),a.hc(31,"span",36),a.Rc(32),a.gc(),a.hc(33,"span",37),a.Rc(34),a.uc(35,"myTimePipe"),a.gc(),a.hc(36,"span",38),a.Rc(37),a.uc(38,"myDatePipe"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc()}if(2&e){const e=t.$implicit,i=t.index;a.Ob(3),a.Uc("",e.OrderId,"_",e.Index+1,""),a.Ob(3),a.Sc(e.ProductName),a.Ob(2),a.Uc("",e.CustomerName,"-",e.CustomerPhoneNumber,""),a.Ob(1),a.Ac("state",e.State)("id",e.OrderDetailId)("index",i+1),a.Ob(10),a.Bc("src",a.wc(20,15,e.ProductImageUrl,"ProductImg"),a.Lc),a.Ob(4),a.Sc(a.vc(24,18,e.OriginalPrice)),a.Ob(3),a.Sc(a.vc(27,20,e.AdditionalFee)),a.Ob(3),a.Sc(a.vc(30,22,e.ModifiedPrice)),a.Ob(3),a.Sc(e.DeliveryInfo.Address),a.Ob(2),a.Tc("",a.vc(35,24,e.MakingRequestTime)," "),a.Ob(3),a.Tc(" ",a.vc(38,26,e.MakingRequestTime),"")}}function xt(e,t){if(1&e){const e=a.ic();a.hc(0,"div",39),a.hc(1,"div",18),a.hc(2,"span",19),a.Rc(3),a.gc(),a.hc(4,"div",20),a.hc(5,"h4",21),a.Rc(6),a.gc(),a.hc(7,"span",22),a.Rc(8),a.gc(),a.gc(),a.cc(9,"app-status-point",23),a.gc(),a.hc(10,"div",24),a.hc(11,"ul",25),a.hc(12,"li",26),a.hc(13,"div",27),a.hc(14,"button",28),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit,r=t.index;return a.tc().move(c.ShippingOrderDetail.State,r,!0)})),a.Rc(15,"t\u0103ng"),a.gc(),a.hc(16,"button",29),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit,r=t.index;return a.tc().move(c.ShippingOrderDetail.State,r,!1)})),a.Rc(17,"gi\u1ea3m"),a.gc(),a.gc(),a.hc(18,"div",30),a.pc("click",(function(i){a.Jc(e);const c=t.index;return a.tc().viewShippingDetail(c)})),a.cc(19,"img",31),a.uc(20,"ImgPipe"),a.hc(21,"div",32),a.hc(22,"span",33),a.Rc(23),a.uc(24,"myCurrPipe"),a.gc(),a.hc(25,"span",34),a.Rc(26),a.uc(27,"myCurrPipe"),a.gc(),a.hc(28,"span",35),a.Rc(29),a.uc(30,"myCurrPipe"),a.gc(),a.hc(31,"span",36),a.Rc(32),a.gc(),a.hc(33,"span",37),a.Rc(34),a.uc(35,"myTimePipe"),a.gc(),a.hc(36,"span",38),a.Rc(37),a.uc(38,"myDatePipe"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc()}if(2&e){const e=t.$implicit,i=t.index;a.Ac("ngClass",e.IsSelect?"selected-order-detail":""),a.Ob(3),a.Uc("",e.ShippingOrderDetail.OrderId,"_",e.ShippingOrderDetail.Index+1,""),a.Ob(3),a.Sc(e.ShippingOrderDetail.ProductName),a.Ob(2),a.Uc("",e.ShippingOrderDetail.CustomerName,"-",e.ShippingOrderDetail.CustomerPhoneNumber,""),a.Ob(1),a.Ac("state",e.ShippingOrderDetail.State)("id",e.ShippingOrderDetail.OrderDetailId)("index",i+1),a.Ob(10),a.Bc("src",a.wc(20,16,e.ShippingOrderDetail.ProductImageUrl,"ProductImg"),a.Lc),a.Ob(4),a.Sc(a.vc(24,19,e.ShippingOrderDetail.OriginalPrice)),a.Ob(3),a.Sc(a.vc(27,21,e.ShippingOrderDetail.AdditionalFee)),a.Ob(3),a.Sc(a.vc(30,23,e.ShippingOrderDetail.ModifiedPrice)),a.Ob(3),a.Sc(e.ShippingOrderDetail.DeliveryInfo.Address),a.Ob(2),a.Sc(a.vc(35,25,e.ShippingOrderDetail.DeliveryInfo.DateTime)),a.Ob(3),a.Sc(a.vc(38,27,e.ShippingOrderDetail.DeliveryInfo.DateTime))}}function Lt(e,t){if(1&e){const e=a.ic();a.hc(0,"div",40),a.hc(1,"div",41),a.hc(2,"button",42),a.pc("click",(function(t){return a.Jc(e),a.tc().selectShipperDialogOpen()})),a.Rc(3,"Ch\u1ecdn Shipper"),a.gc(),a.gc(),a.hc(4,"div",43),a.pc("click",(function(t){return a.Jc(e),a.tc().cancelSelectMode()})),a.hc(5,"button",44),a.Rc(6,"Hu\u1ef7"),a.gc(),a.gc(),a.gc()}}function Bt(e,t){if(1&e){const e=a.ic();a.hc(0,"div",40),a.hc(1,"div",41),a.hc(2,"button",42),a.pc("click",(function(t){return a.Jc(e),a.tc().gotoSelectMode()})),a.Rc(3,"Ch\u1ecdn nhi\u1ec1u"),a.gc(),a.gc(),a.gc()}}function Ut(e,t){if(1&e){const e=a.ic();a.hc(0,"li",45),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit;return a.tc().selectShipper(c)})),a.cc(1,"img",46),a.uc(2,"ImgPipe"),a.hc(3,"span",47),a.Rc(4),a.gc(),a.hc(5,"span",48),a.Rc(6),a.gc(),a.gc()}if(2&e){const e=t.$implicit;a.Ob(1),a.Bc("src",a.wc(2,3,e.AvtUrl,"UserAvt"),a.Lc),a.Ob(3),a.Sc(e.FullName),a.Ob(2),a.Sc(e.IsExternalShipper?"Shipper ngo\xe0i":"Nh\xe2n vi\xean")}}let qt=(()=>{class e extends m{constructor(e,t,i){super(),this.orderDetailService=e,this.userService=t,this.router=i,this.Title="Th\u1ee9 t\u1ef1 \u01b0u ti\xean",this.IsDataLosingWarning=!1,this.isAssigningShipper=!1,this.shippingODs=[],this.shippers=[]}Init(){this.loadMakingDetails(),this.loadShippingDetails(),this.userService.getByRole(b.i.Shipper).then(e=>{this.shippers=e})}loadMakingDetails(){this.makingOrderDetails=[],this.orderDetailService.getByState(b.e.Waiting).then(e=>{this.makingOrderDetails=e,this.makingOrderDetails.sort((e,t)=>e.MakingSortOrder<t.MakingSortOrder?-1:e.MakingSortOrder>t.MakingSortOrder?1:0)})}loadShippingDetails(){this.shippingODs=[],this.orderDetailService.getByState(b.e.DeliveryWaiting).then(e=>{e.forEach(e=>{this.shippingODs.push({ShippingOrderDetail:e,IsSelect:!1})}),this.shippingODs.sort((e,t)=>e.ShippingOrderDetail.ShippingSortOrder<t.ShippingOrderDetail.ShippingSortOrder?-1:e.ShippingOrderDetail.ShippingSortOrder>t.ShippingOrderDetail.ShippingSortOrder?1:0)})}viewShippingDetail(e){this.isAssigningShipper?this.shippingODs[e].IsSelect=!this.shippingODs[e].IsSelect:(this.globalOrderDetail=this.shippingODs[e].ShippingOrderDetail,this.router.navigate(["staff/order-detail-view"]))}viewMakingDetail(e){this.globalOrderDetail=this.makingOrderDetails[e],this.router.navigate(["staff/order-detail-view"])}dropMakingList(e){var t=this.makingOrderDetails[e.previousIndex].MakingSortOrder,i=this.makingOrderDetails[e.currentIndex].MakingSortOrder;if(console.log(t,i),t===i)return;let c=[];this.makingOrderDetails.forEach(e=>{e.MakingSortOrder>=i&&e.MakingSortOrder<=t&&(e.MakingSortOrder=e.MakingSortOrder<t?e.MakingSortOrder+1:i,c.push({Id:e.OrderDetailId,MarkingSortOrder:e.MakingSortOrder})),e.MakingSortOrder<=i&&e.MakingSortOrder>=t&&(e.MakingSortOrder=e.MakingSortOrder>t?e.MakingSortOrder-1:i,c.push({Id:e.OrderDetailId,MarkingSortOrder:e.MakingSortOrder}))}),this.orderDetailService.updateMakingSortOrders(c).then(()=>{this.makingOrderDetails.sort((e,t)=>e.MakingSortOrder<t.MakingSortOrder?-1:e.MakingSortOrder>t.MakingSortOrder?1:0)})}dropShippingList(e){var t=this.shippingODs[e.previousIndex].ShippingOrderDetail.ShippingSortOrder,i=this.shippingODs[e.currentIndex].ShippingOrderDetail.ShippingSortOrder;if(t===i)return;let c=[];this.shippingODs.forEach(e=>{let r=e.ShippingOrderDetail;r.ShippingSortOrder>=i&&r.ShippingSortOrder<=t&&(r.ShippingSortOrder=r.ShippingSortOrder<t?r.ShippingSortOrder+1:i,c.push({Id:r.OrderDetailId,ShippingSortOrder:r.ShippingSortOrder})),r.ShippingSortOrder<=i&&r.ShippingSortOrder>=t&&(r.ShippingSortOrder=r.ShippingSortOrder>t?r.ShippingSortOrder-1:i,c.push({Id:r.OrderDetailId,ShippingSortOrder:r.ShippingSortOrder}))}),this.orderDetailService.updateMakingSortOrders(c).then(()=>{this.shippingODs.sort((e,t)=>e.ShippingOrderDetail.ShippingSortOrder<t.ShippingOrderDetail.ShippingSortOrder?-1:e.ShippingOrderDetail.ShippingSortOrder>t.ShippingOrderDetail.ShippingSortOrder?1:0)})}move(e,t,i){let c,r;switch(e){case b.e.Waiting:if(c=this.makingOrderDetails[t],i&&t<=0||!i&&t>=this.makingOrderDetails.length-1)return;if(r=this.makingOrderDetails[i?t-1:t+1],r){let e=[];e.push({Id:r.OrderDetailId,MakingSortOrder:c.MakingSortOrder}),e.push({Id:c.OrderDetailId,MakingSortOrder:r.MakingSortOrder}),this.orderDetailService.updateMakingSortOrders(e).then(()=>{let e=r.MakingSortOrder;r.MakingSortOrder=c.MakingSortOrder,c.MakingSortOrder=e,this.makingOrderDetails.sort((e,t)=>e.MakingSortOrder<t.MakingSortOrder?-1:e.MakingSortOrder>t.MakingSortOrder?1:0)})}break;case b.e.DeliveryWaiting:if(c=this.shippingODs[t].ShippingOrderDetail,i&&t<=0||!i&&t>=this.shippingODs.length-1)return;if(r=this.shippingODs[i?t-1:t+1].ShippingOrderDetail,r){let e=[];e.push({Id:r.OrderDetailId,ShippingSortOrder:c.ShippingSortOrder}),e.push({Id:c.OrderDetailId,ShippingSortOrder:r.ShippingSortOrder}),this.orderDetailService.updateShippingSortOrders(e).then(()=>{let e=r.ShippingSortOrder;r.ShippingSortOrder=c.ShippingSortOrder,c.ShippingSortOrder=e,this.shippingODs.sort((e,t)=>e.ShippingOrderDetail.ShippingSortOrder<t.ShippingOrderDetail.ShippingSortOrder?-1:e.ShippingOrderDetail.ShippingSortOrder>t.ShippingOrderDetail.ShippingSortOrder?1:0)})}}}gotoSelectMode(){this.isAssigningShipper=!0}cancelSelectMode(){this.shippingODs.forEach(e=>{e.IsSelect=!1}),this.isAssigningShipper=!1}selectShipper(e){dismissShipperSelecting(()=>{this.openConfirm("X\xe1c nh\u1eadn giao \u0111\u01a1n cho shipper?",()=>{let t=[];this.shippingODs.forEach(e=>{e.IsSelect&&t.push(e.ShippingOrderDetail.OrderDetailId)}),this.orderDetailService.assignOrderDetails(t,e.Id,(new Date).getTime()).then(e=>{this.isAssigningShipper=!1,this.loadMakingDetails(),this.loadShippingDetails()})})})}selectShipperDialogOpen(){let e=!1;this.shippingODs.forEach(t=>{t.IsSelect&&(e=!0)}),e&&openViewed()}}return e.\u0275fac=function(t){return new(t||e)(a.bc(L.a),a.bc(We.a),a.bc(c.b))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-sort-order-changing"]],features:[a.Lb],decls:23,vars:5,consts:[["id","orderList",1,"page-content"],[1,"container"],["id","listNav","role","tablist",1,"nav","nav-tabs","row"],[1,"nav-item","col-6"],["id","nav1","data-toggle","tab","href","#camhoa","role","tab","aria-controls","camhoa","aria-selected","true",1,"active","main-bg"],["id","nav2","data-toggle","tab","href","#giaohoa","role","tab","aria-controls","giaohoa","aria-selected","false",1,"main-bg"],["id","listContent",1,"tab-content","order-list-bot"],["id","camhoa","role","tabpanel","aria-labelledby","nav1",1,"tab-pane","fade","show","active"],["cdkDropList","",1,"order-content","cusScroll",3,"cdkDropListDropped"],["cdkDrag","","cdkDragStartDelay","300","class","order-content-item product-item",4,"ngFor","ngForOf"],["id","giaohoa","role","tabpanel","aria-labelledby","nav2",1,"tab-pane","fade"],["class","order-content-item product-item","cdkDrag","","cdkDragStartDelay","300",3,"ngClass",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],["id","viewed",1,"popup-content"],[1,"main-bg"],[1,"viewedList"],["class","viewItem-three-column",3,"click",4,"ngFor","ngForOf"],["cdkDrag","","cdkDragStartDelay","300",1,"order-content-item","product-item"],[1,"item-top"],[1,"item-code"],[1,"item-info"],[1,"item-name"],[1,"item-quantity"],[3,"state","id","index"],[1,"item-bot"],[1,"order-product-list","cusScroll"],[1,""],[1,"changeOrder"],[1,"inOrder","navOrder",3,"click"],[1,"deOrder","navOrder",3,"click"],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"prodPriceOld"],[1,"prodCharge"],[1,"prodPrice"],[1,"item-address"],[1,"item-time"],[1,"item-date"],["cdkDrag","","cdkDragStartDelay","300",1,"order-content-item","product-item",3,"ngClass"],[1,"row"],[1,"col-6","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-3","exchange-confirm",3,"click"],[1,"col-6","mx-auto","text-center",3,"click"],["type","submit",1,"btn","main-btn","w-100","mt-3","exchange-confirm"],[1,"viewItem-three-column",3,"click"],["alt","",1,"itemAva",3,"src"],[1,"itemName"],[1,"itemRole"]],template:function(e,t){1&e&&(a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"ul",2),a.hc(3,"li",3),a.hc(4,"a",4),a.Rc(5,"C\u1eafm hoa"),a.gc(),a.gc(),a.hc(6,"li",3),a.hc(7,"a",5),a.Rc(8,"Giao hoa"),a.gc(),a.gc(),a.gc(),a.hc(9,"div",6),a.hc(10,"div",7),a.hc(11,"ul",8),a.pc("cdkDropListDropped",(function(e){return t.dropMakingList(e)})),a.Pc(12,Nt,39,28,"div",9),a.gc(),a.gc(),a.hc(13,"div",10),a.hc(14,"ul",8),a.pc("cdkDropListDropped",(function(e){return t.dropShippingList(e)})),a.Pc(15,xt,39,29,"div",11),a.gc(),a.Pc(16,Lt,7,0,"div",12),a.Pc(17,Bt,4,0,"div",12),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(18,"div",13),a.hc(19,"h3",14),a.Rc(20,"Ch\u1ecdn Shipper"),a.gc(),a.hc(21,"ul",15),a.Pc(22,Ut,7,6,"li",16),a.gc(),a.gc()),2&e&&(a.Ob(12),a.Ac("ngForOf",t.makingOrderDetails),a.Ob(3),a.Ac("ngForOf",t.shippingODs),a.Ob(1),a.Ac("ngIf",t.isAssigningShipper&&t.shippingODs.length>0),a.Ob(1),a.Ac("ngIf",!t.isAssigningShipper&&t.shippingODs.length>0),a.Ob(5),a.Ac("ngForOf",t.shippers))},directives:[Ft.b,g.k,g.l,Ft.a,Pe,g.j],pipes:[M.a,w.a,w.c,w.b],styles:[""]}),e})();var Vt=i("TG2U"),Ht=i("3oHN");let Et=(()=>{class e extends m{constructor(e,t){super(),this.router=e,this.realtimeService=t,this.Title="",this.NavigateClass="",this.model=new Vt.a,p.a.clear()}Init(){this.setStatusBarColor(!0),this.globalService.isOnMobile()&&savedLoginInforGettingRequest()}savedLoginInforReturn(e,t){this.model.passcode=t,this.model.userName=e}afterLogin(){switch(this.globalService.isOnMobile()&&(this.globalService.isRememberPassWillCheck=!0,mobileLogin(this.model.userName,this.model.passcode)),p.a.getRole()){case b.i.Admin:case b.i.Account:this.router.navigate(["/staff/orders-manage"]);break;case b.i.Florist:this.router.navigate(["staff/florist-main"]);break;case b.i.Shipper:this.router.navigate(["staff/shipper-main"])}}login(e){e.valid&&this.authService.login(this.model,e=>{e&&this.ngZone.run(()=>{this.afterLogin()})})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(c.b),a.bc(Ht.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-login"]],features:[a.Lb],decls:11,vars:2,consts:[["id","login",1,"page-content"],[1,"logo"],["href","#"],["autocomplete","on","id","loginform",3,"submit"],["form","ngForm"],[1,"form-group"],["name","userName","placeholder","T\xean \u0111\u0103ng nh\u1eadp...",1,"form-control",3,"ngModel","ngModelChange"],["type","password","name","passcode","placeholder","M\u1eadt kh\u1ea9u...",1,"form-control",3,"ngModel","ngModelChange"],["type","submit","value","\u0110\u0103ng nh\u1eadp",1,"btn","btn-default"]],template:function(e,t){if(1&e){const e=a.ic();a.hc(0,"div",0),a.hc(1,"h1",1),a.hc(2,"a",2),a.Rc(3,"Login to Florid"),a.gc(),a.gc(),a.hc(4,"form",3,4),a.pc("submit",(function(i){a.Jc(e);const c=a.Hc(5);return t.login(c)})),a.hc(6,"div",5),a.hc(7,"input",6),a.pc("ngModelChange",(function(e){return t.model.userName=e})),a.gc(),a.gc(),a.hc(8,"div",5),a.hc(9,"input",7),a.pc("ngModelChange",(function(e){return t.model.passcode=e})),a.gc(),a.gc(),a.cc(10,"input",8),a.gc(),a.gc()}2&e&&(a.Ob(7),a.Ac("ngModel",t.model.userName),a.Ob(2),a.Ac("ngModel",t.model.passcode))},directives:[T.v,T.l,T.m,T.b,T.k,T.n],styles:[""]}),e})(),Jt=(()=>{class e{constructor(e,t,i,c,r){this.router=e,this.globalService=t,this.authService=i,this.printJobService=c,this.realtimeService=r,this.navigateClass="",this.title="",this.headerUpdate=this.globalService.mobileUpdateHeader.subscribe(e=>{null!==e&&e&&this.updateHeaderBar(e.Title,e.NavigateClass)})}ngOnInit(){let e=p.a.getUserId(),t=p.a.isPrinter();e&&this.realtimeService.connect(+e,t,()=>{}),this.globalService.setStatusBarColor(!1)}updateHeaderBar(e,t){setTimeout(()=>{this.navigateClass=t,this.title=e},100)}ngOnDestroy(){this.headerUpdate.unsubscribe()}navigateOnClick(){this.globalService.clickOnNavigateButton()}}return e.\u0275fac=function(t){return new(t||e)(a.bc(c.b),a.bc(h.a),a.bc(d.a),a.bc(A.a),a.bc(Ht.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-staff-main-layout"]],decls:6,vars:3,consts:[[1,"breadcrumb"],[3,"click"],[1,"breadcrumb-title"]],template:function(e,t){1&e&&(a.hc(0,"div",0),a.hc(1,"a",1),a.pc("click",(function(e){return t.navigateOnClick()})),a.gc(),a.hc(2,"div",2),a.hc(3,"span"),a.Rc(4),a.gc(),a.gc(),a.gc(),a.cc(5,"router-outlet")),2&e&&(a.Ob(1),a.Qb(t.navigateClass),a.Ob(3),a.Sc(t.title))},directives:[c.e],styles:[""]}),e})();function Wt(e,t){if(1&e&&(a.hc(0,"div",25),a.hc(1,"span",13),a.Rc(2,"T\xean KH"),a.gc(),a.hc(3,"span",14),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.order.CustomerInfo.Name)}}function Gt(e,t){if(1&e&&(a.hc(0,"div",25),a.hc(1,"span",13),a.Rc(2,"SDT KH"),a.gc(),a.hc(3,"span",14),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.order.CustomerInfo.PhoneNumber)}}function $t(e,t){if(1&e&&(a.hc(0,"div",25),a.hc(1,"span",13),a.Rc(2,"T\xean ng\u01b0\u1eddi nh\u1eadn:"),a.gc(),a.hc(3,"span",14),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.orderDetail.DeliveryInfo.FullName)}}function jt(e,t){if(1&e&&(a.hc(0,"div",26),a.hc(1,"span",13),a.Rc(2,"SDT ng\u01b0\u1eddi nh\u1eadn:"),a.gc(),a.hc(3,"span",14),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.orderDetail.DeliveryInfo.PhoneNumber)}}function Xt(e,t){if(1&e&&(a.hc(0,"div",26),a.hc(1,"span",13),a.Rc(2,"\u0110\u1ecba ch\u1ec9 giao:"),a.gc(),a.hc(3,"span",14),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.orderDetail.DeliveryInfo.Address)}}function Qt(e,t){if(1&e&&(a.hc(0,"div",27),a.hc(1,"span",13),a.Rc(2,"Y\xeau c\u1ea7u xong tr\u01b0\u1edbc:"),a.gc(),a.hc(3,"span",14),a.Rc(4),a.uc(5,"myDatePipe"),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(a.wc(5,1,e.orderDetail.MakingRequestTime,"HH:mm dd/MM/yyyy"))}}function zt(e,t){if(1&e&&(a.hc(0,"div",28),a.hc(1,"span",13),a.Rc(2,"M\xf4 t\u1ea3 KH:"),a.gc(),a.hc(3,"span",14),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.orderDetail.Description)}}function Kt(e,t){if(1&e&&(a.hc(0,"div",28),a.hc(1,"span",13),a.Rc(2,"Ghi ch\xfa th\u1ef1c hi\u1ec7n:"),a.gc(),a.hc(3,"span",14),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.orderDetail.MakingNote)}}function _t(e,t){if(1&e&&(a.hc(0,"div",28),a.hc(1,"span",13),a.Rc(2,"Ghi ch\xfa giao h\xe0ng:"),a.gc(),a.hc(3,"span",14),a.Rc(4),a.gc(),a.gc()),2&e){const e=a.tc();a.Ob(4),a.Sc(e.orderDetail.ShippingNote)}}function Zt(e,t){if(1&e){const e=a.ic();a.hc(0,"div",29),a.pc("click",(function(t){return a.Jc(e),a.tc().openViewed()})),a.cc(1,"img",30),a.Rc(2,"\u0110\xe3 xem "),a.gc()}}function Yt(e,t){if(1&e&&(a.hc(0,"li",31),a.cc(1,"img",32),a.uc(2,"ImgPipe"),a.hc(3,"span",33),a.Rc(4),a.gc(),a.hc(5,"span",34),a.Rc(6),a.gc(),a.gc()),2&e){const e=t.$implicit;a.Ob(1),a.Bc("src",a.wc(2,3,e.Avt,"UserAvt"),a.Lc),a.Ob(3),a.Sc(e.FullName),a.Ob(2),a.Sc(e.Role)}}let ei=(()=>{class e extends m{constructor(e){super(),this.orderDetailService=e,this.Title="Chi ti\u1ebft \u0111\u01a1n",this.IsDataLosingWarning=!1,this.states=b.e,this.canSeen=!0,console.log(this.globalOrder),this.orderDetail=new f.c,this.orderDetail.SeenUsers=[],this.order=new f.d}Init(){this.orderDetail=this.globalOrderDetail,this.order=this.globalOrder,this.state=$.e.filter(e=>e.State===this.orderDetail.State)[0].DisplayName,setTimeout(()=>{this.canSeen&&(this.CurrentUser.Role!=b.i.Florist&&this.CurrentUser.Role!==b.i.Shipper||this.orderDetailService.updateDetailSeen(this.orderDetail.OrderDetailId,this.CurrentUser.Id,(new Date).getTime(),!1).then(e=>{}))},2e3)}getDetailDiscount(e){return v.a.getDetailDiscount(e)}destroy(){this.canSeen=!1}openViewed(){this.orderDetailService.getODSeeners(this.orderDetail.OrderDetailId).then(e=>{this.orderDetail.SeenUsers=e,openViewed()})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(L.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-view-order-detail"]],features:[a.Lb],decls:51,vars:35,consts:[["id","prodDetail",1,"page-content"],[1,"container"],[1,"prodDetail"],[1,"prodGen"],[3,"state"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPriceOld"],[1,"prodPrice"],[1,"prodCharge"],[1,"prodInfo","cusScroll"],[1,"prodQuan","infoGroup"],[1,"itemlabel"],[1,"itemVal"],["class","prodName infoGroup",4,"ngIf"],["class","prodAddr infoGroup",4,"ngIf"],[1,"prodTime","infoGroup"],["class","prodMakingTime infoGroup",4,"ngIf"],["class","prodDesc infoGroup",4,"ngIf"],["class","viewed",3,"click",4,"ngIf"],["id","viewed",1,"popup-content"],[1,"main-bg"],[1,"viewedList"],["class","viewItem-three-column",4,"ngFor","ngForOf"],[1,"prodName","infoGroup"],[1,"prodAddr","infoGroup"],[1,"prodMakingTime","infoGroup"],[1,"prodDesc","infoGroup"],[1,"viewed",3,"click"],["src","../../../assets/images/eye.svg","alt","",1,"main-filter"],[1,"viewItem-three-column"],["alt","",1,"itemAva",3,"src"],[1,"itemName"],[1,"itemRole"]],template:function(e,t){1&e&&(a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"div",2),a.hc(3,"div",3),a.cc(4,"app-status-point",4),a.cc(5,"img",5),a.uc(6,"ImgPipe"),a.hc(7,"div",6),a.hc(8,"h5",7),a.Rc(9),a.gc(),a.hc(10,"span",8),a.Rc(11),a.uc(12,"myCurrPipe"),a.gc(),a.hc(13,"span",9),a.Rc(14),a.uc(15,"myCurrPipe"),a.gc(),a.hc(16,"span",10),a.Rc(17),a.uc(18,"myCurrPipe"),a.gc(),a.hc(19,"span",10),a.Rc(20),a.uc(21,"myCurrPipe"),a.gc(),a.hc(22,"span",10),a.Rc(23),a.gc(),a.gc(),a.gc(),a.hc(24,"div",11),a.hc(25,"div",12),a.hc(26,"span",13),a.Rc(27,"Tr\u1ea1ng th\xe1i:"),a.gc(),a.hc(28,"span",14),a.Rc(29),a.gc(),a.gc(),a.Pc(30,Wt,5,1,"div",15),a.Pc(31,Gt,5,1,"div",15),a.Pc(32,$t,5,1,"div",15),a.Pc(33,jt,5,1,"div",16),a.Pc(34,Xt,5,1,"div",16),a.hc(35,"div",17),a.hc(36,"span",13),a.Rc(37,"Th\u1eddi gian giao:"),a.gc(),a.hc(38,"span",14),a.Rc(39),a.uc(40,"myDatePipe"),a.gc(),a.gc(),a.Pc(41,Qt,6,4,"div",18),a.Pc(42,zt,5,1,"div",19),a.Pc(43,Kt,5,1,"div",19),a.Pc(44,_t,5,1,"div",19),a.gc(),a.Pc(45,Zt,3,0,"div",20),a.gc(),a.gc(),a.gc(),a.hc(46,"div",21),a.hc(47,"h3",22),a.Rc(48,"Nh\u1eefng ng\u01b0\u1eddi \u0111\xe3 xem"),a.gc(),a.hc(49,"ul",23),a.Pc(50,Yt,7,6,"li",24),a.gc(),a.gc()),2&e&&(a.Ob(4),a.Ac("state",t.orderDetail.State),a.Ob(1),a.Bc("src",a.wc(6,21,t.orderDetail.ProductImageUrl,"ProductImg"),a.Lc),a.Ob(4),a.Sc(t.orderDetail.ProductName),a.Ob(2),a.Sc(a.vc(12,24,t.orderDetail.OriginalPrice)),a.Ob(3),a.Sc(a.vc(15,26,t.orderDetail.ModifiedPrice)),a.Ob(3),a.Tc("Ph\u1ee5 ph\xed: ",a.vc(18,28,t.getDetailDiscount(t.orderDetail)),""),a.Ob(3),a.Tc("Gi\u1ea3m gi\xe1: ",a.vc(21,30,t.orderDetail.AdditionalFee),""),a.Ob(3),a.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",t.orderDetail.Quantity,""),a.Ob(6),a.Sc(t.state),a.Ob(1),a.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),a.Ob(1),a.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),a.Ob(1),a.Ac("ngIf","Florist"!=t.CurrentUser.Role),a.Ob(1),a.Ac("ngIf","Florist"!=t.CurrentUser.Role),a.Ob(1),a.Ac("ngIf","Florist"!=t.CurrentUser.Role),a.Ob(5),a.Sc(a.wc(40,32,t.orderDetail.DeliveryInfo.DateTime,"HH:mm dd/MM/yyyy")),a.Ob(2),a.Ac("ngIf","Shipper"!=t.CurrentUser.Role),a.Ob(1),a.Ac("ngIf",""!=t.orderDetail.Description),a.Ob(1),a.Ac("ngIf",""!=t.orderDetail.MakingNote),a.Ob(1),a.Ac("ngIf",""!=t.orderDetail.ShippingNote),a.Ob(1),a.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),a.Ob(5),a.Ac("ngForOf",t.orderDetail.SeenUsers))},directives:[Pe,g.l,g.k],pipes:[M.a,w.a,w.b],styles:[""]}),e})(),ti=(()=>{class e extends m{constructor(){super(),this.Title="Trang ch\u1ee7"}Init(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Vb({type:e,selectors:[["app-home"]],features:[a.Lb],decls:2,vars:0,template:function(e,t){1&e&&(a.hc(0,"p"),a.Rc(1,"home works!"),a.gc())},styles:[""]}),e})();const ii=function(e){return[e,"VND","symbol-narrow","","vi-VN"]};function ci(e,t){if(1&e){const e=a.ic();a.hc(0,"div",38),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit;return a.tc().selectItem(c)})),a.hc(1,"div",7),a.Rc(2),a.gc(),a.hc(3,"div",8),a.Rc(4),a.uc(5,"currency"),a.gc(),a.hc(6,"div",9),a.Rc(7),a.gc(),a.gc()}if(2&e){const e=t.$implicit;a.Ob(2),a.Sc(e.Method),a.Ob(2),a.Sc(a.xc(5,3,a.Cc(9,ii,e.Amount))),a.Ob(3),a.Sc(e.Status)}}let ri=(()=>{class e extends m{constructor(e){super(),this.purchaseService=e,this.Title="C\u1eadp nh\u1eadt thanh to\xe1n",this.purchaseType=b.g,this.IsDataLosingWarning=!1,this.qrContentTemplate="",this.currTotalPaidAmount=0,this.purchaseItems=[],this.order=this.globalOrder,this.qrContent="",this.currentPurchase=new D.a}get totalBalance(){return this.order?this.order.TotalAmount-this.order.TotalPaidAmount:0}Init(){this.purchaseItems=this.globalPurchases}selectItem(e){this.currTotalPaidAmount=this.order.TotalPaidAmount,this.order.TotalPaidAmount-=e.Amount,this.currentPurchase=new D.a,this.currentPurchase.Id=e.Id,this.currentPurchase.Amount=e.Amount,this.currentPurchase.Method=e.Method,this.currentPurchase.Status=e.Status,this.currentPurchase.Note=e.Note,purchaseDoing(()=>{this.order.TotalPaidAmount=this.currTotalPaidAmount})}addPurchase(){this.currTotalPaidAmount=this.order.TotalPaidAmount,this.currentPurchase=new D.a,this.currentPurchase.Id=-1,this.currentPurchase.Amount=this.totalBalance,this.currentPurchase.Method=b.g.Cash,this.currentPurchase.Status=b.h.Completed,this.currentPurchase.Note="",purchaseDoing(()=>{})}onPayChanged(e){this.currentPurchase.Amount<10&&(this.currentPurchase.Amount*=1e3,this.moveCursor(this.currentPurchase.Amount.toString().length,"Amount")),this.currentPurchase.Amount=+this.currentPurchase.Amount}onPayFocus(){this.currentPurchase.Amount||(this.currentPurchase.Amount=0),this.moveCursor(this.currentPurchase.Amount.toString().length,"Amount")}purchaseConfirm(){if(this.currentPurchase.Amount>this.totalBalance||this.currentPurchase.Amount<=0)return void this.showError("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!");let e=new D.a;e.OrderId=this.order.OrderId,e.Id=this.currentPurchase.Id,e.Amount=+this.currentPurchase.Amount,e.Method=this.currentPurchase.Method,e.Status=this.currentPurchase.Status,e.AddingTime=(new Date).getTime(),e.Note=this.currentPurchase.Note,this.order.TotalPaidAmount+=e.Amount,this.purchaseService.createOrUpdate(e,this.order.TotalPaidAmount).then(t=>{if(e.Id>0){let t=this.purchaseItems.filter(t=>t.Id==e.Id)[0];t.OrderId=e.OrderId,t.Id=e.Id,t.Amount=+e.Amount,t.Method=e.Method,t.Status=e.Status,this.showSuccess("\u0110\xe3 c\u1eadp nh\u1eadt 1 thanh to\xe1n!"),dismissPurchaseDialog()}else this.globalPurchases.push(e),this.showSuccess("\u0110\xe3 th\xeam 1 thanh to\xe1n!"),this.currentPurchase.Amount=0,this.totalBalance<=0&&dismissPurchaseDialog()})}selectPurType(e){this.currentPurchase.Method=e,e==b.g.Momo&&this.currentPurchase.Amount>0&&(this.qrContent=this.qrContentTemplate+this.currentPurchase.Amount.toString(),openQR())}}return e.\u0275fac=function(t){return new(t||e)(a.bc(y.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-view-purchase"]],features:[a.Lb],decls:86,vars:25,consts:[["id","customerInfo",1,"page-content"],[1,"container"],[1,"row","checkTop","search"],[1,"col-12","mx-auto","text-center"],["type","button",1,"btn","main-btn","w-100",3,"click"],[1,"nameTable"],[1,"tableHead"],[1,"tableLeft"],[1,"tableCenter"],[1,"tableRight"],["id","customer-list",1,"tableBody","cusScroll"],["class","tableRow main-bg customer-item",3,"click",4,"ngFor","ngForOf"],[1,"orderTotal"],[1,"totalOld"],[1,"orderPrice"],[1,"totalNew"],["id","purchase-dialog",1,"popup-content"],[1,"checkOut",2,"margin-top","0px","padding","0px"],[1,"checkOutTotal"],[1,"checkOutLeft","mb-2"],[1,"form-group"],["for","currentPayAmount",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Amount","id","Amount",1,"mainForm",3,"ngModel","input","focus","ngModelChange"],["for","Note",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Note","id","Note",1,"mainForm",3,"ngModel","ngModelChange"],["for","Method",2,"width","100%","text-align","left","margin-bottom","0px"],["id","Status","name","Status",1,"mainForm",3,"ngModel","ngModelChange"],["selected",""],[3,"ngValue"],[1,"form-group","methodGrid","mb-0"],["href","javascript:void(0)",1,"methodItem",3,"ngClass","click"],["src","../../../../assets/images/momo.jpg","alt",""],["src","../../../../assets/images/banking.jpg","alt",""],["src","../../../../assets/images/cash.png","alt",""],[1,"row"],["id","codeQR",1,"popup-content"],[3,"value","size"],["type","button","id","submit-btn","onClick","qrDone()",1,"btn","main-btn","w-100","mt-3"],[1,"tableRow","main-bg","customer-item",3,"click"]],template:function(e,t){1&e&&(a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"div",2),a.hc(3,"div",3),a.hc(4,"button",4),a.pc("click",(function(e){return t.addPurchase()})),a.Rc(5,"Th\xeam thanh to\xe1n"),a.gc(),a.gc(),a.gc(),a.hc(6,"div",5),a.hc(7,"div",6),a.hc(8,"div",7),a.Rc(9,"H\xecnh th\u1ee9c"),a.gc(),a.hc(10,"div",8),a.Rc(11,"S\u1ed1 ti\u1ec1n"),a.gc(),a.hc(12,"div",9),a.Rc(13,"Tr\u1ea1ng Th\xe1i"),a.gc(),a.gc(),a.hc(14,"div",10),a.Pc(15,ci,8,11,"div",11),a.gc(),a.gc(),a.hc(16,"div",12),a.hc(17,"p",13),a.Rc(18,"M\xe3 \u0111\u01a1n: "),a.hc(19,"span",14),a.Rc(20),a.gc(),a.gc(),a.hc(21,"p",13),a.Rc(22,"C\xf2n l\u1ea1i: "),a.hc(23,"span",14),a.Rc(24),a.uc(25,"myCurrPipe"),a.gc(),a.gc(),a.hc(26,"p",15),a.Rc(27,"Th\xe0nh ti\u1ec1n: "),a.hc(28,"span",14),a.Rc(29),a.uc(30,"myCurrPipe"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(31,"div",16),a.hc(32,"div",1),a.hc(33,"div",17),a.hc(34,"div",18),a.hc(35,"h3"),a.Rc(36,"T\u1ed5ng"),a.gc(),a.hc(37,"p"),a.Rc(38),a.uc(39,"myCurrPipe"),a.gc(),a.gc(),a.hc(40,"div",19),a.hc(41,"h4"),a.Rc(42,"S\u1ed1 ti\u1ec1n c\xf2n l\u1ea1i"),a.gc(),a.hc(43,"p"),a.Rc(44),a.uc(45,"myCurrPipe"),a.gc(),a.gc(),a.hc(46,"div",20),a.hc(47,"label",21),a.Rc(48,"S\u1ed1 ti\u1ec1n thanh to\xe1n"),a.gc(),a.hc(49,"input",22),a.pc("input",(function(e){return t.onPayChanged(e.target.value)}))("focus",(function(e){return t.onPayFocus()}))("ngModelChange",(function(e){return t.currentPurchase.Amount=e})),a.gc(),a.gc(),a.hc(50,"div",20),a.hc(51,"label",23),a.Rc(52,"Ghi Ch\xfa"),a.gc(),a.hc(53,"input",24),a.pc("ngModelChange",(function(e){return t.currentPurchase.Note=e})),a.gc(),a.gc(),a.hc(54,"div",20),a.hc(55,"label",25),a.Rc(56,"T\xecnh tr\u1ea1ng thanh to\xe1n"),a.gc(),a.hc(57,"select",26),a.pc("ngModelChange",(function(e){return t.currentPurchase.Status=e})),a.hc(58,"option",27),a.Rc(59,"Ch\u1ecdn..."),a.gc(),a.hc(60,"option",28),a.Rc(61,"\u0110ang \u0111\u1ee3i"),a.gc(),a.hc(62,"option",28),a.Rc(63,"Ho\xe0n t\u1ea5t"),a.gc(),a.hc(64,"option",28),a.Rc(65,"\u0110\xe3 Hu\u1ef7"),a.gc(),a.gc(),a.gc(),a.hc(66,"div",29),a.hc(67,"a",30),a.pc("click",(function(e){return t.selectPurType(t.purchaseType.Momo)})),a.cc(68,"img",31),a.gc(),a.hc(69,"a",30),a.pc("click",(function(e){return t.selectPurType(t.purchaseType.Banking)})),a.cc(70,"img",32),a.gc(),a.hc(71,"a",30),a.pc("click",(function(e){return t.selectPurType(t.purchaseType.Cash)})),a.cc(72,"img",33),a.gc(),a.gc(),a.hc(73,"div",34),a.hc(74,"div",3),a.hc(75,"button",4),a.pc("click",(function(e){return t.purchaseConfirm()})),a.Rc(76,"X\xe1c nh\u1eadn"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(77,"div",35),a.hc(78,"span"),a.Rc(79,"Qu\xe9t m\xe3 QR \u0111\u1ec3 thanh to\xe1n "),a.gc(),a.hc(80,"div"),a.cc(81,"qr-code",36),a.gc(),a.hc(82,"div",34),a.hc(83,"div",3),a.hc(84,"button",37),a.Rc(85,"Xong"),a.gc(),a.gc(),a.gc(),a.gc()),2&e&&(a.Ob(15),a.Ac("ngForOf",t.purchaseItems),a.Ob(5),a.Tc("",t.order.OrderId," "),a.Ob(4),a.Tc("",a.vc(25,17,t.totalBalance)," "),a.Ob(5),a.Tc("",a.vc(30,19,t.order.TotalAmount)," "),a.Ob(9),a.Sc(a.vc(39,21,t.order.TotalAmount)),a.Ob(6),a.Sc(a.vc(45,23,t.totalBalance)),a.Ob(5),a.Ac("ngModel",t.currentPurchase.Amount),a.Ob(4),a.Ac("ngModel",t.currentPurchase.Note),a.Ob(4),a.Ac("ngModel",t.currentPurchase.Status),a.Ob(3),a.Ac("ngValue","Waiting"),a.Ob(2),a.Ac("ngValue","Completed"),a.Ob(2),a.Ac("ngValue","Canceled"),a.Ob(3),a.Ac("ngClass","Momo"===t.currentPurchase.Method?" img-purchase-selected":""),a.Ob(2),a.Ac("ngClass","Banking"===t.currentPurchase.Method?" img-purchase-selected":""),a.Ob(2),a.Ac("ngClass","Cash"===t.currentPurchase.Method?" img-purchase-selected":""),a.Ob(10),a.Ac("value",t.qrContent)("size",290))},directives:[g.k,T.b,T.k,T.n,T.s,T.o,T.u,g.j,R.a],pipes:[w.a,g.c],styles:[""]}),e})();function ni(e,t){if(1&e){const e=a.ic();a.hc(0,"div",36),a.pc("click",(function(i){a.Jc(e);const c=t.$implicit,r=t.index;return a.tc().selectItem(c,r)})),a.hc(1,"div",7),a.Rc(2),a.gc(),a.hc(3,"div",8),a.Rc(4),a.uc(5,"myCurrPipe"),a.gc(),a.hc(6,"div",9),a.Rc(7),a.uc(8,"myDatePipe"),a.gc(),a.gc()}if(2&e){const e=t.$implicit;a.Ob(2),a.Sc(e.Method),a.Ob(2),a.Sc(a.vc(5,3,e.Amount)),a.Ob(3),a.Tc("",a.wc(8,5,e.AddingTime,"HH:mm dd/MM/yyyy")," ")}}function oi(e,t){1&e&&(a.hc(0,"div"),a.Rc(1," S\u1ed1 ti\u1ec1n l\xe0 b\u1eaft bu\u1ed9c "),a.gc())}function ai(e,t){1&e&&(a.hc(0,"div"),a.Rc(1," S\u1ed1 ti\u1ec1n t\u1ed1i thi\u1ec3u 3 k\xfd t\u1ef1 "),a.gc())}function si(e,t){if(1&e&&(a.hc(0,"div",37),a.Pc(1,oi,2,0,"div",38),a.Pc(2,ai,2,0,"div",38),a.gc()),2&e){a.tc();const e=a.Hc(27);a.Ob(1),a.Ac("ngIf",e.errors.required),a.Ob(1),a.Ac("ngIf",e.errors.minlength)}}const hi=[{path:"login",component:Et},{path:"",component:Jt,children:[{path:"",component:ti,canActivate:[r.f]},{path:"add-purchse",component:(()=>{class e extends m{constructor(e){super(),this.purchaseService=e,this.Title="Thanh to\xe1n n\u1eb7c danh",this.currentIndex=-1,this.purchaseMethod=b.g,this.purchaseStatus=b.h,this.currPurchase=new D.a,this.purchases=[],this.currentAddingTime=new Date}Init(){}selectItem(e,t){this.currentIndex=t,this.currPurchase=new D.a,this.currPurchase.Amount=e.Amount,this.currentAddingTime=new Date(e.AddingTime),this.currPurchase.Id=e.Id,this.currPurchase.Method=e.Method,this.currPurchase.Status=e.Status,this.currPurchase.OrderId=e.OrderId,this.currPurchase.Note=e.Note,openAddPurchaseDialog()}addPurchase(){this.currPurchase=new D.a,this.currPurchase.Amount=0,this.currentAddingTime=new Date,this.currPurchase.Id=0,this.currPurchase.Method=b.g.Banking,this.currPurchase.Status=b.h.Completed,this.currPurchase.OrderId="",this.currPurchase.Note="",openAddPurchaseDialog()}onAmountChanged(e){this.currPurchase.Amount<10&&(this.currPurchase.Amount*=1e3,this.moveCursor(this.currPurchase.Amount.toString().length,"Amount")),this.currPurchase.Amount=+this.currPurchase.Amount}onAmountFocus(){this.currPurchase.Amount||(this.currPurchase.Amount=0),this.moveCursor(this.currPurchase.Amount.toString().length,"Amount")}purchaseSaving(e){e.valid&&(this.currentIndex>-1?(Object.assign(this.purchases[this.currentIndex],this.currPurchase),this.purchases[this.currentIndex].AddingTime=this.currentAddingTime.getTime(),this.currentIndex=-1):(this.currPurchase.AddingTime=this.currentAddingTime.getTime(),this.purchases.push(this.currPurchase)),dissmissAddPurchaseDialog())}saveChanges(){this.purchases.length<=0||this.purchaseService.bulkCreate(this.purchases,"",()=>{this.purchases=[]})}}return e.\u0275fac=function(t){return new(t||e)(a.bc(y.a))},e.\u0275cmp=a.Vb({type:e,selectors:[["app-add-purchase"]],features:[a.Lb],decls:71,vars:17,consts:[["id","customerInfo",1,"page-content"],[1,"container"],[1,"row","checkTop","search"],[1,"col-12","mx-auto","text-center"],["type","button",1,"btn","main-btn","w-100",3,"click"],[1,"nameTable"],[1,"tableHead"],[1,"tableLeft","small-width"],[1,"tableCenter"],[1,"tableRight","large-width"],["id","customer-list",1,"tableBody","cusScroll"],["class","tableRow main-bg customer-item",3,"click",4,"ngFor","ngForOf"],["id","addPurchase",1,"popup-content"],["autocomplete","on",1,"addInfoForm",3,"submit"],["form","ngForm"],[1,"form-group"],["for","Amount",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Amount","id","Amount","required","","minlength","3","placeholder","S\xf4 ti\u1ec1n...",1,"mainForm",3,"ngModel","input","focus","ngModelChange"],["Amount","ngModel"],["class","alert alert-danger",4,"ngIf"],["for","Note",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Note","id","Note",1,"mainForm",3,"ngModel","ngModelChange"],["for","Method",2,"width","100%","text-align","left","margin-bottom","0px"],["id","Method","name","Method",1,"mainForm",3,"ngModel","ngModelChange"],["selected",""],[3,"ngValue"],["for","Status",2,"width","100%","text-align","left","margin-bottom","0px"],["id","Status","name","Status",1,"mainForm",3,"ngModel","ngModelChange"],["for","currentAddingTime",2,"width","100%","text-align","left","margin-bottom","0px"],["name","currentAddingTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],[1,"row"],[1,"col-6","mx-auto","text-center"],["type","button","id","cancel-button","onClick","dissmissAddPurchaseDialog()",1,"btn","grey-btn","w-100","mt-3"],["type","submit",1,"btn","main-btn","w-100","mt-3","btn-success"],[1,"tableRow","main-bg","customer-item",3,"click"],[1,"alert","alert-danger"],[4,"ngIf"]],template:function(e,t){if(1&e){const e=a.ic();a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"div",2),a.hc(3,"div",3),a.hc(4,"button",4),a.pc("click",(function(e){return t.addPurchase()})),a.Rc(5,"Th\xeam thanh to\xe1n"),a.gc(),a.gc(),a.gc(),a.hc(6,"div",5),a.hc(7,"div",6),a.hc(8,"div",7),a.Rc(9,"H\xecnh th\u1ee9c"),a.gc(),a.hc(10,"div",8),a.Rc(11,"S\u1ed1 ti\u1ec1n"),a.gc(),a.hc(12,"div",9),a.Rc(13,"Th\u1eddi gian"),a.gc(),a.gc(),a.hc(14,"div",10),a.Pc(15,ni,9,8,"div",11),a.gc(),a.gc(),a.hc(16,"div",2),a.hc(17,"div",3),a.hc(18,"button",4),a.pc("click",(function(e){return t.saveChanges()})),a.Rc(19,"L\u01b0u"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(20,"div",12),a.hc(21,"form",13,14),a.pc("submit",(function(i){a.Jc(e);const c=a.Hc(22);return t.purchaseSaving(c)})),a.hc(23,"div",15),a.hc(24,"label",16),a.Rc(25,"S\u1ed1 ti\u1ec1n"),a.gc(),a.hc(26,"input",17,18),a.pc("input",(function(e){return t.onAmountChanged(e.target.value)}))("focus",(function(e){return t.onAmountFocus()}))("ngModelChange",(function(e){return t.currPurchase.Amount=e})),a.gc(),a.Pc(28,si,3,2,"div",19),a.gc(),a.hc(29,"div",15),a.hc(30,"label",20),a.Rc(31,"Ghi Ch\xfa"),a.gc(),a.hc(32,"input",21),a.pc("ngModelChange",(function(e){return t.currPurchase.Note=e})),a.gc(),a.gc(),a.hc(33,"div",15),a.hc(34,"label",22),a.Rc(35,"H\xecnh th\u1ee9c thanh to\xe1n"),a.gc(),a.hc(36,"select",23),a.pc("ngModelChange",(function(e){return t.currPurchase.Method=e})),a.hc(37,"option",24),a.Rc(38,"Ch\u1ecdn..."),a.gc(),a.hc(39,"option",25),a.Rc(40,"Ti\u1ec1n m\u1eb7t"),a.gc(),a.hc(41,"option",25),a.Rc(42,"Chuy\u1ec3n kho\u1ea3n"),a.gc(),a.hc(43,"option",25),a.Rc(44,"V\xed Momo"),a.gc(),a.gc(),a.gc(),a.hc(45,"div",15),a.hc(46,"label",26),a.Rc(47,"T\xecnh tr\u1ea1ng thanh to\xe1n"),a.gc(),a.hc(48,"select",27),a.pc("ngModelChange",(function(e){return t.currPurchase.Status=e})),a.hc(49,"option",24),a.Rc(50,"Ch\u1ecdn..."),a.gc(),a.hc(51,"option",25),a.Rc(52,"\u0110ang \u0111\u1ee3i"),a.gc(),a.hc(53,"option",25),a.Rc(54,"Ho\xe0n t\u1ea5t"),a.gc(),a.hc(55,"option",25),a.Rc(56,"\u0110\xe3 ho\xe0n ti\u1ec1n"),a.gc(),a.hc(57,"option",25),a.Rc(58,"\u0110\xe3 Hu\u1ef7"),a.gc(),a.gc(),a.gc(),a.hc(59,"label",28),a.Rc(60,"Th\u1eddi gian"),a.gc(),a.hc(61,"input",29),a.pc("ngModelChange",(function(e){return t.currentAddingTime=e})),a.gc(),a.cc(62,"owl-date-time",30,31),a.hc(64,"div",32),a.hc(65,"div",33),a.hc(66,"button",34),a.Rc(67,"H\u1ee7y"),a.gc(),a.gc(),a.hc(68,"div",33),a.hc(69,"button",35),a.Rc(70,"L\u01b0u"),a.gc(),a.gc(),a.gc(),a.gc(),a.gc()}if(2&e){const e=a.Hc(27),i=a.Hc(63);a.Ob(15),a.Ac("ngForOf",t.purchases),a.Ob(11),a.Ac("ngModel",t.currPurchase.Amount),a.Ob(2),a.Ac("ngIf",e.invalid&&(e.dirty||e.touched)),a.Ob(4),a.Ac("ngModel",t.currPurchase.Note),a.Ob(4),a.Ac("ngModel",t.currPurchase.Method),a.Ob(3),a.Ac("ngValue",t.purchaseMethod.Cash),a.Ob(2),a.Ac("ngValue",t.purchaseMethod.Banking),a.Ob(2),a.Ac("ngValue",t.purchaseMethod.Momo),a.Ob(5),a.Ac("ngModel",t.currPurchase.Status),a.Ob(3),a.Ac("ngValue",t.purchaseStatus.Waiting),a.Ob(2),a.Ac("ngValue",t.purchaseStatus.Completed),a.Ob(2),a.Ac("ngValue",t.purchaseStatus.SentBack),a.Ob(2),a.Ac("ngValue",t.purchaseStatus.Canceled),a.Ob(4),a.Ac("owlDateTime",i)("owlDateTimeTrigger",i)("ngModel",t.currentAddingTime),a.Ob(1),a.Ac("stepMinute",5)}},directives:[g.k,T.v,T.l,T.m,T.b,T.r,T.h,T.k,T.n,g.l,T.s,T.o,T.u,Xe.c,Xe.f,Xe.b],pipes:[w.a,w.b],styles:[""]}),e})(),canActivate:[r.b]},{path:"final-confirm",component:z,canActivate:[r.b]},{path:"view-purchase",component:ri,canActivate:[r.b]},{path:"customer-confirming",component:W,canActivate:[r.a]},{path:"shipper-main",component:Mt,canActivate:[r.a]},{path:"sort-order-changing",component:qt,canActivate:[r.b]},{path:"florist-main",component:ye,canActivate:[r.d]},{path:"order-detail-confirming",component:Ue,canActivate:[r.a]},{path:"orders-manage",canActivate:[r.b],component:Ye},{path:"select-customer",component:mt,canActivate:[r.b]},{path:"order-detail/:id",component:He,canActivate:[r.b]},{path:"search-product",component:kt,canActivate:[r.b]},{path:"add-order",component:x,canActivate:[r.b]},{path:"select-receiver",component:Tt,canActivate:[r.b]},{path:"order-detail-view",component:ei,canActivate:[r.e]}]}];let di=(()=>{class e{}return e.\u0275mod=a.Zb({type:e}),e.\u0275inj=a.Yb({factory:function(t){return new(t||e)},imports:[[c.d.forChild(hi),n.a],c.d]}),e})()}}]);