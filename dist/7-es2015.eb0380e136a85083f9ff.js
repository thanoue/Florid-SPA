(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"711k":function(e,t,i){"use strict";i.r(t),i.d(t,"ROUTES",(function(){return ni})),i.d(t,"StaffModule",(function(){return oi}));var c=i("tyNb"),r=i("+XmF"),n=i("d2mR"),o=i("mrSG"),s=i("fXoL"),a=i("IAJr"),h=i("F2nW"),d=i("QGCU");class l{constructor(e,t){this.Title=e,this.NavigateClass=t}}var g=i("ofXK"),u=i("CVMR"),m=i("oz8C"),p=i("LQcV");let f=(()=>{class e{constructor(){this.IsDataLosingWarning=!0,this.NavigateClass="prev-icon",this.viewProdOptions={btnClass:"default",zoomFactor:.1,containerBackgroundColor:"#ccc",wheelZoom:!0,allowDrag:!0,btnIcons:{zoomIn:"fa fa-plus",zoomOut:"fa fa-minus",rotateClockwise:"fa fa-repeat",rotateCounterClockwise:"fa fa-undo",next:"fa fa-arrow-right",prev:"fa fa-arrow-left",fullscreen:"fa fa-arrows-alt"},btnShow:{zoomIn:!0,zoomOut:!0,rotateClockwise:!0,rotateCounterClockwise:!0,next:!0,prev:!0}};const e=a.a.getInjector();this.globalService=e.get(h.a),this.authService=e.get(d.a),this.location=e.get(g.h),this.ngZone=e.get(s.H),this.addressService=e.get(u.a)}get isEdittingOrder(){return this.globalService.isEdittingOrder}set isEdittingOrder(e){this.globalService.isEdittingOrder=e}get globalPurchases(){return this.globalService.currentPurchases}set globalPurchases(e){this.globalService.currentPurchases=e}get globalOrder(){return this.globalService.currentOrderViewModel}set globalOrder(e){this.globalService.currentOrderViewModel=e}get globalOrderDetail(){return this.globalService.currentOrderDetailViewModel}set globalOrderDetail(e){this.globalService.currentOrderDetailViewModel=e}get globalDistricts(){return this.globalService.currentDistricts}set globalDistricts(e){this.globalService.currentDistricts=e}get globalwards(){return this.globalService.currentWards}set globalwards(e){this.globalService.currentWards=e}get CurrentUser(){return{FullName:m.a.getUserName(),Role:m.a.getRole(),Avt:m.a.getUserAvtUrl(),Id:m.a.getUserId(),PhoneNumber:m.a.getPhoneNumber()}}getDetailDiscount(e){return p.a.getDetailDiscount(e)}ngOnInit(){window.BaseReference={component:this,zone:this.ngZone,dateTimeSelected:(e,t,i,c,r)=>this.dateTimeSelected(e,t,i,c,r),forceBackNavigate:()=>this.backNavigateOnClick(),fileChosen:e=>this.fileChosen(e),printConfirm:e=>this.printConfirm(e),rememberPassConfirm:()=>this.rememberPassConfirm(),savedLoginInforReturn:(e,t)=>this.savedLoginInforReturn(e,t)},this.IsOnTerminal=this.globalService.isRunOnTerimal(),this.Init()}menuOpening(e,t){menuOpen(e,t)}savedLoginInforReturn(e,t){}moveCursor(e,t){setTimeout(()=>{e>3&&moveCursor(t,e-3)},10)}askForRememberPassword(){this.globalService.isRememberPassWillCheck&&(this.globalService.isRememberPassWillCheck=!1,this.globalService.isOnMobile()&&isRememberPassChecking())}rememberPassConfirm(){this.openConfirm("B\u1ea1n mu\u1ed1n l\u01b0u th\xf4ng tin \u0111\u0103ng nh\u1eadp?",()=>{passwordSaving()},()=>{passwordClearing()})}ngOnDestroy(){this.navigateOnClick.unsubscribe(),this.destroy()}ngAfterViewInit(){this.globalService.updaterMobileHeaderInfo(new l(this.Title,this.NavigateClass)),this.navigateOnClick=this.globalService.navigateOnClick.subscribe(e=>{e&&this.backNavigateOnClick()})}printConfirm(e){this.openConfirm("In th\xeam b\u1ea3n?",()=>{e()},()=>{})}selectAddress(e){this.globalwards.length<=0?this.addressService.getAllDistrict().then(t=>{this.globalDistricts=t,this.addressService.getAllWards().then(t=>{this.globalwards=t,this.addressRequest(e)})}):this.addressRequest(e)}addressRequest(e){addressRequest(this.globalDistricts,e,(e,t)=>{t(this.globalwards.filter(t=>t.DistrictId===e))})}dateTimeSelected(e,t,i,c,r){}showError(e){this.globalService.showError(e)}showInfo(e){this.globalService.showInfo(e)}showSuccess(e){this.globalService.showSuccess(e)}showWarning(e){this.globalService.showWarning(e)}openFile(){pickFile(!1)}openFileForShare(){pickFile(!0)}startLoading(){this.globalService.startLoading()}stopLoading(){this.globalService.stopLoading()}setStatusBarColor(e){this.globalService.setStatusBarColor(e)}OnBackNaviage(){this.location.back()}backNavigateOnClick(){this.IsDataLosingWarning?this.openConfirm("D\u1eef li\u1ec7u hi\u1ec7n t\u1ea1i s\u1ebd b\u1ecb m\u1ea5t! B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn?",()=>{this.OnBackNaviage()}):this.OnBackNaviage()}destroy(){}fileChosen(e){}openConfirm(e,t,i,c,r,n){this.globalService.openMobileConfirm(e,t,i,c,r,n)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=s.Wb({type:e}),e})();var b=i("r5y0"),v=i("2pNN"),O=i("jXcA"),D=i("TjQO"),I=i("Abtb"),S=i("kVqo"),C=i("0zL+"),P=i("kGcc"),A=i("EeL4"),y=i("NWHx"),T=i("3Pt+"),k=i("z17N"),w=i("O0x4"),R=i("wRGf"),M=i("jjJn");function F(e,t){if(1&e){const e=s.ic();s.hc(0,"li",72),s.hc(1,"div",73),s.hc(2,"span"),s.Rc(3),s.gc(),s.gc(),s.hc(4,"div",74),s.cc(5,"img",75),s.uc(6,"ImgPipe"),s.hc(7,"div",76),s.hc(8,"h5",77),s.Rc(9),s.gc(),s.hc(10,"span",78),s.Rc(11),s.uc(12,"myCurrPipe"),s.gc(),s.hc(13,"span",79),s.Rc(14),s.gc(),s.hc(15,"span",79),s.Rc(16),s.uc(17,"myCurrPipe"),s.gc(),s.hc(18,"span",79),s.Rc(19),s.uc(20,"myCurrPipe"),s.gc(),s.gc(),s.gc(),s.hc(21,"div",80),s.hc(22,"a",81),s.pc("click",(function(){s.Jc(e);const i=t.$implicit;return s.tc().deleteOrderDetail(i.Index)})),s.cc(23,"img",82),s.gc(),s.hc(24,"a",81),s.pc("click",(function(){s.Jc(e);const i=t.$implicit;return s.tc().editOrderDetail(i.Index)})),s.cc(25,"img",83),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.$implicit,i=s.tc();s.Ob(3),s.Sc(e.Index+1),s.Ob(2),s.Bc("src",s.wc(6,7,e.ProductImageUrl,"ProductImg"),s.Lc),s.Ob(4),s.Sc(e.ProductName),s.Ob(2),s.Tc("",s.vc(12,10,e.ModifiedPrice)," "),s.Ob(3),s.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.Quantity," "),s.Ob(2),s.Tc("Ph\u1ee5 ph\xed: ",s.vc(17,12,e.AdditionalFee)," "),s.Ob(3),s.Tc("Gi\u1ea3m gi\xe1: ",s.vc(20,14,i.getDetailDiscount(e)),"")}}function N(e,t){if(1&e){const e=s.ic();s.hc(0,"li",84),s.pc("click",(function(){s.Jc(e);const i=t.index;return s.tc().selectPromotion(i)})),s.hc(1,"p",85),s.Rc(2),s.gc(),s.hc(3,"span",86),s.Rc(4),s.gc(),s.hc(5,"span",87),s.Rc(6),s.uc(7,"myDatePipe"),s.uc(8,"myDatePipe"),s.gc(),s.gc()}if(2&e){const e=t.$implicit,i=t.index,c=s.tc();s.Pb("data-index",i),s.Ob(2),s.Sc(e.Name),s.Ob(2),s.Sc(c.getPromotionAmount(e)),s.Ob(2),s.Uc("",s.vc(7,5,e.StartTime),"-",s.vc(8,7,e.EndTime),"")}}let x=(()=>{class e extends f{constructor(e,t,i,c,r,n){super(),this.router=e,this.orderService=t,this.customerService=i,this.printJobService=c,this.promotionService=r,this.purchaseService=n,this.Title="Th\xeam \u0110\u01a1n",this.memberShipTitle="",this.totalBalance=0,this.orderDiscount=0,this.isPurchased=!1,this.purchaseType=v.h,this.qrContentTemplate="",this.purchaseNote="",this.isCompleting=!1,this.promotions=[],this.currentPayAmount=0,this.qrContent="",this.wishingDoneTime=new Date}get AcctualBalance(){return this.order?this.order.TotalAmount-this.order.TotalPaidAmount:0}Init(){if(this.promotionService.getAvailablePromotions((new Date).getTime(),!1).then(e=>{this.promotions=e}),this.order=this.globalOrder,this.isEdittingOrder)this.wishingDoneTime=new Date(this.order.DoneTime);else if(this.memberShipTitle="New Customer",!this.order.OrderId){const e=(new Date).getFullYear();this.orderService.getMaxNumberId(e).then(t=>{null==t&&(t=0),this.order.OrderId=`${e%100}.${(t+1).toString()}`})}switch(this.onVATIncludedChange(),this.order.CustomerInfo.MembershipType){case v.d.NewCustomer:this.memberShipTitle="New Customer";break;case v.d.Member:this.memberShipTitle="Member";break;case v.d.Vip:this.memberShipTitle="VIP";break;case v.d.VVip:this.memberShipTitle="VVIP";break;default:this.memberShipTitle="New Customer"}this.totalBalance=this.order.TotalAmount-this.order.TotalPaidAmount}onMemberDiscountChange(){this.totalAmountCalculate()}getPromotionAmount(e){return e.PromotionType===D.b.Amount?e.Amount+" \u20ab":e.Amount+" %"}selectPromotion(e){this.order.AmountDiscount=this.order.PercentDiscount=0;const t=this.promotions[e];t.PromotionType===D.b.Amount?this.order.AmountDiscount=t.Amount:this.order.PercentDiscount=t.Amount,hideReceiverPopup(),this.onVATIncludedChange()}completingOrder(){this.placeOrder(!0)}editOrder(){return Object(o.a)(this,void 0,void 0,(function*(){const e=[];this.order.OrderDetails.forEach(t=>{t.NoteImages&&t.NoteImages.length>0&&t.NoteImages.forEach(t=>{p.a.isBase64(t)||e.push(t)})});try{yield this.orderService.deleteOrderDetailByOrderId(this.order.OrderId,e),this.orderConfirm()}catch(t){console.error(t)}}))}refundChecking(){this.totalBalance<0?this.openConfirm("S\u1ed1 ti\u1ec1n c\u1ea7n tr\u1ea3 l\u1ea1i cho KH l\xe0 "+p.a.toFormatCurrency(-1*this.totalBalance),()=>{this.purchaseService.refund(this.totalBalance,this.order.OrderId).then(()=>{this.order.TotalPaidAmount=this.order.TotalAmount,this.totalBalance=0,this.editOrder()})},()=>{this.editOrder()},()=>{},"X\xe1c nh\u1eadn \u0111\xe3 tr\u1ea3","\u0110\u1ec3 sau"):0==this.totalBalance?this.editOrder():this.openConfirm("Th\xeam thanh to\xe1n cho \u0111\u01a1n n\xe0y?",()=>{this.addPurchase()},()=>{this.editOrder()},null,"Th\xeam","\u0110\u1ec3 sau")}placeOrder(e){this.isCompleting=e,this.currentPayAmount=this.order.TotalAmount-this.order.TotalPaidAmount,this.order.DoneTime=this.wishingDoneTime.getTime(),this.order.CustomerInfo&&this.order.CustomerInfo.Id||(this.order.CustomerInfo=new b.a,this.order.CustomerInfo.Id="KHACH_LE",this.order.CustomerInfo.Name="Kh\xe1ch l\u1ebb"),!this.order.OrderDetails||this.order.OrderDetails.length<=0?this.showError("Ch\u01b0a ch\u1ecdn s\u1ea3n ph\u1ea9m n\xe0o!"):!this.order.TotalAmount||this.order.TotalAmount<=0?this.showError("Th\xe0nh ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!"):(this.order.CustomerInfo.GainedScore=p.a.getScoreFromOrder(this.order),this.isEdittingOrder?this.refundChecking():this.AcctualBalance>0?this.openConfirm("Th\xeam thanh to\xe1n cho \u0111\u01a1n n\xe0y?",()=>{this.addPurchase()},()=>{this.printConfirmation()},null,"Th\xeam","\u0110\u1ec3 sau"):this.printConfirmation())}addPurchase(){this.currentPayAmount=this.totalBalance,this.currentPurType=v.h.Cash,this.purchaseNote="",purchaseDoing()}printConfirmation(){this.order.CreatedDate||(this.order.CreatedDate=new Date),this.openConfirm("In ho\xe1 \u0111\u01a1n?",()=>{this.doPrintJob()},()=>{this.orderConfirm()},()=>{this.orderConfirm()})}getDetailDiscount(e){return p.a.getDetailDiscount(e)}doPrintJob(){let e=0;const t=[];this.order.OrderDetails.forEach(i=>{t.push({productName:i.ProductName,index:i.Index+1,price:i.ModifiedPrice,additionalFee:i.AdditionalFee,discount:p.a.getDetailDiscount(i),quantity:i.Quantity}),e+=i.ModifiedPrice*i.Quantity});const i=[];this.globalPurchases.forEach(e=>{i.push({method:e.Method,amount:e.Amount})});const c={Created:(new Date).getTime(),doneTime:new Date(this.order.DoneTime).toLocaleString("en-US",{hour12:!1}),Id:this.order.OrderId,Active:!0,IsDeleted:!1,saleItems:t,createdDate:this.order.CreatedDate.toLocaleString("en-US",{hour12:!1}),orderId:this.order.OrderId,summary:e,totalAmount:this.order.TotalAmount,totalPaidAmount:this.order.TotalAmount-this.AcctualBalance,totalBalance:this.totalBalance,vatIncluded:this.order.VATIncluded,memberDiscount:this.order.CustomerInfo.DiscountPercent,scoreUsed:this.order.CustomerInfo.ScoreUsed,gainedScore:this.order.CustomerInfo.GainedScore,totalScore:this.order.CustomerInfo.AvailableScore-this.order.CustomerInfo.ScoreUsed+this.order.CustomerInfo.GainedScore,customerName:this.order.CustomerInfo.Name,customerId:this.order.CustomerInfo.Id,discount:this.orderDiscount,isMemberDiscountApply:this.order.IsMemberDiscountApply,purchaseItems:i};this.printJobService.addPrintJob(c),this.orderConfirm()}orderConfirm(){this.startLoading();const e=new O.d;e.CustomerId=this.order.CustomerInfo.Id,e.Id=this.order.OrderId,e.Created=this.order.CreatedDate.getTime(),e.VATIncluded=this.order.VATIncluded,e.TotalAmount=this.order.TotalAmount,e.TotalPaidAmount=this.order.TotalPaidAmount,e.GainedScore=this.order.CustomerInfo.GainedScore,e.ScoreUsed=this.order.CustomerInfo.ScoreUsed,e.Index=this.order.Index,e.OrderType=this.order.OrderType,e.PercentDiscount=this.order.PercentDiscount,e.AmountDiscount=this.order.AmountDiscount,e.IsMemberDiscountApply=this.order.IsMemberDiscountApply,e.DoneTime=this.order.DoneTime,e.IsFinished=this.isCompleting,this.orderService.addOrEditOrder(e,this.isEdittingOrder).then(t=>Object(o.a)(this,void 0,void 0,(function*(){this.globalPurchases.length>0&&this.purchaseService.bulkCreate(this.globalPurchases,e.Id,()=>{this.globalPurchases=[]});const t=[],i=[];this.order.OrderDetails.forEach(c=>{const r=new O.e;r.OrderId=e.Id,r.IsHardcodeProduct=c.IsFromHardCodeProduct,r.HardcodeProductImageName=c.HardcodeImageName,r.ProductId=c.ProductId,r.ProductImageUrl=c.ProductImageUrl,r.ProductPrice=c.ModifiedPrice,r.AdditionalFee=c.AdditionalFee,r.ProductName=c.ProductName,r.Description=c.Description,r.State=this.isCompleting?v.f.Completed:v.f.Added,r.IsVATIncluded=e.VATIncluded,r.PurposeOf=c.PurposeOf,r.Index=c.Index,r.PercentDiscount=c.PercentDiscount,r.AmountDiscount=c.AmountDiscount,r.Quantity=c.Quantity,r.NoteImages=c.NoteImages,r.CustomerName=this.order.CustomerInfo.Name,r.CustomerPhoneNumber=this.order.CustomerInfo.PhoneNumber;const n=new O.a;n.Address=c.DeliveryInfo.Address?c.DeliveryInfo.Address:this.order.CustomerInfo.Address?this.order.CustomerInfo.Address:"",n.FullName=c.DeliveryInfo.FullName?c.DeliveryInfo.FullName:this.order.CustomerInfo.Name?this.order.CustomerInfo.Name:"",n.PhoneNumber=c.DeliveryInfo.PhoneNumber?c.DeliveryInfo.PhoneNumber:this.order.CustomerInfo.PhoneNumber?this.order.CustomerInfo.PhoneNumber:"",r.DeliveryInfo.ReceivingTime=c.DeliveryInfo.DateTime?c.DeliveryInfo.DateTime.getTime():this.order.DoneTime,r.DeliveryInfo.ReceiverDetail=n,t.push(r);let o=!0;i.forEach(e=>{p.a.receiverInfoCompare(e,n)&&(o=!1)}),o&&i.push(n)}),this.globalOrder.CustomerInfo.ReceiverInfos.forEach(e=>{let t=!0;i.forEach(i=>{p.a.receiverInfoCompare(e,i)&&(t=!1)}),t&&i.push(e)}),this.uploadImage(t).then(c=>{this.orderService.addOrderDetails(t).then(()=>{"KHACH_LE"!==e.CustomerId?this.customerService.updateReceiverList(e.CustomerId,i).then(e=>{this.stopLoading(),e&&this.completeOrder()}):(this.stopLoading(),this.completeOrder())}).catch(e=>{console.log(e),this.globalService.stopLoading(),this.showError(e.toString())})}).catch(e=>{this.showError(e.toString())})})))}selectPurType(e){this.currentPurType=e,e===v.h.Momo&&this.currentPayAmount>0&&(this.qrContent=this.qrContentTemplate+this.currentPayAmount.toString(),openQR())}purchaseConfirm(){if(this.currentPayAmount>this.totalBalance||this.currentPayAmount<=0)return void this.showError("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!");const e=new I.a;e.OrderId=this.order.OrderId,e.Amount=+this.currentPayAmount,e.Method=this.currentPurType,e.Note=this.purchaseNote,e.AddingTime=(new Date).getTime(),this.globalPurchases.push(e),this.order.TotalPaidAmount+=e.Amount,this.currentPayAmount=0,this.showSuccess("\u0110\xe3 th\xeam 1 thanh to\xe1n!"),this.totalAmountCalculate(),this.totalBalance<=0?dismissPurchaseDialog(()=>{this.isEdittingOrder?this.editOrder():this.printConfirmation()}):(this.currentPayAmount=this.totalBalance,this.currentPurType=v.h.Cash)}uploadImages(e){return Object(o.a)(this,void 0,void 0,(function*(){return yield new Promise((t,i)=>Object(o.a)(this,void 0,void 0,(function*(){let c="";for(let t=0;t<e.NoteImages.length;t++){const r=e.NoteImages[t];if(!p.a.isBase64(r)){c=t===e.NoteImages.length-1?c+r:c+r+",";continue}const n=yield fetch(r),o=yield n.blob();if(null!=o){const r=new File([o],"result.png",{type:"image/png"}),n=yield this.orderService.uploadNoteImg(r).catch(e=>{this.showError(e),i(e)});c=t===e.NoteImages.length-1?c+n:c+n+","}}t(c)}))).then(e=>e)}))}uploadImage(e){return Object(o.a)(this,void 0,void 0,(function*(){return yield new Promise((t,i)=>Object(o.a)(this,void 0,void 0,(function*(){try{for(let t=0;t<e.length;t++){const c=e[t];if(c.NoteImages&&c.NoteImages.length>0){const e=yield this.uploadImages(c).catch(e=>{i(e)});e&&(console.log(e),c.NoteImages=[],c.NoteImagesBlobbed=e)}}t("added")}catch(c){i(c)}}))).then(e=>e)}))}totalAmountCalculate(){this.order.TotalAmount=0,this.order.OrderDetails.forEach(e=>{e.AdditionalFee||(e.AdditionalFee=0);const t=e.ModifiedPrice*e.Quantity;let i=t;e.PercentDiscount&&e.PercentDiscount>0&&(i-=i/100*e.PercentDiscount),e.AmountDiscount&&e.AmountDiscount>0&&(i-=e.AmountDiscount),this.order.TotalAmount+=this.order.CustomerInfo&&this.order.CustomerInfo.DiscountPercent&&this.order.CustomerInfo.DiscountPercent>0&&this.order.IsMemberDiscountApply?i-t/100*this.order.CustomerInfo.DiscountPercent+e.AdditionalFee:i+e.AdditionalFee}),this.orderDiscount=0,this.order.PercentDiscount&&this.order.PercentDiscount>0&&(this.orderDiscount=this.order.TotalAmount/100*this.order.PercentDiscount,this.order.TotalAmount-=this.orderDiscount),this.order.AmountDiscount&&this.order.AmountDiscount>0&&(this.order.TotalAmount=this.order.TotalAmount-this.order.AmountDiscount,this.orderDiscount+=this.order.AmountDiscount),this.order.VATIncluded&&(this.order.TotalAmount=this.order.TotalAmount+.1*this.order.TotalAmount),this.order.TotalAmount-=p.a.geExchangableAmount(this.order.CustomerInfo.ScoreUsed),this.totalBalance=this.order.TotalAmount-this.order.TotalPaidAmount}onDiscountChanged(e){this.onVATIncludedChange()}onPayChanged(e){this.currentPayAmount<10&&this.currentPayAmount>0&&(this.currentPayAmount*=1e3,this.moveCursor(this.currentPayAmount.toString().length,"currentPayAmount")),this.currentPayAmount=+this.currentPayAmount}onPayFocus(){this.currentPayAmount||(this.currentPayAmount=0),this.moveCursor(this.currentPayAmount.toString().length,"currentPayAmount")}onAmountDiscountChanged(e){this.order.AmountDiscount<10&&this.order.AmountDiscount>0&&(this.order.AmountDiscount*=1e3,this.moveCursor(this.order.AmountDiscount.toString().length,"AmountDiscount")),this.order.AmountDiscount=+this.order.AmountDiscount,this.onVATIncludedChange()}onAmountDiscountFocus(){this.order.AmountDiscount||(this.order.AmountDiscount=0),this.moveCursor(this.order.AmountDiscount.toString().length,"AmountDiscount")}onVATIncludedChange(){this.totalAmountCalculate()}scoreExchange(){openExcForm((e,t)=>this.order.CustomerInfo.AvailableScore<e?(this.showError("V\u01b0\u1ee3t qu\xe1 \u0111i\u1ec3m t\xedch l\u0169y!!"),void t.call(this,!1)):p.a.geExchangableAmount(e)>=this.totalBalance?(this.showError("V\u01b0\u1ee3t qu\xe1 t\u1ed5ng ti\u1ec1n thanh to\xe1n!"),void t.call(this,!1)):(t.call(this,!0),this.order.CustomerInfo.ScoreUsed=e,void this.onVATIncludedChange()))}addNewOrderDetail(){this.globalOrderDetail=new b.c,this.router.navigate(["/staff/order-detail/-1"])}editOrderDetail(e){menuOpen(t=>{const i=b.c.DeepCopy(this.order.OrderDetails[e]);switch(+t){case 0:this.globalOrderDetail=i,this.router.navigate(["/staff/order-detail/"+e]);break;case 1:i.Index=this.order.OrderDetails.length,this.order.OrderDetails.push(i),this.onVATIncludedChange()}},["Ch\u1ec9nh s\u1eeda","Sao ch\xe9p"])}deleteOrderDetail(e){this.openConfirm("Ch\u1eafc ch\u1eafn xo\xe1?",()=>{this.order.OrderDetails.splice(e,1);let t=0;this.order.OrderDetails.forEach(e=>{e.Index=t,t++}),this.onVATIncludedChange()})}completeOrder(){"KHACH_LE"!==this.order.CustomerInfo.Id&&this.isCompleting?this.orderService.addScoreToCustomer(this.order).then(e=>{this.OnBackNaviage()}):this.OnBackNaviage()}}return e.\u0275fac=function(t){return new(t||e)(s.bc(c.b),s.bc(S.a),s.bc(C.a),s.bc(P.a),s.bc(A.a),s.bc(y.a))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-add-order"]],features:[s.Lb],decls:136,vars:36,consts:[["id","confirm",1,"page-content"],[1,"container"],[1,"row","custBrow",2,"margin-bottom","1vh"],[1,"col-10","custList"],["routerLink","/staff/select-customer",1,"main-bg","custListButton"],["src","../../../../assets/images/cust.png","alt",""],["behavior","scroll","direction","left"],[1,"col-2","prodAdd","text-right","pl-0"],[1,"main-bg",3,"click"],["src","../../../../assets/images/add.svg","alt","",1,"main-filter"],[1,"vatStatus"],[1,"vatScope"],["type","checkbox","id","IsMemberDiscountApply","name","IsMemberDiscountApply","value","1",1,"custom-checkbox",3,"ngModel","change","ngModelChange"],[1,"main-bg","vatCustom"],[1,"title-field"],[1,"form-group","orderInfo","borderless-field"],["type","text","name","OrderId","id","OrderId","placeholder","M\xe3 \u0111\u01a1n...",1,"orderField","small-height",3,"ngModel","readonly","ngModelChange"],["href","javascript:void(0)","onclick","openCustMenu()","type","button",1,"btn","main-btn","w-100",2,"margin-bottom","1vh"],[1,"row","col-xs-12",2,"height","62px","padding-left","15px","padding-right","15px"],[1,"addInfo",2,"width","50%","padding-right","5px"],[1,"form-group","orderInfo","borderless-field",2,"margin-bottom","1vh"],["type","number","name","PercentDiscount","id","PercentDiscount","placeholder","%",1,"orderField","small-height",3,"ngModel","input","ngModelChange"],[1,"addInfo",2,"width","50%","padding-left","5px"],["type","tel","name","AmountDiscount","id","AmountDiscount","placeholder","0",1,"orderField","small-height",3,"ngModel","ngModelChange","input","focus"],["type","text","name","wishingDoneTime","id","wishingDoneTime","placeholder","",1,"orderField","small-height",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],[1,"orderDetail","cusScroll"],["class","orderDetailItem",4,"ngFor","ngForOf"],["type","checkbox","id","VATIncluded","name","VATIncluded","value","1",1,"custom-checkbox",3,"ngModel","change","ngModelChange"],[1,"orderTotal"],[1,"totalOld"],[1,"orderPrice"],[1,"totalNew"],[1,"totalExc"],["href","javascript:void(0)","type","button",1,"btn","main-btn","w-100",2,"margin-top","2vh",3,"click"],[1,"row","orderConfirm","text-center"],[1,"col-4","exchange"],[1,"btn","main-bg","w-100",3,"click"],["src","../../../../assets/images/money.svg","alt","\u0110\u1ed5i \u0111i\u1ec3m",1,"main-filter"],[1,"col-8","pl-0"],["href","javascript:void(0)","type","submit",1,"btn","main-btn","w-100",3,"click"],["id","exchangeAdd",1,"popup-content"],["action","",1,""],[1,"form-group"],["for","",1,"excLabel"],[1,"memberLevel","v"],[1,""],["type","number","name","","id","exchange-val","placeholder","S\u1ed1 \u0111i\u1ec3m mu\u1ed1n \u0111\u1ed5i...",1,"mainForm"],[1,"row"],[1,"col-8","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-3","exchange-confirm"],["id","recentInfo",1,"actionMenu2"],["style","height: 69px;text-align: left;",3,"click",4,"ngFor","ngForOf"],["id","purchase-dialog",1,"popup-content"],[1,"checkOut",2,"margin-top","0px","padding","0px"],[1,"checkOutTotal"],[1,"checkOutLeft","mb-2"],["for","currentPayAmount",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","currentPayAmount","id","currentPayAmount",1,"mainForm",3,"ngModel","input","focus","ngModelChange"],["for","Note",2,"width","100%","text-align","left","margin-bottom","0px"],["type","text","name","purchaseNote","id","purchaseNote",1,"mainForm",3,"ngModel","ngModelChange"],[1,"form-group","methodGrid","mb-0"],["href","javascript:void(0)",1,"methodItem",3,"ngClass","click"],["src","../../../../assets/images/momo.jpg","alt",""],["src","../../../../assets/images/banking.jpg","alt",""],["src","../../../../assets/images/cash.png","alt",""],[1,"col-12","mx-auto","text-center"],["type","button",1,"btn","main-btn","w-100",3,"click"],["id","codeQR",1,"popup-content"],[3,"value","size"],["type","button","id","submit-btn","onClick","qrDone()",1,"btn","main-btn","w-100","mt-3"],[1,"orderDetailItem"],[1,"itemNumb"],[1,"itemDetail"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPrice"],[1,"prodCharge"],[1,"itemAction"],[3,"click"],["src","../../../../assets/images/delete.svg","alt","",1,"white-filter"],["src","../../../../assets/images/edit.svg","alt","",1,"white-filter"],[2,"height","69px","text-align","left",3,"click"],[1,"recentInfo-name"],[1,"recentInfo-phone",2,"width","25%"],[1,"recentInfo-date",2,"width","75%"]],template:function(e,t){if(1&e&&(s.hc(0,"div",0),s.hc(1,"div",1),s.hc(2,"div",2),s.hc(3,"div",3),s.hc(4,"a",4),s.cc(5,"img",5),s.hc(6,"marquee",6),s.Rc(7),s.gc(),s.gc(),s.gc(),s.hc(8,"div",7),s.hc(9,"a",8),s.pc("click",(function(){return t.addNewOrderDetail()})),s.cc(10,"img",9),s.gc(),s.gc(),s.gc(),s.hc(11,"div",10),s.hc(12,"p"),s.Rc(13,"\xc1p d\u1ee5ng khuy\u1ebfn m\xe3i th\xe0nh vi\xean"),s.gc(),s.hc(14,"div",11),s.hc(15,"input",12),s.pc("change",(function(){return t.onMemberDiscountChange()}))("ngModelChange",(function(e){return t.order.IsMemberDiscountApply=e})),s.gc(),s.cc(16,"span",13),s.gc(),s.gc(),s.hc(17,"label",14),s.Rc(18,"M\xe3 \u0111\u01a1n "),s.gc(),s.hc(19,"div",15),s.hc(20,"input",16),s.pc("ngModelChange",(function(e){return t.order.OrderId=e})),s.gc(),s.gc(),s.hc(21,"a",17),s.Rc(22,"\xc1p d\u1ee5ng khuy\u1ebfn m\xe3i"),s.gc(),s.hc(23,"div",18),s.hc(24,"div",19),s.hc(25,"label",14),s.Rc(26,"Gi\u1ea3m gi\xe1 ph\u1ea7n tr\u0103m"),s.gc(),s.hc(27,"div",20),s.hc(28,"input",21),s.pc("input",(function(e){return t.onDiscountChanged(e.target.value)}))("ngModelChange",(function(e){return t.order.PercentDiscount=e})),s.gc(),s.gc(),s.gc(),s.hc(29,"div",22),s.hc(30,"label",14),s.Rc(31,"Gi\u1ea3 gi\xe1 ti\u1ec1n"),s.gc(),s.hc(32,"div",15),s.hc(33,"input",23),s.pc("ngModelChange",(function(e){return t.order.AmountDiscount=e}))("input",(function(e){return t.onAmountDiscountChanged(e.target.value)}))("focus",(function(){return t.onAmountDiscountFocus()})),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(34,"label",14),s.Rc(35,"Th\u1eddi gian nh\u1eadn d\u1ef1 ki\u1ebfn"),s.gc(),s.hc(36,"div",15),s.hc(37,"input",24),s.pc("ngModelChange",(function(e){return t.wishingDoneTime=e})),s.gc(),s.cc(38,"owl-date-time",25,26),s.gc(),s.hc(40,"ul",27),s.Pc(41,F,26,16,"li",28),s.gc(),s.hc(42,"div",10),s.hc(43,"p"),s.Rc(44,"Bao g\u1ed3m VAT"),s.gc(),s.hc(45,"div",11),s.hc(46,"input",29),s.pc("change",(function(){return t.onVATIncludedChange()}))("ngModelChange",(function(e){return t.order.VATIncluded=e})),s.gc(),s.cc(47,"span",13),s.gc(),s.gc(),s.hc(48,"div",30),s.hc(49,"p",31),s.Rc(50,"C\xf2n l\u1ea1i: "),s.hc(51,"span",32),s.Rc(52),s.uc(53,"myCurrPipe"),s.gc(),s.gc(),s.hc(54,"p",33),s.Rc(55,"Th\xe0nh ti\u1ec1n: "),s.hc(56,"span",32),s.Rc(57),s.uc(58,"myCurrPipe"),s.gc(),s.gc(),s.hc(59,"p",34),s.Rc(60,"\u0110\u1ed5i \u0111i\u1ec3m: "),s.hc(61,"span",32),s.Rc(62),s.gc(),s.gc(),s.gc(),s.hc(63,"a",35),s.pc("click",(function(){return t.completingOrder()})),s.Rc(64," K\u1ebft th\xfac \u0111\u01a1n"),s.gc(),s.hc(65,"div",36),s.hc(66,"div",37),s.hc(67,"button",38),s.pc("click",(function(){return t.scoreExchange()})),s.cc(68,"img",39),s.gc(),s.gc(),s.hc(69,"div",40),s.hc(70,"a",41),s.pc("click",(function(){return t.placeOrder(!1)})),s.Rc(71,"L\u01b0u"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(72,"div",42),s.hc(73,"form",43),s.hc(74,"div",44),s.hc(75,"label",45),s.Rc(76,"Th\xe0nh vi\xean: "),s.gc(),s.hc(77,"span",46),s.Rc(78),s.gc(),s.gc(),s.hc(79,"div",44),s.hc(80,"label",45),s.Rc(81,"\u0110i\u1ec3m t\xedch l\u0169y: "),s.gc(),s.hc(82,"span",47),s.Rc(83),s.gc(),s.gc(),s.hc(84,"div",44),s.cc(85,"input",48),s.gc(),s.hc(86,"div",49),s.hc(87,"div",50),s.hc(88,"button",51),s.Rc(89,"\u0110\u1ed5i \u0111i\u1ec3m"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(90,"div",52),s.hc(91,"ul"),s.Pc(92,N,9,9,"li",53),s.gc(),s.gc(),s.hc(93,"div",54),s.hc(94,"div",1),s.hc(95,"div",55),s.hc(96,"div",56),s.hc(97,"h3"),s.Rc(98,"T\u1ed5ng"),s.gc(),s.hc(99,"p"),s.Rc(100),s.uc(101,"myCurrPipe"),s.gc(),s.gc(),s.hc(102,"div",57),s.hc(103,"h4"),s.Rc(104,"S\u1ed1 ti\u1ec1n c\xf2n l\u1ea1i"),s.gc(),s.hc(105,"p"),s.Rc(106),s.uc(107,"myCurrPipe"),s.gc(),s.gc(),s.hc(108,"div",44),s.hc(109,"label",58),s.Rc(110,"S\u1ed1 ti\u1ec1n thanh to\xe1n"),s.gc(),s.hc(111,"input",59),s.pc("input",(function(e){return t.onPayChanged(e.target.value)}))("focus",(function(){return t.onPayFocus()}))("ngModelChange",(function(e){return t.currentPayAmount=e})),s.gc(),s.gc(),s.hc(112,"div",44),s.hc(113,"label",60),s.Rc(114,"Ghi Ch\xfa"),s.gc(),s.hc(115,"input",61),s.pc("ngModelChange",(function(e){return t.purchaseNote=e})),s.gc(),s.gc(),s.hc(116,"div",62),s.hc(117,"a",63),s.pc("click",(function(){return t.selectPurType(t.purchaseType.Momo)})),s.cc(118,"img",64),s.gc(),s.hc(119,"a",63),s.pc("click",(function(){return t.selectPurType(t.purchaseType.Banking)})),s.cc(120,"img",65),s.gc(),s.hc(121,"a",63),s.pc("click",(function(){return t.selectPurType(t.purchaseType.Cash)})),s.cc(122,"img",66),s.gc(),s.gc(),s.hc(123,"div",49),s.hc(124,"div",67),s.hc(125,"button",68),s.pc("click",(function(){return t.purchaseConfirm()})),s.Rc(126,"X\xe1c nh\u1eadn"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(127,"div",69),s.hc(128,"span"),s.Rc(129,"Qu\xe9t m\xe3 QR \u0111\u1ec3 thanh to\xe1n "),s.gc(),s.hc(130,"div"),s.cc(131,"qr-code",70),s.gc(),s.hc(132,"div",49),s.hc(133,"div",67),s.hc(134,"button",71),s.Rc(135,"Xong"),s.gc(),s.gc(),s.gc(),s.gc()),2&e){const e=s.Hc(39);s.Ob(7),s.Uc("",t.order.CustomerInfo.Name," (-",t.order.CustomerInfo.DiscountPercent,"%)"),s.Ob(8),s.Ac("ngModel",t.order.IsMemberDiscountApply),s.Ob(5),s.Ac("ngModel",t.order.OrderId)("readonly",t.isEdittingOrder),s.Ob(8),s.Ac("ngModel",t.order.PercentDiscount),s.Ob(5),s.Ac("ngModel",t.order.AmountDiscount),s.Ob(4),s.Ac("owlDateTime",e)("owlDateTimeTrigger",e)("ngModel",t.wishingDoneTime),s.Ob(1),s.Ac("stepMinute",5),s.Ob(3),s.Ac("ngForOf",t.order.OrderDetails),s.Ob(5),s.Ac("ngModel",t.order.VATIncluded),s.Ob(6),s.Tc("",s.vc(53,28,t.AcctualBalance)," "),s.Ob(5),s.Tc("",s.vc(58,30,t.order.TotalAmount)," "),s.Ob(5),s.Sc(t.order.CustomerInfo.ScoreUsed),s.Ob(16),s.Sc(t.memberShipTitle),s.Ob(5),s.Sc(t.order.CustomerInfo.AvailableScore),s.Ob(9),s.Ac("ngForOf",t.promotions),s.Ob(8),s.Sc(s.vc(101,32,t.order.TotalAmount)),s.Ob(6),s.Sc(s.vc(107,34,t.totalBalance)),s.Ob(5),s.Ac("ngModel",t.currentPayAmount),s.Ob(4),s.Ac("ngModel",t.purchaseNote),s.Ob(2),s.Ac("ngClass","Momo"===t.currentPurType?" img-purchase-selected":""),s.Ob(2),s.Ac("ngClass","Banking"===t.currentPurType?" img-purchase-selected":""),s.Ob(2),s.Ac("ngClass","Cash"===t.currentPurType?" img-purchase-selected":""),s.Ob(10),s.Ac("value",t.qrContent)("size",290)}},directives:[c.c,T.a,T.k,T.n,T.b,T.p,k.c,k.f,k.b,g.k,T.v,T.l,T.m,g.j,w.a],pipes:[R.a,M.a,R.b],styles:[""]}),e})();var L=i("uP5C"),B=i("e6qa");function U(e,t){if(1&e){const e=s.ic();s.hc(0,"a",7),s.pc("click",(function(){return s.Jc(e),s.tc().openFileForShare()})),s.Rc(1,"Ch\u1ecdn h\xecnh"),s.gc()}}function H(e,t){if(1&e){const e=s.ic();s.hc(0,"a",7),s.pc("click",(function(){return s.Jc(e),s.tc().openFile()})),s.Rc(1,"Ch\u1ecdn h\xecnh"),s.gc()}}function q(e,t){if(1&e){const e=s.ic();s.hc(0,"div"),s.hc(1,"input",8,9),s.pc("change",(function(t){return s.Jc(e),s.tc().onChange(t)})),s.gc(),s.hc(3,"a",7),s.pc("click",(function(){return s.Jc(e),s.Hc(2).click()})),s.Rc(4,"Ch\u1ecdn h\xecnh"),s.gc(),s.gc()}}function E(e,t){if(1&e){const e=s.ic();s.hc(0,"a",7),s.pc("click",(function(){return s.Jc(e),s.tc().shareForCus()})),s.Rc(1,"Share cho KH"),s.gc()}}function V(e,t){if(1&e){const e=s.ic();s.hc(0,"a",7),s.pc("click",(function(){return s.Jc(e),s.tc().confirm("")})),s.Rc(1,"X\xe1c nh\u1eadn"),s.gc()}}function J(e,t){if(1&e){const e=s.ic();s.hc(0,"a",7),s.pc("click",(function(){return s.Jc(e),s.tc().shipperCofirm()})),s.Rc(1,"X\xe1c nh\u1eadn"),s.gc()}}let G=(()=>{class e extends f{constructor(e,t,i,c){super(),this.orderDetailService=e,this.customerService=t,this.router=i,this.orderService=c,this.Title="X\xe1c nh\u1eadn v\u1edbi kh\xe1ch h\xe0ng",this.edittingImageUrl="",this.orderDetail=new b.c,this.order=new b.d,this.customer=new L.a}Init(){this.orderDetail=this.globalOrderDetail,this.orderService.getById(this.orderDetail.OrderId).then(e=>{this.order=e,this.customerService.getById(this.order.CustomerInfo.Id).then(e=>{this.customer=e})})}fileChosen(e){this.edittingImageUrl="data:image/png;base64,"+e}onChange(e){const t=e.target.files[0];if(!t)return;if(null==t.type.match(/image\/*/))return void this.showError("Ph\u1ea3i ch\u1ecdn h\xecnh !!");const i=new FileReader;i.readAsDataURL(t),i.onload=e=>{this.edittingImageUrl=i.result.toString()}}destroy(){super.destroy(),deleteTempImage()}shipperCofirm(){getShippingNoteDialog("X\xe1c nh\u1eadn",e=>{this.confirm(e)})}confirm(e){switch(this.CurrentUser.Role){case v.i.Account:case v.i.Admin:""!==this.edittingImageUrl?fetch(this.edittingImageUrl).then(e=>e.blob()).then(e=>{const t=new File([e],"result.png",{type:"image/png"});this.orderDetailService.resultConfirm(this.orderDetail.OrderDetailId,this.orderDetailService.getLastestMaking(this.orderDetail).Id,t).then(e=>{this.router.navigate(["staff/account-main"])})}):this.orderDetailService.resultConfirm(this.orderDetail.OrderDetailId,this.orderDetailService.getLastestMaking(this.orderDetail).Id,null).then(e=>{this.router.navigate(["staff/account-main"])});break;case v.i.Shipper:""!==this.edittingImageUrl?fetch(this.edittingImageUrl).then(e=>e.blob()).then(t=>{const i=new File([t],"shipping.png",{type:"image/png"});this.shippingConfirm(i,e)}):this.shippingConfirm(null,e)}}shippingConfirm(e,t){this.orderDetailService.shippingConfirm(this.orderDetail,null,t).then(e=>{this.orderDetailService.completeOD(this.orderDetail,this.order).then(()=>{this.router.navigate(["staff/shipper-main"])})})}shareForCus(){""!==this.edittingImageUrl&&(this.IsOnTerminal?shareImageCus(p.a.getMainContact(this.customer)):shareImageCusWithData(this.edittingImageUrl,p.a.getMainContact(this.customer)))}}return e.\u0275fac=function(t){return new(t||e)(s.bc(B.a),s.bc(C.a),s.bc(c.b),s.bc(S.a))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-customer-confirm"]],features:[s.Lb],decls:11,vars:7,consts:[["id","staff",1,"page-content"],[1,"container"],[1,"image-top"],["id","selected-image","onclick","rotateImage()","alt","",3,"src"],[1,"image-action"],["href","javascript:void(0)","class","main-bg",3,"click",4,"ngIf"],[4,"ngIf"],["href","javascript:void(0)",1,"main-bg",3,"click"],["type","file","id","resultFile","name","uploadedFile","hidden","",1,"img-cover","file-upload-default",3,"change"],["imageUpload",""]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"div",1),s.hc(2,"div",2),s.cc(3,"img",3),s.gc(),s.hc(4,"div",4),s.Pc(5,U,2,0,"a",5),s.Pc(6,H,2,0,"a",5),s.Pc(7,q,5,0,"div",6),s.Pc(8,E,2,0,"a",5),s.Pc(9,V,2,0,"a",5),s.Pc(10,J,2,0,"a",5),s.gc(),s.gc(),s.gc()),2&e&&(s.Ob(3),s.Ac("src",t.edittingImageUrl,s.Lc),s.Ob(2),s.Ac("ngIf",t.IsOnTerminal&&"Shipper"!=t.CurrentUser.Role),s.Ob(1),s.Ac("ngIf",t.IsOnTerminal&&"Shipper"==t.CurrentUser.Role),s.Ob(1),s.Ac("ngIf",!t.IsOnTerminal),s.Ob(1),s.Ac("ngIf","Shipper"!=t.CurrentUser.Role),s.Ob(1),s.Ac("ngIf","Shipper"!=t.CurrentUser.Role),s.Ob(1),s.Ac("ngIf","Shipper"==t.CurrentUser.Role))},directives:[g.l],styles:[""]}),e})();var W=i("AytR"),j=i("dkQB");let $=(()=>{class e{constructor(e){this.globalService=e}pushFileToStorage(e,t,i){}push(e,t,i){return Object(o.a)(this,void 0,void 0,(function*(){return""}))}deleteFile(e,t){}downloadFIle(e,t){const i=new XMLHttpRequest;i.responseType="blob",i.onload=e=>{t(i.response)},i.open("GET",e),i.send()}pushStringToStorage(e,t,i){}}return e.\u0275fac=function(t){return new(t||e)(s.lc(h.a))},e.\u0275prov=s.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function X(e,t){if(1&e&&(s.hc(0,"div",21),s.hc(1,"span",11),s.Rc(2,"SDT ng\u01b0\u1eddi nh\u1eadn:"),s.gc(),s.hc(3,"span",12),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(4),s.Sc(e.orderDetail.DeliveryInfo.PhoneNumber)}}function Q(e,t){if(1&e&&(s.hc(0,"div",21),s.hc(1,"span",11),s.Rc(2,"\u0110\u1ecba ch\u1ec9 giao:"),s.gc(),s.hc(3,"span",12),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(4),s.Sc(e.orderDetail.DeliveryInfo.Address)}}let z=(()=>{class e extends f{constructor(e,t,i,c,r){super(),this.router=e,this.orderService=t,this.orderDetailService=i,this.storageService=c,this.customerService=r,this.Title="X\xe1c nh\u1eadn giao h\xe0ng",this.sharingImage=""}Init(){this.orderDetail=this.globalOrderDetail,this.customerService.getById(this.globalOrder.CustomerInfo.Id).then(e=>{this.customer=e})}destroy(){super.destroy(),deleteTempImage()}confirmOrderDetail(){this.orderDetailService.completeOD(this.orderDetail,this.globalOrder).then(e=>Object(o.a)(this,void 0,void 0,(function*(){this.router.navigate(["staff/orders-manage"])})))}getShippingImg(){const e=this.orderDetailService.getLastestShipping(this.orderDetail);return null!=e?e.DeliveryImageUrl:""}getResultImg(){const e=this.orderDetailService.getLastestMaking(this.orderDetail);return null!=e?e.ResultImageUrl:""}shareToCus(){this.startLoading(),this.storageService.downloadFIle(`${W.a.base_domain}${j.b.shipping_img}${this.getShippingImg()}`,e=>{this.stopLoading();const t=new FileReader;t.readAsDataURL(e),t.onloadend=()=>{const e=t.result.toString();this.sharingImage=e,shareImageCusWithData(this.sharingImage,p.a.getMainContact(this.customer))}})}}return e.\u0275fac=function(t){return new(t||e)(s.bc(c.b),s.bc(S.a),s.bc(B.a),s.bc($),s.bc(C.a))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-final-confirm"]],features:[s.Lb],decls:63,vars:31,consts:[["id","deliConfirm",1,"page-content"],[1,"container"],[1,"prodDetail"],[1,"prodGen"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPrice"],[1,"prodCharge"],[1,"prodInfo","cusScroll"],[1,"prodQuan","infoGroup"],[1,"itemlabel"],[1,"itemVal"],[1,"prodName","infoGroup"],[1,"prodTime","infoGroup"],["class","prodAddr infoGroup",4,"ngIf"],[1,"prodDesc","infoGroup"],[1,"row"],[1,"col-10","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-2",3,"click"],["type","submit",1,"btn","grey-btn","w-100","mt-2",3,"click"],[1,"prodAddr","infoGroup"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"div",1),s.hc(2,"div",2),s.hc(3,"div",3),s.cc(4,"img",4),s.uc(5,"ImgPipe"),s.cc(6,"img",4),s.uc(7,"ImgPipe"),s.hc(8,"div",5),s.hc(9,"h5",6),s.Rc(10),s.gc(),s.hc(11,"span",7),s.Rc(12),s.uc(13,"myCurrPipe"),s.gc(),s.hc(14,"span",8),s.Rc(15),s.gc(),s.hc(16,"span",8),s.Rc(17),s.uc(18,"myCurrPipe"),s.gc(),s.hc(19,"span",8),s.Rc(20),s.uc(21,"myCurrPipe"),s.gc(),s.gc(),s.gc(),s.hc(22,"div",9),s.hc(23,"div",10),s.hc(24,"span",11),s.Rc(25,"M\xe3 \u0111\u01a1n: "),s.gc(),s.hc(26,"span",12),s.Rc(27),s.gc(),s.gc(),s.hc(28,"div",13),s.hc(29,"span",11),s.Rc(30,"T\xean KH"),s.gc(),s.hc(31,"span",12),s.Rc(32),s.gc(),s.gc(),s.hc(33,"div",13),s.hc(34,"span",11),s.Rc(35,"SDT KH"),s.gc(),s.hc(36,"span",12),s.Rc(37),s.gc(),s.gc(),s.hc(38,"div",14),s.hc(39,"span",11),s.Rc(40,"Th\u1eddi gian giao:"),s.gc(),s.hc(41,"span",12),s.Rc(42),s.uc(43,"date"),s.gc(),s.gc(),s.hc(44,"div",13),s.hc(45,"span",11),s.Rc(46,"T\xean ng\u01b0\u1eddi nh\u1eadn:"),s.gc(),s.hc(47,"span",12),s.Rc(48),s.gc(),s.gc(),s.Pc(49,X,5,1,"div",15),s.Pc(50,Q,5,1,"div",15),s.hc(51,"div",16),s.hc(52,"span",11),s.Rc(53,"M\xf4 t\u1ea3:"),s.gc(),s.hc(54,"span",12),s.Rc(55),s.gc(),s.gc(),s.gc(),s.hc(56,"div",17),s.hc(57,"div",18),s.hc(58,"button",19),s.pc("click",(function(){return t.shareToCus()})),s.Rc(59,"X\xe1c nh\u1eadn Kh\xe1ch h\xe0ng"),s.gc(),s.gc(),s.hc(60,"div",18),s.hc(61,"button",20),s.pc("click",(function(){return t.confirmOrderDetail()})),s.Rc(62,"X\xe1c nh\u1eadn"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc()),2&e&&(s.Ob(4),s.Bc("src",s.wc(5,16,t.getResultImg(),"ResultImg"),s.Lc),s.Ob(2),s.Bc("src",s.wc(7,19,t.getShippingImg(),"ShippingImg"),s.Lc),s.Ob(4),s.Sc(t.orderDetail.ProductName),s.Ob(2),s.Sc(s.vc(13,22,t.orderDetail.ModifiedPrice)),s.Ob(3),s.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",t.orderDetail.Quantity,""),s.Ob(2),s.Tc("Gi\u1ea3m gi\xe1: ",s.vc(18,24,t.getDetailDiscount(t.orderDetail)),""),s.Ob(3),s.Tc("Ph\u1ee5 ph\xed: ",s.vc(21,26,t.orderDetail.AdditionalFee),""),s.Ob(7),s.Uc("",t.orderDetail.OrderId,"_",t.orderDetail.Index+1,""),s.Ob(5),s.Sc(t.orderDetail.CustomerName),s.Ob(5),s.Sc(t.orderDetail.CustomerPhoneNumber),s.Ob(5),s.Sc(s.wc(43,28,t.orderDetail.DeliveryInfo.DateTime,"HH:mm dd/MM/yyyy")),s.Ob(6),s.Sc(t.orderDetail.DeliveryInfo.FullName),s.Ob(1),s.Ac("ngIf","Florist"!=t.CurrentUser.Role),s.Ob(1),s.Ac("ngIf","Florist"!=t.CurrentUser.Role),s.Ob(5),s.Sc(t.orderDetail.Description))},directives:[g.l],pipes:[M.a,R.a,g.e],styles:[""]}),e})();function K(e,t){if(1&e){const e=s.ic();s.hc(0,"div",10),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.hc(1,"span"),s.Rc(2),s.gc(),s.gc()}if(2&e){const e=s.tc(2);s.Ob(2),s.Sc(e.index)}}function _(e,t){if(1&e){const e=s.ic();s.hc(0,"div",11),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.hc(1,"span"),s.Rc(2),s.gc(),s.gc()}if(2&e){const e=s.tc(2);s.Ob(2),s.Sc(e.index)}}function Z(e,t){if(1&e){const e=s.ic();s.hc(0,"div",12),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.hc(1,"span"),s.Rc(2),s.gc(),s.gc()}if(2&e){const e=s.tc(2);s.Ob(2),s.Sc(e.index)}}function Y(e,t){if(1&e){const e=s.ic();s.hc(0,"div",13),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.hc(1,"span"),s.Rc(2),s.gc(),s.gc()}if(2&e){const e=s.tc(2);s.Ob(2),s.Sc(e.index)}}function ee(e,t){if(1&e){const e=s.ic();s.hc(0,"div",14),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.hc(1,"span"),s.Rc(2),s.gc(),s.gc()}if(2&e){const e=s.tc(2);s.Ob(2),s.Sc(e.index)}}function te(e,t){if(1&e){const e=s.ic();s.hc(0,"div",15),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.hc(1,"span"),s.Rc(2),s.gc(),s.gc()}if(2&e){const e=s.tc(2);s.Ob(2),s.Sc(e.index)}}function ie(e,t){if(1&e){const e=s.ic();s.hc(0,"div",16),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.hc(1,"span"),s.Rc(2),s.gc(),s.gc()}if(2&e){const e=s.tc(2);s.Ob(2),s.Sc(e.index)}}function ce(e,t){if(1&e){const e=s.ic();s.hc(0,"div",17),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.hc(1,"span"),s.Rc(2),s.gc(),s.gc()}if(2&e){const e=s.tc(2);s.Ob(2),s.Sc(e.index)}}function re(e,t){if(1&e&&(s.hc(0,"div",1),s.Pc(1,K,3,1,"div",2),s.Pc(2,_,3,1,"div",3),s.Pc(3,Z,3,1,"div",4),s.Pc(4,Y,3,1,"div",5),s.Pc(5,ee,3,1,"div",6),s.Pc(6,te,3,1,"div",7),s.Pc(7,ie,3,1,"div",8),s.Pc(8,ce,3,1,"div",9),s.gc()),2&e){const e=s.tc();s.Ac("ngSwitch",e.state),s.Ob(1),s.Ac("ngSwitchCase",e.states.Added),s.Ob(1),s.Ac("ngSwitchCase",e.states.Making),s.Ob(1),s.Ac("ngSwitchCase",e.states.Comfirming),s.Ob(1),s.Ac("ngSwitchCase",e.states.Completed),s.Ob(1),s.Ac("ngSwitchCase",e.states.Canceled),s.Ob(1),s.Ac("ngSwitchCase",e.states.OnTheWay),s.Ob(1),s.Ac("ngSwitchCase",e.states.SentBack),s.Ob(1),s.Ac("ngSwitchCase",e.states.Fixing)}}function ne(e,t){if(1&e){const e=s.ic();s.hc(0,"div",10),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.cc(1,"span"),s.gc()}}function oe(e,t){if(1&e){const e=s.ic();s.hc(0,"div",11),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.cc(1,"span"),s.gc()}}function se(e,t){if(1&e){const e=s.ic();s.hc(0,"div",12),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.cc(1,"span"),s.gc()}}function ae(e,t){if(1&e){const e=s.ic();s.hc(0,"div",13),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.cc(1,"span"),s.gc()}}function he(e,t){if(1&e){const e=s.ic();s.hc(0,"div",14),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.cc(1,"span"),s.gc()}}function de(e,t){if(1&e){const e=s.ic();s.hc(0,"div",15),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.cc(1,"span"),s.gc()}}function le(e,t){if(1&e){const e=s.ic();s.hc(0,"div",16),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.cc(1,"span"),s.gc()}}function ge(e,t){if(1&e){const e=s.ic();s.hc(0,"div",17),s.pc("click",(function(){return s.Jc(e),s.tc(2).pointClicked()})),s.cc(1,"span"),s.gc()}}function ue(e,t){if(1&e&&(s.hc(0,"div",1),s.Pc(1,ne,2,0,"div",2),s.Pc(2,oe,2,0,"div",3),s.Pc(3,se,2,0,"div",4),s.Pc(4,ae,2,0,"div",5),s.Pc(5,he,2,0,"div",6),s.Pc(6,de,2,0,"div",7),s.Pc(7,le,2,0,"div",8),s.Pc(8,ge,2,0,"div",9),s.gc()),2&e){const e=s.tc();s.Ac("ngSwitch",e.state),s.Ob(1),s.Ac("ngSwitchCase",e.states.Added),s.Ob(1),s.Ac("ngSwitchCase",e.states.Making),s.Ob(1),s.Ac("ngSwitchCase",e.states.Comfirming),s.Ob(1),s.Ac("ngSwitchCase",e.states.Completed),s.Ob(1),s.Ac("ngSwitchCase",e.states.Canceled),s.Ob(1),s.Ac("ngSwitchCase",e.states.OnTheWay),s.Ob(1),s.Ac("ngSwitchCase",e.states.SentBack),s.Ob(1),s.Ac("ngSwitchCase",e.states.Fixing)}}let me=(()=>{class e{constructor(){this.states=v.f,this.index=-1,this.id="",this.onClicked=new s.q,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){}pointClicked(){this.onClicked.emit(this.id)}preventEvent(e){e.stopPropagation()}writeValue(e){}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}updateChanges(){this.onChange()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Vb({type:e,selectors:[["app-status-point"]],inputs:{state:"state",index:"index",id:"id"},outputs:{onClicked:"onClicked"},features:[s.Nb([{provide:T.j,useExisting:Object(s.fb)(()=>e),multi:!0}])],decls:2,vars:2,consts:[[3,"ngSwitch",4,"ngIf"],[3,"ngSwitch"],["class","item-status pi",3,"click",4,"ngSwitchCase"],["class","item-status o",3,"click",4,"ngSwitchCase"],["class","item-status y",3,"click",4,"ngSwitchCase"],["class","item-status g",3,"click",4,"ngSwitchCase"],["class","item-status x",3,"click",4,"ngSwitchCase"],["class","item-status on-the-way",3,"click",4,"ngSwitchCase"],["class","item-status send-back",3,"click",4,"ngSwitchCase"],["class","item-status fixing",3,"click",4,"ngSwitchCase"],[1,"item-status","pi",3,"click"],[1,"item-status","o",3,"click"],[1,"item-status","y",3,"click"],[1,"item-status","g",3,"click"],[1,"item-status","x",3,"click"],[1,"item-status","on-the-way",3,"click"],[1,"item-status","send-back",3,"click"],[1,"item-status","fixing",3,"click"]],template:function(e,t){1&e&&(s.Pc(0,re,9,9,"div",0),s.Pc(1,ue,9,9,"div",0)),2&e&&(s.Ac("ngIf",t.index>-1),s.Ob(1),s.Ac("ngIf",-1==t.index))},directives:[g.l,g.n,g.o],styles:[""]}),e})();function pe(e,t){if(1&e){const e=s.ic();s.hc(0,"div",18),s.hc(1,"div",19),s.hc(2,"span",20),s.Rc(3),s.gc(),s.hc(4,"div",21),s.hc(5,"h4",22),s.Rc(6),s.gc(),s.hc(7,"span",23),s.Rc(8),s.gc(),s.gc(),s.cc(9,"app-status-point",24),s.gc(),s.hc(10,"div",25),s.hc(11,"ul",26),s.hc(12,"li",27),s.hc(13,"div",28),s.pc("click",(function(){s.Jc(e);const i=t.$implicit;return s.tc().getMenu(i)})),s.cc(14,"img",29),s.uc(15,"ImgPipe"),s.hc(16,"div",30),s.hc(17,"span",31),s.Rc(18),s.uc(19,"myCurrPipe"),s.gc(),s.hc(20,"span",32),s.Rc(21),s.uc(22,"myCurrPipe"),s.gc(),s.hc(23,"span",32),s.Rc(24),s.uc(25,"myCurrPipe"),s.gc(),s.hc(26,"span",33),s.Rc(27),s.gc(),s.hc(28,"span",34),s.Rc(29),s.uc(30,"myTimePipe"),s.gc(),s.hc(31,"span",35),s.Rc(32),s.uc(33,"myDatePipe"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.$implicit,i=t.index,c=s.tc();s.Ob(3),s.Uc("",e.OrderId,"_",e.Index+1,""),s.Ob(3),s.Sc(e.ProductName),s.Ob(2),s.Uc("",e.CustomerName,"-",e.CustomerPhoneNumber,""),s.Ob(1),s.Ac("state",e.State)("id",e.OrderDetailId)("index",i+1),s.Ob(5),s.Bc("src",s.wc(15,15,e.ProductImageUrl,"ProductImg"),s.Lc),s.Ob(4),s.Sc(s.vc(19,18,e.ModifiedPrice)),s.Ob(3),s.Tc("Ph\u1ee5 ph\xed: ",s.vc(22,20,e.AdditionalFee),""),s.Ob(3),s.Tc("Gi\u1ea3m gi\xe1: ",s.vc(25,22,c.getDetailDiscount(e)),""),s.Ob(3),s.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.Quantity,""),s.Ob(2),s.Tc("",s.vc(30,24,e.MakingRequestTime)," "),s.Ob(3),s.Tc(" ",s.vc(33,26,e.MakingRequestTime),"")}}function fe(e,t){if(1&e){const e=s.ic();s.hc(0,"div",36),s.hc(1,"div",19),s.hc(2,"span",20),s.Rc(3),s.gc(),s.hc(4,"div",21),s.hc(5,"h4",22),s.Rc(6),s.gc(),s.hc(7,"span",23),s.Rc(8),s.gc(),s.gc(),s.cc(9,"app-status-point",24),s.gc(),s.hc(10,"div",25),s.hc(11,"ul",26),s.hc(12,"li",27),s.hc(13,"div",28),s.pc("click",(function(){s.Jc(e);const i=t.$implicit;return s.tc().getMenu(i)})),s.cc(14,"img",29),s.uc(15,"ImgPipe"),s.hc(16,"div",30),s.hc(17,"span",31),s.Rc(18),s.uc(19,"myCurrPipe"),s.gc(),s.hc(20,"span",32),s.Rc(21),s.uc(22,"myCurrPipe"),s.gc(),s.hc(23,"span",32),s.Rc(24),s.uc(25,"myCurrPipe"),s.gc(),s.hc(26,"span",33),s.Rc(27),s.gc(),s.hc(28,"span",34),s.Rc(29),s.uc(30,"myTimePipe"),s.gc(),s.hc(31,"span",35),s.Rc(32),s.uc(33,"myDatePipe"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.$implicit,i=t.index,c=s.tc();s.Ac("ngClass","Making"===e.State||"Fixing"===e.State?"selected-order-detail":""),s.Ob(3),s.Uc("",e.OrderId,"_",e.Index+1,""),s.Ob(3),s.Sc(e.ProductName),s.Ob(2),s.Uc("",e.CustomerName,"-",e.CustomerPhoneNumber,""),s.Ob(1),s.Ac("state",e.State)("id",e.OrderDetailId)("index",i+1),s.Ob(5),s.Bc("src",s.wc(15,16,e.ProductImageUrl,"ProductImg"),s.Lc),s.Ob(4),s.Sc(s.vc(19,19,e.ModifiedPrice)),s.Ob(3),s.Tc("Ph\u1ee5 ph\xed: ",s.vc(22,21,e.AdditionalFee),""),s.Ob(3),s.Tc("Gi\u1ea3m gi\xe1: ",s.vc(25,23,c.getDetailDiscount(e)),""),s.Ob(3),s.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.Quantity,""),s.Ob(2),s.Tc("",s.vc(30,25,e.MakingRequestTime)," "),s.Ob(3),s.Tc(" ",s.vc(33,27,e.MakingRequestTime),"")}}let be=(()=>{class e extends f{constructor(e,t){super(),this.router=e,this.orderDetailService=t,this.Title="Th\u1ee3 c\u1eafm hoa",this.NavigateClass="nav-icon ",this.IsDataLosingWarning=!1,this.waitingMenuItems=["Nh\u1eadn \u0111\u01a1n","Ho\xe0n th\xe0nh \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],this.makingMenuItems=["Ho\xe0n th\xe0nh \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"]}OnBackNaviage(){customerSupport()}logout(){this.authService.logOut(e=>{e&&this.router.navigate(["staff/login"])})}Init(){this.loadWaitingDetails(),this.loadMakingDetails(),this.askForRememberPassword()}viewDetail(e){this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}loadWaitingDetails(){this.waitingOrderDetails=[],this.orderDetailService.getDetailWithTimeSort([v.f.Added,v.f.SentBack],"MakingRequestTime").then(e=>{this.waitingOrderDetails=e})}loadMakingDetails(){this.makingOrderDetails=[],this.orderDetailService.getMakingOrderDetails(this.CurrentUser.Id).then(e=>{this.makingOrderDetails=e})}completeOD(e){this.openConfirm("ch\u1eafc ch\u1eafn ho\xe0n th\xe0nh \u0111\u01a1n?",()=>{this.orderDetailService.updateMakingFields(this.orderDetailService.getLastestMaking(e).Id,{CompleteTime:(new Date).getTime()}).then(()=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Comfirming}).then(()=>{this.loadMakingDetails(),this.loadWaitingDetails()})})})}getMenu(e){let t;switch(console.log(e.State),e.State){case v.f.Added:case v.f.SentBack:t=this.waitingMenuItems;break;case v.f.Making:case v.f.Fixing:t=this.makingMenuItems}menuOpen(t=>{switch(+t){case 0:switch(e.State){case v.f.Added:case v.f.SentBack:this.orderDetailService.updateDetailSeen(e.OrderDetailId,this.CurrentUser.Id,(new Date).getTime()).then(t=>{let i=v.c.Making;i=e.State==v.f.Added?v.c.Making:v.c.Fixing,this.orderDetailService.assignSingleMaking(e.OrderDetailId,this.CurrentUser.Id,(new Date).getTime(),i).then(()=>{this.loadMakingDetails(),this.loadWaitingDetails()})});break;case v.f.Making:case v.f.Fixing:this.completeOD(e)}break;case 1:switch(e.State){case v.f.Added:case v.f.SentBack:this.orderDetailService.updateDetailSeen(e.OrderDetailId,this.CurrentUser.Id,(new Date).getTime()).then(t=>{let i=v.c.Making;i=e.State==v.f.Added?v.c.Making:v.c.Fixing,this.orderDetailService.assignSingleMaking(e.OrderDetailId,this.CurrentUser.Id,(new Date).getTime(),i).then(t=>{this.orderDetailService.updateMakingFields(t.Id,{CompleteTime:(new Date).getTime()}).then(()=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Comfirming}).then(()=>{this.loadMakingDetails(),this.loadWaitingDetails()})})})});break;default:this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}break;case 2:this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}},t)}}return e.\u0275fac=function(t){return new(t||e)(s.bc(c.b),s.bc(B.a))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-florist-main"]],features:[s.Lb],decls:27,vars:9,consts:[["id","arrange",1,"page-content"],[1,"container"],["id","listNav","role","tablist",1,"nav","nav-tabs","row"],[1,"nav-item","col-6"],["id","nav1","data-toggle","tab","href","#camhoa","role","tab","aria-controls","camhoa","aria-selected","true",1,"active","main-bg"],["id","nav2","data-toggle","tab","href","#giaohoa","role","tab","aria-controls","giaohoa","aria-selected","false",1,"main-bg"],["id","listContent",1,"tab-content","order-list-bot"],["id","camhoa","role","tabpanel","aria-labelledby","nav1",1,"tab-pane","fade","show","active"],[1,"order-content","cusScroll"],["class","order-content-item product-item",4,"ngFor","ngForOf"],["id","giaohoa","role","tabpanel","aria-labelledby","nav2",1,"tab-pane","fade"],["class","order-content-item product-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"customer-support"],["alt","",1,"customer-avatar",3,"src"],[1,"customer-name"],["href","tel:0000",1,"customer-phone"],[1,"customer-position"],["id","logoutBtn",1,"customer-position",3,"click"],[1,"order-content-item","product-item"],[1,"item-top"],[1,"item-code"],[1,"item-info"],[1,"item-name"],[1,"item-quantity"],[3,"state","id","index"],[1,"item-bot"],[1,"order-product-list","cusScroll"],[1,""],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"prodPrice"],[1,"prodCharge"],[1,"item-address"],[1,"item-time"],[1,"item-date"],[1,"order-content-item","product-item",3,"ngClass"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"div",1),s.hc(2,"ul",2),s.hc(3,"li",3),s.hc(4,"a",4),s.Rc(5,"Ch\u1edd c\u1eafm"),s.gc(),s.gc(),s.hc(6,"li",3),s.hc(7,"a",5),s.Rc(8,"\u0110ang c\u1eafm"),s.gc(),s.gc(),s.gc(),s.hc(9,"div",6),s.hc(10,"div",7),s.hc(11,"ul",8),s.Pc(12,pe,34,28,"div",9),s.gc(),s.gc(),s.hc(13,"div",10),s.hc(14,"ul",8),s.Pc(15,fe,34,29,"div",11),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(16,"div",12),s.cc(17,"img",13),s.uc(18,"ImgPipe"),s.hc(19,"p",14),s.Rc(20),s.gc(),s.hc(21,"a",15),s.Rc(22),s.gc(),s.hc(23,"p",16),s.Rc(24),s.gc(),s.hc(25,"p",17),s.pc("click",(function(){return t.logout()})),s.Rc(26,"\u0110\u0103ng xu\u1ea5t"),s.gc(),s.gc()),2&e&&(s.Ob(12),s.Ac("ngForOf",t.waitingOrderDetails),s.Ob(3),s.Ac("ngForOf",t.makingOrderDetails),s.Ob(2),s.Bc("src",s.wc(18,6,t.CurrentUser.Avt,"UserAvt"),s.Lc),s.Ob(3),s.Sc(t.CurrentUser.FullName),s.Ob(2),s.Sc(t.CurrentUser.PhoneNumber),s.Ob(2),s.Sc(t.CurrentUser.Role))},directives:[g.k,me,g.j],pipes:[M.a,R.a,R.c,R.b],styles:[""]}),e})();function ve(e,t){1&e&&(s.hc(0,"span",15),s.Rc(1,"\u0110\xe3 bao g\u1ed3m"),s.gc())}function Oe(e,t){1&e&&(s.hc(0,"span",15),s.Rc(1,"Ch\u01b0a bao g\u1ed3m"),s.gc())}function De(e,t){if(1&e&&(s.hc(0,"div",22),s.hc(1,"span",14),s.Rc(2,"VAT: "),s.gc(),s.Pc(3,ve,2,0,"span",23),s.Pc(4,Oe,2,0,"span",23),s.gc()),2&e){const e=s.tc();s.Ob(3),s.Ac("ngIf",e.orderDetail.IsVATIncluded),s.Ob(1),s.Ac("ngIf",!e.orderDetail.IsVATIncluded)}}function Ie(e,t){if(1&e&&(s.hc(0,"div",24),s.hc(1,"span",14),s.Rc(2,"T\xean KH"),s.gc(),s.hc(3,"span",15),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(4),s.Sc(e.orderDetail.CustomerName)}}function Se(e,t){if(1&e&&(s.hc(0,"div",24),s.hc(1,"span",14),s.Rc(2,"T\xean ng\u01b0\u1eddi nh\u1eadn"),s.gc(),s.hc(3,"span",15),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(4),s.Sc(e.orderDetail.DeliveryInfo.FullName)}}function Ce(e,t){if(1&e&&(s.hc(0,"div",24),s.hc(1,"span",14),s.Rc(2,"SDT KH"),s.gc(),s.hc(3,"span",15),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(4),s.Sc(e.orderDetail.CustomerPhoneNumber)}}function Pe(e,t){if(1&e&&(s.hc(0,"div",24),s.hc(1,"span",14),s.Rc(2,"SDT ng\u01b0\u1eddi nh\u1eadn"),s.gc(),s.hc(3,"span",15),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(4),s.Sc(e.orderDetail.DeliveryInfo.PhoneNumber)}}function Ae(e,t){if(1&e){const e=s.ic();s.hc(0,"button",25),s.pc("click",(function(){return s.Jc(e),s.tc().gotToCusConfirm()})),s.Rc(1,"X\xe1c nh\u1eadn v\u1edbi Kh\xe1ch h\xe0ng"),s.gc()}}function ye(e,t){if(1&e){const e=s.ic();s.hc(0,"button",25),s.pc("click",(function(){return s.Jc(e),s.tc().gotToCusConfirm()})),s.Rc(1,"Ch\u1ee5p \u1ea3nh"),s.gc()}}let Te=(()=>{class e extends f{constructor(e,t){super(),this.router=e,this.orderDetailService=t,this.Title="X\xe1c nh\u1eadn th\xe0nh ph\u1ea9m",this.IsDataLosingWarning=!1}Init(){this.orderDetail=this.globalOrderDetail}gotToCusConfirm(){this.router.navigate(["staff/customer-confirming"])}confirm(){switch(this.CurrentUser.Role){case v.i.Account:case v.i.Admin:this.orderDetailService.resultConfirm(this.globalOrderDetail.OrderDetailId,this.orderDetailService.getLastestMaking(this.globalOrderDetail).Id,null).then(()=>{this.router.navigate(["staff/account-main"])});break;case v.i.Shipper:this.orderDetailService.updateFields(this.globalOrderDetail.OrderDetailId,{State:v.f.Completed,DeliveryCompletedTime:(new Date).getTime()}).then(()=>{this.router.navigate(["staff/shipper-main"])})}}}return e.\u0275fac=function(t){return new(t||e)(s.bc(c.b),s.bc(B.a))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-order-detail-confirming"]],features:[s.Lb],decls:49,vars:29,consts:[["id","orderConfirm",1,"page-content"],[1,"container"],[1,"prodDetail"],[1,"prodGen"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPriceOld"],[1,"prodCharge"],[1,"prodPrice"],[1,"prodInfo","cusScroll"],["class","prodQuan infoGroup",4,"ngIf"],["class","prodName infoGroup",4,"ngIf"],[1,"prodAddr","infoGroup"],[1,"itemlabel"],[1,"itemVal"],[1,"prodTime","infoGroup"],[1,"prodDesc","infoGroup"],[1,"row"],[1,"col-10","mx-auto","text-center"],["type","button","class","btn main-btn w-100 mt-2",3,"click",4,"ngIf"],["type","button",1,"btn","grey-btn","w-100","mt-2",3,"click"],[1,"prodQuan","infoGroup"],["class","itemVal",4,"ngIf"],[1,"prodName","infoGroup"],["type","button",1,"btn","main-btn","w-100","mt-2",3,"click"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"div",1),s.hc(2,"div",2),s.hc(3,"div",3),s.cc(4,"img",4),s.uc(5,"ImgPipe"),s.hc(6,"div",5),s.hc(7,"h5",6),s.Rc(8),s.gc(),s.hc(9,"h5",6),s.Rc(10),s.gc(),s.hc(11,"span",7),s.Rc(12),s.uc(13,"myCurrPipe"),s.gc(),s.hc(14,"span",8),s.Rc(15),s.uc(16,"myCurrPipe"),s.gc(),s.hc(17,"span",9),s.Rc(18),s.uc(19,"myCurrPipe"),s.gc(),s.gc(),s.gc(),s.hc(20,"div",10),s.Pc(21,De,5,2,"div",11),s.Pc(22,Ie,5,1,"div",12),s.Pc(23,Se,5,1,"div",12),s.Pc(24,Ce,5,1,"div",12),s.Pc(25,Pe,5,1,"div",12),s.hc(26,"div",13),s.hc(27,"span",14),s.Rc(28,"\u0110\u1ecba ch\u1ec9 giao:"),s.gc(),s.hc(29,"span",15),s.Rc(30),s.gc(),s.gc(),s.hc(31,"div",16),s.hc(32,"span",14),s.Rc(33,"Th\u1eddi gian giao:"),s.gc(),s.hc(34,"span",15),s.Rc(35),s.uc(36,"date"),s.gc(),s.gc(),s.hc(37,"div",17),s.hc(38,"span",14),s.Rc(39,"M\xf4 t\u1ea3:"),s.gc(),s.hc(40,"span",15),s.Rc(41),s.gc(),s.gc(),s.gc(),s.hc(42,"div",18),s.hc(43,"div",19),s.Pc(44,Ae,2,0,"button",20),s.Pc(45,ye,2,0,"button",20),s.gc(),s.hc(46,"div",19),s.hc(47,"button",21),s.pc("click",(function(){return t.confirm()})),s.Rc(48,"Xong"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc()),2&e&&(s.Ob(4),s.Bc("src",s.wc(5,17,t.orderDetail.ProductImageUrl,"ProductImg"),s.Lc),s.Ob(4),s.Uc("",t.orderDetail.OrderId,"_",t.orderDetail.Index+1,""),s.Ob(2),s.Sc(t.orderDetail.ProductName),s.Ob(2),s.Sc(s.vc(13,20,t.orderDetail.OriginalPrice)),s.Ob(3),s.Tc("Ph\u1ee5 ph\xed: ",s.vc(16,22,t.orderDetail.AdditionalFee),""),s.Ob(3),s.Sc(s.vc(19,24,t.orderDetail.ModifiedPrice)),s.Ob(3),s.Ac("ngIf","Shipper"!=t.CurrentUser.Role),s.Ob(1),s.Ac("ngIf","Shipper"!=t.CurrentUser.Role),s.Ob(1),s.Ac("ngIf","Shipper"==t.CurrentUser.Role),s.Ob(1),s.Ac("ngIf","Shipper"!=t.CurrentUser.Role),s.Ob(1),s.Ac("ngIf","Shipper"==t.CurrentUser.Role),s.Ob(5),s.Sc(t.orderDetail.DeliveryInfo.Address),s.Ob(5),s.Sc(s.wc(36,26,t.orderDetail.DeliveryInfo.DateTime,"hh:mm a dd/MM/yyyy")),s.Ob(6),s.Sc(t.orderDetail.Description),s.Ob(3),s.Ac("ngIf","Shipper"!=t.CurrentUser.Role),s.Ob(1),s.Ac("ngIf","Shipper"==t.CurrentUser.Role))},directives:[g.l],pipes:[M.a,R.a,g.e],styles:[""]}),e})();var ke=i("cPV5"),we=i("ftz2");function Re(e,t){if(1&e){const e=s.ic();s.hc(0,"li",51),s.pc("click",(function(){s.Jc(e);const i=t.index;return s.tc().selectPromotion(i)})),s.hc(1,"p",52),s.Rc(2),s.gc(),s.hc(3,"span",53),s.Rc(4),s.gc(),s.hc(5,"span",54),s.Rc(6),s.uc(7,"myDatePipe"),s.uc(8,"myDatePipe"),s.gc(),s.gc()}if(2&e){const e=t.$implicit,i=t.index,c=s.tc();s.Pb("data-index",i),s.Ob(2),s.Sc(e.Name),s.Ob(2),s.Sc(c.getPromotionAmount(e)),s.Ob(2),s.Uc("",s.vc(7,5,e.StartTime),"-",s.vc(8,7,e.EndTime),"")}}function Me(e,t){if(1&e){const e=s.ic();s.hc(0,"div",55),s.pc("click",(function(){return s.Jc(e),s.tc().addNoteImage()})),s.cc(1,"img",56),s.gc()}}function Fe(e,t){if(1&e){const e=s.ic();s.hc(0,"div",55),s.pc("click",(function(){return s.Jc(e),s.Hc(3).click()})),s.cc(1,"img",56),s.hc(2,"input",57,58),s.pc("change",(function(t){return s.Jc(e),s.tc(2).onChange(t)})),s.gc(),s.gc()}}function Ne(e,t){if(1&e&&(s.hc(0,"div"),s.Pc(1,Fe,4,0,"div",45),s.gc()),2&e){const e=s.tc();s.Ob(1),s.Ac("ngIf",!e.IsOnTerminal)}}function xe(e,t){if(1&e){const e=s.ic();s.hc(0,"div",44),s.hc(1,"div",59),s.pc("click",(function(){s.Jc(e);const i=t.index;return s.tc().selectNoteImage(i)})),s.cc(2,"img",60),s.uc(3,"ImgPipe"),s.gc(),s.gc()}if(2&e){const e=t.$implicit;s.Ob(2),s.Bc("src",s.wc(3,1,e,"NoteImg"),s.Lc)}}let Le=(()=>{class e extends f{constructor(e,t,i,c){super(),this.route=e,this.router=t,this.categoryService=i,this.promotionService=c,this.Title="Chi ti\u1ebft \u0111\u01a1n",this.isAddingNoteImage=!1,this.promotions=[],this.images=[],this.globalOrderDetail.NoteImages||(this.globalOrderDetail.NoteImages=[])}Init(){this.promotionService.getAvailablePromotions((new Date).getTime(),!1).then(e=>{this.promotions=e}),this.route.params.subscribe(e=>{this.detailIndex=+e.id,this.globalOrderDetail.PurposeOf||(this.globalOrderDetail.PurposeOf="Mua t\u1eb7ng"),this.globalOrderDetail.ProductName||(this.globalOrderDetail.ProductName="...."),createNumbericElement(!1,e=>{this.globalOrderDetail.Quantity=e})})}getPromotionAmount(e){return e.PromotionType===D.b.Amount?e.Amount+" \u20ab":e.Amount+" %"}onAmountDiscountChanged(e){this.globalOrderDetail.AmountDiscount<10&&(this.globalOrderDetail.AmountDiscount*=1e3,this.moveCursor(this.globalOrderDetail.AmountDiscount.toString().length,"AmountDiscount")),this.globalOrderDetail.AmountDiscount=+this.globalOrderDetail.AmountDiscount}onAcmountDiscountFocus(){this.globalOrderDetail.AmountDiscount||(this.globalOrderDetail.AmountDiscount=0),this.moveCursor(this.globalOrderDetail.AmountDiscount.toString().length,"AmountDiscount")}addNoteImage(){this.isAddingNoteImage=!0,super.openFileForShare()}fileChosen(e){this.globalOrderDetail.NoteImages.push("data:image/png;base64,"+e)}onChange(e){const t=e.target.files[0];if(!t)return;if(null==t.type.match(/image\/*/))return void this.showError("Ph\u1ea3i ch\u1ecdn h\xecnh !!");const i=new FileReader;i.readAsDataURL(t),i.onload=e=>{this.globalOrderDetail.NoteImages.push(i.result.toString())}}selectNoteImage(e){this.menuOpening(t=>{switch(+t){case 0:this.globalOrderDetail.NoteImages.splice(e,1);break;case 1:const t=M.a.getImgUrl(this.globalOrderDetail.NoteImages[e],j.c.NoteImg);this.images=[t],setTimeout(()=>{viewImages(()=>{this.images=[]})},100)}},["Xo\xe1 \u1ea3nh","Xem chi ti\u1ebft \u1ea3nh"])}onAddFeeChanged(e){this.globalOrderDetail.AdditionalFee<10&&(this.globalOrderDetail.AdditionalFee*=1e3,this.moveCursor(this.globalOrderDetail.AdditionalFee.toString().length,"AdditionalFee")),this.globalOrderDetail.AdditionalFee=+this.globalOrderDetail.AdditionalFee}onAddFeeFocus(){this.globalOrderDetail.AdditionalFee||(this.globalOrderDetail.AdditionalFee=0),this.moveCursor(this.globalOrderDetail.AdditionalFee.toString().length,"AdditionalFee")}onNewPriceChanged(e){this.newPrice<10&&(this.newPrice*=1e3,this.moveCursor(this.newPrice.toString().length,"NewPrice")),this.newPrice=+this.newPrice}onNewPriceFocus(){this.newPrice||(this.newPrice=0),this.moveCursor(this.newPrice.toString().length,"NewPrice")}clearProductImg(){this.globalOrderDetail.ProductImageUrl&&(this.globalOrderDetail.IsFromHardCodeProduct?this.globalOrderDetail.ProductImageUrl="":this.openConfirm("Ch\u1eafc ch\u0103c xo\xe1 \u1ea3nh n\xe0y? ",()=>{this.globalOrderDetail.ProductImageUrl=""}))}productNameChangeRequest(){getInputWithType(e=>{""!==e&&(this.globalOrderDetail.ProductName=e,this.globalOrderDetail.IsFromHardCodeProduct=!0)},"C\u1eadp nh\u1eadt t\xean s\u1ea3n ph\u1ea9m...","...."===this.globalOrderDetail.ProductName?"":this.globalOrderDetail.ProductName,"text")}insertModifiedValue(){this.newPrice=this.globalOrderDetail.ModifiedPrice,openFixPriceDialog()}quantityChangeRequest(){getInputWithType(e=>{e&&(this.globalOrderDetail.Quantity=+e)},"C\u1eadp nh\u1eadt s\u1ed1 l\u01b0\u1ee3ng...",this.globalOrderDetail.Quantity.toString(),"number")}submitPrice(){this.newPrice<0?this.showError("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!!"):(this.globalOrderDetail.ModifiedPrice=this.newPrice,dismissFixPriceDialog())}searchProduct(){this.router.navigate(["/staff/search-product"],{queryParams:{category:-1},queryParamsHandling:"merge"})}submitOrderDetail(e){if(!e.valid)return;if(this.globalOrderDetail.ModifiedPrice<=0)return void this.showError("Ch\u01b0a nh\u1eadp gi\xe1 ti\u1ec1n!");this.globalOrderDetail.Index=this.detailIndex>-1?this.detailIndex:this.globalOrder.OrderDetails.length;const t=b.c.DeepCopy(this.globalOrderDetail);this.insertOrderDetail(t)}insertOrderDetail(e){this.detailIndex>-1?this.globalOrder.OrderDetails[this.detailIndex]=e:this.globalOrder.OrderDetails.push(e),super.OnBackNaviage()}selectPromotion(e){this.globalOrderDetail.PercentDiscount=this.globalOrderDetail.AmountDiscount=0;const t=this.promotions[e];t.PromotionType===D.b.Amount?this.globalOrderDetail.AmountDiscount=t.Amount:this.globalOrderDetail.PercentDiscount=t.Amount,hideReceiverPopup()}}return e.\u0275fac=function(t){return new(t||e)(s.bc(c.a),s.bc(c.b),s.bc(ke.a),s.bc(A.a))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-order-detail"]],features:[s.Lb],decls:88,vars:21,consts:[["id","orderAdd",1,"page-content"],[1,"container"],["autocomplete","on",1,"addOrderForm",3,"submit"],["form","ngForm"],[1,"form-group","prodInfo"],[1,"prodImg"],["alt","",3,"src"],["src","../../../../assets/images/delete_white.svg","alt","",1,"close-img",3,"click"],[1,"prodContent"],[1,"prodCode"],[1,"prodPrice"],[1,"prodQuantity"],["type","number","readonly","","name","Quantity","id","Quantity","step","1","min","1",3,"ngModel","ngModelChange"],[1,"prodBrowser",3,"click"],[1,"fa","fa-search","main-bg"],[1,"row","col-xs-12",2,"margin-bottom","10px","padding-left","15px","padding-right","15px"],[1,"addInfo",2,"width","100%","padding-right","5px"],["href","javascript:void(0);",1,"btn","main-btn",3,"click"],[1,"addInfo",2,"width","50%","padding-right","5px"],[1,"addInfo",2,"width","50%","padding-left","5px"],[1,"form-group","addInfo"],["routerLink","/staff/select-receiver",1,"btn","main-btn"],[1,"title-field"],[1,"form-group","orderInfo"],["type","text","name","AdditionalFee","id","AdditionalFee","placeholder","Ph\u1ee5 ph\xed (k)...",1,"orderField",3,"ngModel","ngModelChange","input","focus"],["href","javascript:void(0)","onclick","openCustMenu()","type","button",1,"btn","main-btn","w-100",2,"margin-bottom","1vh","font-size","16px"],[1,"row","col-xs-12",2,"padding-left","15px","padding-right","15px"],["type","number","name","PercentDiscount","id","PercentDiscount","placeholder","%",1,"orderField",3,"ngModel","ngModelChange"],["type","tel","name","AmountDiscount","id","AmountDiscount","placeholder","0",1,"orderField",3,"ngModel","ngModelChange","input","focus"],["type","text","name","PurposeOf","id","PurposeOf","placeholder","M\u1ee5c \u0111\xedch mua h\xe0ng...",1,"orderField",3,"ngModel","ngModelChange"],["type","text","name","Description","id","Description","placeholder","M\xf4 t\u1ea3 giao h\xe0ng...",1,"orderField","col-xs-6",3,"ngModel","ngModelChange"],["href","javascript:void(0)","onClick","openImgsDialog()",1,"btn","main-btn"],["type","submit",1,"btn","main-btn","w-100"],["id","recentInfo",1,"actionMenu2"],["style","height: 69px;text-align: left;",3,"click",4,"ngFor","ngForOf"],["id","inputDialog",1,"popup-content","dialog-popup"],[1,"form-group"],["type","tel","name","newPrice","id","NewPrice","placeholder","c\u1eadp nh\u1eadt gi\xe1 ti\u1ec1n...",1,"mainForm",3,"ngModel","ngModelChange","input","focus"],[1,"row"],[1,"col-6"],["id","confirm-button",1,"main-btn","btn",3,"click"],["id","cancel-button","onClick","dismissFixPriceDialog()",1,"main-bg","border","btn"],["id","imgsDialog",1,"popup-content","dialog-popup"],[1,"row","imageList","cusScroll",2,"max-height","450px"],[1,"col-6","product-item-big"],["class","prodItem-tall","style","height: 220px;position: relative;",3,"click",4,"ngIf"],[4,"ngIf"],["class","col-6 product-item-big",4,"ngFor","ngForOf"],["id","confirm-button","onClick","closeImgsDialog()",1,"main-btn","btn"],["id","view-product",1,"popup-content","view-img-popup-content",2,"z-index","1000"],[3,"src","config"],[2,"height","69px","text-align","left",3,"click"],[1,"recentInfo-name"],[1,"recentInfo-phone",2,"width","25%"],[1,"recentInfo-date",2,"width","75%"],[1,"prodItem-tall",2,"height","220px","position","relative",3,"click"],["src","../../../../assets/images/add.svg","alt","",2,"margin-bottom","0px","width","64px","height","64px","position","absolute","top","50%","left","50%","transform","translate(-50%, -50%)"],["type","file","name","uploadedFile","hidden","",1,"img-cover","file-upload-default",3,"change"],["imageUpload",""],[1,"prodItem-tall",3,"click"],["alt","",2,"margin-bottom","0px",3,"src"]],template:function(e,t){if(1&e){const e=s.ic();s.hc(0,"div",0),s.hc(1,"div",1),s.hc(2,"form",2,3),s.pc("submit",(function(){s.Jc(e);const i=s.Hc(3);return t.submitOrderDetail(i)})),s.hc(4,"div",4),s.hc(5,"div",5),s.cc(6,"img",6),s.uc(7,"ImgPipe"),s.hc(8,"img",7),s.pc("click",(function(){return t.clearProductImg()})),s.gc(),s.gc(),s.hc(9,"div",8),s.hc(10,"h5",9),s.Rc(11),s.gc(),s.hc(12,"span",10),s.Rc(13),s.uc(14,"myCurrPipe"),s.gc(),s.hc(15,"div",11),s.hc(16,"input",12),s.pc("ngModelChange",(function(e){return t.globalOrderDetail.Quantity=e})),s.gc(),s.gc(),s.gc(),s.hc(17,"div",13),s.pc("click",(function(){return t.searchProduct()})),s.cc(18,"i",14),s.gc(),s.gc(),s.hc(19,"div",15),s.hc(20,"div",16),s.hc(21,"a",17),s.pc("click",(function(){return t.quantityChangeRequest()})),s.Rc(22,"C\u1eadp nh\u1eadt S\u1ed1 l\u01b0\u1ee3ng"),s.gc(),s.gc(),s.gc(),s.hc(23,"div",15),s.hc(24,"div",18),s.hc(25,"a",17),s.pc("click",(function(){return t.productNameChangeRequest()})),s.Rc(26,"C\u1eadp nh\u1eadt T\xean"),s.gc(),s.gc(),s.hc(27,"div",19),s.hc(28,"a",17),s.pc("click",(function(){return t.insertModifiedValue()})),s.Rc(29,"C\u1eadp nh\u1eadt gi\xe1"),s.gc(),s.gc(),s.gc(),s.hc(30,"div",20),s.hc(31,"a",21),s.Rc(32,"Th\xf4ng tin ng\u01b0\u1eddi nh\u1eadn"),s.gc(),s.gc(),s.hc(33,"label",22),s.Rc(34,"Ph\u1ee5 ph\xed"),s.gc(),s.hc(35,"div",23),s.hc(36,"input",24),s.pc("ngModelChange",(function(e){return t.globalOrderDetail.AdditionalFee=e}))("input",(function(e){return t.onAddFeeChanged(e.target.value)}))("focus",(function(){return t.onAddFeeFocus()})),s.gc(),s.gc(),s.hc(37,"a",25),s.Rc(38,"\xc1p d\u1ee5ng khuy\u1ebfn m\xe3i"),s.gc(),s.hc(39,"div",26),s.hc(40,"div",18),s.hc(41,"label",22),s.Rc(42,"Gi\u1ea3m gi\xe1 ph\u1ea7n tr\u0103m "),s.gc(),s.hc(43,"div",23),s.hc(44,"input",27),s.pc("ngModelChange",(function(e){return t.globalOrderDetail.PercentDiscount=e})),s.gc(),s.gc(),s.gc(),s.hc(45,"div",19),s.hc(46,"label",22),s.Rc(47,"Gi\u1ea3m gi\xe1 ti\u1ec1n"),s.gc(),s.hc(48,"div",23),s.hc(49,"input",28),s.pc("ngModelChange",(function(e){return t.globalOrderDetail.AmountDiscount=e}))("input",(function(e){return t.onAmountDiscountChanged(e.target.value)}))("focus",(function(){return t.onAcmountDiscountFocus()})),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(50,"label",22),s.Rc(51,"M\u1ee5c \u0111\xedch mua h\xe0ng"),s.gc(),s.hc(52,"div",23),s.hc(53,"input",29),s.pc("ngModelChange",(function(e){return t.globalOrderDetail.PurposeOf=e})),s.gc(),s.gc(),s.hc(54,"label",22),s.Rc(55,"M\xf4 t\u1ea3"),s.gc(),s.hc(56,"div",23),s.hc(57,"input",30),s.pc("ngModelChange",(function(e){return t.globalOrderDetail.Description=e})),s.gc(),s.gc(),s.hc(58,"div",20),s.hc(59,"a",31),s.Rc(60,"\u1ea2nh m\xf4 t\u1ea3"),s.gc(),s.gc(),s.hc(61,"div",20),s.hc(62,"button",32),s.Rc(63,"Xong"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(64,"div",33),s.hc(65,"ul"),s.Pc(66,Re,9,9,"li",34),s.gc(),s.gc(),s.hc(67,"div",35),s.hc(68,"div",36),s.hc(69,"input",37),s.pc("ngModelChange",(function(e){return t.newPrice=e}))("input",(function(e){return t.onNewPriceChanged(e.target.value)}))("focus",(function(){return t.onNewPriceFocus()})),s.gc(),s.gc(),s.hc(70,"div",38),s.hc(71,"div",39),s.hc(72,"button",40),s.pc("click",(function(){return t.submitPrice()})),s.Rc(73,"X\xe1c nh\u1eadn"),s.gc(),s.gc(),s.hc(74,"div",39),s.hc(75,"button",41),s.Rc(76,"H\u1ee7y"),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(77,"div",42),s.hc(78,"div",43),s.hc(79,"div",44),s.Pc(80,Me,2,0,"div",45),s.Pc(81,Ne,2,1,"div",46),s.gc(),s.Pc(82,xe,4,4,"div",47),s.gc(),s.hc(83,"div",38),s.hc(84,"button",48),s.Rc(85,"\u0110\xf3ng"),s.gc(),s.gc(),s.gc(),s.hc(86,"div",49),s.cc(87,"angular-image-viewer",50),s.gc()}2&e&&(s.Ob(6),s.Bc("src",s.wc(7,16,t.globalOrderDetail.ProductImageUrl,"ProductImg"),s.Lc),s.Ob(5),s.Tc("",t.globalOrderDetail.ProductName," "),s.Ob(2),s.Sc(s.vc(14,19,t.globalOrderDetail.ModifiedPrice)),s.Ob(3),s.Ac("ngModel",t.globalOrderDetail.Quantity),s.Ob(20),s.Ac("ngModel",t.globalOrderDetail.AdditionalFee),s.Ob(8),s.Ac("ngModel",t.globalOrderDetail.PercentDiscount),s.Ob(5),s.Ac("ngModel",t.globalOrderDetail.AmountDiscount),s.Ob(4),s.Ac("ngModel",t.globalOrderDetail.PurposeOf),s.Ob(4),s.Ac("ngModel",t.globalOrderDetail.Description),s.Ob(9),s.Ac("ngForOf",t.promotions),s.Ob(3),s.Ac("ngModel",t.newPrice),s.Ob(11),s.Ac("ngIf",t.IsOnTerminal),s.Ob(1),s.Ac("ngIf",!t.IsOnTerminal),s.Ob(1),s.Ac("ngForOf",t.globalOrderDetail.NoteImages),s.Ob(5),s.Ac("src",t.images)("config",t.viewProdOptions))},directives:[T.v,T.l,T.m,T.p,T.b,T.k,T.n,c.c,g.k,g.l,we.a],pipes:[M.a,R.a,R.b],styles:[""]}),e})();var Be=i("Gdn9"),Ue=i("tk/3"),He=i("qfBg"),qe=i("Kj3r"),Ee=i("vkgz");let Ve=(()=>{class e{constructor(e,t){this.formBuilder=e,this.ngForm=t,this.placeholder="",this.delayTimeSpan=1e3,this.searchTextInvoke=new s.q,this.onChange=e=>{},this.onTouched=()=>{},this.searchContent=new T.d,this.searchForm=this.formBuilder.group({searchContent:this.searchContent})}ngOnInit(){this.searchContent.valueChanges.pipe(Object(qe.a)(this.delayTimeSpan),Object(Ee.a)()).subscribe(e=>{this.searchTextInvoke.emit(e)})}preventEvent(e){e.stopPropagation()}writeValue(e){e!==this.value&&(this.value=e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}updateChanges(){this.onChange(this.value)}}return e.\u0275fac=function(t){return new(t||e)(s.bc(T.c),s.bc(T.m,8))},e.\u0275cmp=s.Vb({type:e,selectors:[["mobile-search-box"]],inputs:{placeholder:"placeholder",delayTimeSpan:"delayTimeSpan"},outputs:{searchTextInvoke:"searchTextInvoke"},features:[s.Nb([{provide:T.j,useExisting:Object(s.fb)(()=>e),multi:!0}])],decls:2,vars:1,consts:[[3,"formGroup"],["type","text","placeholder","placeholder","formControlName","searchContent",1,"form-control"]],template:function(e,t){1&e&&(s.hc(0,"form",0),s.cc(1,"input",1),s.gc()),2&e&&s.Ac("formGroup",t.searchForm)},directives:[T.v,T.l,T.f,T.b,T.k,T.e],styles:[""]}),e})();function Je(e,t){if(1&e){const e=s.ic();s.hc(0,"li",73),s.hc(1,"app-status-point",74),s.pc("onClicked",(function(t){return s.Jc(e),s.tc(2).openDetailInfo(t)})),s.gc(),s.hc(2,"div",75),s.pc("click",(function(){s.Jc(e);const i=t.$implicit;return s.tc(2).updateOrderDetailState(i.OrderDetailId)})),s.cc(3,"img",76),s.uc(4,"ImgPipe"),s.hc(5,"div",77),s.hc(6,"h5",78),s.Rc(7),s.gc(),s.hc(8,"span",79),s.Rc(9),s.uc(10,"myCurrPipe"),s.gc(),s.hc(11,"span",80),s.Rc(12),s.gc(),s.hc(13,"span",81),s.Rc(14),s.uc(15,"myTimePipe"),s.gc(),s.hc(16,"span",67),s.Rc(17),s.uc(18,"myDatePipe"),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.$implicit;s.Ob(1),s.Ac("state",e.State)("id",e.OrderDetailId)("index",e.Index+1),s.Ob(2),s.Bc("src",s.wc(4,9,e.ProductImageUrl,"ProductImg"),s.Lc),s.Ob(4),s.Sc(e.ProductName),s.Ob(2),s.Sc(s.vc(10,12,e.ModifiedPrice)),s.Ob(3),s.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.Quantity,""),s.Ob(2),s.Sc(s.vc(15,14,e.DeliveryInfo.DateTime)),s.Ob(3),s.Sc(s.vc(18,16,e.DeliveryInfo.DateTime))}}function Ge(e,t){if(1&e){const e=s.ic();s.hc(0,"a",82),s.pc("click",(function(){s.Jc(e);const t=s.tc().$implicit;return s.tc().editOrder(t.OrderId)})),s.cc(1,"i",83),s.Rc(2," Ch\u1ec9nh s\u1eeda"),s.gc()}}function We(e,t){if(1&e){const e=s.ic();s.hc(0,"li",60),s.hc(1,"div",61),s.hc(2,"span",62),s.pc("click",(function(){s.Jc(e);const i=t.$implicit;return s.tc().viewPurchase(i.OrderId)})),s.Rc(3),s.gc(),s.hc(4,"div",63),s.pc("click",(function(){s.Jc(e);const i=t.$implicit;return s.tc().selectOrder(i)})),s.hc(5,"h4",64),s.Rc(6),s.gc(),s.hc(7,"h4",65),s.Rc(8),s.gc(),s.hc(9,"span",66),s.Rc(10),s.uc(11,"myCurrPipe"),s.gc(),s.hc(12,"span",67),s.Rc(13),s.uc(14,"myDatePipe"),s.gc(),s.gc(),s.hc(15,"button",68),s.pc("click",(function(){s.Jc(e);const i=t.$implicit;return s.tc().openOrder(i)})),s.Rc(16,"m\u1edf"),s.gc(),s.gc(),s.hc(17,"div",69),s.hc(18,"ul",70),s.Pc(19,Je,19,18,"li",71),s.gc(),s.Pc(20,Ge,3,0,"a",72),s.gc(),s.gc()}if(2&e){const e=t.$implicit,i=t.index;s.Ac("id","order"+i),s.Ob(1),s.Ac("id","heading"+i),s.Ob(2),s.Sc(e.OrderId),s.Ob(3),s.Sc(e.CustomerInfo.Name),s.Ob(2),s.Tc("tel: ",e.CustomerInfo.PhoneNumber,""),s.Ob(2),s.Tc("",s.vc(11,15,e.TotalAmount)," "),s.Ob(3),s.Sc(s.vc(14,17,e.DoneTime)),s.Ob(2),s.Ac("id","arrowBtn"+e.OrderId),s.Pb("data-target","#collapse"+i)("aria-controls","collapse"+i),s.Ob(2),s.Ac("id","collapse"+i),s.Pb("aria-labelledby","heading"+i)("data-parent","#order"+i),s.Ob(2),s.Ac("ngForOf",e.OrderDetails),s.Ob(1),s.Ac("ngIf",!e.IsFinished)}}function je(e,t){if(1&e&&(s.hc(0,"span"),s.Rc(1),s.gc()),2&e){const e=t.$implicit;s.Ob(1),s.Sc(e.FullName)}}function $e(e,t){if(1&e&&(s.hc(0,"span",84),s.Rc(1),s.gc()),2&e){const e=t.$implicit;s.Ob(1),s.Sc(e.FullName)}}function Xe(e,t){if(1&e&&(s.hc(0,"li",85),s.cc(1,"img",86),s.uc(2,"ImgPipe"),s.hc(3,"span",87),s.Rc(4),s.gc(),s.gc()),2&e){const e=t.$implicit;s.Bc("id",e.Id),s.Ob(1),s.Bc("src",s.wc(2,3,e.AvtUrl,"UserAvt"),s.Lc),s.Ob(3),s.Sc(e.FullName)}}function Qe(e,t){if(1&e&&(s.hc(0,"li",88),s.cc(1,"img",86),s.uc(2,"ImgPipe"),s.hc(3,"span",87),s.Rc(4),s.gc(),s.hc(5,"span",89),s.Rc(6),s.gc(),s.gc()),2&e){const e=t.$implicit;s.Bc("id",e.Id),s.Ob(1),s.Bc("src",s.wc(2,4,e.AvtUrl,"UserAvt"),s.Lc),s.Ob(3),s.Sc(e.FullName),s.Ob(2),s.Sc(e.IsExternalShipper?"Shipper ngo\xe0i":"Nh\xe2n vi\xean")}}let ze=(()=>{class e extends f{constructor(e,t,i,c,r,n,o,s,a,h,d){super(),this.customerService=e,this.activatedRoute=t,this.router=i,this.orderService=c,this.storageService=r,this.productService=n,this.orderDetailService=o,this.http=s,this.datePipe=a,this.userService=h,this.printJobService=d,this.Title="Danh s\xe1ch \u0111\u01a1n",this.NavigateClass="nav-icon ",this.IsDataLosingWarning=!1,this.states=v.f,this.pageSize=20,this.totalPage=0,this.searchTerm="",this.allStatuses=[v.f.Added,v.f.Making,v.f.Comfirming,v.f.OnTheWay,v.f.SentBack,v.f.Fixing,v.f.Completed,v.f.Canceled],this.selectedDetail={},this.globalService.currentOrderViewModel=new b.d,this.selectMakingRequestTime=new Date,this.orders=[],this.florists=[],this.shippers=[]}get selectedOrderId(){return this.globalService.selectedOrderId}set selectedOrderId(e){this.globalService.selectedOrderId=e}get currentPage(){return this.globalService.currentOrderPage}set currentPage(e){this.globalService.currentOrderPage=e}get currentOrderListScrollPos(){return this.globalService.currentOrderListScrollPos}set currentOrderListScrollPos(e){this.globalService.currentOrderListScrollPos=e}get displayStatuses(){return this.globalService.displayStatuses}set displayStatuses(e){this.globalService.displayStatuses=e}OnBackNaviage(){customerSupport()}updateOrderDetailState(e){let t=new b.c,i=new b.d;switch(this.orders.forEach(c=>{c.OrderDetails.forEach(r=>{if(r.OrderDetailId===e)return t=r,void(i=c)})}),t.State){case v.f.Added:this.updateAddedDetailState(t,i);break;case v.f.Making:case v.f.Fixing:this.updateMakingDetailState(t,i);break;case v.f.Comfirming:this.updatConfirmingDetailState(t,i);break;case v.f.OnTheWay:this.updateShippingDetail(t,i);break;case v.f.SentBack:this.updateSentBackDetailState(t,i);break;case v.f.Completed:this.globalOrderDetail=t,this.globalOrder=i,this.router.navigate(["staff/order-detail-view"])}}filterByState(){const e=[];e.push({Name:"T\u1ea5t c\u1ea3",Value:"ALL"}),j.e.forEach(t=>{e.push({Name:t.DisplayName,Value:t.State})}),filterOrderByState(e,e=>{this.currentPage=0,this.displayStatuses="ALL"===e?this.allStatuses:e===v.f.Making?[v.f.Making,v.f.Fixing]:[e],this.getOrders()})}getOrders(){this.orders=[],this.orderService.searchOrders(this.currentPage,this.pageSize,this.displayStatuses,this.searchTerm).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders})}searchOrder(e){this.currentPage=0,this.searchTerm=e,this.getOrders()}goToPage(e){e>=this.totalPage||e<0||(this.currentPage=e,this.orderService.searchOrders(this.currentPage,this.pageSize,this.displayStatuses,this.searchTerm).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders}))}logout(){this.authService.logOut(e=>{e&&this.router.navigate(["staff/login"])})}Init(){return Object(o.a)(this,void 0,void 0,(function*(){this.setStatusBarColor(!1),this.displayStatuses=this.displayStatuses.length>0?this.displayStatuses:this.allStatuses,this.orderService.searchOrders(this.currentPage,this.pageSize,this.displayStatuses).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders,this.selectedOrderId&&scrollToOrder(this.selectedOrderId,this.currentOrderListScrollPos)}),this.askForRememberPassword(),this.userService.getByRole(v.i.Florist).then(e=>{this.florists=e}),this.userService.getByRole(v.i.Shipper).then(e=>{this.shippers=e})}))}doPrintJob(e){let t=0;const i=[];e.OrderDetails.forEach(e=>{i.push({productName:e.ProductName,index:e.Index+1,price:e.ModifiedPrice,additionalFee:e.AdditionalFee,discount:this.getDiscount(e.ModifiedPrice,e.PercentDiscount,e.AmountDiscount),quantity:e.Quantity}),t+=e.ModifiedPrice});const c=[];e.PurchaseItems&&e.PurchaseItems.forEach(e=>{c.push({method:e.Method,amount:e.Amount})});const r={Created:(new Date).getTime(),doneTime:new Date(e.DoneTime).toLocaleString("en-US",{hour12:!1}),Id:e.OrderId,Active:!0,IsDeleted:!1,saleItems:i,createdDate:e.CreatedDate.toLocaleString("en-US",{hour12:!1}),orderId:e.OrderId,summary:t,totalAmount:e.TotalAmount,totalPaidAmount:e.TotalPaidAmount,totalBalance:e.TotalAmount-e.TotalPaidAmount,vatIncluded:e.VATIncluded,memberDiscount:e.CustomerInfo.DiscountPercent,scoreUsed:e.CustomerInfo.ScoreUsed,gainedScore:e.CustomerInfo.GainedScore,totalScore:e.IsFinished?e.CustomerInfo.AvailableScore:e.CustomerInfo.AvailableScore-e.CustomerInfo.ScoreUsed+e.CustomerInfo.GainedScore,customerName:e.CustomerInfo.Name,customerId:e.CustomerInfo.Id,discount:this.getDiscount(e.TotalAmount,e.PercentDiscount,e.AmountDiscount),purchaseItems:c,isMemberDiscountApply:e.IsMemberDiscountApply};this.printJobService.addPrintJob(r)}getDiscount(e,t,i){let c=0;return t&&t>0&&(c=e/100*t),i&&i>0&&(c+=i),c}selectOrder(e){this.menuOpening(t=>{switch(+t){case 0:this.viewPurchase(e.OrderId);break;case 1:this.doPrintJob(e);break;case 2:if(e.IsFinished)return void this.showInfo("\u0110\u01a1n \u0111\xe3 ho\xe0n t\u1ea5!");this.orderDetailService.completeOrder(e).then(t=>{this.orderService.addScoreToCustomer(e).then(()=>{this.orderService.searchOrders(this.currentPage,this.pageSize,this.displayStatuses).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders})})});break;case 3:this.openConfirm("Thao t\xe1c n\xe0y kh\xf4ng h\u1ec3 ho\xe0n l\u1ea1i, ch\u1eafc ch\u1eafn xo\xe1?",()=>{e.IsFinished?this.orderService.revertUsedScore(e.OrderId).then(t=>{this.orderService.deleteOrder(e.OrderId).then(e=>{this.orderService.searchOrders(this.currentPage,this.pageSize,this.displayStatuses).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders})})}):this.orderService.deleteOrder(e.OrderId).then(e=>{this.orderService.searchOrders(this.currentPage,this.pageSize,this.displayStatuses).then(e=>{this.totalPage=e.totalPages,this.orders=e.orders})})})}},["Th\xeam thanh to\xe1n","In ho\xe1 \u0111\u01a1n","Ho\xe0n t\u1ea5t \u0111\u01a1n","Xo\xe1 \u0111\u01a1n"])}editOrder(e){this.globalOrder=this.orders.filter(t=>t.OrderId===e)[0],this.globalPurchases=this.globalOrder.PurchaseItems,this.isEdittingOrder=!0,this.customerService.getById(this.globalOrder.CustomerInfo.Id).then(e=>{e&&(this.globalOrder.CustomerInfo=this.orderService.getCustomerInfo(e,this.globalOrder)),this.router.navigate(["/staff/add-order"])})}viewPurchase(e){this.globalOrder=this.orders.filter(t=>t.OrderId===e)[0],this.globalPurchases=this.globalOrder.PurchaseItems,this.router.navigate(["staff/view-purchase"])}addOrder(){this.globalOrder=new b.d,this.globalOrderDetail=new b.c,this.isEdittingOrder=!1,this.globalPurchases=[],this.router.navigate(["/staff/add-order"])}getDetailById(e){return this.orders.filter(t=>t.OrderDetails.filter(t=>t.OrderDetailId===e).length>0)[0].OrderDetails.filter(t=>t.OrderDetailId===e)[0]}openDetailInfo(e){const t=this.getDetailById(e);t&&(this.selectedDetail.Shippers=t.Shippers?t.Shippers:[],this.selectedDetail.Florists=t.Florists?t.Florists:[],this.selectedDetail.State=t.State,this.selectedDetail.StateDisplay=j.f.filter(e=>e.State===t.State)[0].DisplayName,openColorBoard())}openOrder(e){getTopScrollPosition(t=>{this.currentOrderListScrollPos=+t,this.selectedOrderId=e.OrderId})}updateShippingDetail(e,t){this.menuOpening(i=>{switch(+i){case 0:this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd-MM-yyyy"),this.selectReceiveRequestTime=e.DeliveryInfo.DateTime,this.shippingNote=e.ShippingNote;const i={State:e.State,ReceivingTime:this.selectReceiveRequestTime.getTime(),ShippingNote:this.shippingNote};shippingRequest(()=>{chooseShipper(t=>{i.State=v.f.OnTheWay,i.ShippingNote=this.shippingNote,i.ReceivingTime=this.selectReceiveRequestTime.getTime(),this.orderDetailService.updateFields(e.OrderDetailId,i).then(i=>{this.orderDetailService.replaceShipper(e.OrderDetailId,this.orderDetailService.getLastestShipping(e).Id,+t).then(()=>{this.getOrders()})})})});break;case 1:this.openConfirm("Ho\xe0n t\u1ea5t giao \u0111\u01a1n n\xe0y?",()=>{getShippingNoteDialog("Ho\xe0n t\u1ea5t",i=>{this.orderDetailService.shippingConfirm(e,null,i).then(i=>{this.orderDetailService.completeOD(e,t).then(()=>{this.getOrders()})})})});break;case 2:if(e.State!==v.f.OnTheWay)return void this.showInfo("\u0110\u01a1n ch\u01b0a b\u1eaft \u0111\u1ea7u giao!");this.openConfirm("Tr\u1ea3 l\u1ea1i c\u1eeba h\xe0ng \u0111\u01a1n n\xe0y?",()=>{getShippingNoteDialog("Tr\u1ea3 \u0111\u01a1n",t=>{this.orderDetailService.updateShippingFields(this.orderDetailService.getLastestShipping(e).Id,{Note:t,CompleteTime:(new Date).getTime(),DeliveryImageUrl:""}).then(t=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.SentBack}).then(e=>{this.getOrders()})}).catch(e=>{this.showError(e)})})});break;case 4:this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Canceled}).then(()=>{this.getOrders()});break;case 3:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"])}},["Ch\u1ecdn l\u1ea1i Shipper","Ho\xe0n th\xe0nh giao","Tr\u1ea3 \u0111\u01a1n v\u1ec1","Xem chi ti\u1ebft","Hu\u1ef7  \u0111\u01a1n"])}updateSentBackDetailState(e,t){this.menuOpening(i=>{switch(+i){case 2:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 0:this.assignShipper(e);break;case 1:this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd-MM-yyyy"),this.selectMakingRequestTime=new Date,this.makingNote=e.MakingNote,makingTimeRequest(()=>{chooseFlorist(t=>{this.transferToFlorist(e,v.c.Fixing,+t)})});break;case 3:this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Canceled}).then(()=>{this.getOrders()})}},["Ch\u1ecdn l\u1ea1i shipper","L\xe0m l\u1ea1i \u0111\u01a1n","Xem chi ti\u1ebft","Hu\u1ef7  \u0111\u01a1n"])}assignShipper(e){this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd-MM-yyyy"),this.selectReceiveRequestTime=e.DeliveryInfo.DateTime,this.shippingNote="";const t={State:v.f.OnTheWay,ReceivingTime:this.selectReceiveRequestTime.getTime(),ShippingNote:this.shippingNote};shippingRequest(()=>{chooseShipper(i=>{t.State=v.f.OnTheWay,t.ReceivingTime=this.selectReceiveRequestTime.getTime(),t.ShippingNote=this.shippingNote,this.orderDetailService.updateFields(e.OrderDetailId,t).then(t=>{this.orderDetailService.assignSingleShipper(e.OrderDetailId,+i,(new Date).getTime()).then(()=>{this.getOrders()})})})})}updateMakingDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.orderDetailService.updateFields(e.OrderDetailId,{State:e.State===v.f.Making?v.f.Added:v.f.SentBack,MakingRequestTime:0,FloristId:null}).then(()=>{this.getOrders()});break;case 1:this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd-MM-yyyy"),this.selectMakingRequestTime=new Date(e.MakingRequestTime),this.makingNote=e.MakingNote;const i={State:e.State,MakingRequestTime:this.selectMakingRequestTime.getTime(),MakingNote:this.makingNote};makingTimeRequest(()=>{chooseFlorist(t=>{i.MakingNote=this.makingNote,i.MakingRequestTime=this.selectMakingRequestTime.getTime(),this.orderDetailService.updateFields(e.OrderDetailId,i).then(i=>{this.orderDetailService.replaceFlorist(e.OrderDetailId,this.orderDetailService.getLastestMaking(e).Id,+t).then(()=>{this.getOrders()})})})});break;case 2:this.openConfirm("Ho\xe0n th\xe0nh \u0111\u01a1n n\xe0y?",()=>{this.orderDetailService.updateMakingFields(this.orderDetailService.getLastestMaking(e).Id,{CompleteTime:(new Date).getTime()}).then(()=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Comfirming}).then(()=>{this.assignShipper(e)})})});break;case 3:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 4:this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Canceled}).then(()=>{this.getOrders()})}},["X\u1eed l\xfd sau","\u0110\u1ed5i florist","Giao h\xe0ng","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}updatConfirmingDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.assignShipper(e);break;case 1:this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd-MM-yyyy"),this.selectMakingRequestTime=e.DeliveryInfo.DateTime,this.makingNote="",makingTimeRequest(()=>{chooseFlorist(t=>{this.transferToFlorist(e,v.c.Fixing,+t)})});break;case 2:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 3:this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.Canceled,MakingRequestTime:0}).then(()=>{this.getOrders()})}},["Giao h\xe0ng","S\u1eeda l\u1ea1i \u0111\u01a1n","Xem chi ti\u1ebft","Hu\u1ef7 \u0111\u01a1n"])}transferToFlorist(e,t,i){this.orderDetailService.assignSingleMaking(e.OrderDetailId,i,(new Date).getTime(),t).then(()=>{this.orderDetailService.updateFields(e.OrderDetailId,{MakingNote:this.makingNote,State:t===v.c.Making?v.f.Making:v.f.Fixing,MakingRequestTime:this.selectMakingRequestTime.getTime()}).then(()=>{this.getOrders()})})}updateAddedDetailState(e,t){this.menuOpening(i=>{switch(+i){case 0:this.selectDeliveryTime=this.datePipe.transform(e.DeliveryInfo.DateTime,"HH:mm dd/MM/yyyy"),this.selectMakingRequestTime=e.MakingRequestTime?new Date(e.MakingRequestTime):e.DeliveryInfo.DateTime,this.makingNote=e.MakingNote?e.MakingNote:"",makingTimeRequest(()=>{chooseFlorist(t=>{this.transferToFlorist(e,v.c.Making,+t)})});break;case 1:this.globalOrderDetail=e,this.globalOrder=t,this.router.navigate(["staff/order-detail-view"]);break;case 2:this.assignShipper(e);break;case 3:this.orderDetailService.completeOD(e,t).then(e=>Object(o.a)(this,void 0,void 0,(function*(){this.getOrders()})))}},["Chuy\u1ec3n cho Florist","Xem chi ti\u1ebft","Giao h\xe0ng","K\u1ebft th\xfac chi ti\u1ebft \u0111\u01a1n"])}deleteOrderDetail(e,t){const i=t.OrderDetails.indexOf(e);if(t.OrderDetails.splice(i,1),t.OrderDetails.length<=0){const e=this.orders.filter(e=>e.OrderId===t.OrderId)[0];this.orders.splice(this.orders.indexOf(e),1)}}}return e.\u0275fac=function(t){return new(t||e)(s.bc(C.a),s.bc(c.a),s.bc(c.b),s.bc(S.a),s.bc($),s.bc(Be.a),s.bc(B.a),s.bc(Ue.a),s.bc(R.b),s.bc(He.a),s.bc(P.a))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-orders-manage"]],features:[s.Lb],decls:107,vars:27,consts:[["id","order",1,"page-content"],[1,"container","order-add"],[1,"row"],[1,"col-2"],[1,"col-8","text-center"],["href","javascript:void(0);",1,"btn","main-btn",3,"click"],[1,"col-2","order-noti","text-right"],["routerLink","/staff/add-purchse"],["src","../../../assets/images/money.svg","alt","",1,"main-filter"],[1,"container","order-list"],[1,"row","order-list-top"],[1,"col-2","order-filter","text-left",3,"click"],[1,"main-bg"],["src","../../../assets/images/filter.svg","alt","",1,"main-filter"],[1,"col-8","order-search"],["placeholder","T\xean ho\u1eb7c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i KH...",3,"delayTimeSpan","searchTextInvoke"],[1,"col-2","order-check","text-right"],["routerLink","/staff/sort-order-changing",1,"main-bg"],["src","../../../assets/images/check.svg","alt","",1,"main-filter"],[1,"paging"],[1,"paging-arrow","paging-prev","main-bg",3,"click"],[1,"fa","fa-angle-left"],[1,"paging-arrow","paging-next","main-bg",3,"click"],[1,"fa","fa-angle-right"],[1,"row","order-list-bot"],["id","accordionOrder",1,"col-12","order-content","accordion","cusScroll"],["class","order-content-item",3,"id",4,"ngFor","ngForOf"],["id","makingTimeRequest",1,"popup-content"],[2,"font-weight","bold","font-size","15px","margin-left","3px"],[1,"form-group"],[1,"custom-label"],["id","selectMakingRequestTime","name","selectMakingRequestTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],["id","makingNote","name","makingNote",1,"mainForm",2,"width","100%","height","130px",3,"ngModel","ngModelChange"],[1,"col-6","mx-auto","text-center"],["type","button","id","choose-florist-btn",1,"btn","main-btn","w-100","mt-3"],["type","button","id","cancel-btn",1,"btn","grey-btn","w-100","mt-3"],["id","shippingRequest",1,"popup-content"],["id","selectReceiveRequestTime","name","selectReceiveRequestTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],["dt2",""],["id","shippingNote","name","shippingNote",1,"mainForm",2,"width","100%","height","130px",3,"ngModel","ngModelChange"],["id","colorBoard",1,"popup-content"],[1,"colorList"],[1,"colorInfo","colorItem"],[3,"state"],[1,"colorInfo"],[4,"ngFor","ngForOf"],["style","margin-left: 5px;",4,"ngFor","ngForOf"],["id","viewed",1,"popup-content","florist"],[1,"viewedList"],["class","viewItem",3,"id",4,"ngFor","ngForOf"],["id","viewed",1,"popup-content","shipper"],["class","viewItem-three-column",3,"id",4,"ngFor","ngForOf"],[1,"customer-support"],["alt","",1,"customer-avatar",3,"src"],[1,"customer-name"],["href","tel:0000",1,"customer-phone"],[1,"customer-position"],["id","logoutBtn",1,"customer-position",3,"click"],[1,"order-content-item",3,"id"],[1,"item-top",3,"id"],[1,"item-code",3,"click"],[1,"item-info",3,"click"],[1,"item-name"],[1,"item-name",2,"font-size","12px","margin-top","1px"],[1,"item-price"],[1,"item-date"],["data-toggle","collapse","aria-expanded","false",1,"collapsed",3,"id","click"],[1,"item-bot","collapse",3,"id"],[1,"order-product-list","cusScroll"],["class","order-product-item",4,"ngFor","ngForOf"],["href","javascript:void(0);","class","order-edit",3,"click",4,"ngIf"],[1,"order-product-item"],[3,"state","id","index","onClicked"],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPrice"],[1,"item-quantity"],[1,"item-time"],["href","javascript:void(0);",1,"order-edit",3,"click"],[1,"fa","fa-pencil"],[2,"margin-left","5px"],[1,"viewItem",3,"id"],["alt","",1,"itemAva",3,"src"],[1,"itemName"],[1,"viewItem-three-column",3,"id"],[1,"itemRole"]],template:function(e,t){if(1&e&&(s.hc(0,"div",0),s.hc(1,"div",1),s.hc(2,"div",2),s.cc(3,"div",3),s.hc(4,"div",4),s.hc(5,"a",5),s.pc("click",(function(){return t.addOrder()})),s.Rc(6,"Th\xeam \u0111\u01a1n"),s.gc(),s.gc(),s.hc(7,"div",6),s.hc(8,"a",7),s.cc(9,"img",8),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(10,"div",9),s.hc(11,"div",10),s.hc(12,"div",11),s.pc("click",(function(){return t.filterByState()})),s.hc(13,"a",12),s.cc(14,"img",13),s.gc(),s.gc(),s.hc(15,"div",14),s.hc(16,"mobile-search-box",15),s.pc("searchTextInvoke",(function(e){return t.searchOrder(e)})),s.gc(),s.gc(),s.hc(17,"div",16),s.hc(18,"a",17),s.cc(19,"img",18),s.gc(),s.gc(),s.gc(),s.hc(20,"ul",19),s.hc(21,"li",20),s.pc("click",(function(){return t.goToPage(t.currentPage-1)})),s.cc(22,"i",21),s.gc(),s.hc(23,"li",22),s.pc("click",(function(){return t.goToPage(t.currentPage+1)})),s.cc(24,"i",23),s.gc(),s.gc(),s.hc(25,"div",24),s.hc(26,"ul",25),s.Pc(27,We,21,19,"li",26),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(28,"div",27),s.hc(29,"label"),s.Rc(30,"Th\u1eddi gian giao: "),s.gc(),s.hc(31,"span",28),s.Rc(32),s.gc(),s.hc(33,"div",29),s.hc(34,"label",30),s.Rc(35,"Th\u1eddi gian ho\xe0n th\xe0nh: "),s.gc(),s.hc(36,"input",31),s.pc("ngModelChange",(function(e){return t.selectMakingRequestTime=e})),s.gc(),s.cc(37,"owl-date-time",32,33),s.gc(),s.hc(39,"div",29),s.hc(40,"label",30),s.Rc(41,"Ghi ch\xfa: "),s.gc(),s.hc(42,"textarea",34),s.pc("ngModelChange",(function(e){return t.makingNote=e})),s.gc(),s.gc(),s.hc(43,"div",2),s.hc(44,"div",35),s.hc(45,"button",36),s.Rc(46,"Ch\u1ecdn Florist"),s.gc(),s.gc(),s.hc(47,"div",35),s.hc(48,"button",37),s.Rc(49,"H\u1ee7y"),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(50,"div",38),s.hc(51,"label"),s.Rc(52,"Th\u1eddi nh\u1eadn d\u1ef1 ki\u1ebfn: "),s.gc(),s.hc(53,"span",28),s.Rc(54),s.gc(),s.hc(55,"div",29),s.hc(56,"label",30),s.Rc(57,"Th\u1eddi gian nh\u1eadn: "),s.gc(),s.hc(58,"input",39),s.pc("ngModelChange",(function(e){return t.selectReceiveRequestTime=e})),s.gc(),s.cc(59,"owl-date-time",32,40),s.gc(),s.hc(61,"div",29),s.hc(62,"label",30),s.Rc(63,"Ghi ch\xfa giao h\xe0ng: "),s.gc(),s.hc(64,"textarea",41),s.pc("ngModelChange",(function(e){return t.shippingNote=e})),s.gc(),s.gc(),s.hc(65,"div",2),s.hc(66,"div",35),s.hc(67,"button",36),s.Rc(68,"Ch\u1ecdn Shipper"),s.gc(),s.gc(),s.hc(69,"div",35),s.hc(70,"button",37),s.Rc(71,"H\u1ee7y"),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(72,"div",42),s.hc(73,"ul",43),s.hc(74,"li",44),s.cc(75,"app-status-point",45),s.hc(76,"label"),s.Rc(77),s.gc(),s.gc(),s.hc(78,"li",46),s.hc(79,"label"),s.Rc(80,"Th\u1ee3 c\u1eafm hoa: "),s.gc(),s.Pc(81,je,2,1,"span",47),s.gc(),s.hc(82,"li",46),s.hc(83,"label"),s.Rc(84,"Ng\u01b0\u1eddi giao hoa: "),s.gc(),s.Pc(85,$e,2,1,"span",48),s.gc(),s.gc(),s.gc(),s.hc(86,"div",49),s.hc(87,"h3",12),s.Rc(88,"Ch\u1ecdn Florist"),s.gc(),s.hc(89,"ul",50),s.Pc(90,Xe,5,6,"li",51),s.gc(),s.gc(),s.hc(91,"div",52),s.hc(92,"h3",12),s.Rc(93,"Ch\u1ecdn Shipper"),s.gc(),s.hc(94,"ul",50),s.Pc(95,Qe,7,7,"li",53),s.gc(),s.gc(),s.hc(96,"div",54),s.cc(97,"img",55),s.uc(98,"ImgPipe"),s.hc(99,"p",56),s.Rc(100),s.gc(),s.hc(101,"a",57),s.Rc(102),s.gc(),s.hc(103,"p",58),s.Rc(104),s.gc(),s.hc(105,"p",59),s.pc("click",(function(){return t.logout()})),s.Rc(106,"\u0110\u0103ng xu\u1ea5t"),s.gc(),s.gc()),2&e){const e=s.Hc(38),i=s.Hc(60);s.Ob(16),s.Ac("delayTimeSpan",1e3),s.Ob(11),s.Ac("ngForOf",t.orders),s.Ob(5),s.Sc(t.selectDeliveryTime),s.Ob(4),s.Ac("owlDateTime",e)("owlDateTimeTrigger",e)("ngModel",t.selectMakingRequestTime),s.Ob(1),s.Ac("stepMinute",5),s.Ob(5),s.Ac("ngModel",t.makingNote),s.Ob(12),s.Sc(t.selectDeliveryTime),s.Ob(4),s.Ac("owlDateTime",i)("owlDateTimeTrigger",i)("ngModel",t.selectReceiveRequestTime),s.Ob(1),s.Ac("stepMinute",5),s.Ob(5),s.Ac("ngModel",t.shippingNote),s.Ob(11),s.Ac("state",t.selectedDetail.State),s.Ob(2),s.Sc(t.selectedDetail.StateDisplay),s.Ob(4),s.Ac("ngForOf",t.selectedDetail.Florists),s.Ob(4),s.Ac("ngForOf",t.selectedDetail.Shippers),s.Ob(5),s.Ac("ngForOf",t.florists),s.Ob(5),s.Ac("ngForOf",t.shippers),s.Ob(2),s.Bc("src",s.wc(98,24,t.CurrentUser.Avt,"UserAvt"),s.Lc),s.Ob(3),s.Sc(t.CurrentUser.FullName),s.Ob(2),s.Sc(t.CurrentUser.PhoneNumber),s.Ob(2),s.Sc(t.CurrentUser.Role)}},directives:[c.c,Ve,g.k,k.c,T.b,k.f,T.k,T.n,k.b,me,g.l],pipes:[M.a,R.a,R.b,R.c],styles:[".item-detail-info[_ngcontent-%COMP%]   .item-date[_ngcontent-%COMP%]{margin-left:7px}"]}),e})();function Ke(e,t){if(1&e&&(s.hc(0,"div",37),s.hc(1,"div",10),s.Rc(2),s.gc(),s.hc(3,"div",11),s.Rc(4),s.gc(),s.hc(5,"div",12),s.Rc(6),s.gc(),s.gc()),2&e){const e=t.$implicit;s.Pb("data-id",e.Id),s.Ob(2),s.Sc(e.FullName),s.Ob(2),s.Sc(e.PhoneNumber),s.Ob(2),s.Sc(e.MembershipInfo.MembershipType)}}function _e(e,t){1&e&&(s.hc(0,"div"),s.Rc(1," M\xe3 l\xe0 b\u1eaft bu\u1ed9c "),s.gc())}function Ze(e,t){1&e&&(s.hc(0,"div"),s.Rc(1," T\xean t\u1ed1i thi\u1ec3u 3 k\xfd t\u1ef1 "),s.gc())}function Ye(e,t){if(1&e&&(s.hc(0,"div",38),s.Pc(1,_e,2,0,"div",39),s.Pc(2,Ze,2,0,"div",39),s.gc()),2&e){s.tc();const e=s.Hc(27);s.Ob(1),s.Ac("ngIf",e.errors.required),s.Ob(1),s.Ac("ngIf",e.errors.minlength)}}function et(e,t){1&e&&(s.hc(0,"div"),s.Rc(1," T\xean t\u1ed1i thi\u1ec3u 1 k\xfd t\u1ef1 "),s.gc())}function tt(e,t){if(1&e&&(s.hc(0,"div",38),s.Pc(1,et,2,0,"div",39),s.gc()),2&e){s.tc();const e=s.Hc(31);s.Ob(1),s.Ac("ngIf",e.errors.minlength)}}function it(e,t){1&e&&(s.hc(0,"div"),s.Rc(1," SDT t\u1ed1i thi\u1ec3u 3 k\xfd t\u1ef1 "),s.gc())}function ct(e,t){if(1&e&&(s.hc(0,"div",38),s.Pc(1,it,2,0,"div",39),s.gc()),2&e){s.tc();const e=s.Hc(43);s.Ob(1),s.Ac("ngIf",e.errors.minlength)}}function rt(e,t){if(1&e&&(s.hc(0,"li",42),s.hc(1,"label"),s.Rc(2,"Ng\xe0y sinh: "),s.gc(),s.hc(3,"span"),s.Rc(4),s.uc(5,"myDatePipe"),s.gc(),s.gc()),2&e){const e=s.tc(2);s.Ob(4),s.Sc(s.vc(5,1,e.selectedCustomer.Birthday))}}function nt(e,t){if(1&e&&(s.hc(0,"li",42),s.hc(1,"label"),s.Rc(2,"Facebook: "),s.gc(),s.hc(3,"span"),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc(2);s.Ob(4),s.Sc(e.selectedCustomer.ContactInfo.Facebook)}}function ot(e,t){if(1&e&&(s.hc(0,"li",42),s.hc(1,"label"),s.Rc(2,"Zalo: "),s.gc(),s.hc(3,"span"),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc(2);s.Ob(4),s.Sc(e.selectedCustomer.ContactInfo.Zalo)}}function st(e,t){if(1&e&&(s.hc(0,"li",42),s.hc(1,"label"),s.Rc(2,"Instagram: "),s.gc(),s.hc(3,"span"),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc(2);s.Ob(4),s.Sc(e.selectedCustomer.ContactInfo.Instagram)}}function at(e,t){if(1&e&&(s.hc(0,"li",42),s.hc(1,"label"),s.Rc(2,"Skype: "),s.gc(),s.hc(3,"span"),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc(2);s.Ob(4),s.Sc(e.selectedCustomer.ContactInfo.Skype)}}function ht(e,t){if(1&e&&(s.hc(0,"div",40),s.hc(1,"ul",41),s.hc(2,"li",42),s.hc(3,"label"),s.Rc(4,"H\u1ecd t\xean:"),s.gc(),s.hc(5,"span"),s.Rc(6),s.gc(),s.gc(),s.hc(7,"li",42),s.hc(8,"label"),s.Rc(9,"SDT: "),s.gc(),s.hc(10,"span"),s.Rc(11),s.gc(),s.gc(),s.hc(12,"li",42),s.hc(13,"label"),s.Rc(14,"Danh x\u01b0ng: "),s.gc(),s.hc(15,"span"),s.Rc(16),s.gc(),s.gc(),s.Pc(17,rt,6,3,"li",43),s.Pc(18,nt,5,1,"li",43),s.Pc(19,ot,5,1,"li",43),s.Pc(20,st,5,1,"li",43),s.Pc(21,at,5,1,"li",43),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(6),s.Sc(e.selectedCustomer.FullName),s.Ob(5),s.Sc(e.selectedCustomer.PhoneNumber),s.Ob(5),s.Sc(e.selectedCustomer.Sex),s.Ob(1),s.Ac("ngIf",e.selectedCustomer.Birthday&&e.selectedCustomer.Birthday>0),s.Ob(1),s.Ac("ngIf",e.selectedCustomer.ContactInfo&&e.selectedCustomer.ContactInfo.Facebook),s.Ob(1),s.Ac("ngIf",e.selectedCustomer.ContactInfo&&e.selectedCustomer.ContactInfo.Zalo),s.Ob(1),s.Ac("ngIf",e.selectedCustomer.ContactInfo&&e.selectedCustomer.ContactInfo.Instagram),s.Ob(1),s.Ac("ngIf",e.selectedCustomer.ContactInfo&&e.selectedCustomer.ContactInfo.Skype)}}let dt=(()=>{class e extends f{constructor(e,t){super(),this.customerService=e,this._ngZone=t,this.Title="Ch\u1ecdn kh\xe1ch h\xe0ng",this.IsDataLosingWarning=!1,this.totalCount=0,this.newCustomer=new L.a,this.customers=[],this.selectedCustomer=new L.a,window.searchProdReference={component:this,zone:this._ngZone,itemSelected:e=>this.setSelectedCustomer(e)}}setSelectedCustomer(e){const t=this.customers.filter(t=>t.Id===e)[0],i=[];let c=!0;this.selectedCustomer&&this.selectedCustomer.Id===t.Id?(i.push("B\u1ecf ch\u1ecdn"),c=!1):(this.selectedCustomer=t,i.push("Ch\u1ecdn")),i.push("Xem th\xf4ng tin chi ti\u1ebft"),this.menuOpening(e=>{switch(+e){case 0:c?this.selectConfirm():this.unSelectCustomer();break;case 1:viewCustomerInfo()}},i)}Init(){this.customerService.getCount().then(e=>{this.totalCount=e+1,this.newCustomer.Id=p.a.detectCustomerId(this.totalCount)}),this.selectedCustomer=new L.a,this.globalOrder.CustomerInfo&&this.searchCustomer(this.globalOrder.CustomerInfo.PhoneNumber?this.globalOrder.CustomerInfo.PhoneNumber:this.globalOrder.CustomerInfo.Name)}addCustomer(e){if(!e.valid)return;this.selectedCustomer=new L.a;const t=new L.a;t.FullName=this.newCustomer.FullName,t.PhoneNumber=this.newCustomer.PhoneNumber,t.Sex=this.newCustomer.Sex,t.MembershipInfo.MembershipType=v.d.NewCustomer,t.MembershipInfo.AccumulatedAmount=0,t.MembershipInfo.AvailableScore=0,t.MembershipInfo.UsedScoreTotal=0,t.Id=this.newCustomer.Id,this.customerService.createCustomer(t).then(e=>{this.newCustomer=new L.a,this.selectedCustomer=t,this.customers.push(t),this.globalOrder.CustomerInfo=b.a.toViewModel(this.selectedCustomer),closeAddCustomerDialog(),this.totalCount+=1,this.newCustomer=new L.a,this.newCustomer.Id=p.a.detectCustomerId(this.totalCount),setTimeout(()=>{setSelectedCustomerItem(this.selectedCustomer.Id)},500)})}unSelectCustomer(){this.globalOrder.CustomerInfo=new b.a,this.selectedCustomer=null,this.newCustomer=new L.a,setSelectedCustomerItem("")}selectConfirm(){null!=this.selectedCustomer?this.globalOrder.CustomerInfo.Id!==this.selectedCustomer.Id?(this.globalOrder.CustomerInfo=b.a.toViewModel(this.selectedCustomer),this.OnBackNaviage()):this.OnBackNaviage():this.showError("Ch\u01b0a ch\u1ecdn kh\xe1ch h\xe0ng n\xe0o c\u1ea3!!!")}searchCustomer(e){e&&""!==e?this.customerService.getList(-1,-1,v.d.All,e).then(e=>{this.customers=e.Customers,setTimeout(()=>{null!=this.globalOrder.CustomerInfo.Id&&(setSelectedCustomerItem(this.globalOrder.CustomerInfo.Id),this.selectedCustomer=e.Customers.find(e=>e.Id===this.globalOrder.CustomerInfo.Id))},50)}):this.customers=[]}}return e.\u0275fac=function(t){return new(t||e)(s.bc(C.a),s.bc(s.H))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-select-customer"]],features:[s.Lb],decls:53,vars:12,consts:[["id","customerInfo",1,"page-content"],[1,"container"],[1,"row","checkTop","search"],[1,"col-10","filterSearch"],["placeholder","T\xean ho\u1eb7c s\u1ed1 \u0111i\u1ec7n tho\u1ea1i KH...",3,"delayTimeSpan","searchTextInvoke"],[1,"col-2","filterAdd","text-right"],["onclick","openAddInfo()",1,"main-bg"],["src","../../../../assets/images/addnew.svg","alt","",1,"main-filter"],[1,"nameTable"],[1,"tableHead"],[1,"tableLeft"],[1,"tableCenter"],[1,"tableRight"],["id","customer-list",1,"tableBody","cusScroll"],["class","tableRow main-bg customer-item","onclick","selectItem(this,'.customer-item')",4,"ngFor","ngForOf"],[1,"row","prodDone"],[1,"col-8","mx-auto","text-center"],["href","javascript:void(0);",1,"btn","main-btn","w-100",3,"click"],["id","infoAdd",1,"popup-content"],["autocomplete","on",1,"addInfoForm",3,"submit"],["form","ngForm"],[1,"form-group"],["type","text","name","Id","id","Id","required","","minlength","3","placeholder","M\xe3 KH...",1,"mainForm",3,"ngModel","ngModelChange"],["Id","ngModel"],["class","alert alert-danger",4,"ngIf"],["type","text","name","FullName","id","FullName","minlength","1","placeholder","T\xean \u0111\u1ea7y \u0111\u1ee7 ...",1,"mainForm",3,"ngModel","ngModelChange"],["FullName","ngModel"],["id","newCustomer.Sex","name","newCustomer.Sex",1,"mainForm",3,"ngModel","ngModelChange"],["selected",""],[3,"ngValue"],["type","tel","name","PhoneNumber","id","PhoneNumber","minlength","3","placeholder","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i...",1,"mainForm",3,"ngModel","ngModelChange"],["PhoneNumber","ngModel"],[1,"row"],[1,"col-6","mx-auto","text-center"],["type","button","id","cancel-button",1,"btn","grey-btn","w-100","mt-3"],["type","submit",1,"btn","main-btn","w-100","mt-3","btn-success"],["id","colorBoard","class","popup-content",4,"ngIf"],["onclick","selectItem(this,'.customer-item')",1,"tableRow","main-bg","customer-item"],[1,"alert","alert-danger"],[4,"ngIf"],["id","colorBoard",1,"popup-content"],[1,"colorList"],[1,"colorInfo"],["class","colorInfo",4,"ngIf"]],template:function(e,t){if(1&e){const e=s.ic();s.hc(0,"div",0),s.hc(1,"div",1),s.hc(2,"div",2),s.hc(3,"div",3),s.hc(4,"mobile-search-box",4),s.pc("searchTextInvoke",(function(e){return t.searchCustomer(e)})),s.gc(),s.gc(),s.hc(5,"div",5),s.hc(6,"button",6),s.cc(7,"img",7),s.gc(),s.gc(),s.gc(),s.hc(8,"div",8),s.hc(9,"div",9),s.hc(10,"div",10),s.Rc(11,"H\u1ecd t\xean"),s.gc(),s.hc(12,"div",11),s.Rc(13,"SDT"),s.gc(),s.hc(14,"div",12),s.Rc(15,"Th\xe0nh vi\xean"),s.gc(),s.gc(),s.hc(16,"div",13),s.Pc(17,Ke,7,4,"div",14),s.gc(),s.gc(),s.hc(18,"div",15),s.hc(19,"div",16),s.hc(20,"a",17),s.pc("click",(function(){return t.selectConfirm()})),s.Rc(21,"Xong"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(22,"div",18),s.hc(23,"form",19,20),s.pc("submit",(function(){s.Jc(e);const i=s.Hc(24);return t.addCustomer(i)})),s.hc(25,"div",21),s.hc(26,"input",22,23),s.pc("ngModelChange",(function(e){return t.newCustomer.Id=e})),s.gc(),s.Pc(28,Ye,3,2,"div",24),s.gc(),s.hc(29,"div",21),s.hc(30,"input",25,26),s.pc("ngModelChange",(function(e){return t.newCustomer.FullName=e})),s.gc(),s.Pc(32,tt,2,1,"div",24),s.gc(),s.hc(33,"div",21),s.hc(34,"select",27),s.pc("ngModelChange",(function(e){return t.newCustomer.Sex=e})),s.hc(35,"option",28),s.Rc(36,"Danh x\u01b0ng"),s.gc(),s.hc(37,"option",29),s.Rc(38,"Anh"),s.gc(),s.hc(39,"option",29),s.Rc(40,"Ch\u1ecb"),s.gc(),s.gc(),s.gc(),s.hc(41,"div",21),s.hc(42,"input",30,31),s.pc("ngModelChange",(function(e){return t.newCustomer.PhoneNumber=e})),s.gc(),s.Pc(44,ct,2,1,"div",24),s.gc(),s.hc(45,"div",32),s.hc(46,"div",33),s.hc(47,"button",34),s.Rc(48,"H\u1ee7y"),s.gc(),s.gc(),s.hc(49,"div",33),s.hc(50,"button",35),s.Rc(51,"L\u01b0u"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.Pc(52,ht,22,8,"div",36)}if(2&e){const e=s.Hc(27),i=s.Hc(31),c=s.Hc(43);s.Ob(4),s.Ac("delayTimeSpan",1e3),s.Ob(13),s.Ac("ngForOf",t.customers),s.Ob(9),s.Ac("ngModel",t.newCustomer.Id),s.Ob(2),s.Ac("ngIf",e.invalid&&(e.dirty||e.touched)),s.Ob(2),s.Ac("ngModel",t.newCustomer.FullName),s.Ob(2),s.Ac("ngIf",i.invalid&&(i.dirty||i.touched)),s.Ob(2),s.Ac("ngModel",t.newCustomer.Sex),s.Ob(3),s.Ac("ngValue","Male"),s.Ob(2),s.Ac("ngValue","Female"),s.Ob(3),s.Ac("ngModel",t.newCustomer.PhoneNumber),s.Ob(2),s.Ac("ngIf",c.invalid&&(c.dirty||c.touched)),s.Ob(8),s.Ac("ngIf",t.selectedCustomer)}},directives:[Ve,g.k,T.v,T.l,T.m,T.b,T.r,T.h,T.k,T.n,g.l,T.s,T.o,T.u],pipes:[R.b],styles:[""]}),e})();var lt=i("nAti"),gt=i("kLqA"),ut=i("sWfF");class mt extends ut.a{}class pt extends mt{constructor(){super(),this.FolderName="/tempProduct"}}let ft=(()=>{class e extends class{constructor(){const e=a.a.getInjector();this.globalService=e.get(h.a),this.storageService=e.get($)}get tableRef(){return this.db.ref(this.tableName)}startLoading(){this.globalService.startLoading()}stopLoading(){this.globalService.stopLoading()}errorToast(e){this.globalService.showError(e)}infoToast(e){this.globalService.showInfo(e)}warningToast(e){this.globalService.showWarning(e)}successToast(e){this.globalService.showSuccess(e)}get db(){return null}deleteFileByUrl(e,t){e&&""!==e?(this.startLoading(),this.tableRef.orderByChild("Url").equalTo(e).once("value").then(e=>{var i;if(e.forEach(e=>{i=e.val()}),!i)return this.stopLoading(),void t(!0);this.storageService.deleteFile(i.Name,i.FolderName).then(()=>{this.stopLoading(),t(!0),this.delete(i.Id)}).catch(e=>{t(!1),this.stopLoading(),this.errorToast(e)})})):t(!0)}updateList(e,t){return this.tableRef.update(e,e=>{e?this.errorToast(e.message):t()})}getByFieldName(e,t){return this.globalService.startLoading(),this.tableRef.orderByChild(e).equalTo(t).once("value").then(e=>{this.globalService.stopLoading();const t=[];return e.forEach(e=>{const i=e.val();t.push(i)}),t}).catch(e=>(this.globalService.stopLoading(),this.globalService.showError(e),[]))}setAnotherEntity(e,t){return this.db.ref(`${t}/${e.Id}`).set(e).then(t=>{if(t)return e})}set(e){return e.Id&&""!=e.Id||(e.Id=gt.Guid.create().toString()),this.startLoading(),this.db.ref(`${this.tableName}/${e.Id}`).set(e).then(t=>(this.stopLoading(),e)).catch(e=>{throw this.errorToast(e.message),this.stopLoading(),new e})}insert(e){this.startLoading();const t=this.tableRef.push(e);return e.Id=t.key,this.update(e)}setListSeperate(e){return Object(o.a)(this,void 0,void 0,(function*(){for(const t of e)this.set(t).catch(e=>{throw e});return[]}))}setList(e){return Object(o.a)(this,void 0,void 0,(function*(){const t=[];for(const i of e){const e=yield this.set(i).catch(e=>{throw e});e&&t.push(e)}return t}))}insertList(e){return Object(o.a)(this,void 0,void 0,(function*(){const t=[];this.startLoading();for(let i=0;i<e.length;i++){const c=yield this.insert(e[i]);c?t.push(c):console.log("error insert")}return t}))}getById(e){return this.startLoading(),this.db.ref(`${this.tableName}/${e}`).once("value").then(e=>(this.stopLoading(),e?e.val():null)).catch(e=>(this.stopLoading(),console.log(e),null))}updateSingleField(e,t,i){this.startLoading();var c={};return c[`/${e}/${t}`]=i,this.tableRef.update(c,e=>{this.stopLoading(),null!=e&&this.errorToast(e.message)})}updateFields(e){return this.startLoading(),this.tableRef.update(e,e=>{this.stopLoading(),null!=e&&this.errorToast(e.message)})}update(e){return this.tableRef.child(e.Id).set(e).then(()=>(this.stopLoading(),e))}delete(e){return this.startLoading(),this.db.ref(`${this.tableName}/${e}`).remove().then(()=>{this.stopLoading()})}deleteMany(e){return Object(o.a)(this,void 0,void 0,(function*(){this.startLoading(),e.forEach(e=>Object(o.a)(this,void 0,void 0,(function*(){yield this.db.ref(`${this.tableName}/${e}`).remove()}))),this.stopLoading()}))}getAllWithOrder(e){return this.startLoading(),this.tableRef.orderByChild(e).once("value").then(e=>{const t=[];return e.forEach(e=>{t.push(e.val())}),this.stopLoading(),t}).catch(e=>(this.errorToast(e),this.stopLoading(),[]))}getAll(){return this.startLoading(),this.tableRef.once("value").then(e=>{const t=[];return e.forEach(e=>{t.push(e.val())}),this.stopLoading(),t}).catch(e=>(this.errorToast(e),this.stopLoading(),[]))}deleteAll(){return this.startLoading(),this.tableRef.remove().then(()=>{this.stopLoading()})}}{constructor(){super()}get tableName(){return"/tempProducts"}deleteFile(e){const t=new pt;return this.storageService.deleteFile(e,t.FolderName)}addFile(e,t,i){this.storageService.pushFileToStorage(e,t,e=>{null===e&&i("ERROR"),i(e.Url)})}addFileFromBase64String(e,t,i){this.storageService.pushStringToStorage(e,t,e=>{null===e&&i("ERROR"),i(e.Url)})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Xb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var bt=i("lBcp");function vt(e,t){if(1&e&&(s.hc(0,"div",26),s.hc(1,"div",27),s.cc(2,"img",28),s.uc(3,"ImgPipe"),s.hc(4,"h4"),s.Rc(5),s.gc(),s.hc(6,"span"),s.Rc(7),s.uc(8,"myCurrPipe"),s.gc(),s.gc(),s.gc()),2&e){const e=t.$implicit;s.Pb("data-id",e.Id),s.Ob(2),s.Bc("src",s.wc(3,4,e.ImageUrl,"ProductImg"),s.Lc),s.Ob(3),s.Sc(e.Name),s.Ob(2),s.Sc(s.vc(8,7,e.Price))}}function Ot(e,t){if(1&e){const e=s.ic();s.hc(0,"div",29),s.hc(1,"label",30),s.hc(2,"input",31),s.pc("ngModelChange",(function(i){return s.Jc(e),t.$implicit.IsSelected=i})),s.gc(),s.cc(3,"span",32),s.Rc(4),s.gc(),s.gc()}if(2&e){const e=t.$implicit;s.Ob(2),s.Ac("ngModel",e.IsSelected),s.Ob(2),s.Tc("",e.Tag.Name," ")}}let Dt=(()=>{class e extends f{constructor(e,t,i,c,r,n,o,s){super(),this.route=e,this.router=t,this.orderDetailService=i,this.productService=c,this._ngZone=r,this.tempProductService=n,this.tagService=o,this.categoryService=s,this.Title="Ch\u1ecdn s\u1ea3n ph\u1ea9m",this.currentPage=1,this.itemsPerPage=18,this.currentMaxPage=1,this.categoryName="",this.currentHardcodeUsedCount=-1,this.searchTerm="",this.priceSearchTerm=0,this.IsDataLosingWarning=!1,this.pagingProducts=[],this.categories=[],this.globalTags=[],this.productSearchingMode=v.g.None,this.images=[]}Init(){return Object(o.a)(this,void 0,void 0,(function*(){this.selectedProduct=new lt.a,this.route.queryParams.subscribe(e=>{this.categoryService.getAll().then(t=>{this.categories.push({Value:-1,Name:"T\u1ea5t c\u1ea3"}),t.forEach(e=>{this.categories.push({Value:e.Id,Name:e.Name})}),this.tagService.getAll().then(t=>{t.forEach(e=>{this.globalTags.push({Tag:e,IsSelected:!1})}),this.getProductByCategory(+e.category)})})}),window.searchProdReference={component:this,zone:this._ngZone,itemSelected:e=>this.setSelectedProduct(e),tagsSelected:()=>this.tagsSelected()}}))}tagsSelected(){const e=[];this.globalTags.forEach(t=>{t.IsSelected&&e.push(t.Tag.Id)}),e.length<=0||(this.currentPage=1,this.filterByTags(e))}filterByTags(e){this.searchTerm="",this.priceSearchTerm=0,this.productSearchingMode=v.g.Name,this.getProductsByPage(1,e)}setSelectedProduct(e){this.selectedProduct=this.pagingProducts.filter(t=>t.Id==e)[0];const t=["Xem h\xecnh S\u1ea3n ph\u1ea3m"];(!this.selectedProduct.PriceList||this.selectedProduct.PriceList.length<=0)&&(this.selectedProduct.PriceList=[this.selectedProduct.Price]),this.selectedProduct.PriceList.forEach(e=>{t.push(R.a.currencyFormat(e))}),this.menuOpening(e=>{switch(+e){case 0:const t=M.a.getImgUrl(this.selectedProduct.ImageUrl,j.c.ProductImg);this.images=[t],setTimeout(()=>{viewProductImg(t,()=>{this.images=[]})},200);break;default:this.selectedProduct.Price=this.selectedProduct.PriceList[e-1],this.selectProduct()}},t)}getProductByCategory(e){this.productCategory=e,this.searchTerm="",this.priceSearchTerm=0,this.productSearchingMode=v.g.Name,this.categoryName=this.categories.filter(e=>e.Value===this.productCategory)[0].Name,this.getProductsByPage(this.currentPage)}filter(){selectProductCategory(this.categories,e=>{filterFocus(),this.getProductByCategory(+e)})}getProductsByPage(e,t=[]){return Object(o.a)(this,void 0,void 0,(function*(){if(this.globalTags.forEach(e=>{e.IsSelected=!1}),e<=0)return;if(this.currentMaxPage<e&&this.currentMaxPage>0)return;let i;this.pagingProducts=[],this.currentPage=e,this.selectedProduct=new lt.a,i=this.productSearchingMode!==v.g.Price?yield this.productService.getRecords(e,this.itemsPerPage,this.productCategory,t,this.searchTerm):yield this.productService.getRecordsByPrice(e,this.itemsPerPage,this.productCategory,this.priceSearchTerm),i&&i.products?(i.products.forEach(e=>{this.pagingProducts.push(e.Product)}),this.currentMaxPage=i.totalPages):this.currentMaxPage=1}))}searchProduct(e){if(e.indexOf("k")===e.length-1||e.indexOf("K")===e.length-1){const t=e.toLowerCase().split("k")[0],i=parseInt(t);NaN!==i&&i>0?(this.productSearchingMode=v.g.Price,this.priceSearchTerm=1e3*i,this.searchTerm="",console.log(this.priceSearchTerm)):(this.productSearchingMode=v.g.Name,this.searchTerm="",this.priceSearchTerm=0)}else this.productSearchingMode=v.g.Name,this.priceSearchTerm=0,this.searchTerm=e;this.getProductsByPage(1)}selectProduct(){this.selectedProduct.Id?(this.globalOrderDetail.ProductName=this.selectedProduct.Name,this.globalOrderDetail.ProductImageUrl=this.selectedProduct.ImageUrl,this.globalOrderDetail.ProductId=this.selectedProduct.Id,this.globalOrderDetail.IsFromHardCodeProduct=!1,this.globalOrderDetail.OriginalPrice=this.selectedProduct.Price,this.globalOrderDetail.ModifiedPrice=this.selectedProduct.Price,this.OnBackNaviage()):this.showError("Ch\u01b0a c\xf3 s\u1ea3n ph\u1ea9m n\xe0o \u0111\u01b0\u1ee3c ch\u1ecdn!!")}}return e.\u0275fac=function(t){return new(t||e)(s.bc(c.a),s.bc(c.b),s.bc(B.a),s.bc(Be.a),s.bc(s.H),s.bc(ft),s.bc(bt.a),s.bc(ke.a))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-search-product"]],features:[s.Lb],decls:31,vars:6,consts:[["id","prodCate",1,"page-content"],[1,"container"],[1,"prodFilter"],[1,"filterCate"],["href","javascript:void(0)",1,"main-bg",3,"click"],["src","../../../../assets/images/filter2.png","alt",""],["onclick","searchFocus(this)",1,"filterSearch"],["placeholder","M\xe3 s\u1ea3n ph\u1ea9m...",3,"delayTimeSpan","searchTextInvoke"],[1,"filterAdd"],[1,"main-bg"],["src","../../../../assets/images/attach.svg","alt","",1,"main-filter"],["src","../../../../assets/images/price.svg","alt","","onClick","openTagMenu()",1,"main-filter"],[1,"row","prodList","cusScroll"],["onclick","selectItem(this,'.product-item')","class","col-4 product-item","style","padding-left: 0px;padding-right: 0px;",4,"ngFor","ngForOf"],[1,"paging"],[1,"paging-arrow","paging-prev","main-bg",3,"click"],[1,"fa","fa-angle-left"],[1,"paging-arrow","paging-next","main-bg",3,"click"],[1,"fa","fa-angle-right"],[1,"row","prodDone"],[1,"col-8","mx-auto","text-center"],["href","javascript:void(0);",1,"btn","main-btn",3,"click"],["id","tagsMenu",1,"tagMenu","checkMenu","tagMenu"],["class","form-check",4,"ngFor","ngForOf"],["id","view-product",1,"popup-content","view-img-popup-content"],[3,"src","config"],["onclick","selectItem(this,'.product-item')",1,"col-4","product-item",2,"padding-left","0px","padding-right","0px"],[1,"prodItem"],["alt","",3,"src"],[1,"form-check"],[1,"form-check-label"],["type","checkbox","name","IsSelected","id","IsSelected","value","checkedValue",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"main-bg","vatCustom"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"div",1),s.hc(2,"div",2),s.hc(3,"div",3),s.hc(4,"a",4),s.pc("click",(function(){return t.filter()})),s.cc(5,"img",5),s.hc(6,"span"),s.Rc(7),s.gc(),s.gc(),s.gc(),s.hc(8,"div",6),s.hc(9,"mobile-search-box",7),s.pc("searchTextInvoke",(function(e){return t.searchProduct(e)})),s.gc(),s.gc(),s.hc(10,"div",8),s.hc(11,"button",9),s.cc(12,"img",10),s.gc(),s.gc(),s.hc(13,"div",8),s.hc(14,"button",9),s.cc(15,"img",11),s.gc(),s.gc(),s.gc(),s.hc(16,"div",12),s.Pc(17,vt,9,9,"div",13),s.gc(),s.hc(18,"ul",14),s.hc(19,"li",15),s.pc("click",(function(){return t.getProductsByPage(t.currentPage-1)})),s.cc(20,"i",16),s.gc(),s.hc(21,"li",17),s.pc("click",(function(){return t.getProductsByPage(t.currentPage+1)})),s.cc(22,"i",18),s.gc(),s.gc(),s.hc(23,"div",19),s.hc(24,"div",20),s.hc(25,"a",21),s.pc("click",(function(){return t.selectProduct()})),s.Rc(26,"Xong"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(27,"div",22),s.Pc(28,Ot,5,2,"div",23),s.gc(),s.hc(29,"div",24),s.cc(30,"angular-image-viewer",25),s.gc()),2&e&&(s.Ob(7),s.Sc(t.categoryName),s.Ob(2),s.Ac("delayTimeSpan",1600),s.Ob(8),s.Ac("ngForOf",t.pagingProducts),s.Ob(11),s.Ac("ngForOf",t.globalTags),s.Ob(2),s.Ac("src",t.images)("config",t.viewProdOptions))},directives:[Ve,g.k,we.a,T.a,T.k,T.n],pipes:[M.a,R.a],styles:[""]}),e})();function It(e,t){if(1&e&&(s.hc(0,"li",24),s.hc(1,"p",25),s.Rc(2),s.gc(),s.hc(3,"span",26),s.Rc(4),s.gc(),s.hc(5,"span",27),s.Rc(6),s.uc(7,"myDatePipe"),s.gc(),s.hc(8,"span",28),s.Rc(9),s.gc(),s.gc()),2&e){const e=t.$implicit;s.Pb("data-index",t.index),s.Ob(2),s.Sc(e.FullName),s.Ob(2),s.Sc(e.PhoneNumber),s.Ob(2),s.Sc(s.wc(7,5,e.DateTime,"HH:mm d/M/yyyy")),s.Ob(3),s.Sc(e.Address)}}let St=(()=>{class e extends f{constructor(e,t){super(),this.route=e,this._ngZone=t,this.Title="Th\xf4ng tin ng\u01b0\u1eddi nh\u1eadn",this.IsDataLosingWarning=!1,this.currentList=[],this.deliveryInfo=new b.b}addressChoosing(){this.selectAddress(e=>{console.log("selected"),this.deliveryInfo.Address=e})}Init(){this.route.params.subscribe(e=>{this.deliveryInfo=b.b.DeepCopy(this.globalOrderDetail.DeliveryInfo),this.deliveryInfo.DateTime.setSeconds(0)}),window.DeliveryInfoReference={component:this,zone:this._ngZone,selectDeliveryInfo:e=>this.selectDeliveryInfo(e)},setTimeout(()=>{this.globalOrder.OrderDetails.forEach(e=>{const t=b.b.DeepCopy(e.DeliveryInfo);let i=!0;this.currentList.forEach(e=>{p.a.deliveryInfoCompare(t,e)&&(i=!1)}),i&&this.currentList.push(t)}),this.globalOrder.CustomerInfo&&this.globalOrder.CustomerInfo.ReceiverInfos.forEach(e=>{let t=!0;this.currentList.forEach(i=>{p.a.receiverInfoCompare(e,{FullName:i.FullName,PhoneNumber:i.PhoneNumber,Address:i.Address})&&(t=!1)}),t&&this.currentList.push({FullName:e.FullName,PhoneNumber:e.PhoneNumber,Address:e.Address,DateTime:new Date})})},200)}selectDeliveryInfo(e){console.log("selected"),this.deliveryInfo=b.b.DeepCopy(this.currentList[e])}addReceiver(e){e.valid&&(this.globalOrderDetail.DeliveryInfo=b.b.DeepCopy(this.deliveryInfo),super.OnBackNaviage())}}return e.\u0275fac=function(t){return new(t||e)(s.bc(c.a),s.bc(s.H))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-select-receiver"]],features:[s.Lb],decls:30,vars:8,consts:[["id","custInfo",1,"page-content"],[1,"container"],[1,"custInfo"],[1,"currentInfo"],["href","javascript:void(0)","onclick","openCustMenu()",1,"main-bg"],["src","../../../../assets/images/view.svg",1,"white-filter"],[1,"newInfo"],["autocomplete","on",1,"addInfoForm",3,"submit"],["form","ngForm"],[1,"form-group"],["type","text","name","FullName","id","FullName","value","","placeholder","T\xean...",1,"mainForm",3,"ngModel","ngModelChange"],["FullName","ngModel"],["type","tel","name","PhoneNumber","id","PhoneNumber","value","","placeholder","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i...",1,"mainForm",3,"ngModel","ngModelChange"],["type","text","name","Address","id","Address","placeholder","\u0110\u1ecba ch\u1ec9...",1,"mainForm",3,"ngModel","ngModelChange"],["href","javascript:void(0)",1,"viewMore","btn","main-btn",3,"click"],[1,"fa","fa-location-arrow"],["name","DateTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],[1,"row"],[1,"col-8","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-3"],["id","recentInfo",1,"actionMenu"],["onclick","selectSavedDeliveryInfo(this)",4,"ngFor","ngForOf"],["onclick","selectSavedDeliveryInfo(this)"],[1,"recentInfo-name"],[1,"recentInfo-phone"],[1,"recentInfo-date"],[1,"recentInfo-add"]],template:function(e,t){if(1&e){const e=s.ic();s.hc(0,"div",0),s.hc(1,"div",1),s.hc(2,"div",2),s.hc(3,"div",3),s.hc(4,"span"),s.Rc(5,"Th\xf4ng tin ng\u01b0\u1eddi nh\u1eadn \u0111\xe3 l\u01b0u"),s.gc(),s.hc(6,"a",4),s.cc(7,"img",5),s.gc(),s.gc(),s.hc(8,"div",6),s.hc(9,"form",7,8),s.pc("submit",(function(){s.Jc(e);const i=s.Hc(10);return t.addReceiver(i)})),s.hc(11,"div",9),s.hc(12,"input",10,11),s.pc("ngModelChange",(function(e){return t.deliveryInfo.FullName=e})),s.gc(),s.gc(),s.hc(14,"div",9),s.hc(15,"input",12),s.pc("ngModelChange",(function(e){return t.deliveryInfo.PhoneNumber=e})),s.gc(),s.gc(),s.hc(16,"div",9),s.hc(17,"input",13),s.pc("ngModelChange",(function(e){return t.deliveryInfo.Address=e})),s.gc(),s.hc(18,"a",14),s.pc("click",(function(){return t.addressChoosing()})),s.cc(19,"i",15),s.gc(),s.gc(),s.hc(20,"input",16),s.pc("ngModelChange",(function(e){return t.deliveryInfo.DateTime=e})),s.gc(),s.cc(21,"owl-date-time",17,18),s.hc(23,"div",19),s.hc(24,"div",20),s.hc(25,"button",21),s.Rc(26,"Xong"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(27,"div",22),s.hc(28,"ul"),s.Pc(29,It,10,8,"li",23),s.gc(),s.gc()}if(2&e){const e=s.Hc(22);s.Ob(12),s.Ac("ngModel",t.deliveryInfo.FullName),s.Ob(3),s.Ac("ngModel",t.deliveryInfo.PhoneNumber),s.Ob(2),s.Ac("ngModel",t.deliveryInfo.Address),s.Ob(3),s.Ac("owlDateTime",e)("owlDateTimeTrigger",e)("ngModel",t.deliveryInfo.DateTime),s.Ob(1),s.Ac("stepMinute",5),s.Ob(8),s.Ac("ngForOf",t.currentList)}},directives:[T.v,T.l,T.m,T.b,T.k,T.n,k.c,k.f,k.b,g.k],pipes:[R.b],styles:[""]}),e})();function Ct(e,t){if(1&e){const e=s.ic();s.hc(0,"div",18),s.hc(1,"div",19),s.hc(2,"span",20),s.Rc(3),s.gc(),s.hc(4,"div",21),s.hc(5,"h4",22),s.Rc(6),s.gc(),s.hc(7,"span",23),s.Rc(8),s.gc(),s.gc(),s.cc(9,"app-status-point",24),s.gc(),s.hc(10,"div",25),s.hc(11,"ul",26),s.hc(12,"li",27),s.hc(13,"div",28),s.pc("click",(function(){s.Jc(e);const i=t.$implicit;return s.tc().getMenu(i)})),s.cc(14,"img",29),s.uc(15,"ImgPipe"),s.hc(16,"div",30),s.hc(17,"span",31),s.Rc(18),s.uc(19,"myCurrPipe"),s.gc(),s.hc(20,"span",32),s.Rc(21),s.gc(),s.hc(22,"span",32),s.Rc(23),s.gc(),s.hc(24,"span",32),s.Rc(25),s.gc(),s.hc(26,"span",33),s.Rc(27),s.uc(28,"myTimePipe"),s.gc(),s.hc(29,"span",34),s.Rc(30),s.uc(31,"myDatePipe"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.$implicit,i=t.index;s.Ob(3),s.Uc("",e.OrderId,"_",e.Index+1,""),s.Ob(3),s.Sc(e.ProductName),s.Ob(2),s.Uc("",e.DeliveryInfo.FullName,"-",e.DeliveryInfo.PhoneNumber,""),s.Ob(1),s.Ac("state",e.State)("id",e.OrderDetailId)("index",i+1),s.Ob(5),s.Bc("src",s.wc(15,15,e.ProductImageUrl,"ProductImg"),s.Lc),s.Ob(4),s.Sc(s.vc(19,18,e.ModifiedPrice)),s.Ob(3),s.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.Quantity,""),s.Ob(2),s.Tc("t\xean: ",e.DeliveryInfo.FullName,""),s.Ob(2),s.Tc("dc: ",e.DeliveryInfo.Address,""),s.Ob(2),s.Tc("th\u1eddi gian ",s.vc(28,20,e.DeliveryInfo.DateTime)," "),s.Ob(3),s.Tc(" ",s.vc(31,22,e.DeliveryInfo.DateTime),"")}}function Pt(e,t){if(1&e){const e=s.ic();s.hc(0,"div",35),s.hc(1,"div",19),s.hc(2,"span",20),s.Rc(3),s.gc(),s.hc(4,"div",21),s.hc(5,"h4",22),s.Rc(6),s.gc(),s.hc(7,"span",23),s.Rc(8),s.gc(),s.gc(),s.cc(9,"app-status-point",24),s.gc(),s.hc(10,"div",25),s.hc(11,"ul",26),s.hc(12,"li",27),s.hc(13,"div",28),s.pc("click",(function(){s.Jc(e);const i=t.$implicit;return s.tc().getMenu(i)})),s.cc(14,"img",29),s.uc(15,"ImgPipe"),s.hc(16,"div",30),s.hc(17,"span",31),s.Rc(18),s.uc(19,"myCurrPipe"),s.gc(),s.hc(20,"span",32),s.Rc(21),s.gc(),s.hc(22,"span",32),s.Rc(23),s.gc(),s.hc(24,"span",32),s.Rc(25),s.gc(),s.hc(26,"span",33),s.Rc(27),s.uc(28,"myTimePipe"),s.gc(),s.hc(29,"span",34),s.Rc(30),s.uc(31,"myDatePipe"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.$implicit,i=t.index;s.Ac("ngClass","OnTheWay"===e.State?"selected-order-detail":""),s.Ob(3),s.Uc("",e.OrderId,"_",e.Index+1,""),s.Ob(3),s.Sc(e.ProductName),s.Ob(2),s.Uc("",e.DeliveryInfo.FullName,"-",e.DeliveryInfo.PhoneNumber,""),s.Ob(1),s.Ac("state",e.State)("id",e.OrderDetailId)("index",i+1),s.Ob(5),s.Bc("src",s.wc(15,16,e.ProductImageUrl,"ProductImg"),s.Lc),s.Ob(4),s.Sc(s.vc(19,19,e.ModifiedPrice)),s.Ob(3),s.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.Quantity,""),s.Ob(2),s.Tc("ng\u01b0\u1eddi nh\u1eadn: ",e.DeliveryInfo.FullName,""),s.Ob(2),s.Tc("dc nh\u1eadn: ",e.DeliveryInfo.Address,""),s.Ob(2),s.Tc("giao l\xfac ",s.vc(28,21,e.DeliveryInfo.DateTime)," "),s.Ob(3),s.Tc(" ",s.vc(31,23,e.DeliveryInfo.DateTime),"")}}let At=(()=>{class e extends f{constructor(e,t,i){super(),this.router=e,this.orderService=t,this.orderDetailService=i,this.Title="Ng\u01b0\u1eddi giao h\xe0ng",this.NavigateClass="nav-icon ",this.IsDataLosingWarning=!1,this.selectDeliveryTime="",this.shippingNote="",this.waitingMenuItems=["Nh\u1eadn \u0111\u01a1n","Xem chi ti\u1ebft \u0111\u01a1n"],this.onTheWayMenuItems=["Ho\xe0n th\xe0nh \u0111\u01a1n","Ch\u1ee5p \u1ea3nh giao h\xe0ng","Tr\u1ea3 h\xe0ng","Xem chi ti\u1ebft \u0111\u01a1n"],this.waitingOrderDetails=[],this.shippingOrderDetails=[]}Init(){this.loadWaitingDetails(),this.loadShippingDetails(),this.askForRememberPassword()}OnBackNaviage(){customerSupport()}logout(){this.authService.logOut(e=>{e&&this.router.navigate(["staff/login"])})}viewDetail(e){this.globalOrderDetail=e,this.router.navigate(["staff/order-detail-view"])}loadWaitingDetails(){this.waitingOrderDetails=[],this.orderDetailService.getDetailWithTimeSort([v.f.Comfirming,v.f.SentBack],"ReceivingTime").then(e=>{this.waitingOrderDetails=e})}loadShippingDetails(){this.shippingOrderDetails=[],this.orderDetailService.getShippingOrderDetails(this.CurrentUser.Id).then(e=>{this.shippingOrderDetails=e})}updateFinalState(e,t,i){getShippingNoteDialog(t,t=>{i===v.f.SentBack?this.orderDetailService.updateShippingFields(this.orderDetailService.getLastestShipping(e).Id,{Note:t,CompleteTime:(new Date).getTime(),DeliveryImageUrl:""}).then(t=>{this.orderDetailService.updateFields(e.OrderDetailId,{State:v.f.SentBack}).then(e=>{this.loadShippingDetails()})}).catch(e=>{this.showError(e)}):this.orderService.getById(e.OrderId).then(i=>{this.orderDetailService.shippingConfirm(e,null,t).then(t=>{this.orderDetailService.completeOD(e,i).then(()=>{this.loadShippingDetails()})}).catch(e=>{this.showError(e)})})})}updateWaitingDetail(e,t){switch(e){case 0:this.orderDetailService.updateDetailSeen(t.OrderDetailId,this.CurrentUser.Id,(new Date).getTime()).then(e=>{this.orderDetailService.assignSingleShipper(t.OrderDetailId,this.CurrentUser.Id,(new Date).getTime()).then(()=>{this.loadShippingDetails(),this.loadWaitingDetails()})});break;case 1:this.viewDetail(t)}}updateOnTheWayDetail(e,t){switch(e){case 0:this.openConfirm("Ho\xe0n th\xe0nh giao \u0111\u01a1n?",()=>{this.updateFinalState(t,"Ho\xe0n th\xe0nh",v.f.Completed)});break;case 1:this.globalOrderDetail=t,this.router.navigate(["staff/customer-confirming"]);break;case 2:this.openConfirm("Tr\u1ea3 \u0111\u01a1n n\xe0y?",()=>{this.updateFinalState(t,"Tr\u1ea3 \u0111\u01a1n",v.f.SentBack)});break;case 3:this.viewDetail(t)}}getMenu(e){let t;switch(e.State){case v.f.Comfirming:case v.f.SentBack:t=this.waitingMenuItems;break;case v.f.OnTheWay:t=this.onTheWayMenuItems}menuOpen(t=>{switch(e.State){case v.f.OnTheWay:this.updateOnTheWayDetail(+t,e);break;default:this.updateWaitingDetail(+t,e)}},t)}}return e.\u0275fac=function(t){return new(t||e)(s.bc(c.b),s.bc(S.a),s.bc(B.a))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-shipper-main"]],features:[s.Lb],decls:27,vars:9,consts:[["id","arrange",1,"page-content"],[1,"container"],["id","listNav","role","tablist",1,"nav","nav-tabs","row"],[1,"nav-item","col-6"],["id","nav1","data-toggle","tab","href","#camhoa","role","tab","aria-controls","camhoa","aria-selected","true",1,"active","main-bg"],["id","nav2","data-toggle","tab","href","#giaohoa","role","tab","aria-controls","giaohoa","aria-selected","false",1,"main-bg"],["id","listContent",1,"tab-content","order-list-bot"],["id","camhoa","role","tabpanel","aria-labelledby","nav1",1,"tab-pane","fade","show","active"],[1,"order-content","cusScroll"],["class","order-content-item product-item",4,"ngFor","ngForOf"],["id","giaohoa","role","tabpanel","aria-labelledby","nav2",1,"tab-pane","fade"],["class","order-content-item product-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"customer-support"],["alt","",1,"customer-avatar",3,"src"],[1,"customer-name"],["href","tel:0000",1,"customer-phone"],[1,"customer-position"],["id","logoutBtn",1,"customer-position",3,"click"],[1,"order-content-item","product-item"],[1,"item-top"],[1,"item-code"],[1,"item-info"],[1,"item-name"],[1,"item-quantity"],[3,"state","id","index"],[1,"item-bot"],[1,"order-product-list","cusScroll"],[1,""],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"prodPrice"],[1,"item-address"],[1,"item-time"],[1,"item-date"],[1,"order-content-item","product-item",3,"ngClass"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"div",1),s.hc(2,"ul",2),s.hc(3,"li",3),s.hc(4,"a",4),s.Rc(5,"Ch\u1edd giao"),s.gc(),s.gc(),s.hc(6,"li",3),s.hc(7,"a",5),s.Rc(8,"\u0110ang giao"),s.gc(),s.gc(),s.gc(),s.hc(9,"div",6),s.hc(10,"div",7),s.hc(11,"ul",8),s.Pc(12,Ct,32,24,"div",9),s.gc(),s.gc(),s.hc(13,"div",10),s.hc(14,"ul",8),s.Pc(15,Pt,32,25,"div",11),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(16,"div",12),s.cc(17,"img",13),s.uc(18,"ImgPipe"),s.hc(19,"p",14),s.Rc(20),s.gc(),s.hc(21,"a",15),s.Rc(22),s.gc(),s.hc(23,"p",16),s.Rc(24),s.gc(),s.hc(25,"p",17),s.pc("click",(function(){return t.logout()})),s.Rc(26,"\u0110\u0103ng xu\u1ea5t"),s.gc(),s.gc()),2&e&&(s.Ob(12),s.Ac("ngForOf",t.waitingOrderDetails),s.Ob(3),s.Ac("ngForOf",t.shippingOrderDetails),s.Ob(2),s.Bc("src",s.wc(18,6,t.CurrentUser.Avt,"UserAvt"),s.Lc),s.Ob(3),s.Sc(t.CurrentUser.FullName),s.Ob(2),s.Sc(t.CurrentUser.PhoneNumber),s.Ob(2),s.Sc(t.CurrentUser.Role))},directives:[g.k,me,g.j],pipes:[M.a,R.a,R.c,R.b],styles:[""]}),e})();function yt(e,t){if(1&e){const e=s.ic();s.hc(0,"div",18),s.hc(1,"div",19),s.hc(2,"span",20),s.Rc(3),s.gc(),s.hc(4,"div",21),s.hc(5,"h4",22),s.Rc(6),s.gc(),s.hc(7,"span",23),s.Rc(8),s.gc(),s.hc(9,"span",23),s.Rc(10),s.gc(),s.gc(),s.cc(11,"app-status-point",24),s.gc(),s.hc(12,"div",25),s.hc(13,"ul",26),s.hc(14,"li",27),s.hc(15,"div",28),s.pc("click",(function(){s.Jc(e);const i=t.index;return s.tc().viewMakingDetail(i)})),s.cc(16,"img",29),s.uc(17,"ImgPipe"),s.hc(18,"div",30),s.hc(19,"span",31),s.Rc(20),s.uc(21,"myCurrPipe"),s.gc(),s.hc(22,"span",32),s.Rc(23),s.uc(24,"myCurrPipe"),s.gc(),s.hc(25,"span",32),s.Rc(26),s.uc(27,"myCurrPipe"),s.gc(),s.hc(28,"span",33),s.Rc(29),s.gc(),s.hc(30,"span",34),s.Rc(31),s.uc(32,"myTimePipe"),s.gc(),s.hc(33,"span",35),s.Rc(34),s.uc(35,"myDatePipe"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.$implicit,i=t.index,c=s.tc();s.Ac("ngClass",e.IsSelect?"selected-order-detail":""),s.Ob(3),s.Uc("",e.OrderDetail.OrderId,"_",e.OrderDetail.Index+1,""),s.Ob(3),s.Sc(e.OrderDetail.ProductName),s.Ob(2),s.Sc(e.OrderDetail.CustomerName),s.Ob(2),s.Sc(e.OrderDetail.CustomerPhoneNumber),s.Ob(1),s.Ac("state",e.OrderDetail.State)("id",e.OrderDetail.OrderDetailId)("index",i+1),s.Ob(5),s.Bc("src",s.wc(17,16,e.OrderDetail.ProductImageUrl,"ProductImg"),s.Lc),s.Ob(4),s.Sc(s.vc(21,19,e.OrderDetail.ModifiedPrice)),s.Ob(3),s.Tc("Ph\u1ee5 ph\xed: ",s.vc(24,21,e.OrderDetail.AdditionalFee),""),s.Ob(3),s.Tc("Gi\u1ea3m gi\xe1: ",s.vc(27,23,c.getDetailDiscount(e.OrderDetail)),""),s.Ob(3),s.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.OrderDetail.Quantity,""),s.Ob(2),s.Tc("",s.vc(32,25,e.OrderDetail.MakingRequestTime)," "),s.Ob(3),s.Tc(" ",s.vc(35,27,e.OrderDetail.MakingRequestTime),"")}}function Tt(e,t){if(1&e){const e=s.ic();s.hc(0,"div",36),s.hc(1,"div",37),s.hc(2,"button",38),s.pc("click",(function(){return s.Jc(e),s.tc().selectFloristDialogOpen()})),s.Rc(3,"Ch\u1ecdn Florist"),s.gc(),s.gc(),s.hc(4,"div",39),s.pc("click",(function(){return s.Jc(e),s.tc().cancelFloristSelectMode()})),s.hc(5,"button",40),s.Rc(6,"Hu\u1ef7"),s.gc(),s.gc(),s.gc()}}function kt(e,t){if(1&e){const e=s.ic();s.hc(0,"div",36),s.hc(1,"div",37),s.hc(2,"button",41),s.pc("click",(function(){return s.Jc(e),s.tc().gotoSelectFloristMode()})),s.Rc(3,"Ch\u1ecdn nhi\u1ec1u"),s.gc(),s.gc(),s.gc()}}function wt(e,t){if(1&e){const e=s.ic();s.hc(0,"div",18),s.hc(1,"div",19),s.hc(2,"span",20),s.Rc(3),s.gc(),s.hc(4,"div",21),s.hc(5,"h4",22),s.Rc(6),s.gc(),s.hc(7,"span",23),s.Rc(8),s.gc(),s.gc(),s.cc(9,"app-status-point",24),s.gc(),s.hc(10,"div",25),s.hc(11,"ul",26),s.hc(12,"li",27),s.hc(13,"div",28),s.pc("click",(function(){s.Jc(e);const i=t.index;return s.tc().viewShippingDetail(i)})),s.cc(14,"img",29),s.uc(15,"ImgPipe"),s.hc(16,"div",30),s.hc(17,"span",31),s.Rc(18),s.uc(19,"myCurrPipe"),s.gc(),s.hc(20,"span",32),s.Rc(21),s.uc(22,"myCurrPipe"),s.gc(),s.hc(23,"span",32),s.Rc(24),s.uc(25,"myCurrPipe"),s.gc(),s.hc(26,"span",33),s.Rc(27),s.gc(),s.hc(28,"span",34),s.Rc(29),s.uc(30,"myTimePipe"),s.gc(),s.hc(31,"span",35),s.Rc(32),s.uc(33,"myDatePipe"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=t.$implicit,i=t.index,c=s.tc();s.Ac("ngClass",e.IsSelect?"selected-order-detail":""),s.Ob(3),s.Uc("",e.OrderDetail.OrderId,"_",e.OrderDetail.Index+1,""),s.Ob(3),s.Sc(e.OrderDetail.ProductName),s.Ob(2),s.Uc("",e.OrderDetail.CustomerName,"-",e.OrderDetail.CustomerPhoneNumber,""),s.Ob(1),s.Ac("state",e.OrderDetail.State)("id",e.OrderDetail.OrderDetailId)("index",i+1),s.Ob(5),s.Bc("src",s.wc(15,16,e.OrderDetail.ProductImageUrl,"ProductImg"),s.Lc),s.Ob(4),s.Sc(s.vc(19,19,e.OrderDetail.ModifiedPrice)),s.Ob(3),s.Tc("Ph\u1ee5 ph\xed: ",s.vc(22,21,e.OrderDetail.AdditionalFee),""),s.Ob(3),s.Tc("Gi\u1ea3m gi\xe1: ",s.vc(25,23,c.getDetailDiscount(e.OrderDetail)),""),s.Ob(3),s.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",e.OrderDetail.Quantity,""),s.Ob(2),s.Tc("",s.vc(30,25,e.OrderDetail.DeliveryInfo.DateTime)," "),s.Ob(3),s.Tc(" ",s.vc(33,27,e.OrderDetail.DeliveryInfo.DateTime),"")}}function Rt(e,t){if(1&e){const e=s.ic();s.hc(0,"div",36),s.hc(1,"div",37),s.hc(2,"button",38),s.pc("click",(function(){return s.Jc(e),s.tc().selectShipperDialogOpen()})),s.Rc(3,"Ch\u1ecdn Shipper"),s.gc(),s.gc(),s.hc(4,"div",39),s.pc("click",(function(){return s.Jc(e),s.tc().cancelShipperSelectMode()})),s.hc(5,"button",40),s.Rc(6,"Hu\u1ef7"),s.gc(),s.gc(),s.gc()}}function Mt(e,t){if(1&e){const e=s.ic();s.hc(0,"div",36),s.hc(1,"div",37),s.hc(2,"button",38),s.pc("click",(function(){return s.Jc(e),s.tc().gotoSelectShipperMode()})),s.Rc(3,"Ch\u1ecdn nhi\u1ec1u"),s.gc(),s.gc(),s.gc()}}function Ft(e,t){if(1&e&&(s.hc(0,"li",42),s.cc(1,"img",43),s.uc(2,"ImgPipe"),s.hc(3,"span",44),s.Rc(4),s.gc(),s.gc()),2&e){const e=t.$implicit;s.Bc("id",e.Id),s.Ob(1),s.Bc("src",s.wc(2,3,e.AvtUrl,"UserAvt"),s.Lc),s.Ob(3),s.Sc(e.FullName)}}function Nt(e,t){if(1&e&&(s.hc(0,"li",45),s.cc(1,"img",43),s.uc(2,"ImgPipe"),s.hc(3,"span",44),s.Rc(4),s.gc(),s.hc(5,"span",46),s.Rc(6),s.gc(),s.gc()),2&e){const e=t.$implicit;s.Bc("id",e.Id),s.Ob(1),s.Bc("src",s.wc(2,4,e.AvtUrl,"UserAvt"),s.Lc),s.Ob(3),s.Sc(e.FullName),s.Ob(2),s.Sc(e.IsExternalShipper?"Shipper ngo\xe0i":"Nh\xe2n vi\xean")}}let xt=(()=>{class e extends f{constructor(e,t,i){super(),this.orderDetailService=e,this.userService=t,this.router=i,this.Title="Th\u1ee9 t\u1ef1 \u01b0u ti\xean",this.IsDataLosingWarning=!1,this.isAssigningShipper=!1,this.isAssigningFlorist=!1,this.shippingODs=[],this.shippers=[],this.makingODs=[],this.florists=[]}Init(){this.loadMakingDetails(),this.loadShippingDetails(),this.userService.getByRole(v.i.Shipper).then(e=>{this.shippers=e}),this.userService.getByRole(v.i.Florist).then(e=>{this.florists=e})}loadMakingDetails(){this.makingODs=[],this.orderDetailService.getDetailWithTimeSort([v.f.Added,v.f.SentBack],"MakingRequestTime").then(e=>{e.forEach(e=>{this.makingODs.push({OrderDetail:e,IsSelect:!1})})})}loadShippingDetails(){this.shippingODs=[],this.orderDetailService.getDetailWithTimeSort([v.f.OnTheWay,v.f.SentBack],"ReceivingTime").then(e=>{e.forEach(e=>{this.shippingODs.push({OrderDetail:e,IsSelect:!1})})})}viewShippingDetail(e){this.isAssigningShipper?this.shippingODs[e].IsSelect=!this.shippingODs[e].IsSelect:(this.globalOrderDetail=this.shippingODs[e].OrderDetail,this.router.navigate(["staff/order-detail-view"]))}viewMakingDetail(e){this.isAssigningFlorist?this.makingODs[e].IsSelect=!this.makingODs[e].IsSelect:(this.globalOrderDetail=this.makingODs[e].OrderDetail,this.router.navigate(["staff/order-detail-view"]))}gotoSelectShipperMode(){this.isAssigningShipper=!0}gotoSelectFloristMode(){this.isAssigningFlorist=!0}cancelShipperSelectMode(){this.shippingODs.forEach(e=>{e.IsSelect=!1}),this.isAssigningShipper=!1}cancelFloristSelectMode(){this.makingODs.forEach(e=>{e.IsSelect=!1}),this.isAssigningFlorist=!1}assignUsers(e){this.openConfirm(this.isAssigningShipper?"X\xe1c nh\u1eadn giao \u0111\u01a1n cho shipper?":"X\xe1c nh\u1eadn ph\xe2n c\xf4ng florist?",()=>{if(this.isAssigningShipper){const t=[];this.shippingODs.forEach(e=>{e.IsSelect&&t.push(e.OrderDetail.OrderDetailId)}),this.orderDetailService.assignShipperForOrderDetails(t,e,(new Date).getTime()).then(e=>{this.isAssigningShipper=!1,this.loadMakingDetails(),this.loadShippingDetails()})}else{const t=[];this.makingODs.forEach(e=>{e.IsSelect&&t.push(e.OrderDetail)}),this.orderDetailService.assignFloristForOrderDetails(t,e,(new Date).getTime()).then(e=>{this.isAssigningFlorist=!1,this.loadMakingDetails(),this.loadShippingDetails()})}})}selectShipperDialogOpen(){let e=!1;this.shippingODs.forEach(t=>{t.IsSelect&&(e=!0)}),e&&chooseShipper(e=>{this.assignUsers(+e)})}selectFloristDialogOpen(){let e=!1;this.makingODs.forEach(t=>{t.IsSelect&&(e=!0)}),e&&chooseFlorist(e=>{this.assignUsers(+e)})}}return e.\u0275fac=function(t){return new(t||e)(s.bc(B.a),s.bc(He.a),s.bc(c.b))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-sort-order-changing"]],features:[s.Lb],decls:30,vars:8,consts:[["id","orderList",1,"page-content"],[1,"container"],["id","listNav","role","tablist",1,"nav","nav-tabs","row"],[1,"nav-item","col-6"],["id","nav1","data-toggle","tab","href","#camhoa","role","tab","aria-controls","camhoa","aria-selected","true",1,"active","main-bg"],["id","nav2","data-toggle","tab","href","#giaohoa","role","tab","aria-controls","giaohoa","aria-selected","false",1,"main-bg"],["id","listContent",1,"tab-content","order-list-bot"],["id","camhoa","role","tabpanel","aria-labelledby","nav1",1,"tab-pane","fade","show","active"],[1,"order-content","cusScroll"],["class","order-content-item product-item",3,"ngClass",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],["id","giaohoa","role","tabpanel","aria-labelledby","nav2",1,"tab-pane","fade"],["id","viewed",1,"popup-content","florist"],[1,"main-bg"],[1,"viewedList"],["class","viewItem",3,"id",4,"ngFor","ngForOf"],["id","viewed",1,"popup-content","shipper"],["class","viewItem-three-column",3,"id",4,"ngFor","ngForOf"],[1,"order-content-item","product-item",3,"ngClass"],[1,"item-top"],[1,"item-code"],[1,"item-info"],[1,"item-name"],[1,"item-quantity"],[3,"state","id","index"],[1,"item-bot"],[1,"order-product-list","cusScroll"],[1,""],[1,"item-detail",3,"click"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"prodPrice"],[1,"prodCharge"],[1,"item-address"],[1,"item-time"],[1,"item-date"],[1,"row"],[1,"col-6","mx-auto","text-center"],["type","submit",1,"btn","main-btn","w-100","mt-3","exchange-confirm",3,"click"],[1,"col-6","mx-auto","text-center",3,"click"],["type","submit",1,"btn","main-btn","w-100","mt-3","exchange-confirm"],["type","button",1,"btn","main-btn","w-100","mt-3","exchange-confirm",3,"click"],[1,"viewItem",3,"id"],["alt","",1,"itemAva",3,"src"],[1,"itemName"],[1,"viewItem-three-column",3,"id"],[1,"itemRole"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"div",1),s.hc(2,"ul",2),s.hc(3,"li",3),s.hc(4,"a",4),s.Rc(5,"C\u1eafm hoa"),s.gc(),s.gc(),s.hc(6,"li",3),s.hc(7,"a",5),s.Rc(8,"Giao hoa"),s.gc(),s.gc(),s.gc(),s.hc(9,"div",6),s.hc(10,"div",7),s.hc(11,"ul",8),s.Pc(12,yt,36,29,"div",9),s.gc(),s.Pc(13,Tt,7,0,"div",10),s.Pc(14,kt,4,0,"div",10),s.gc(),s.hc(15,"div",11),s.hc(16,"ul",8),s.Pc(17,wt,34,29,"div",9),s.gc(),s.Pc(18,Rt,7,0,"div",10),s.Pc(19,Mt,4,0,"div",10),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(20,"div",12),s.hc(21,"h3",13),s.Rc(22,"Ch\u1ecdn Florist"),s.gc(),s.hc(23,"ul",14),s.Pc(24,Ft,5,6,"li",15),s.gc(),s.gc(),s.hc(25,"div",16),s.hc(26,"h3",13),s.Rc(27,"Ch\u1ecdn Shipper"),s.gc(),s.hc(28,"ul",14),s.Pc(29,Nt,7,7,"li",17),s.gc(),s.gc()),2&e&&(s.Ob(12),s.Ac("ngForOf",t.makingODs),s.Ob(1),s.Ac("ngIf",t.isAssigningFlorist&&t.makingODs.length>0),s.Ob(1),s.Ac("ngIf",!t.isAssigningFlorist&&t.makingODs.length>0),s.Ob(3),s.Ac("ngForOf",t.shippingODs),s.Ob(1),s.Ac("ngIf",t.isAssigningShipper&&t.shippingODs.length>0),s.Ob(1),s.Ac("ngIf",!t.isAssigningShipper&&t.shippingODs.length>0),s.Ob(5),s.Ac("ngForOf",t.florists),s.Ob(5),s.Ac("ngForOf",t.shippers))},directives:[g.k,g.l,g.j,me],pipes:[M.a,R.a,R.c,R.b],styles:[""]}),e})();var Lt=i("TG2U"),Bt=i("3oHN");let Ut=(()=>{class e extends f{constructor(e,t){super(),this.router=e,this.realtimeService=t,this.Title="",this.NavigateClass="",this.model=new Lt.a,m.a.clear()}Init(){this.setStatusBarColor(!0),this.globalService.isOnMobile()&&savedLoginInforGettingRequest()}savedLoginInforReturn(e,t){this.model.passcode=t,this.model.userName=e}afterLogin(){switch(this.globalService.isOnMobile()&&(this.globalService.isRememberPassWillCheck=!0,mobileLogin(this.model.userName,this.model.passcode)),m.a.getRole()){case v.i.Admin:case v.i.Account:this.router.navigate(["/staff/orders-manage"]);break;case v.i.Florist:this.router.navigate(["staff/florist-main"]);break;case v.i.Shipper:this.router.navigate(["staff/shipper-main"])}}login(e){e.valid&&this.authService.login(this.model,e=>{e&&this.ngZone.run(()=>{this.afterLogin()})})}}return e.\u0275fac=function(t){return new(t||e)(s.bc(c.b),s.bc(Bt.a))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-login"]],features:[s.Lb],decls:11,vars:2,consts:[["id","login",1,"page-content"],[1,"logo"],["href","#"],["autocomplete","on","id","loginform",3,"submit"],["form","ngForm"],[1,"form-group"],["name","userName","placeholder","T\xean \u0111\u0103ng nh\u1eadp...",1,"form-control",3,"ngModel","ngModelChange"],["type","password","name","passcode","placeholder","M\u1eadt kh\u1ea9u...",1,"form-control",3,"ngModel","ngModelChange"],["type","submit","value","\u0110\u0103ng nh\u1eadp",1,"btn","btn-default"]],template:function(e,t){if(1&e){const e=s.ic();s.hc(0,"div",0),s.hc(1,"h1",1),s.hc(2,"a",2),s.Rc(3,"Login to Florid"),s.gc(),s.gc(),s.hc(4,"form",3,4),s.pc("submit",(function(){s.Jc(e);const i=s.Hc(5);return t.login(i)})),s.hc(6,"div",5),s.hc(7,"input",6),s.pc("ngModelChange",(function(e){return t.model.userName=e})),s.gc(),s.gc(),s.hc(8,"div",5),s.hc(9,"input",7),s.pc("ngModelChange",(function(e){return t.model.passcode=e})),s.gc(),s.gc(),s.cc(10,"input",8),s.gc(),s.gc()}2&e&&(s.Ob(7),s.Ac("ngModel",t.model.userName),s.Ob(2),s.Ac("ngModel",t.model.passcode))},directives:[T.v,T.l,T.m,T.b,T.k,T.n],styles:[""]}),e})(),Ht=(()=>{class e{constructor(e,t,i,c){this.router=e,this.globalService=t,this.authService=i,this.realtimeService=c,this.navigateClass="",this.title="",this.headerUpdate=this.globalService.mobileUpdateHeader.subscribe(e=>{null!==e&&e&&this.updateHeaderBar(e.Title,e.NavigateClass)})}ngOnInit(){this.logoutInvoker=this.realtimeService.LogouOutBehavier.subscribe(e=>{!1!==e&&this.authService.logOut(e=>{e&&this.router.navigate(["/staff/login"])})});const e=m.a.getUserId();e&&this.realtimeService.connect(+e,m.a.getRole(),()=>{}),this.globalService.setStatusBarColor(!1)}updateHeaderBar(e,t){setTimeout(()=>{this.navigateClass=t,this.title=e},100)}ngOnDestroy(){this.headerUpdate.unsubscribe(),this.logoutInvoker.unsubscribe()}navigateOnClick(){this.globalService.clickOnNavigateButton()}}return e.\u0275fac=function(t){return new(t||e)(s.bc(c.b),s.bc(h.a),s.bc(d.a),s.bc(Bt.a))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-staff-main-layout"]],decls:6,vars:2,consts:[[1,"breadcrumb"],[3,"className","click"],[1,"breadcrumb-title"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"a",1),s.pc("click",(function(){return t.navigateOnClick()})),s.gc(),s.hc(2,"div",2),s.hc(3,"span"),s.Rc(4),s.gc(),s.gc(),s.gc(),s.cc(5,"router-outlet")),2&e&&(s.Ob(1),s.Ac("className",t.navigateClass),s.Ob(3),s.Sc(t.title))},directives:[c.e],styles:[""]}),e})();function qt(e,t){if(1&e&&(s.hc(0,"div",28),s.hc(1,"span",12),s.Rc(2,"T\xean KH"),s.gc(),s.hc(3,"span",13),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(4),s.Sc(e.order.CustomerInfo.Name)}}function Et(e,t){if(1&e&&(s.hc(0,"div",28),s.hc(1,"span",12),s.Rc(2,"SDT KH"),s.gc(),s.hc(3,"span",13),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(4),s.Sc(e.order.CustomerInfo.PhoneNumber)}}function Vt(e,t){if(1&e&&(s.hc(0,"div",28),s.hc(1,"span",12),s.Rc(2,"T\xean ng\u01b0\u1eddi nh\u1eadn:"),s.gc(),s.hc(3,"span",13),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(4),s.Sc(e.orderDetail.DeliveryInfo.FullName)}}function Jt(e,t){if(1&e&&(s.hc(0,"div",29),s.hc(1,"span",12),s.Rc(2,"SDT ng\u01b0\u1eddi nh\u1eadn:"),s.gc(),s.hc(3,"span",13),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(4),s.Sc(e.orderDetail.DeliveryInfo.PhoneNumber)}}function Gt(e,t){if(1&e&&(s.hc(0,"div",29),s.hc(1,"span",12),s.Rc(2,"\u0110\u1ecba ch\u1ec9 giao:"),s.gc(),s.hc(3,"span",13),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(4),s.Sc(e.orderDetail.DeliveryInfo.Address)}}function Wt(e,t){if(1&e&&(s.hc(0,"div",30),s.hc(1,"span",12),s.Rc(2,"Y\xeau c\u1ea7u xong tr\u01b0\u1edbc:"),s.gc(),s.hc(3,"span",13),s.Rc(4),s.uc(5,"myDatePipe"),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(4),s.Sc(s.wc(5,1,e.orderDetail.MakingRequestTime,"HH:mm dd/MM/yyyy"))}}function jt(e,t){if(1&e&&(s.hc(0,"div",31),s.hc(1,"span",12),s.Rc(2,"M\xf4 t\u1ea3 KH:"),s.gc(),s.hc(3,"span",13),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(4),s.Sc(e.orderDetail.Description)}}function $t(e,t){if(1&e&&(s.hc(0,"div",31),s.hc(1,"span",12),s.Rc(2,"Ghi ch\xfa th\u1ef1c hi\u1ec7n:"),s.gc(),s.hc(3,"span",13),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(4),s.Sc(e.orderDetail.MakingNote)}}function Xt(e,t){if(1&e&&(s.hc(0,"div",31),s.hc(1,"span",12),s.Rc(2,"Ghi ch\xfa giao h\xe0ng:"),s.gc(),s.hc(3,"span",13),s.Rc(4),s.gc(),s.gc()),2&e){const e=s.tc();s.Ob(4),s.Sc(e.orderDetail.ShippingNote)}}function Qt(e,t){if(1&e){const e=s.ic();s.hc(0,"div",32),s.pc("click",(function(){return s.Jc(e),s.tc().openViewed()})),s.cc(1,"img",21),s.Rc(2,"\u0110\xe3 xem "),s.gc()}}function zt(e,t){if(1&e&&(s.hc(0,"li",33),s.cc(1,"img",34),s.uc(2,"ImgPipe"),s.hc(3,"span",35),s.Rc(4),s.gc(),s.hc(5,"span",36),s.Rc(6),s.gc(),s.gc()),2&e){const e=t.$implicit;s.Ob(1),s.Bc("src",s.wc(2,3,e.Avt,"UserAvt"),s.Lc),s.Ob(3),s.Sc(e.FullName),s.Ob(2),s.Sc(e.Role)}}let Kt=(()=>{class e extends f{constructor(e,t){super(),this.orderDetailService=e,this.orderService=t,this.Title="Chi ti\u1ebft \u0111\u01a1n",this.IsDataLosingWarning=!1,this.states=v.f,this.canSeen=!0,this.orderDetail=new b.c,this.orderDetail.SeenUsers=[],this.order=new b.d,this.noteImgs=[]}Init(){this.orderDetail=this.globalOrderDetail,this.orderService.getById(this.orderDetail.OrderId).then(e=>{null!=e&&(this.order=e)}),this.state=j.f.filter(e=>e.State===this.orderDetail.State)[0].DisplayName,this.orderDetail.NoteImages.forEach(e=>{this.noteImgs.push(M.a.getImgUrl(e,j.c.NoteImg))}),setTimeout(()=>{this.canSeen&&(this.CurrentUser.Role!==v.i.Florist&&this.CurrentUser.Role!==v.i.Shipper||this.orderDetailService.updateDetailSeen(this.orderDetail.OrderDetailId,this.CurrentUser.Id,(new Date).getTime(),!1).then(e=>{}))},2e3)}destroy(){this.canSeen=!1}openViewed(){this.orderDetailService.getODSeeners(this.orderDetail.OrderDetailId).then(e=>{this.orderDetail.SeenUsers=e,openViewed()})}openNoteImages(){this.orderDetail.NoteImages.length>0&&viewImages(()=>{})}}return e.\u0275fac=function(t){return new(t||e)(s.bc(B.a),s.bc(S.a))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-view-order-detail"]],features:[s.Lb],decls:53,vars:34,consts:[["id","prodDetail",1,"page-content"],[1,"container"],[1,"prodDetail"],[1,"prodGen"],[3,"state"],["alt","",1,"item-detail-thumb",3,"src"],[1,"item-detail-info"],[1,"item-code"],[1,"prodPrice"],[1,"prodCharge"],[1,"prodInfo","cusScroll"],[1,"prodQuan","infoGroup"],[1,"itemlabel"],[1,"itemVal"],["class","prodName infoGroup",4,"ngIf"],["class","prodAddr infoGroup",4,"ngIf"],[1,"prodTime","infoGroup"],["class","prodMakingTime infoGroup",4,"ngIf"],["class","prodDesc infoGroup",4,"ngIf"],["style","right:150px;","class","viewed",3,"click",4,"ngIf"],[1,"viewed",3,"click"],["src","../../../assets/images/eye.svg","alt","",1,"main-filter"],["id","viewed",1,"popup-content"],[1,"main-bg"],[1,"viewedList"],["class","viewItem-three-column",4,"ngFor","ngForOf"],["id","view-product",1,"popup-content","view-img-popup-content",2,"z-index","1000"],[3,"src","config"],[1,"prodName","infoGroup"],[1,"prodAddr","infoGroup"],[1,"prodMakingTime","infoGroup"],[1,"prodDesc","infoGroup"],[1,"viewed",2,"right","150px",3,"click"],[1,"viewItem-three-column"],["alt","",1,"itemAva",3,"src"],[1,"itemName"],[1,"itemRole"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"div",1),s.hc(2,"div",2),s.hc(3,"div",3),s.cc(4,"app-status-point",4),s.cc(5,"img",5),s.uc(6,"ImgPipe"),s.hc(7,"div",6),s.hc(8,"h5",7),s.Rc(9),s.gc(),s.hc(10,"span",8),s.Rc(11),s.uc(12,"myCurrPipe"),s.gc(),s.hc(13,"span",9),s.Rc(14),s.uc(15,"myCurrPipe"),s.gc(),s.hc(16,"span",9),s.Rc(17),s.uc(18,"myCurrPipe"),s.gc(),s.hc(19,"span",9),s.Rc(20),s.gc(),s.gc(),s.gc(),s.hc(21,"div",10),s.hc(22,"div",11),s.hc(23,"span",12),s.Rc(24,"Tr\u1ea1ng th\xe1i:"),s.gc(),s.hc(25,"span",13),s.Rc(26),s.gc(),s.gc(),s.Pc(27,qt,5,1,"div",14),s.Pc(28,Et,5,1,"div",14),s.Pc(29,Vt,5,1,"div",14),s.Pc(30,Jt,5,1,"div",15),s.Pc(31,Gt,5,1,"div",15),s.hc(32,"div",16),s.hc(33,"span",12),s.Rc(34,"Th\u1eddi gian giao:"),s.gc(),s.hc(35,"span",13),s.Rc(36),s.uc(37,"myDatePipe"),s.gc(),s.gc(),s.Pc(38,Wt,6,4,"div",17),s.Pc(39,jt,5,1,"div",18),s.Pc(40,$t,5,1,"div",18),s.Pc(41,Xt,5,1,"div",18),s.gc(),s.Pc(42,Qt,3,0,"div",19),s.hc(43,"div",20),s.pc("click",(function(){return t.openNoteImages()})),s.cc(44,"img",21),s.Rc(45,"\u1ea2nh ghi ch\xfa "),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(46,"div",22),s.hc(47,"h3",23),s.Rc(48,"Nh\u1eefng ng\u01b0\u1eddi \u0111\xe3 xem"),s.gc(),s.hc(49,"ul",24),s.Pc(50,zt,7,6,"li",25),s.gc(),s.gc(),s.hc(51,"div",26),s.cc(52,"angular-image-viewer",27),s.gc()),2&e&&(s.Ob(4),s.Ac("state",t.orderDetail.State),s.Ob(1),s.Bc("src",s.wc(6,22,t.orderDetail.ProductImageUrl,"ProductImg"),s.Lc),s.Ob(4),s.Sc(t.orderDetail.ProductName),s.Ob(2),s.Sc(s.vc(12,25,t.orderDetail.ModifiedPrice)),s.Ob(3),s.Tc("Gi\u1ea3m gi\xe1: ",s.vc(15,27,t.getDetailDiscount(t.orderDetail)),""),s.Ob(3),s.Tc("Ph\u1ee5 ph\xed: ",s.vc(18,29,t.orderDetail.AdditionalFee),""),s.Ob(3),s.Tc("S\u1ed1 l\u01b0\u1ee3ng: ",t.orderDetail.Quantity,""),s.Ob(6),s.Sc(t.state),s.Ob(1),s.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),s.Ob(1),s.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),s.Ob(1),s.Ac("ngIf","Florist"!=t.CurrentUser.Role),s.Ob(1),s.Ac("ngIf","Florist"!=t.CurrentUser.Role),s.Ob(1),s.Ac("ngIf","Florist"!=t.CurrentUser.Role),s.Ob(5),s.Sc(s.wc(37,31,t.orderDetail.DeliveryInfo.DateTime,"HH:mm dd/MM/yyyy")),s.Ob(2),s.Ac("ngIf","Shipper"!=t.CurrentUser.Role),s.Ob(1),s.Ac("ngIf",""!=t.orderDetail.Description),s.Ob(1),s.Ac("ngIf",""!=t.orderDetail.MakingNote),s.Ob(1),s.Ac("ngIf",""!=t.orderDetail.ShippingNote),s.Ob(1),s.Ac("ngIf","Admin"==t.CurrentUser.Role||"Account"==t.CurrentUser.Role),s.Ob(8),s.Ac("ngForOf",t.orderDetail.SeenUsers),s.Ob(2),s.Ac("src",t.noteImgs)("config",t.viewProdOptions))},directives:[me,g.l,g.k,we.a],pipes:[M.a,R.a,R.b],styles:[""]}),e})(),_t=(()=>{class e extends f{constructor(){super(),this.Title="Trang ch\u1ee7"}Init(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Vb({type:e,selectors:[["app-home"]],features:[s.Lb],decls:2,vars:0,template:function(e,t){1&e&&(s.hc(0,"p"),s.Rc(1,"home works!"),s.gc())},styles:[""]}),e})();const Zt=function(e){return[e,"VND","symbol-narrow","","vi-VN"]};function Yt(e,t){if(1&e){const e=s.ic();s.hc(0,"div",34),s.pc("click",(function(){s.Jc(e);const i=t.$implicit;return s.tc().selectItem(i)})),s.hc(1,"div",7),s.Rc(2),s.uc(3,"currency"),s.gc(),s.hc(4,"div",8),s.Rc(5),s.gc(),s.hc(6,"div",9),s.Rc(7),s.uc(8,"myDatePipe"),s.gc(),s.gc()}if(2&e){const e=t.$implicit;s.Ob(2),s.Sc(s.xc(3,3,s.Cc(11,Zt,e.Amount))),s.Ob(3),s.Sc(e.Method),s.Ob(2),s.Sc(s.vc(8,9,e.AddingTime))}}let ei=(()=>{class e extends f{constructor(e){super(),this.purchaseService=e,this.Title="C\u1eadp nh\u1eadt thanh to\xe1n",this.purchaseType=v.h,this.IsDataLosingWarning=!1,this.qrContentTemplate="",this.currTotalPaidAmount=0,this.purchaseItems=[],this.order=this.globalOrder,this.qrContent="",this.currentPurchase=new I.a}get totalBalance(){return this.order?this.order.TotalAmount-this.order.TotalPaidAmount:0}Init(){console.log(this.globalPurchases),this.purchaseItems=this.globalPurchases}selectItem(e){this.currTotalPaidAmount=this.order.TotalPaidAmount,this.order.TotalPaidAmount-=e.Amount,this.currentPurchase=new I.a,this.currentPurchase.Id=e.Id,this.currentPurchase.Amount=e.Amount,this.currentPurchase.Method=e.Method,this.currentPurchase.Note=e.Note,purchaseDoing(()=>{this.order.TotalPaidAmount=this.currTotalPaidAmount})}addPurchase(){this.currTotalPaidAmount=this.order.TotalPaidAmount,this.currentPurchase=new I.a,this.currentPurchase.Id=-1,this.currentPurchase.Amount=this.totalBalance,this.currentPurchase.Method=v.h.Cash,this.currentPurchase.Note="",purchaseDoing(()=>{})}onPayChanged(e){this.currentPurchase.Amount<10&&(this.currentPurchase.Amount*=1e3,this.moveCursor(this.currentPurchase.Amount.toString().length,"Amount")),this.currentPurchase.Amount=+this.currentPurchase.Amount}onPayFocus(){this.currentPurchase.Amount||(this.currentPurchase.Amount=0),this.moveCursor(this.currentPurchase.Amount.toString().length,"Amount")}purchaseConfirm(){if(this.currentPurchase.Amount>this.totalBalance||this.currentPurchase.Amount<=0)return void this.showError("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7!");const e=new I.a;e.OrderId=this.order.OrderId,e.Id=this.currentPurchase.Id,e.Amount=+this.currentPurchase.Amount,e.Method=this.currentPurchase.Method,e.AddingTime=(new Date).getTime(),e.Note=this.currentPurchase.Note,this.order.TotalPaidAmount+=e.Amount,this.purchaseService.createOrUpdate(e,this.order.TotalPaidAmount).then(t=>{if(e.Id>0){const t=this.purchaseItems.filter(t=>t.Id===e.Id)[0];t.OrderId=e.OrderId,t.Id=e.Id,t.Amount=+e.Amount,t.Method=e.Method,this.showSuccess("\u0110\xe3 c\u1eadp nh\u1eadt 1 thanh to\xe1n!"),dismissPurchaseDialog()}else this.globalPurchases.push(e),this.showSuccess("\u0110\xe3 th\xeam 1 thanh to\xe1n!"),this.currentPurchase.Amount=0,this.totalBalance<=0&&dismissPurchaseDialog()})}selectPurType(e){this.currentPurchase.Method=e,e===v.h.Momo&&this.currentPurchase.Amount>0&&(this.qrContent=this.qrContentTemplate+this.currentPurchase.Amount.toString(),openQR())}}return e.\u0275fac=function(t){return new(t||e)(s.bc(y.a))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-view-purchase"]],features:[s.Lb],decls:74,vars:21,consts:[["id","customerInfo",1,"page-content"],[1,"container"],[1,"row","checkTop","search"],[1,"col-12","mx-auto","text-center"],["type","button",1,"btn","main-btn","w-100",3,"click"],[1,"nameTable"],[1,"tableHead"],[1,"tableCenter"],[1,"tableLeft"],[1,"tableRight"],["id","customer-list",1,"tableBody","cusScroll"],["class","tableRow main-bg customer-item",3,"click",4,"ngFor","ngForOf"],[1,"orderTotal"],[1,"totalOld"],[1,"orderPrice"],[1,"totalNew"],["id","purchase-dialog",1,"popup-content"],[1,"checkOut",2,"margin-top","0px","padding","0px"],[1,"checkOutTotal"],[1,"checkOutLeft","mb-2"],[1,"form-group"],["for","currentPayAmount",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Amount","id","Amount",1,"mainForm",3,"ngModel","input","focus","ngModelChange"],["for","Note",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Note","id","Note",1,"mainForm",3,"ngModel","ngModelChange"],[1,"form-group","methodGrid","mb-0"],["href","javascript:void(0)",1,"methodItem",3,"ngClass","click"],["src","../../../../assets/images/momo.jpg","alt",""],["src","../../../../assets/images/banking.jpg","alt",""],["src","../../../../assets/images/cash.png","alt",""],[1,"row"],["id","codeQR",1,"popup-content"],[3,"value","size"],["type","button","id","submit-btn","onClick","qrDone()",1,"btn","main-btn","w-100","mt-3"],[1,"tableRow","main-bg","customer-item",3,"click"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"div",1),s.hc(2,"div",2),s.hc(3,"div",3),s.hc(4,"button",4),s.pc("click",(function(){return t.addPurchase()})),s.Rc(5,"Th\xeam thanh to\xe1n"),s.gc(),s.gc(),s.gc(),s.hc(6,"div",5),s.hc(7,"div",6),s.hc(8,"div",7),s.Rc(9,"S\u1ed1 ti\u1ec1n"),s.gc(),s.hc(10,"div",8),s.Rc(11,"H\xecnh th\u1ee9c"),s.gc(),s.hc(12,"div",9),s.Rc(13,"Th\u1eddi gian"),s.gc(),s.gc(),s.hc(14,"div",10),s.Pc(15,Yt,9,13,"div",11),s.gc(),s.gc(),s.hc(16,"div",12),s.hc(17,"p",13),s.Rc(18,"M\xe3 \u0111\u01a1n: "),s.hc(19,"span",14),s.Rc(20),s.gc(),s.gc(),s.hc(21,"p",13),s.Rc(22,"C\xf2n l\u1ea1i: "),s.hc(23,"span",14),s.Rc(24),s.uc(25,"myCurrPipe"),s.gc(),s.gc(),s.hc(26,"p",15),s.Rc(27,"Th\xe0nh ti\u1ec1n: "),s.hc(28,"span",14),s.Rc(29),s.uc(30,"myCurrPipe"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(31,"div",16),s.hc(32,"div",1),s.hc(33,"div",17),s.hc(34,"div",18),s.hc(35,"h3"),s.Rc(36,"T\u1ed5ng"),s.gc(),s.hc(37,"p"),s.Rc(38),s.uc(39,"myCurrPipe"),s.gc(),s.gc(),s.hc(40,"div",19),s.hc(41,"h4"),s.Rc(42,"S\u1ed1 ti\u1ec1n c\xf2n l\u1ea1i"),s.gc(),s.hc(43,"p"),s.Rc(44),s.uc(45,"myCurrPipe"),s.gc(),s.gc(),s.hc(46,"div",20),s.hc(47,"label",21),s.Rc(48,"S\u1ed1 ti\u1ec1n thanh to\xe1n"),s.gc(),s.hc(49,"input",22),s.pc("input",(function(e){return t.onPayChanged(e.target.value)}))("focus",(function(){return t.onPayFocus()}))("ngModelChange",(function(e){return t.currentPurchase.Amount=e})),s.gc(),s.gc(),s.hc(50,"div",20),s.hc(51,"label",23),s.Rc(52,"Ghi Ch\xfa"),s.gc(),s.hc(53,"input",24),s.pc("ngModelChange",(function(e){return t.currentPurchase.Note=e})),s.gc(),s.gc(),s.hc(54,"div",25),s.hc(55,"a",26),s.pc("click",(function(){return t.selectPurType(t.purchaseType.Momo)})),s.cc(56,"img",27),s.gc(),s.hc(57,"a",26),s.pc("click",(function(){return t.selectPurType(t.purchaseType.Banking)})),s.cc(58,"img",28),s.gc(),s.hc(59,"a",26),s.pc("click",(function(){return t.selectPurType(t.purchaseType.Cash)})),s.cc(60,"img",29),s.gc(),s.gc(),s.hc(61,"div",30),s.hc(62,"div",3),s.hc(63,"button",4),s.pc("click",(function(){return t.purchaseConfirm()})),s.Rc(64,"X\xe1c nh\u1eadn"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(65,"div",31),s.hc(66,"span"),s.Rc(67,"Qu\xe9t m\xe3 QR \u0111\u1ec3 thanh to\xe1n"),s.gc(),s.hc(68,"div"),s.cc(69,"qr-code",32),s.gc(),s.hc(70,"div",30),s.hc(71,"div",3),s.hc(72,"button",33),s.Rc(73,"Xong"),s.gc(),s.gc(),s.gc(),s.gc()),2&e&&(s.Ob(15),s.Ac("ngForOf",t.purchaseItems),s.Ob(5),s.Tc("",t.order.OrderId," "),s.Ob(4),s.Tc("",s.vc(25,13,t.totalBalance)," "),s.Ob(5),s.Tc("",s.vc(30,15,t.order.TotalAmount)," "),s.Ob(9),s.Sc(s.vc(39,17,t.order.TotalAmount)),s.Ob(6),s.Sc(s.vc(45,19,t.totalBalance)),s.Ob(5),s.Ac("ngModel",t.currentPurchase.Amount),s.Ob(4),s.Ac("ngModel",t.currentPurchase.Note),s.Ob(2),s.Ac("ngClass","Momo"===t.currentPurchase.Method?" img-purchase-selected":""),s.Ob(2),s.Ac("ngClass","Banking"===t.currentPurchase.Method?" img-purchase-selected":""),s.Ob(2),s.Ac("ngClass","Cash"===t.currentPurchase.Method?" img-purchase-selected":""),s.Ob(10),s.Ac("value",t.qrContent)("size",290))},directives:[g.k,T.b,T.k,T.n,g.j,w.a],pipes:[R.a,g.c,R.b],styles:[""]}),e})();function ti(e,t){if(1&e){const e=s.ic();s.hc(0,"div",34),s.pc("click",(function(){s.Jc(e);const i=t.$implicit,c=t.index;return s.tc().selectItem(i,c)})),s.hc(1,"div",7),s.Rc(2),s.gc(),s.hc(3,"div",8),s.Rc(4),s.uc(5,"myCurrPipe"),s.gc(),s.hc(6,"div",9),s.Rc(7),s.uc(8,"myDatePipe"),s.gc(),s.gc()}if(2&e){const e=t.$implicit;s.Ob(2),s.Sc(e.Method),s.Ob(2),s.Sc(s.vc(5,3,e.Amount)),s.Ob(3),s.Tc("",s.wc(8,5,e.AddingTime,"HH:mm dd/MM/yyyy")," ")}}function ii(e,t){1&e&&(s.hc(0,"div"),s.Rc(1," S\u1ed1 ti\u1ec1n l\xe0 b\u1eaft bu\u1ed9c "),s.gc())}function ci(e,t){1&e&&(s.hc(0,"div"),s.Rc(1," S\u1ed1 ti\u1ec1n t\u1ed1i thi\u1ec3u 3 k\xfd t\u1ef1 "),s.gc())}function ri(e,t){if(1&e&&(s.hc(0,"div",35),s.Pc(1,ii,2,0,"div",36),s.Pc(2,ci,2,0,"div",36),s.gc()),2&e){s.tc();const e=s.Hc(27);s.Ob(1),s.Ac("ngIf",e.errors.required),s.Ob(1),s.Ac("ngIf",e.errors.minlength)}}const ni=[{path:"login",component:Ut},{path:"",component:Ht,children:[{path:"",component:_t,canActivate:[r.f]},{path:"add-purchse",component:(()=>{class e extends f{constructor(e){super(),this.purchaseService=e,this.Title="Thanh to\xe1n n\u1eb7c danh",this.currentIndex=-1,this.purchaseMethod=v.h,this.currPurchase=new I.a,this.purchases=[],this.currentAddingTime=new Date}Init(){}selectItem(e,t){this.currentIndex=t,this.currPurchase=new I.a,this.currPurchase.Amount=e.Amount,this.currentAddingTime=new Date(e.AddingTime),this.currPurchase.Id=e.Id,this.currPurchase.Method=e.Method,this.currPurchase.OrderId=e.OrderId,this.currPurchase.Note=e.Note,openAddPurchaseDialog()}addPurchase(){this.currPurchase=new I.a,this.currPurchase.Amount=0,this.currentAddingTime=new Date,this.currPurchase.Id=0,this.currPurchase.Method=v.h.Banking,this.currPurchase.OrderId="",this.currPurchase.Note="",openAddPurchaseDialog()}onAmountChanged(e){this.currPurchase.Amount<10&&(this.currPurchase.Amount*=1e3,this.moveCursor(this.currPurchase.Amount.toString().length,"Amount")),this.currPurchase.Amount=+this.currPurchase.Amount}onAmountFocus(){this.currPurchase.Amount||(this.currPurchase.Amount=0),this.moveCursor(this.currPurchase.Amount.toString().length,"Amount")}purchaseSaving(e){e.valid&&(this.currentIndex>-1?(Object.assign(this.purchases[this.currentIndex],this.currPurchase),this.purchases[this.currentIndex].AddingTime=this.currentAddingTime.getTime(),this.currentIndex=-1):(this.currPurchase.AddingTime=this.currentAddingTime.getTime(),this.purchases.push(this.currPurchase)),dissmissAddPurchaseDialog())}saveChanges(){this.purchases.length<=0||this.purchaseService.bulkCreate(this.purchases,"",()=>{this.purchases=[]})}}return e.\u0275fac=function(t){return new(t||e)(s.bc(y.a))},e.\u0275cmp=s.Vb({type:e,selectors:[["app-add-purchase"]],features:[s.Lb],decls:57,vars:12,consts:[["id","customerInfo",1,"page-content"],[1,"container"],[1,"row","checkTop","search"],[1,"col-12","mx-auto","text-center"],["type","button",1,"btn","main-btn","w-100",3,"click"],[1,"nameTable"],[1,"tableHead"],[1,"tableLeft","small-width"],[1,"tableCenter"],[1,"tableRight","large-width"],["id","customer-list",1,"tableBody","cusScroll"],["class","tableRow main-bg customer-item",3,"click",4,"ngFor","ngForOf"],["id","addPurchase",1,"popup-content"],["autocomplete","on",1,"addInfoForm",3,"submit"],["form","ngForm"],[1,"form-group"],["for","Amount",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Amount","id","Amount","required","","minlength","3","placeholder","S\xf4 ti\u1ec1n...",1,"mainForm",3,"ngModel","input","focus","ngModelChange"],["Amount","ngModel"],["class","alert alert-danger",4,"ngIf"],["for","Note",2,"width","100%","text-align","left","margin-bottom","0px"],["type","tel","name","Note","id","Note",1,"mainForm",3,"ngModel","ngModelChange"],["for","Method",2,"width","100%","text-align","left","margin-bottom","0px"],["id","Method","name","Method",1,"mainForm",3,"ngModel","ngModelChange"],["selected",""],[3,"ngValue"],["for","currentAddingTime",2,"width","100%","text-align","left","margin-bottom","0px"],["name","currentAddingTime",1,"mainForm",3,"owlDateTime","owlDateTimeTrigger","ngModel","ngModelChange"],[3,"stepMinute"],["dt1",""],[1,"row"],[1,"col-6","mx-auto","text-center"],["type","button","id","cancel-button","onClick","dissmissAddPurchaseDialog()",1,"btn","grey-btn","w-100","mt-3"],["type","submit",1,"btn","main-btn","w-100","mt-3","btn-success"],[1,"tableRow","main-bg","customer-item",3,"click"],[1,"alert","alert-danger"],[4,"ngIf"]],template:function(e,t){if(1&e){const e=s.ic();s.hc(0,"div",0),s.hc(1,"div",1),s.hc(2,"div",2),s.hc(3,"div",3),s.hc(4,"button",4),s.pc("click",(function(){return t.addPurchase()})),s.Rc(5,"Th\xeam thanh to\xe1n"),s.gc(),s.gc(),s.gc(),s.hc(6,"div",5),s.hc(7,"div",6),s.hc(8,"div",7),s.Rc(9,"H\xecnh th\u1ee9c"),s.gc(),s.hc(10,"div",8),s.Rc(11,"S\u1ed1 ti\u1ec1n"),s.gc(),s.hc(12,"div",9),s.Rc(13,"Th\u1eddi gian"),s.gc(),s.gc(),s.hc(14,"div",10),s.Pc(15,ti,9,8,"div",11),s.gc(),s.gc(),s.hc(16,"div",2),s.hc(17,"div",3),s.hc(18,"button",4),s.pc("click",(function(){return t.saveChanges()})),s.Rc(19,"L\u01b0u"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.hc(20,"div",12),s.hc(21,"form",13,14),s.pc("submit",(function(){s.Jc(e);const i=s.Hc(22);return t.purchaseSaving(i)})),s.hc(23,"div",15),s.hc(24,"label",16),s.Rc(25,"S\u1ed1 ti\u1ec1n"),s.gc(),s.hc(26,"input",17,18),s.pc("input",(function(e){return t.onAmountChanged(e.target.value)}))("focus",(function(){return t.onAmountFocus()}))("ngModelChange",(function(e){return t.currPurchase.Amount=e})),s.gc(),s.Pc(28,ri,3,2,"div",19),s.gc(),s.hc(29,"div",15),s.hc(30,"label",20),s.Rc(31,"Ghi Ch\xfa"),s.gc(),s.hc(32,"input",21),s.pc("ngModelChange",(function(e){return t.currPurchase.Note=e})),s.gc(),s.gc(),s.hc(33,"div",15),s.hc(34,"label",22),s.Rc(35,"H\xecnh th\u1ee9c thanh to\xe1n"),s.gc(),s.hc(36,"select",23),s.pc("ngModelChange",(function(e){return t.currPurchase.Method=e})),s.hc(37,"option",24),s.Rc(38,"Ch\u1ecdn..."),s.gc(),s.hc(39,"option",25),s.Rc(40,"Ti\u1ec1n m\u1eb7t"),s.gc(),s.hc(41,"option",25),s.Rc(42,"Chuy\u1ec3n kho\u1ea3n"),s.gc(),s.hc(43,"option",25),s.Rc(44,"V\xed Momo"),s.gc(),s.gc(),s.gc(),s.hc(45,"label",26),s.Rc(46,"Th\u1eddi gian"),s.gc(),s.hc(47,"input",27),s.pc("ngModelChange",(function(e){return t.currentAddingTime=e})),s.gc(),s.cc(48,"owl-date-time",28,29),s.hc(50,"div",30),s.hc(51,"div",31),s.hc(52,"button",32),s.Rc(53,"H\u1ee7y"),s.gc(),s.gc(),s.hc(54,"div",31),s.hc(55,"button",33),s.Rc(56,"L\u01b0u"),s.gc(),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=s.Hc(27),i=s.Hc(49);s.Ob(15),s.Ac("ngForOf",t.purchases),s.Ob(11),s.Ac("ngModel",t.currPurchase.Amount),s.Ob(2),s.Ac("ngIf",e.invalid&&(e.dirty||e.touched)),s.Ob(4),s.Ac("ngModel",t.currPurchase.Note),s.Ob(4),s.Ac("ngModel",t.currPurchase.Method),s.Ob(3),s.Ac("ngValue",t.purchaseMethod.Cash),s.Ob(2),s.Ac("ngValue",t.purchaseMethod.Banking),s.Ob(2),s.Ac("ngValue",t.purchaseMethod.Momo),s.Ob(4),s.Ac("owlDateTime",i)("owlDateTimeTrigger",i)("ngModel",t.currentAddingTime),s.Ob(1),s.Ac("stepMinute",5)}},directives:[g.k,T.v,T.l,T.m,T.b,T.r,T.h,T.k,T.n,g.l,T.s,T.o,T.u,k.c,k.f,k.b],pipes:[R.a,R.b],styles:[""]}),e})(),canActivate:[r.b]},{path:"final-confirm",component:z,canActivate:[r.b]},{path:"view-purchase",component:ei,canActivate:[r.b]},{path:"customer-confirming",component:G,canActivate:[r.a]},{path:"shipper-main",component:At,canActivate:[r.a]},{path:"sort-order-changing",component:xt,canActivate:[r.b]},{path:"florist-main",component:be,canActivate:[r.d]},{path:"order-detail-confirming",component:Te,canActivate:[r.a]},{path:"orders-manage",canActivate:[r.b],component:ze},{path:"select-customer",component:dt,canActivate:[r.b]},{path:"order-detail/:id",component:Le,canActivate:[r.b]},{path:"search-product",component:Dt,canActivate:[r.b]},{path:"add-order",component:x,canActivate:[r.b]},{path:"select-receiver",component:St,canActivate:[r.b]},{path:"order-detail-view",component:Kt,canActivate:[r.e]}]}];let oi=(()=>{class e{}return e.\u0275mod=s.Zb({type:e}),e.\u0275inj=s.Yb({factory:function(t){return new(t||e)},imports:[[c.d.forChild(ni),n.a],c.d]}),e})()}}]);